MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  1


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00001 
                      00002 ; PICBASIC PRO(TM) Compiler 3.0.7.1, (c) 1998, 2013 microEngineering Labs, Inc. All Rights Reserved. 
  00000001            00003 MPASMWIN_USED                   EQU     1
                      00004 
                      00005 #define PBP_PATH        C:\PROGRAM FILES (X86)\PBP3\
                      00006 
                      00007 
                      00008 
                      00009 
                      00016         LIST
                      00017         LIST p = 18F4550, r = dec, w = -311, w = -230, f = inhx32
                      00018         INCLUDE "P18F4550.INC"  ; MPASM  Header
                      00001         LIST
                      00002 
                      00003 ;==========================================================================
                      00004 ;  MPASM PIC18F4550 processor include
                      00005 ; 
                      00006 ;  (c) Copyright 1999-2013 Microchip Technology, All rights reserved
                      00007 ;==========================================================================
                      00008 
                      01764         LIST
                      00021         LIST
  00F00000            00022 EEPROM_START    EQU     0F00000h
  00000020            00023 BLOCK_SIZE      EQU     32
                      00024 
                      00025 
                      00026 PBP_HARDWAREDEF  macro
                      00027   endm
                      00028 
                      00029 
24 06 3F 13 01 A1 0F C00030     CONFIG  PLLDIV = 5            ; Divide by 5 (20 MHz oscillator input)
       0 0F E0 0F 40 
                      00031     CONFIG  CPUDIV = OSC1_PLL2    ;[Primary Oscillator Src: /1][96 MHz PLL Src: /2]
                      00032     CONFIG  USBDIV = 2            ; USB clock source comes from the 96 MHz PLL divided by 2
                      00033     CONFIG  FOSC = ECPLLIO_EC     ; EC oscillator, PLL enabled, port function on RA6 (ECPIO)
                      00034     CONFIG  FCMEN = OFF           ; Fail-Safe Clock Monitor disabled
                      00035     CONFIG  IESO = OFF            ; Oscillator Switchover mode disabled
                      00036     CONFIG  PWRT = OFF            ; PWRT disabled
                      00037     CONFIG  BOR = ON              ; Brown-out Reset enabled in hardware only (SBOREN is disabled)
                      00038     CONFIG  VREGEN = ON           ; USB voltage regulator enabled
                      00039     CONFIG  WDT = ON              ; WDT enabled
                      00040     CONFIG  WDTPS = 512           ; 1:512
                      00041     CONFIG  PBADEN = OFF          ; PORTB<4:0> pins are configured as digital I/O on Reset
                      00042     CONFIG  LPT1OSC = OFF         ; Timer1 configured for higher power operation
                      00043     CONFIG  MCLRE = OFF           ; RE3 input pin enabled; MCLR pin disabled
                      00044     CONFIG  STVREN = ON           ; Stack full/underflow will cause Reset
                      00045     CONFIG  LVP = OFF             ; Single-Supply ICSP disabled
                      00046     CONFIG  ICPRT = ON            ; ICPORT enabled
                      00047     CONFIG  CP0 = OFF             ; Block 0 (000800-001FFFh) is not code-protected
                      00048     CONFIG  CP1 = OFF             ; Block 1 (002000-003FFFh) is not code-protected
                      00049     CONFIG  CP2 = OFF             ; Block 2 (004000-005FFFh) is not code-protected
                      00050     CONFIG  CP3 = OFF             ; Block 3 (006000-007FFFh) is not code-protected
                      00051     
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  2


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00052 
                      00053 
                      00054 
                      00055 ; Define statements.
                      00056 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00040   DEFINE OSC 48
                      00057 #define         OSC              48
                      00058 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00042   Define ADC_BITS     10  ' Set number of bits in result
                      00059 #define         ADC_BITS                     10  
                      00060 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00043   Define ADC_CLOCK     3  ' Set clock source (3=rc)
                      00061 #define         ADC_CLOCK                    3  
                      00062 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00044   Define ADC_SAMPLEUS 50  ' Set sampling time in uS
                      00063 #define         ADC_SAMPLEUS             50  
                      00064 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00047   DEFINE HSER_RCSTA 90h 
                      00065 #define         HSER_RCSTA               90h 
                      00066 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00050   DEFINE HSER_TXSTA 24h 
                      00067 #define         HSER_TXSTA               24h 
                      00068 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00053   DEFINE HSER_BAUD 115200
                      00069 #define         HSER_BAUD                115200
                      00070 
  00000000            00071 RAM_START                       EQU     00000h
  000007FF            00072 RAM_END                         EQU     007FFh
  00000008            00073 RAM_BANKS                       EQU     00008h
  00000060            00074 BANK0_START                     EQU     00060h
  000000FF            00075 BANK0_END                       EQU     000FFh
  00000100            00076 BANK1_START                     EQU     00100h
  000001FF            00077 BANK1_END                       EQU     001FFh
  00000200            00078 BANK2_START                     EQU     00200h
  000002FF            00079 BANK2_END                       EQU     002FFh
  00000300            00080 BANK3_START                     EQU     00300h
  000003FF            00081 BANK3_END                       EQU     003FFh
  00000400            00082 BANK4_START                     EQU     00400h
  000004FF            00083 BANK4_END                       EQU     004FFh
  00000500            00084 BANK5_START                     EQU     00500h
  000005FF            00085 BANK5_END                       EQU     005FFh
  00000600            00086 BANK6_START                     EQU     00600h
  000006FF            00087 BANK6_END                       EQU     006FFh
  00000700            00088 BANK7_START                     EQU     00700h
  000007FF            00089 BANK7_END                       EQU     007FFh
  00000000            00090 BANKA_START                     EQU     00000h
  0000005F            00091 BANKA_END                       EQU     0005Fh
                      00092 
                      00093 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00028   A00000  FLAGS   VAR     BYTE BANKA SYSTEM       
                            ' Static flags
  00000000            00094 FLAGS                           EQU     RAM_START + 000h
                      00095 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00027   A00001  GOP     VAR     BYTE BANKA SYSTEM       
                            ' Gen Op Parameter
  00000001            00096 GOP                             EQU     RAM_START + 001h
                      00097 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00012   A00002  R0      VAR     WORD BANKA SYSTEM       
                            ' System Register
  00000002            00098 R0                              EQU     RAM_START + 002h
                      00099 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00013   A00004  R1      VAR     WORD BANKA SYSTEM       
                            ' System Register
  00000004            00100 R1                              EQU     RAM_START + 004h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  3


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00101 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00014   A00006  R2      VAR     WORD BANKA SYSTEM       
                            ' System Register
  00000006            00102 R2                              EQU     RAM_START + 006h
                      00103 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00015   A00008  R3      VAR     WORD BANKA SYSTEM       
                            ' System Register
  00000008            00104 R3                              EQU     RAM_START + 008h
                      00105 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00016   A0000A  R4      VAR     WORD BANKA SYSTEM       
                            ' System Register
  0000000A            00106 R4                              EQU     RAM_START + 00Ah
                      00107 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00017   A0000C  R5      VAR     WORD BANKA SYSTEM       
                            ' System Register
  0000000C            00108 R5                              EQU     RAM_START + 00Ch
                      00109 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00018   A0000E  R6      VAR     WORD BANKA SYSTEM       
                            ' System Register
  0000000E            00110 R6                              EQU     RAM_START + 00Eh
                      00111 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00019   A00010  R7      VAR     WORD BANKA SYSTEM       
                            ' System Register
  00000010            00112 R7                              EQU     RAM_START + 010h
                      00113 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00020   A00012  R8      VAR     WORD BANKA SYSTEM       
                            ' System Register
  00000012            00114 R8                              EQU     RAM_START + 012h
                      00115 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00001   A00014  '***********************************************
                            *****************
  00000014            00116 T1                              EQU     RAM_START + 014h
                      00117 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00001   A00016  '***********************************************
                            *****************
  00000016            00118 T2                              EQU     RAM_START + 016h
                      00119 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00023   A00018  RM1     VAR     BYTE BANKA SYSTEM       
                            ' Pin 1 Mask
  00000018            00120 RM1                             EQU     RAM_START + 018h
                      00121 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00026   A00019  RM2     VAR     BYTE BANKA SYSTEM       
                            ' Pin 2 Mask
  00000019            00122 RM2                             EQU     RAM_START + 019h
                      00123 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00021   A0001A  RR1     VAR     BYTE BANKA SYSTEM       
                            ' Pin 1 Register
  0000001A            00124 RR1                             EQU     RAM_START + 01Ah
                      00125 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00024   A0001B  RR2     VAR     BYTE BANKA SYSTEM       
                            ' Pin 2 Register
  0000001B            00126 RR2                             EQU     RAM_START + 01Bh
                      00127 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00022   A0001C  RS1     VAR     BYTE BANKA SYSTEM       
                            ' Pin 1 Bank
  0000001C            00128 RS1                             EQU     RAM_START + 01Ch
                      00129 ; C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.RAM      00025   A0001D  RS2     VAR     BYTE BANKA SYSTEM       
                            ' Pin 2 Bank
  0000001D            00130 RS2                             EQU     RAM_START + 01Dh
                      00131 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00001   A0001E  '***********************************************
                            *****************
  0000001E            00132 PB01                            EQU     RAM_START + 01Eh
                      00133 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00061   A00060  AllFlags        var byte        $60     ;Flags.0
                             = USB out 
  00000060            00134 _AllFlags                       EQU     RAM_START + 060h
                      00135 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00062   A00061  FunctionKeys    var byte        $61     ;IO Inpu
                            t State
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  4


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000061            00136 _FunctionKeys                   EQU     RAM_START + 061h
                      00137 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00063   A00062  P1Keys          var word        $62     ;IO Inpu
                            t State
  00000062            00138 _P1Keys                         EQU     RAM_START + 062h
                      00139 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00064   A00064  P2Keys          var word        $64     ;IO Inpu
                            t State
  00000064            00140 _P2Keys                         EQU     RAM_START + 064h
                      00141 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00065   A00066  FKeytemp        var byte        $66     ;IO Inpu
                            t State Temp
  00000066            00142 _FKeytemp                       EQU     RAM_START + 066h
                      00143 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00066   A00067  F1Keys          var word        $67     ;IO Inpu
                            t State Temp
  00000067            00144 _F1Keys                         EQU     RAM_START + 067h
                      00145 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00067   A00069  F2Keys          var word        $69     ;IO Inpu
                            t State Temp
  00000069            00146 _F2Keys                         EQU     RAM_START + 069h
                      00147 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00068   A0006B  OUTPUTS0        var byte        $6B
  0000006B            00148 _OUTPUTS0                       EQU     RAM_START + 06Bh
                      00149 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00069   A0006C  OUTPUTS1        var byte        $6C
  0000006C            00150 _OUTPUTS1                       EQU     RAM_START + 06Ch
                      00151 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00070   A0006D  OUTPUTS2        var byte        $6D
  0000006D            00152 _OUTPUTS2                       EQU     RAM_START + 06Dh
                      00153 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00072   A0006E  ANINPUT         VAR WORD        $6E     ;IO Anal
                            og Input State
  0000006E            00154 _ANINPUT                        EQU     RAM_START + 06Eh
                      00155 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00073   A00070  ANALOG0         var WORD        $70     ;IO Anal
                            og Input State
  00000070            00156 _ANALOG0                        EQU     RAM_START + 070h
                      00157 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00074   A00072  ANALOG1         var WORD        $72     ;IO Anal
                            og Input State
  00000072            00158 _ANALOG1                        EQU     RAM_START + 072h
                      00159 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00075   A00074  ANALOG2         var WORD        $74     ;IO Anal
                            og Input State
  00000074            00160 _ANALOG2                        EQU     RAM_START + 074h
                      00161 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00076   A00076  ANALOG3         var WORD        $76     ;IO Anal
                            og Input State
  00000076            00162 _ANALOG3                        EQU     RAM_START + 076h
                      00163 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00077   A00078  ANALOG4         var WORD        $78     ;IO Anal
                            og Input State
  00000078            00164 _ANALOG4                        EQU     RAM_START + 078h
                      00165 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00078   A0007A  ANALOG5         var WORD        $7A     ;IO Anal
                            og Input State
  0000007A            00166 _ANALOG5                        EQU     RAM_START + 07Ah
                      00167 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00079   A0007C  ANALOG6         var WORD        $7C     ;IO Anal
                            og Input State
  0000007C            00168 _ANALOG6                        EQU     RAM_START + 07Ch
                      00169 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00080   A0007E  ANALOG7         var WORD        $7E     ;IO Anal
                            og Input State
  0000007E            00170 _ANALOG7                        EQU     RAM_START + 07Eh
                      00171 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00081   A00080  ANTemp0         var word        $80     ;IO Anal
                            og Input State Temp
  00000080            00172 _ANTemp0                        EQU     RAM_START + 080h
                      00173 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00082   A00082  ANTemp1         var word        $82     ;IO Anal
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  5


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            og Input State Temp
  00000082            00174 _ANTemp1                        EQU     RAM_START + 082h
                      00175 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00083   A00084  ANTemp2         var word        $84     ;IO Anal
                            og Input State Temp
  00000084            00176 _ANTemp2                        EQU     RAM_START + 084h
                      00177 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00084   A00086  ANTemp3         var word        $86     ;IO Anal
                            og Input State Temp
  00000086            00178 _ANTemp3                        EQU     RAM_START + 086h
                      00179 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00085   A00088  ANTemp4         var word        $88     ;IO Anal
                            og Input State Temp
  00000088            00180 _ANTemp4                        EQU     RAM_START + 088h
                      00181 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00086   A0008A  ANTemp5         var word        $8A     ;IO Anal
                            og Input State Temp
  0000008A            00182 _ANTemp5                        EQU     RAM_START + 08Ah
                      00183 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00087   A0008C  ANTemp6         var word        $8C     ;IO Anal
                            og Input State Temp
  0000008C            00184 _ANTemp6                        EQU     RAM_START + 08Ch
                      00185 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00088   A0008E  ANTemp7         var word        $8E     ;IO Anal
                            og Input State Temp
  0000008E            00186 _ANTemp7                        EQU     RAM_START + 08Eh
                      00187 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00089   A00090  USBBuffer       Var Byte[10]    $90
  00000090            00188 _USBBuffer                      EQU     RAM_START + 090h
                      00189 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00090   A0009B  USBBufferCount  Var Byte        $9B
  0000009B            00190 _USBBufferCount                 EQU     RAM_START + 09Bh
                      00191 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00091   A0009C  IDTX            var byte        $9C
  0000009C            00192 _IDTX                           EQU     RAM_START + 09Ch
                      00193 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00092   A0009D  Temp            var byte        $9D
  0000009D            00194 _Temp                           EQU     RAM_START + 09Dh
                      00195 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00093   A0009E  CHUTES0         var byte        $9E
  0000009E            00196 _CHUTES0                        EQU     RAM_START + 09Eh
                      00197 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00094   A0009F  CHUTES1         var byte        $9F
  0000009F            00198 _CHUTES1                        EQU     RAM_START + 09Fh
                      00199 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00095   A000A0  VConfig         var byte        $A0     ;commcou
                            nter,Autocounter,coinSlot1,coinSlot2,counter Enable 
  000000A0            00200 _VConfig                        EQU     RAM_START + 0A0h
                      00201 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00096   A000A1  TRIGGER1        var byte        $A1
  000000A1            00202 _TRIGGER1                       EQU     RAM_START + 0A1h
                      00203 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00097   A000A2  TRIGGER2        var byte        $A2
  000000A2            00204 _TRIGGER2                       EQU     RAM_START + 0A2h
                      00205 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00098   A000A3  TIMER1          var byte        $A3
  000000A3            00206 _TIMER1                         EQU     RAM_START + 0A3h
                      00207 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00099   A000A4  TIMER2          var byte        $A4
  000000A4            00208 _TIMER2                         EQU     RAM_START + 0A4h
                      00209 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00100   A000A5  MEDIAK          var byte        $A5
  000000A5            00210 _MEDIAK                         EQU     RAM_START + 0A5h
                      00211 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00101   A000A6  TMEDIAK         var byte        $A6
  000000A6            00212 _TMEDIAK                        EQU     RAM_START + 0A6h
                      00213 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00102   A000A7  i               var byte        $A7
  000000A7            00214 _i                              EQU     RAM_START + 0A7h
                      00215 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00103   A000A8  x               var byte        $A8
  000000A8            00216 _x                              EQU     RAM_START + 0A8h
                      00217 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00104   A000A9  y               var byte        $A9
  000000A9            00218 _y                              EQU     RAM_START + 0A9h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  6


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00219 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00105   A000AA  epTX            var byte        $AA
  000000AA            00220 _epTX                           EQU     RAM_START + 0AAh
                      00221 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00106   A000AB  POV1            var byte        $AB
  000000AB            00222 _POV1                           EQU     RAM_START + 0ABh
                      00223 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00107   A000AC  POV2            var byte        $AC
  000000AC            00224 _POV2                           EQU     RAM_START + 0ACh
                      00225 ; C:\TEMP\DCLFI32V1.0\DES_FIRMAC01.BAS  00005   A00400  USBReservedMemory Var Byte[USBMEMORYSIZE] USBMEM
                            ORYADDRESS      ' Reserve memory used by USB assembler code
  00000400            00226 _USBReservedMemory              EQU     RAM_START + 00400h
                      00227 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00305   PORTL   VAR     PORTB
  00000F81            00228 _PORTL                          EQU      PORTB
                      00229 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00306   PORTH   VAR     PORTC
  00000F82            00230 _PORTH                          EQU      PORTC
                      00231 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00307   TRISL   VAR     TRISB
  00000F93            00232 _TRISL                          EQU      TRISB
                      00233 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00308   TRISH   VAR     TRISC
  00000F94            00234 _TRISH                          EQU      TRISC
  00000072            00235 _ANALOG1??LOWBYTE               EQU     _ANALOG1
  00000073            00236 _ANALOG1??HIGHBYTE              EQU     _ANALOG1 + 001h
  0000007A            00237 _ANALOG5??LOWBYTE               EQU     _ANALOG5
  0000007B            00238 _ANALOG5??HIGHBYTE              EQU     _ANALOG5 + 001h
  0000007E            00239 _ANALOG7??LOWBYTE               EQU     _ANALOG7
  0000007F            00240 _ANALOG7??HIGHBYTE              EQU     _ANALOG7 + 001h
  00000076            00241 _ANALOG3??LOWBYTE               EQU     _ANALOG3
  00000077            00242 _ANALOG3??HIGHBYTE              EQU     _ANALOG3 + 001h
  0000007C            00243 _ANALOG6??LOWBYTE               EQU     _ANALOG6
  0000007D            00244 _ANALOG6??HIGHBYTE              EQU     _ANALOG6 + 001h
  00000070            00245 _ANALOG0??LOWBYTE               EQU     _ANALOG0
  00000071            00246 _ANALOG0??HIGHBYTE              EQU     _ANALOG0 + 001h
  00000074            00247 _ANALOG2??LOWBYTE               EQU     _ANALOG2
  00000075            00248 _ANALOG2??HIGHBYTE              EQU     _ANALOG2 + 001h
  00000078            00249 _ANALOG4??LOWBYTE               EQU     _ANALOG4
  00000079            00250 _ANALOG4??HIGHBYTE              EQU     _ANALOG4 + 001h
                      00251 #define _COUNTS1                 PB01, 000h
                      00252 #define _COUNTS2                 PB01, 001h
                      00253 #define _PORTA??6                PORTA, 006h
                      00254 #define _LATC??0                 LATC, 000h
                      00255 #define _VConfig??1             _VConfig, 001h
                      00256 #define _OUTPUTS2??6            _OUTPUTS2, 006h
                      00257 #define _VConfig??2             _VConfig, 002h
                      00258 #define _OUTPUTS2??7            _OUTPUTS2, 007h
                      00259 #define _AllFlags??1            _AllFlags, 001h
                      00260 #define _AllFlags??2            _AllFlags, 002h
                      00261 #define _AllFlags??0            _AllFlags, 000h
                      00262 #define _Temp??0                _Temp, 000h
                      00263 #define _FunctionKeys??0        _FunctionKeys, 000h
                      00264 #define _Temp??1                _Temp, 001h
                      00265 #define _FunctionKeys??3        _FunctionKeys, 003h
                      00266 #define _Temp??2                _Temp, 002h
                      00267 #define _P1Keys??0              _P1Keys, 000h
                      00268 #define _Temp??3                _Temp, 003h
                      00269 #define _P1Keys??5              _P1Keys, 005h
                      00270 #define _Temp??4                _Temp, 004h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  7


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00271 #define _P1Keys??6              _P1Keys, 006h
                      00272 #define _Temp??5                _Temp, 005h
                      00273 #define _P1Keys??7              _P1Keys, 007h
                      00274 #define _Temp??6                _Temp, 006h
                      00275 #define _P1Keys??8              _P1Keys + 001h, 000h
                      00276 #define _Temp??7                _Temp, 007h
                      00277 #define _P1Keys??9              _P1Keys + 001h, 001h
                      00278 #define _P1Keys??10             _P1Keys + 001h, 002h
                      00279 #define _P1Keys??1              _P1Keys, 001h
                      00280 #define _P1Keys??2              _P1Keys, 002h
                      00281 #define _P1Keys??3              _P1Keys, 003h
                      00282 #define _P1Keys??4              _P1Keys, 004h
                      00283 #define _FunctionKeys??1        _FunctionKeys, 001h
                      00284 #define _FunctionKeys??2        _FunctionKeys, 002h
                      00285 #define _FunctionKeys??4        _FunctionKeys, 004h
                      00286 #define _P2Keys??0              _P2Keys, 000h
                      00287 #define _P2Keys??5              _P2Keys, 005h
                      00288 #define _P2Keys??6              _P2Keys, 006h
                      00289 #define _P2Keys??7              _P2Keys, 007h
                      00290 #define _P2Keys??8              _P2Keys + 001h, 000h
                      00291 #define _P2Keys??9              _P2Keys + 001h, 001h
                      00292 #define _P2Keys??10             _P2Keys + 001h, 002h
                      00293 #define _P2Keys??1              _P2Keys, 001h
                      00294 #define _P2Keys??2              _P2Keys, 002h
                      00295 #define _P2Keys??3              _P2Keys, 003h
                      00296 #define _P2Keys??4              _P2Keys, 004h
                      00297 #define _AllFlags??3            _AllFlags, 003h
                      00298 #define _MEDIAK??0              _MEDIAK, 000h
                      00299 #define _PORTA??5                PORTA, 005h
                      00300 #define _MEDIAK??1              _MEDIAK, 001h
                      00301 #define _MEDIAK??2              _MEDIAK, 002h
                      00302 #define _MEDIAK??3              _MEDIAK, 003h
                      00303 #define _MEDIAK??4              _MEDIAK, 004h
                      00304 #define _MEDIAK??5              _MEDIAK, 005h
                      00305 #define _MEDIAK??6              _MEDIAK, 006h
                      00306 #define _MEDIAK??7              _MEDIAK, 007h
                      00307 #define _PORTD??4                PORTD, 004h
                      00308 #define _PORTD??5                PORTD, 005h
                      00309 #define _PORTD??6                PORTD, 006h
                      00310 #define _PORTD??7                PORTD, 007h
                      00311 #define _PORTB??0                PORTB, 000h
                      00312 #define _PORTB??1                PORTB, 001h
                      00313 #define _PORTB??2                PORTB, 002h
                      00314 #define _PORTB??3                PORTB, 003h
                      00315 #define _PORTB??4                PORTB, 004h
                      00316 #define _PORTB??5                PORTB, 005h
                      00317 #define _PORTB??6                PORTB, 006h
                      00318 #define _PORTB??7                PORTB, 007h
                      00319 #define _PORTE??2                PORTE, 002h
                      00320 #define _PORTE??1                PORTE, 001h
                      00321 #define _PORTE??0                PORTE, 000h
                      00322 #define _LATA??4                 LATA, 004h
                      00323 #define _POV1??0                _POV1, 000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  8


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00324 #define _POV1??1                _POV1, 001h
                      00325 #define _POV1??2                _POV1, 002h
                      00326 #define _POV1??3                _POV1, 003h
                      00327 #define _POV2??0                _POV2, 000h
                      00328 #define _POV2??1                _POV2, 001h
                      00329 #define _POV2??2                _POV2, 002h
                      00330 #define _POV2??3                _POV2, 003h
                      00331 #define _VConfig??3             _VConfig, 003h
                      00332 #define _VConfig??0             _VConfig, 000h
                      00333 #define _VConfig??4             _VConfig, 004h
                      00334 #define _FKeytemp??0            _FKeytemp, 000h
                      00335 #define _FKeytemp??3            _FKeytemp, 003h
                      00336 #define _FKeytemp??1            _FKeytemp, 001h
                      00337 #define _FKeytemp??2            _FKeytemp, 002h
                      00338 #define _FKeytemp??4            _FKeytemp, 004h
                      00339 #define _LATA??2                 LATA, 002h
                      00340 #define _LATA??3                 LATA, 003h
                      00341 #define _OUTPUTS2??4            _OUTPUTS2, 004h
                      00342 #define _OUTPUTS2??5            _OUTPUTS2, 005h
                      00343 #define _LATD??0                 LATD, 000h
                      00344 #define _LATD??1                 LATD, 001h
                      00345 #define _PORTD??3                PORTD, 003h
                      00346 #define _PORTD??1                PORTD, 001h
                      00347 #define _LATD??2                 LATD, 002h
                      00348 
                      00349 ; Constants.
  00000400            00350 _USBMEMORYADDRESS               EQU     00400h
  00000100            00351 _USBMEMORYSIZE                  EQU     00100h
  00000008            00352 _USBBufferSizeMax               EQU     00008h
  0000000B            00353 _USBBufferSizeTX                EQU     0000Bh
  00000003            00354 _USBMediaTX                     EQU     00003h
  00000008            00355 _USBkeyTX                       EQU     00008h
  00000008            00356 _USBBufferSizeRX                EQU     00008h
                      00357 
                      00358 ; EEPROM data.
                      00359 
                      00360 
                      00361         INCLUDE "FIRMAC01.MAC"
                      00001 
                      00446         LIST
                      00362         INCLUDE "C:\PROGRAM FILES (X86)\PBP3\PBPPIC18.LIB"
                      00001 ;******************************************************************
                      00002 ;*  PBPPIC18.LIB                                                  *
                      00003 ;*                                                                *
                      00004 ;*  By        : Leonard Zerman, Jeff Schmoyer, Darrel Taylor,     *
                      00005 ;*              Charles Leo                                       *
                      00006 ;*  Notice    : Copyright (c) 2012 microEngineering Labs, Inc.    *
                      00007 ;*              All Rights Reserved                               *
                      00008 ;*  Date      : 05/03/2012                                        *
                      00009 ;*  Version   : 3.?.?                                             *
                      00010 ;*  Notes     :                                                   *
                      00011 ;******************************************************************
                      00129   LIST
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE  9


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00130 ; Oscillator is 48MHz
                      01228   LIST
000000                01229     ORG RESET_ORG               ; Reset vector at 0
                      01238   LIST
000000 EFBA F000      01239         goto    INIT            ; Finish initialization
                      05602   LIST
000004 0E08           05603 SHIFTOUT8 movlw 8               ; Send 8 bits
000006 6E08           05604 SHIFTOUT movwf  R3              ; Save number of bits
                      05605 
000008 C01D FFEA      05606         movff   RS2, FSR0H      ; Point to clock port (FSR0 for High and Low)
00000C C01B FFE9      05607         movff   RR2, FSR0L
000010 5019           05608         movf    RM2, W          ; Get clock bit mask
000012 B401           05609         btfsc   GOP, 2          ; Skip if start low
000014 EC3B F000      05610         call    HIGHT           ; Start clock bit high
000018 A401           05611         btfss   GOP, 2          ; Skip if start high
00001A EC3D F000      05612         call    LOWT            ; Start clock bit low
00001E C01D FFE2      05613         movff   RS2, FSR1H      ; Point to clock port (FSR1)
000022 C01B FFE1      05614         movff   RR2, FSR1L
                      05615 
                      05616 ;        movff   RS1, FSR0H      ; Point to data TRIS (FSR0)
000026 501A           05617         movf    RR1, W
000028 0F12           05618         addlw   12h
00002A 6EE9           05619         movwf   FSR0L
00002C 1C18           05620         comf    RM1, W          ; Get inverted data bit mask
00002E 16EF           05621         andwf   INDF0, F        ; Set data to output
000030 5008           05622         movf    R3, W           ; Get count and check for 0
000032 E00F           05623         bz      shiftoutdone    ; It's 0
000034 B001           05624         btfsc   GOP, 0          ; Shift MSB?
000036 EC7F F000      05625         call    REV             ; Yes, reverse bits to bottom
00003A C01A FFE9      05626         movff   RR1, FSR0L      ; Point back to port
00003E 3203           05627 shiftoutloop rrcf R0 + 1, F     ; Shift LSB to carry
000040 3202           05628         rrcf    R0, F           ; Carry has bit
000042 50EF           05629         movf    INDF0, W        ; Get pin value
000044 1018           05630         iorwf   RM1, W          ; Put in 1 for data
000046 A0D8           05631         btfss   STATUS, C       ; 1 or 0?
000048 1818           05632         xorwf   RM1, W          ; 0, take 1 back out
00004A 6EEF           05633         movwf   INDF0           ; Put out data
00004C D804           05634         rcall   shifttoggle     ; Toggle clock
00004E 2E08           05635         decfsz  R3, F           ; Do all the bits
000050 D7F6           05636         bra     shiftoutloop
000052 EFB7 F000      05637 shiftoutdone goto DUNN
                      05647   LIST
000056 5019           05648 shifttoggle movf RM2, W         ; Get clock bit mask
000058 1AE7           05649         xorwf   INDF1, F        ; Toggle clock
                      05650      ifdef SHIFT_PAUSEUS
                      05651         movf    R0, W           ; Save shift data
                      05652         movwf   R1
                      05653         movf    R0 + 1, W
                      05654         movwf   R1 + 1
                      05655         movlw   (SHIFT_PAUSEUS) >> 8    ; Slow down transfer
                      05656         movwf   R0 + 1
                      05657         movlw   low (SHIFT_PAUSEUS)
                      05658         call    PAUSEUSL
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 10


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      05659         movf    R1, W           ; Restore shift data
                      05660         movwf   R0
                      05661         movf    R1 + 1, W
                      05662         movwf   R0 + 1
                      05663         movf    RM2, W          ; Get clock bit mask
                      05664 PAUSEUS_USED = 1
                      05665      else
00005A 0000           05666         nop                     ; Slow down transfer
                      05667       if (OSC > 4)
00005C D000           05668         bra     $ + 2
                      05669       endif
                      05670       if (OSC > 8)
00005E D000           05671         bra     $ + 2
                      05672       endif
                      05673       if (OSC > 12)
000060 D000           05674         bra     $ + 2
                      05675       endif
                      05676       if (OSC > 16)
000062 D000           05677         bra     $ + 2
                      05678       endif
                      05679       if (OSC > 20)
000064 D000           05680         bra     $ + 2
                      05681       endif
                      05682       if (OSC > 24)
000066 D000           05683         bra     $ + 2
000068 D000           05684         bra     $ + 2
                      05685       endif
                      05686       if (OSC > 32)
00006A D000           05687         bra     $ + 2
00006C D000           05688         bra     $ + 2
                      05689       endif
                      05690       if (OSC > 40)
00006E D000           05691         bra     $ + 2
000070 D000           05692         bra     $ + 2
                      05693       endif
                      05694       if (OSC > 48)
                      05695         bra     $ + 2
                      05696         bra     $ + 2
                      05697         bra     $ + 2
                      05698         bra     $ + 2
                      05699       endif
                      05700      endif
000072 1AE7           05701         xorwf   INDF1, F
000074 0012           05702         return
                      06066   LIST
000076 12EF           06067 HIGHT   iorwf   INDF0, F        ; Set bit high
000078 D003           06068         bra     OUTPUTT         ; Make sure it's an output
                      06091   LIST
00007A 0AFF           06092 LOWT    xorlw   0ffh            ; Invert bit mask
00007C 16EF           06093         andwf   INDF0, F        ; Set bit low
00007E D001           06094         bra     OUTPUTI         ; Make sure it's an output
                      06163   LIST
000080 0AFF           06164 OUTPUTT xorlw   0ffh            ; Invert bit mask
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 11


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      06170   LIST
000082 88E9           06171 OUTPUTI bsf     FSR0L, 4        ; Point to TRIS register
000084 2AE9           06172         incf    FSR0L, F
000086 16EC           06173         andwf   PREINC0, F      ; Set bit to output
000088 EFB7 F000      06174         goto    DUNN            ; Done
                      06319   LIST
00008C                06320 ADCIN
                      06321       ifdef ADCHS
                      06322         movwf   ADCHS           ; Set the channel
                      06323         bcf     ADCON0, ACONV   ; Set to single-shot mode
                      06324         movf    ADCON2, W       ; Set the clock source
                      06325         andlw   0f8h            ; Don't disturb any other settings
                      06326         iorlw   (ADC_CLOCK) & 7
                      06327         movwf   ADCON2
                      06328         bsf     ADCON0, ADON    ; Turn on ADC (must wait 5-10us)
                      06329       else
                      06330           if (GO_DONE == 1)
00008C 34E8           06331         rlcf    WREG, W         ; Move channel into proper position
00008E 34E8           06332         rlcf    WREG, W
000090 0BFC           06333         andlw   0fch            ; Mask channel
000092 0901           06334         iorlw   1               ; Turn on ADC
000094 12C2           06335         iorwf   ADCON0, F       ; Set the one bits
                      06336             ifdef ADC_CHANNELS
                      06337         iorlw   080h
                      06338             else
000096 09C0           06339         iorlw   0c0h
                      06340             endif
000098 16C2           06341         andwf   ADCON0, F       ; Clear the zero bits
                      06342             ifdef ADCON2
00009A 50C0           06343         movf    ADCON2, W       ; Set the clock source
                      06344             else
                      06345         movf    ADCON1, W       ; Set the clock source
                      06346             endif
00009C 0BF8           06347         andlw   0f8h
00009E 0903           06348         iorlw   (ADC_CLOCK) & 7
                      06349             ifdef ADCON2
0000A0 6EC0           06350         movwf   ADCON2
                      06351             else
                      06352         movwf   ADCON1
                      06353             endif
                      06354           else
                      06355         rlcf    WREG, W         ; Move channel into proper position
                      06356         rlcf    WREG, W
                      06357         rlcf    WREG, W
                      06358         andlw   038h            ; Mask channel
                      06359         iorlw   (((ADC_CLOCK) & 3) << 6) | 1    ; Set the clock source and turn on ADC
                      06360         movwf   ADCON0
                      06361           endif
                      06362       endif
                      06363       if ((ADC_SAMPLEUS) != 0)
0000A2 0E00           06364         movlw   (ADC_SAMPLEUS) >> 8     ; Get sample time
0000A4 6E03           06365         movwf   R0 + 1
0000A6 0E32           06366         movlw   low (ADC_SAMPLEUS)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 12


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000A8 EC74 F000      06367         call    PAUSEUSL        ; Wait sample time
                      06368       endif
0000AC 82C2           06369         bsf     ADCON0, GO_DONE ; Start conversion
0000AE B2C2           06370 adcinloop btfsc ADCON0, GO_DONE ; Wait for conversion to complete
0000B0 D7FE           06371         bra     adcinloop
                      06372       if ((ADC_BITS) <= 8)
                      06373         clrf    R0 + 1
                      06374         movf    ADRESH, W       ; Get 8-bit result
                      06375       else
0000B2 50C4           06376         movf    ADRESH, W       ; Get 16-bit result
0000B4 6E03           06377         movwf   R0 + 1
0000B6 50C3           06378         movf    ADRESL, W
                      06379       endif
0000B8 EFB7 F000      06380         goto    DUNN
                      06453   LIST
0000BC 6AA6           06454 READ    clrf    EECON1          ; Read from data memory
0000BE 80A6           06455         bsf     EECON1, RD      ; Read the EEPROM
0000C0 50A8           06456         movf    EEDATA, W       ; Get the data
0000C2                06457 READINC
                      06458       ifdef EEADRH
                      06459         infsnz  EEADR, F        ; Bump up address
                      06460         incf    EEADRH, F
                      06461       else
0000C2 2AA9           06462         incf    EEADR, F        ; Bump up address
                      06463       endif
0000C4 EFB7 F000      06464         goto    DUNN            ; Done
                      06511   LIST
0000C8 6AE8           06512 WRITEZ  clrf    WREG            ; Data is 0
0000CA 6EA8           06513 WRITE   movwf   EEDATA          ; Set the EEPROM data
0000CC 6AA6           06514         clrf    EECON1          ; Write to data memory
0000CE 84A6           06515         bsf     EECON1, WREN
                      06516       ifdef WRITE_INT
                      06517         bcf     INTCON, GIE     ; Disable global interrupts
                      06518         btfsc   INTCON, GIE     ; See AN576
                      06519         bra     $ - 4
                      06520       endif      
0000D0 0E55           06521         movlw   55h             ; Unlock the door
0000D2 6EA7           06522         movwf   EECON2
0000D4 0EAA           06523         movlw   0AAh
0000D6 6EA7           06524         movwf   EECON2
0000D8 82A6           06525         bsf     EECON1, WR      ; Do the write
                      06526       ifdef WRITE_INT
                      06527         bsf     INTCON, GIE     ; Enable global interrupts
                      06528       endif      
0000DA B2A6           06529 writeloop btfsc EECON1, WR      ; Wait for the write to complete
0000DC D7FE           06530         bra     writeloop
0000DE 94A6           06531         bcf     EECON1, WREN    ; Lock up when we're done
                      06532       ifdef EEADRH
                      06533         infsnz  EEADR, F        ; Bump up address
                      06534         incf    EEADRH, F
                      06535       else
0000E0 2AA9           06536         incf    EEADR, F        ; Bump up address
                      06537       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 13


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0000E2 EFB7 F000      06538         goto    DUNN            ; Done
                      06997   LIST
0000E6 6A03           06998 PAUSEUS clrf    R0 + 1          ; 1
0000E8 0FFE           06999 PAUSEUSL addlw  -2              ; 1 Subtract overhead
0000EA 6E02           07000         movwf   R0              ; 1
                      07001 pauseusloop CLRWDT?NOP          ; 1
                          M     ifndef NO_CLRWDT
0000EC 0004               M         clrwdt
                          M     else
                          M         nop
                          M     endif
0000EE 6AE8           07002         clrf    WREG            ; 1
0000F0 5A03           07003         subwfb  R0 + 1, F       ; 1
0000F2 A0D8           07004         btfss   STATUS, C       ; 1 / 2
0000F4 0012           07005         return                  ; 2 + 3 (call + setup)
0000F6 0602           07006         decf    R0, F           ; 1
0000F8 D000           07007         bra     $ + 2           ; 2
0000FA D000           07008         bra     $ + 2           ; 2
0000FC D7F7           07009         bra     pauseusloop     ; 2
                      07388   LIST
0000FE 6A04           07389 REV     clrf    R1              ; Zero the result
000100 6A05           07390         clrf    R1 + 1
000102 D004           07391         bra     revfirst        ; Handle 0 case
000104 3203           07392 revloop rrcf    R0 + 1, F       ; Shift right once
000106 3202           07393         rrcf    R0, F
000108 3604           07394         rlcf    R1, F           ; Reverse the bits
00010A 3605           07395         rlcf    R1 + 1, F
00010C 0FFF           07396 revfirst addlw  -1
00010E E2FA           07397         bc      revloop         ; Done?
000110 5005           07398         movf    R1 + 1, W       ; Move result to R0
000112 6E03           07399         movwf   R0 + 1
000114 5004           07400         movf    R1, W
000116 6E02           07401         movwf   R0              ; Low part of result in W
000118 EFB7 F000      07402         goto    DUNN
                      07550   LIST
00011C 6E04           07551 CMPEQ   movwf   R1
00011E 0E02           07552         movlw   2               ; Mask for =
000120 D00A           07553         bra     CMP
                      07602   LIST
000122 6A03           07603 CMPGTB  clrf    R0 + 1
                      07609   LIST
000124 6A05           07610 CMPGTW  clrf    R1 + 1
                      07616   LIST
000126 6E04           07617 CMPGT   movwf   R1
000128 0E01           07618         movlw   1               ; Mask for >
00012A D005           07619         bra     CMP
                      07668   LIST
00012C 6A03           07669 CMPLTB  clrf    R0 + 1
                      07675   LIST
00012E 6A05           07676 CMPLTW  clrf    R1 + 1
                      07682   LIST
000130 6E04           07683 CMPLT   movwf   R1
000132 0E04           07684         movlw   4               ; Mask for <
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 14


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000134 D000           07685         bra     CMP
                      07734   LIST
000136 6E0A           07735 CMP     movwf   R4              ; Save compare state
000138 5005           07736         movf    R1 + 1, W       ; Flags = MSB(R0) - MSB(R1)
00013A 5C03           07737         subwf   R0 + 1, W
00013C E102           07738         bnz     cmpnoteq        ; If unequal then done
00013E 5004           07739         movf    R1, W           ; Flags = LSB(R0) - LSB(R1)
000140 5C02           07740         subwf   R0, W
000142 0E04           07741 cmpnoteq movlw  4               ; W = 4 if R0 < R1
000144 B0D8           07742         btfsc   STATUS, C
000146 0E01           07743         movlw   1               ; W = 1 if R0 > R1
000148 B4D8           07744         btfsc   STATUS, Z
00014A 0E02           07745         movlw   2               ; W = 2 if R0 == R1
00014C 140A           07746         andwf   R4, W           ; Mask for compare state
00014E A4D8           07747         btfss   STATUS, Z
000150 0EFF           07748         movlw   -1
000152 EFB7 F000      07749         goto    DUNN
                      07769   LIST
000156 66E8           07770 LAND    tstfsz  WREG
000158 0EFF           07771         movlw   -1
00015A 1402           07772         andwf   R0, W
00015C A4D8           07773         btfss   STATUS, Z
00015E 0EFF           07774         movlw   -1
000160 EFB7 F000      07775         goto    DUNN
                      07791   LIST
000164 1002           07792 LOR     iorwf   R0, W
000166 A4D8           07793         btfss   STATUS, Z
000168 0EFF           07794         movlw   -1
00016A EFB7 F000      07795         goto    DUNN
                      08071   LIST
00016E 0100           08072 DUNN    movlb   0               ; 1 Reset banks to 0
                      08073 DUNN5   CLRWDT?NOP              ; 1 Hit Watchdog timer
                          M     ifndef NO_CLRWDT
000170 0004               M         clrwdt
                          M     else
                          M         nop
                          M     endif
000172 0012           08074         return                  ; 2 Done
                      08087   LIST
000174                08088 INIT
                      08124   LIST
000174                08125 main
                      00363 
                      00364 
                      00365 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00036   #HEADER
                      00366 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00062   #CONFIG
                      00367 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00286   BANKA   $0000, $005F
                      00368 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00287   BANK0   $0060, $00FF
                      00369 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00288   BANK1   $0100, $01FF
                      00370 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00289   BANK2   $0200, $02FF
                      00371 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00290   BANK3   $0300, $03FF
                      00372 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00291   BANK4   $0400, $04FF
                      00373 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00292   BANK5   $0500, $05FF
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 15


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00374 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00293   BANK6   $0600, $06FF
                      00375 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00294   BANK7   $0700, $07FF
                      00376 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00300       INCLUDE "PBPPI18L.RAM"
                      00377 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00301   #ELSE
                      00378 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00302       LIBRARY  "PBPPIC18"
                      00379 
                      00380 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00303       INCLUDE "PBPPIC18.RAM"
                      00381 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00304   #ENDIF
                      00382 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00309   USBMEMORYADDRESS Con    $400    ' USB RA
                            M starts here
                      00383 ; C:\PROGRAM FILES (X86)\PBP3\DEVICES\PIC18F4550.PBPINC 00313   #HEADER
                      00384 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00011   #CONFIG
                      00385 
                      00386 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00038   Include "DES_FirmAC01.bas"
                      00387 ; C:\TEMP\DCLFI32V1.0\DES_FIRMAC01.BAS  00004   USBMEMORYSIZE   Con     256     ' USB RAM size in bytes
                      00388 
                      00389 ; C:\TEMP\DCLFI32V1.0\DES_FIRMAC01.BAS  00007   goto    hid_desc_end    ' Skip over all of the USB assem
                            bler code
                      00390         GOTO?L  _hid_desc_end
                          M         L?GOTO  _hid_desc_end
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_hid_desc_end))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    _hid_desc_end
                          M     else
                          M       if ((_hid_desc_end) < 1)
                          M         goto    _hid_desc_end
                          M       else
                          M         if ((_hid_desc_end) > $)
000174 EFFC F006          M         goto    _hid_desc_end
                          M         else
                          M           if ((_hid_desc_end) < ($ - 3ffh))
                          M         goto    _hid_desc_end
                          M           else
                          M         bra     _hid_desc_end
                          M           endif
                          M         endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 16


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                      00391 
                      00392 ; C:\TEMP\DCLFI32V1.0\DES_FIRMAC01.BAS  00008   asm
                      00393 
                      00394         ASM?
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                      00395 
                      00396 
                      00397 #define USB_EP0_BUFF_SIZE       8       ; 8, 16, 32, or 64
                      00398 #define USB_MAX_NUM_INT         2       ; For tracking Alternate Setting
                      00399 #define USB_MAX_EP_NUMBER       2       ; UEP1
                      00400 #define NUM_CONFIGURATIONS      1
                      00401 #define NUM_INTERFACES          2
                      00402 
                      00403 #define UCFG_VAL        USB_PULLUP_ENABLE|USB_INTERNAL_TRANSCEIVER|USB_FULL_SPEED|USB_PING_PONG__NO_PING
                            _PONG
                      00404 ;#define UCFG_VAL       USB_PULLUP_ENABLE|USB_INTERNAL_TRANSCEIVER|USB_LOW_SPEED|USB_PING_PONG__NO_PING_
                            PONG
                      00405 
                      00406 ;#define USE_SELF_POWER_SENSE_IO
                      00407 ;#define USE_USB_BUS_SENSE_IO
                      00408 
                      00409 #define USB_POLLING
                      00410 
                      00411 ; HID
                      00412 ; Endpoints Allocation
                      00413 #define HID_INTF_ID               0x00
                      00414 #define HID_EP                    1
                      00415 #define HID_INT_OUT_EP_SIZE       16
                      00416 #define HID_INT_IN_EP_SIZE        16
                      00417 
                      00418 #define HID_DEV_INTF_ID       0x01
                      00419 #define HID_DEV_EP            2
                      00420 #define HID_DEV_INT_OUT_EP_SIZE   16
                      00421 #define HID_DEV_INT_IN_EP_SIZE    16
                      00422 
                      00423 #define HID_NUM_OF_DSC        1
                      00424 
                      00425    include      "usb_hid.asm"   ; Include rest of USB files, starting with HID class code
                      00001 ; usb_hid.asm
                      00002 ; 10/08/08 microEngineering Labs, Inc.
                      00003 
                      00004         include "usb_hid.inc"   ; Include our header file
                      00001 ; usb_hid.inc
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 17


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00002 ; 6/30/08 microEngineering Labs, Inc.
                      00003 
                      00004 ;/*******************************************************************************
                      00005 
                      00006 ;    USB HID class header file
                      00007 
                      00008 ;This file, with its associated C source file, provides the interface required
                      00009 ;to talk to the USB host through the Human Interface Device (HID) class.  
                      00010 
                      00011 ;******************************************************************************/
                      00012 ;//DOM-IGNORE-BEGIN
                      00013 ;/******************************************************************************
                      00014 ; FileName:             usb_function_hid.h
                      00015 ; Dependencies: See INCLUDES section
                      00016 ; Processor:            PIC18 or PIC24 USB Microcontrollers
                      00017 ; Hardware:             The code is natively intended to be used on the following
                      00018 ;                               hardware platforms: PICDEM FS USB Demo Board, 
                      00019 ;                               PIC18F87J50 FS USB Plug-In Module, or
                      00020 ;                               Explorer 16 + PIC24 USB PIM.  The firmware may be
                      00021 ;                               modified for use on other USB platforms by editing the
                      00022 ;                               HardwareProfile.h file.
                      00023 ; Complier:     Microchip C18 (for PIC18) or C30 (for PIC24)
                      00024 ; Company:              Microchip Technology, Inc.
                      00025 
                      00026 ; Software License Agreement:
                      00027 
                      00028 ; The software supplied herewith by Microchip Technology Incorporated
                      00029 ; (the Company) for its PIC Microcontroller is intended and
                      00030 ; supplied to you, the Companys customer, for use solely and
                      00031 ; exclusively on Microchip PIC Microcontroller products. The
                      00032 ; software is owned by the Company and/or its supplier, and is
                      00033 ; protected under applicable copyright laws. All rights are reserved.
                      00034 ; Any use in violation of the foregoing restrictions may subject the
                      00035 ; user to criminal sanctions under applicable laws, as well as to
                      00036 ; civil liability for the breach of the terms and conditions of this
                      00037 ; license.
                      00038 
                      00039 ; THIS SOFTWARE IS PROVIDED IN AN AS IS CONDITION. NO WARRANTIES,
                      00040 ; WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
                      00041 ; TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
                      00042 ; PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
                      00043 ; IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
                      00044 ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
                      00045 
                      00046 ;********************************************************************
                      00047 ; Change History:
                      00048 ;  Rev   Date         Description
                      00049 ;  1.0   11/19/2004   Initial release
                      00050 ;  2.1   02/26/2007   Updated for simplicity and to use common
                      00051 ;                     coding style
                      00052 ;*******************************************************************/
                      00053 ;#ifndef HID_H
                      00054 ;#define HID_H
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 18


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00055 ;//DOM-IGNORE-END
                      00056 
                      00057 ;/** INCLUDES *******************************************************/
                      00058 
                      00059 ;/** DEFINITIONS ****************************************************/
                      00060 
                      00061 ; DEVICE CLASS USAGE
                      00062 #define USB_USE_HID
                      00063 
                      00064 ; Class-Specific Requests
                      00065 #define GET_REPORT      0x01
                      00066 #define GET_IDLE        0x02
                      00067 #define GET_PROTOCOL    0x03
                      00068 #define SET_REPORT      0x09
                      00069 #define SET_IDLE        0x0A
                      00070 #define SET_PROTOCOL    0x0B
                      00071 
                      00072 ; Class Descriptor Types
                      00073 #define DSC_HID         0x21
                      00074 #define DSC_RPT         0x22
                      00075 #define DSC_PHY         0x23
                      00076 
                      00077 ; Protocol Selection
                      00078 #define BOOT_PROTOCOL   0x00
                      00079 #define RPT_PROTOCOL    0x01
                      00080 
                      00081 ; HID Interface Class Code
                      00082 #define HID_INTF        0x03
                      00083 
                      00084 ; HID Interface Class SubClass Codes
                      00085 #define BOOT_INTF_SUBCLASS      0x01
                      00086 
                      00087 ; HID Interface Class Protocol Codes
                      00088 #define HID_PROTOCOL_NONE       0x00
                      00089 #define HID_PROTOCOL_KEYBOARD   0x01
                      00090 #define HID_PROTOCOL_MOUSE      0x02
                      00091 
                      00092 
                      00093 ;/********************************************************************
                      00094 ; * Macro:           BYTE mHIDGetRptRxLength(void)
                      00095 ; *
                      00096 ; * Description:     mHIDGetRptRxLength is used to retrieve the number
                      00097 ; *                  of bytes copied to user's buffer by the most
                      00098 ; *                  recent call to HIDRxReport function.
                      00099 ; * Input:           
                      00100 ; *     None :
                      00101 ; *
                      00102 ; * Output:          
                      00103 ; *     BYTE : mHIDGetRptRxLength returns hid_rpt_rx_len
                      00104 ; *
                      00105 ; *******************************************************************/
                      00106 ;#define mHIDGetRptRxLength()        hid_rpt_rx_len
                      00107 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 19


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00108 ;#define HIDTxHandleBusy USBHandleBusy
                      00109 ;#define HIDRxHandleBusy USBHandleBusy
                      00110 ;#define HIDTxPacket USBTxOnePacket
                      00111 ;#define HIDRxPacket USBRxOnePacket
                      00112 
                      00113 ;// Section: STRUCTURES *********************************************/
                      00114 
                      00115 ;//USB HID Descriptor header as detailed in section 
                      00116 ;//"6.2.1 HID Descriptor" of the HID class definition specification
                      00117 ;typedef struct _USB_HID_DSC_HEADER
                      00118 ;{
                      00119 ;    BYTE bDescriptorType;      //offset 9
                      00120 ;    WORD wDscLength;           //offset 10
                      00121 ;} USB_HID_DSC_HEADER;
                      00122 
                      00123 ;//USB HID Descriptor header as detailed in section 
                      00124 ;//"6.2.1 HID Descriptor" of the HID class definition specification
                      00125 ;typedef struct _USB_HID_DSC
                      00126 ;{
                      00127 ;    BYTE bLength;                      //offset 0 
                      00128 ;       BYTE bDescriptorType;   //offset 1
                      00129 ;       WORD bcdHID;                    //offset 2
                      00130 ;    BYTE bCountryCode;         //offset 4
                      00131 ;       BYTE bNumDsc;                   //offset 5
                      00132 
                      00133 
                      00134 ;    //USB_HID_DSC_HEADER hid_dsc_header[HID_NUM_OF_DSC];
                      00135 ;    /* HID_NUM_OF_DSC is defined in usbcfg.h */
                      00136     
                      00137 ;} USB_HID_DSC;
                      00138 
                      00139 ;/** EXTERNS ********************************************************/
                      00140 ;extern BYTE hid_rpt_rx_len;
                      00141 
                      00142 ;/** PUBLIC PROTOTYPES **********************************************/
                      00143 ;#if defined(USB_DYNAMIC_EP_CONFIG)
                      00144 ;    #define HIDInitEP()
                      00145 ;#else
                      00146 ;       /********************************************************************
                      00147 ;        * Function:        void HIDInitEP(void)
                      00148 ;        *
                      00149 ;        * PreCondition:    None
                      00150 ;        *
                      00151 ;        * Input:           None
                      00152 ;        *
                      00153 ;        * Output:          None
                      00154 ;        *
                      00155 ;        * Side Effects:    None;
                      00156 ;        *
                      00157 ;        * Overview:        HIDInitEP initializes HID endpoints, buffer
                      00158 ;        *                  descriptors, internal state-machine, and
                      00159 ;        *                  variables. It should be called after the USB
                      00160 ;        *                  host has sent out a SET_CONFIGURATION request.
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 20


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00161 ;        *                  See USBStdSetCfgHandler() in usbd.c for examples.
                      00162 ;        *
                      00163 ;        * Note:            None
                      00164 ;        *******************************************************************/
                      00165 ;    void HIDInitEP(void);
                      00166 ;#endif
                      00167 ;       /********************************************************************
                      00168 ; * Function:        void USBCheckHIDRequest(void)
                      00169 ; *
                      00170 ; * PreCondition:    None
                      00171 ; *
                      00172 ; * Input:           None
                      00173 ; *
                      00174 ; * Output:          None
                      00175 ; *
                      00176 ; * Side Effects:    None
                      00177 ; *
                      00178 ; * Overview:        This routine checks the setup data packet to see
                      00179 ; *                  if it knows how to handle it
                      00180 ; *
                      00181 ; * Note:            None
                      00182 ; *******************************************************************/
                      00183 ;void USBCheckHIDRequest(void);
                      00184 
                      00185 ;#endif //HID_H
                      00005         include "usb_dev.asm"   ; Include the main USB routines
                      00001 ; usb_dev.asm
                      00002 ; 10/07/08 microEngineering Labs, Inc.
                      00003 
                      00004         include "usb_dev.inc"   ; Include our header file
                      00001 ; usb_dev.inc
                      00002 ; 7/7/08 microEngineering Labs, Inc.
                      00003 
                      00004 ; Buffer Descriptor Status Register Initialization Parameters
                      00005 #define _BSTALL         0x04            ; Buffer Stall enable
                      00006 #define _DTSEN          0x08            ; Data Toggle Synch enable
                      00007 #define _INCDIS         0x10            ; Address increment disable
                      00008 #define _KEN            0x20            ; SIE keeps buff descriptors enable
                      00009 #define _DAT0           0x00            ; DATA0 packet expected next
                      00010 #define _DAT1           0x40            ; DATA1 packet expected next
                      00011 #define _DTSMASK        0x40            ; DTS Mask
                      00012 #define _USIE           0x80            ; SIE owns buffer
                      00013 #define _UCPU           0x00            ; CPU owns buffer
                      00014 
                      00015 ;#define _STAT_MASK     0xFF
                      00016 
                      00017 ; PIC Endpoint Definitions
                      00018 ; PIC Endpoint Address Format: X:EP3:EP2:EP1:EP0:DIR:PPBI:X
                      00019 ; This is used when checking the value read from USTAT
                      00020 ; NOTE: These definitions are not used in the descriptors.
                      00021 ; EP addresses used in the descriptors have different format.
                      00022 #define USTAT_EP0_PP_MASK        ~0x02
                      00023 #define USTAT_EP_MASK           0x7E
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 21


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00024 #define USTAT_EP0_OUT           0x00
                      00025 #define USTAT_EP0_IN            0x04
                      00026 
                      00027 #define UEP_STALL       0x0001
                      00028 
                      00029 ; USB Endpoint Definitions
                      00030 ; USB Standard EP Address Format: DIR:X:X:X:EP3:EP2:EP1:EP0
                      00031 ; This is used in the descriptors.
                      00032 ; NOTE: Do not use these values for checking against USTAT.
                      00033 #define _EP_IN          0x80
                      00034 #define _EP_OUT         0x00
                      00035 #define _EP01_OUT       0x01
                      00036 #define _EP01_IN        0x81
                      00037 #define _EP02_OUT       0x02
                      00038 #define _EP02_IN        0x82
                      00039 ;#define _EP03_OUT      0x03
                      00040 ;#define _EP03_IN       0x83
                      00041 ;#define _EP04_OUT      0x04
                      00042 ;#define _EP04_IN       0x84
                      00043 ;#define _EP05_OUT      0x05
                      00044 ;#define _EP05_IN       0x85
                      00045 ;#define _EP06_OUT      0x06
                      00046 ;#define _EP06_IN       0x86
                      00047 ;#define _EP07_OUT      0x07
                      00048 ;#define _EP07_IN       0x87
                      00049 ;#define _EP08_OUT      0x08
                      00050 ;#define _EP08_IN       0x88
                      00051 ;#define _EP09_OUT      0x09
                      00052 ;#define _EP09_IN       0x89
                      00053 ;#define _EP10_OUT      0x0A
                      00054 ;#define _EP10_IN       0x8A
                      00055 ;#define _EP11_OUT      0x0B
                      00056 ;#define _EP11_IN       0x8B
                      00057 ;#define _EP12_OUT      0x0C
                      00058 ;#define _EP12_IN       0x8C
                      00059 ;#define _EP13_OUT      0x0D
                      00060 ;#define _EP13_IN       0x8D
                      00061 ;#define _EP14_OUT      0x0E
                      00062 ;#define _EP14_IN       0x8E
                      00063 ;#define _EP15_OUT      0x0F
                      00064 ;#define _EP15_IN       0x8F
                      00065 
                      00066 ; Configuration Attributes
                      00067 #define _DEFAULT        (0x01<<7)       ; Default Value (Bit 7 is set)
                      00068 #define _SELF           (0x01<<6)       ; Self-powered (Supports if set)
                      00069 #define _RWU            (0x01<<5)       ; Remote Wakeup (Supports if set)
                      00070 
                      00071 ; Endpoint Transfer Type
                      00072 #define _CTRL           0x00            ; Control Transfer
                      00073 #define _ISO            0x01            ; Isochronous Transfer
                      00074 #define _BULK           0x02            ; Bulk Transfer
                      00075 #define _INT            0x03            ; Interrupt Transfer
                      00076 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 22


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00077 ;#define _ROM           USB_INPIPES_ROM
                      00078 ;#define _RAM           USB_INPIPES_RAM
                      00079 
                      00080 ; Various options for setting the PIPES
                      00081 #define USB_INPIPES_ROM         0x00    ; Data comes from RAM
                      00082 #define USB_INPIPES_RAM         0x01    ; Data comes from ROM
                      00083 #define USB_INPIPES_BUSY        0x80    ; The PIPE is busy
                      00084 #define USB_INPIPES_INCLUDE_ZERO 0x40   ; Include a trailing zero packet
                      00085 #define USB_INPIPES_NO_DATA     0x00    ; No data to send
                      00086 #define USB_INPIPES_NO_OPTIONS  0x00    ; No options set
                      00087 
                      00088 #define USB_EP0_ROM             USB_INPIPES_ROM
                      00089 #define USB_EP0_RAM             USB_INPIPES_RAM
                      00090 #define USB_EP0_BUSY            USB_INPIPES_BUSY
                      00091 #define USB_EP0_INCLUDE_ZERO    USB_INPIPES_INCLUDE_ZERO
                      00092 #define USB_EP0_NO_DATA         USB_INPIPES_NO_DATA
                      00093 #define USB_EP0_NO_OPTIONS      USB_INPIPES_NO_OPTIONS
                      00094 
                      00095 ; Standard Request Codes
                      00096 ; USB 2.0 Spec Ref Table 9-4
                      00097 #define GET_STATUS      0
                      00098 #define CLR_FEATURE     1
                      00099 #define SET_FEATURE     3
                      00100 #define SET_ADR         5
                      00101 #define GET_DSC         6
                      00102 #define SET_DSC         7
                      00103 #define GET_CFG         8
                      00104 #define SET_CFG         9
                      00105 #define GET_INTF        10
                      00106 #define SET_INTF        11
                      00107 #define SYNCH_FRAME     12
                      00108 
                      00109 ; Standard Feature Selectors
                      00110 #define DEVICE_REMOTE_WAKEUP    0x01
                      00111 #define ENDPOINT_HALT           0x00
                      00112 
                      00113 ; USB Device States - To be used with [USBDeviceState]
                      00114 #define DETACHED_STATE          0x00
                      00115 #define ATTACHED_STATE          0x01
                      00116 #define POWERED_STATE           0x02
                      00117 #define DEFAULT_STATE           0x04
                      00118 #define ADR_PENDING_STATE       0x08
                      00119 #define ADDRESS_STATE           0x10
                      00120 #define CONFIGURED_STATE        0x20
                      00121 
                      00122 #define USB_PING_PONG__NO_PING_PONG     0x00    ; 0b00
                      00123 #define USB_PING_PONG__EP0_OUT_ONLY     0x01    ; 0b01
                      00124 #define USB_PING_PONG__FULL_PING_PONG   0x02    ; 0b10
                      00125 #define USB_PING_PONG__ALL_BUT_EP0      0x03    ; 0b11
                      00126 
                      00127 ; UCFG Initialization Parameters
                      00128 #define USB_PULLUP_ENABLE               0x10
                      00129 #define USB_PULLUP_DISABLED             0x00
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 23


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00130     
                      00131 #define USB_INTERNAL_TRANSCEIVER        0x00
                      00132 #define USB_EXTERNAL_TRANSCEIVER        0x08
                      00133     
                      00134 #define USB_FULL_SPEED                  0x04
                      00135 #define USB_LOW_SPEED                   0x00
                      00136 
                      00137 ; UEPn Initialization Parameters
                      00138 #define EP_CTRL         0x06            ; Cfg Control pipe for this ep
                      00139 #define EP_OUT          0x0C            ; Cfg OUT only pipe for this ep
                      00140 #define EP_IN           0x0A            ; Cfg IN only pipe for this ep
                      00141 #define EP_OUT_IN       0x0E            ; Cfg both OUT & IN pipes for this ep
                      00142 
                      00143 ; Handshake should be disable for isoch
                      00144 #define USB_HANDSHAKE_ENABLED   0x10
                      00145 #define USB_HANDSHAKE_DISABLED  0x00
                      00146 
                      00147 #define USB_OUT_ENABLED         0x04
                      00148 #define USB_OUT_DISABLED        0x00
                      00149 
                      00150 #define USB_IN_ENABLED          0x02
                      00151 #define USB_IN_DISABLED         0x00
                      00152 
                      00153 #define USB_ALLOW_SETUP         0x00
                      00154 #define USB_DISALLOW_SETUP      0x08
                      00155 
                      00156 #define USB_STALL_ENDPOINT      0x01
                      00157 
                      00158 ; Control Transfer States
                      00159 #define WAIT_SETUP      0
                      00160 #define CTRL_TRF_TX     1
                      00161 #define CTRL_TRF_RX     2
                      00162 
                      00163 ; Short Packet States - Used by Control Transfer Read  - CTRL_TRF_TX
                      00164 #define SHORT_PKT_NOT_USED      0
                      00165 #define SHORT_PKT_PENDING       1
                      00166 #define SHORT_PKT_SENT          2
                      00167 
                      00168 ; USB PID: Token Types - See chapter 8 in the USB specification
                      00169 #define SETUP_TOKEN     0x0D            ; 0b00001101
                      00170 #define OUT_TOKEN       0x01            ; 0b00000001
                      00171 #define IN_TOKEN        0x09            ; 0b00001001
                      00172 
                      00173 ; bmRequestType Definitions
                      00174 #define HOST_TO_DEV     0
                      00175 #define DEV_TO_HOST     1
                      00176 
                      00177 #define STANDARD        0x00
                      00178 #define CLASS           0x01
                      00179 #define VENDOR          0x02
                      00180 
                      00181 #define RCPT_DEV        0
                      00182 #define RCPT_INTF       1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 24


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00183 #define RCPT_EP         2
                      00184 #define RCPT_OTH        3
                      00185 
                      00186 ; Section: USB Descriptors
                      00187 #define USB_DESCRIPTOR_DEVICE           0x01    ; bDescriptorType for a Device Descriptor.
                      00188 #define USB_DESCRIPTOR_CONFIGURATION    0x02    ; bDescriptorType for a Configuration Descriptor.
                      00189 #define USB_DESCRIPTOR_STRING           0x03    ; bDescriptorType for a String Descriptor.
                      00190 #define USB_DESCRIPTOR_INTERFACE        0x04    ; bDescriptorType for an Interface Descriptor.
                      00191 #define USB_DESCRIPTOR_ENDPOINT         0x05    ; bDescriptorType for an Endpoint Descriptor.
                      00192 #define USB_DESCRIPTOR_DEVICE_QUALIFIER 0x06    ; bDescriptorType for a Device Qualifier.
                      00193 #define USB_DESCRIPTOR_OTHER_SPEED      0x07    ; bDescriptorType for a Other Speed Configuration.
                      00194 #define USB_DESCRIPTOR_INTERFACE_POWER  0x08    ; bDescriptorType for Interface Power.
                      00195 #define USB_DESCRIPTOR_OTG              0x09    ; bDescriptorType for an OTG Descriptor.
                      00005         include "usb_mem.asm"   ; Include memory allocation
                      00001 ; usb_mem.asm
                      00002 ; 03/20/09 microEngineering Labs, Inc.
                      00003 
                      00004 ; Buffer Descriptor Byte Aliases
                      00005 #define Stat            0               ; Buffer Descriptor Status Register
                      00006 #define Cnt             1               ; Buffer Count
                      00007 ;#define ADR            2               ; Buffer Address
                      00008 #define ADRL            2               ; Buffer Address Low
                      00009 #define ADRH            3               ; Buffer Address High
                      00010 
                      00011 ; Stat Bit Aliases
                      00012 ;#define BC8            0               ; Upper Count Bit
                      00013 ;#define BC9            1               ; Upper Count Bit
                      00014 #define BSTALL          2               ; Buffer Stall Enable
                      00015 #define DTSEN           3               ; Data Toggle Synch Enable
                      00016 #define INCDIS          4               ; Address Increment Disable
                      00017 #define KEN             5               ; BD Keep Enable
                      00018 #define DTS             6               ; Data Toggle Synch Value
                      00019 #define UOWN            7               ; USB Ownership
                      00020 #define PID             2               ; Packet Identifier (4 bits)
                      00021 
                      00022 
                      00023         cblock  _USBMEMORYADDRESS       ; Point to BDT RAM
                      00024         endc
                      00025 
                      00026 ; Buffer Descriptor Table (BDT) RAM
                      00027 
                      00028 #if(0 <= USB_MAX_EP_NUMBER)
                      00029         cblock
  00000400            00030                 ep0Bo:4                 ; Endpoint #0 BD Out
  00000404            00031                 ep0Bi:4                 ; Endpoint #0 BD In
                      00032         endc
                      00033 #endif
                      00034 
                      00035 #if(1 <= USB_MAX_EP_NUMBER)
                      00036         cblock
  00000408            00037                 ep1Bo:4                 ; Endpoint #1 BD Out
  0000040C            00038                 ep1Bi:4                 ; Endpoint #1 BD In
                      00039         endc
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 25


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00040 #endif
                      00041 
                      00042 #if(2 <= USB_MAX_EP_NUMBER)
                      00043         cblock
  00000410            00044                 ep2Bo:4                 ; Endpoint #2 BD Out
  00000414            00045                 ep2Bi:4                 ; Endpoint #2 BD In
                      00046         endc
                      00047 #endif
                      00048 
                      00049 #if(3 <= USB_MAX_EP_NUMBER)
                      00050         cblock
                      00051                 ep3Bo:4                 ; Endpoint #3 BD Out
                      00052                 ep3Bi:4                 ; Endpoint #3 BD In
                      00053         endc
                      00054 #endif
                      00055 
                      00056 #if(4 <= USB_MAX_EP_NUMBER)
                      00057         cblock
                      00058                 ep4Bo:4                 ; Endpoint #4 BD Out
                      00059                 ep4Bi:4                 ; Endpoint #4 BD In
                      00060         endc
                      00061 #endif
                      00062 
                      00063 #if(5 <= USB_MAX_EP_NUMBER)
                      00064         cblock
                      00065                 ep5Bo:4                 ; Endpoint #5 BD Out
                      00066                 ep5Bi:4                 ; Endpoint #5 BD In
                      00067         endc
                      00068 #endif
                      00069 
                      00070 #if(6 <= USB_MAX_EP_NUMBER)
                      00071         cblock
                      00072                 ep6Bo:4                 ; Endpoint #6 BD Out
                      00073                 ep6Bi:4                 ; Endpoint #6 BD In
                      00074         endc
                      00075 #endif
                      00076 
                      00077 #if(7 <= USB_MAX_EP_NUMBER)
                      00078         cblock
                      00079                 ep7Bo:4                 ; Endpoint #7 BD Out
                      00080                 ep7Bi:4                 ; Endpoint #7 BD In
                      00081         endc
                      00082 #endif
                      00083 
                      00084 #if(8 <= USB_MAX_EP_NUMBER)
                      00085         cblock
                      00086                 ep8Bo:4                 ; Endpoint #8 BD Out
                      00087                 ep8Bi:4                 ; Endpoint #8 BD In
                      00088         endc
                      00089 #endif
                      00090 
                      00091 #if(9 <= USB_MAX_EP_NUMBER)
                      00092         cblock
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 26


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00093                 ep9Bo:4                 ; Endpoint #9 BD Out
                      00094                 ep9Bi:4                 ; Endpoint #9 BD In
                      00095         endc
                      00096 #endif
                      00097 
                      00098 #if(10 <= USB_MAX_EP_NUMBER)
                      00099         cblock
                      00100                 ep10Bo:4                ; Endpoint #10 BD Out
                      00101                 ep10Bi:4                ; Endpoint #10 BD In
                      00102         endc
                      00103 #endif
                      00104 
                      00105 #if(11 <= USB_MAX_EP_NUMBER)
                      00106         cblock
                      00107                 ep11Bo:4                ; Endpoint #11 BD Out
                      00108                 ep11Bi:4                ; Endpoint #11 BD In
                      00109         endc
                      00110 #endif
                      00111 
                      00112 #if(12 <= USB_MAX_EP_NUMBER)
                      00113         cblock
                      00114                 ep12Bo:4                ; Endpoint #12 BD Out
                      00115                 ep12Bi:4                ; Endpoint #12 BD In
                      00116         endc
                      00117 #endif
                      00118 
                      00119 #if(13 <= USB_MAX_EP_NUMBER)
                      00120         cblock
                      00121                 ep13Bo:4                ; Endpoint #13 BD Out
                      00122                 ep13Bi:4                ; Endpoint #13 BD In
                      00123         endc
                      00124 #endif
                      00125 
                      00126 #if(14 <= USB_MAX_EP_NUMBER)
                      00127         cblock
                      00128                 ep14Bo:4                ; Endpoint #14 BD Out
                      00129                 ep14Bi:4                ; Endpoint #14 BD In
                      00130         endc
                      00131 #endif
                      00132 
                      00133 #if(15 <= USB_MAX_EP_NUMBER)
                      00134         cblock
                      00135                 ep15Bo:4                ; Endpoint #15 BD Out
                      00136                 ep15Bi:4                ; Endpoint #15 BD In
                      00137         endc
                      00138 #endif
                      00139 
                      00140 ; General RAM (in _USBMEMORYADDRESS bank)
                      00141         cblock
  00000418            00142                 usb_temp:2              ; Temporary storage
  0000041A            00143                 pSrc:3                  ; Source pointer
  0000041D            00144                 pDst:2                  ; Destination pointer
  0000041F            00145                 USBDeviceState:1        ; Device States: DETACHED, ATTACHED, ...
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 27


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

  00000420            00146                 USBActiveConfiguration:1        ; Value of current configuration
  00000421            00147                 USBAlternateInterface:USB_MAX_NUM_INT   ; Array to keep track of the current alternate s
                            etting for each interface ID
  00000423            00148                 controlTransferState:1  ; Control Transfer State
  00000424            00149                 inCount:2               ; In data counter
  00000426            00150                 outCount:2              ; Out data counter
  00000428            00151                 shortPacketStatus:1     ; Flag used by Control Transfer Read
  00000429            00152                 USTATcopy:1
  0000042A            00153                 lastDTS:1
  0000042B            00154                 bTRNIFCount:1
  0000042C            00155                 info:1
  0000042D            00156                 outfo:1
  0000042E            00157                 RemoteWakeup:1
                      00158         endc
                      00159 
                      00160 ; info bit aliases
                      00161 #define ctrl_trf_mem    0               ; [0]RAM      [1]ROM
                      00162 ;#define        RemoteWakeup    1               ; [0]Disabled [1]Enabled
                      00163 ;#define        cdc_mem_type    2               ; [0]RAM      [1]ROM
                      00164 #define includeZero     6
                      00165 #define busy            7
                      00166 
                      00167 ; Endpoint 0 buffers
                      00168         cblock
  0000042F            00169                 SetupPkt:USB_EP0_BUFF_SIZE
  00000437            00170                 CtrlTrfData:USB_EP0_BUFF_SIZE
                      00171         endc
                      00172 
                      00173 ; SetupPkt Byte and Bit Aliases
                      00174 #define bmRequestType   0
                      00175 #define bRequest        1
                      00176 #define wValue          2
                      00177 #define wIndex          4
                      00178 #define wLength         6
                      00179 
                      00180 #define Recipient       0               ; Device,Interface,Endpoint,Other (5 bits)
                      00181 #define RequestType     5               ; Standard,Class,Vendor,Reserved (2 bits)
                      00182 #define DataDir         7               ; Host-to-device,Device-to-host
                      00183 #define bFeature        2               ; DEVICE_REMOTE_WAKEUP,ENDPOINT_HALT
                      00184 
                      00185 #define bReportID       2               ; In a SET_REPORT or GET_REPORT request
                      00186 #define bReportType     3               ; In a SET_REPORT or GET_REPORT request
                      00187 
                      00188 #define bDscIndex       2               ; For Configuration and String DSC Only
                      00189 #define bDescriptorType 3               ; Device,Configuration,String
                      00190 #define wLangID         4               ; Language ID
                      00191 
                      00192 #define bDevADR         2               ; Device Address 0-127
                      00193 #define bDevADRH        3               ; Must equal zero
                      00194 
                      00195 #define bConfigurationValue 2           ; Configuration Value 0-255
                      00196 #define bCfgRSD         3               ; Must equal zero (Reserved)
                      00197 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 28


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00198 #define bAltID          2               ; Alternate Setting Value 0-255
                      00199 #define bAltID_H        3               ; Must equal zero (Reserved)
                      00200 #define bIntfID         4               ; Interface Number Value 0-255
                      00201 #define bIntfID_H       5               ; Must equal zero
                      00202 
                      00203 #define bEPID           4               ; Endpoint ID (Number & Direction)
                      00204 #define bEPID_H         5               ; Must equal zero
                      00205 
                      00206 #define EPNum           0               ; Endpoint Number 0-15 (4 bits)
                      00207 #define EPDir           7               ; Endpoint Direction: 0-OUT, 1-IN
                      00208 
                      00209 
                      00210 ; HID RAM (in _USBMEMORYADDRESS bank)
                      00211 
                      00212 #ifdef USB_USE_HID
                      00213         cblock
  0000043F            00214                 idle_rate:1
  00000440            00215                 active_protocol:1       ; [0] Boot Protocol [1] Report Protocol
                      00216         endc
                      00217 #endif
                      00218 
                      00219 
                      00220 ; CDC RAM (in _USBMEMORYADDRESS bank)
                      00221 
                      00222 #ifdef USB_USE_CDC
                      00223         cblock
                      00224                 line_coding:LINE_CODING_LENGTH
                      00225                 control_signal_bitmap:1
                      00226                 dummy_encapsulated_cmd_response:dummy_length
                      00227         endc
                      00228 
                      00229 ; line_coding Byte and Bit Aliases
                      00230 #define dwDTERate       0               ; Complex data structure
                      00231 #define bCharFormat     4
                      00232 #define bParityType     5
                      00233 #define bDataBits       6
                      00234 
                      00235 ; control_signal_bitmap Byte and Bit Aliases
                      00236 #define DTE_PRESENT     0               ; [0] Not Present  [1] Present
                      00237 #define CARRIER_CONTROL 1               ; [0] Deactivate   [1] Activate
                      00238 #endif
                      00239 
                      00240 
                      00241 ; All previous RAM must be in _USBMEMORYADDRESS bank
                      00242 ; The following buffers may be in any dual-port RAM bank
                      00243 
                      00244 ; Generic Buffer RAM
                      00245 
                      00246 #ifdef USB_USE_GEN
                      00247         cblock
                      00248                 gen_data_rx:USBGEN_EP_SIZE + 1  ; +1 for size at front
                      00249                 gen_data_tx:USBGEN_EP_SIZE + 1  ; +1 for size at front
                      00250         endc
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 29


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00251 #endif
                      00252 
                      00253 
                      00254 ; HID Buffer RAM
                      00255 
                      00256 #ifdef USB_USE_HID
                      00257         cblock
  00000441            00258                 hid_report_out:HID_INT_OUT_EP_SIZE + 1  ; +1 for size at front
  00000452            00259                 hid_report_in:HID_INT_IN_EP_SIZE + 1    ; +1 for size at front
  00000463            00260                 hid_dev_report_out:HID_DEV_INT_OUT_EP_SIZE + 1  ; +1 for size at front
  00000474            00261                 hid_dev_report_in:HID_DEV_INT_IN_EP_SIZE + 1    ; +1 for size at front
                      00262         endc
                      00263 #endif
                      00264 
                      00265 
                      00266 ; CDC Buffer RAM
                      00267         
                      00268 #ifdef USB_USE_CDC
                      00269         cblock
                      00270                 cdc_notice:CDC_COMM_IN_EP_SIZE + 1      ; +1 for size at front
                      00271                 cdc_data_rx:CDC_DATA_OUT_EP_SIZE + 1    ; +1 for size at front
                      00272                 cdc_data_tx:CDC_DATA_IN_EP_SIZE + 1     ; +1 for size at front
                      00273         endc
                      00274 #endif
                      00006 
                      00007 ;/********************************************************************
                      00008 ; FileName:             usb_device.c
                      00009 ; Dependencies: See INCLUDES section
                      00010 ; Processor:            PIC18 or PIC24 USB Microcontrollers
                      00011 ; Hardware:             The code is natively intended to be used on the following
                      00012 ;                               hardware platforms: PICDEM FS USB Demo Board, 
                      00013 ;                               PIC18F87J50 FS USB Plug-In Module, or
                      00014 ;                               Explorer 16 + PIC24 USB PIM.  The firmware may be
                      00015 ;                               modified for use on other USB platforms by editing the
                      00016 ;                               HardwareProfile.h file.
                      00017 ; Complier:     Microchip C18 (for PIC18) or C30 (for PIC24)
                      00018 ; Company:              Microchip Technology, Inc.
                      00019 ;
                      00020 ; Software License Agreement:
                      00021 ;
                      00022 ; The software supplied herewith by Microchip Technology Incorporated
                      00023 ; (the Company) for its PIC Microcontroller is intended and
                      00024 ; supplied to you, the Companys customer, for use solely and
                      00025 ; exclusively on Microchip PIC Microcontroller products. The
                      00026 ; software is owned by the Company and/or its supplier, and is
                      00027 ; protected under applicable copyright laws. All rights are reserved.
                      00028 ; Any use in violation of the foregoing restrictions may subject the
                      00029 ; user to criminal sanctions under applicable laws, as well as to
                      00030 ; civil liability for the breach of the terms and conditions of this
                      00031 ; license.
                      00032 
                      00033 ; THIS SOFTWARE IS PROVIDED IN AN AS IS CONDITION. NO WARRANTIES,
                      00034 ; WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 30


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00035 ; TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
                      00036 ; PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
                      00037 ; IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
                      00038 ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
                      00039 
                      00040 ;********************************************************************/
                      00041 
                      00042 ;/** INCLUDES *******************************************************/
                      00043 ;#include "GenericTypeDefs.h"
                      00044 ;#include "Compiler.h"
                      00045 ;#include "./USB/usb_ch9.h"
                      00046 ;#include "./USB/USB.h"
                      00047 ;#include "./USB/usb_device.h"
                      00048 ;#include "HardwareProfile.h"
                      00049 ;#include "usb_config.h"
                      00050 
                      00051 ;#if defined(USB_USE_MSD)
                      00052 ;    #include "./USB/usb_function_msd.h"
                      00053 ;#endif
                      00054 
                      00055 ;/** VARIABLES ******************************************************/
                      00056 ;#pragma udata
                      00057 
                      00058 ;USB_VOLATILE BYTE USBDeviceState;
                      00059 ;USB_VOLATILE BYTE USBActiveConfiguration;
                      00060 ;USB_VOLATILE BYTE USBAlternateInterface[USB_MAX_NUM_INT];
                      00061 ;volatile BDT_ENTRY *pBDTEntryEP0OutCurrent;
                      00062 ;volatile BDT_ENTRY *pBDTEntryEP0OutNext;
                      00063 ;volatile BDT_ENTRY *pBDTEntryOut[USB_MAX_EP_NUMBER+1];
                      00064 ;volatile BDT_ENTRY *pBDTEntryIn[USB_MAX_EP_NUMBER+1];
                      00065 ;USB_VOLATILE BYTE shortPacketStatus;
                      00066 ;USB_VOLATILE BYTE controlTransferState;
                      00067 ;USB_VOLATILE IN_PIPE inPipes[1];
                      00068 ;USB_VOLATILE OUT_PIPE outPipes[1];
                      00069 ;USB_VOLATILE BYTE *pDst;
                      00070 ;USB_VOLATILE BOOL RemoteWakeup;
                      00071 ;USB_VOLATILE BYTE USTATcopy;
                      00072 ;USB_VOLATILE WORD USBInMaxPacketSize[USB_MAX_EP_NUMBER]; 
                      00073 ;USB_VOLATILE BYTE *USBInData[USB_MAX_EP_NUMBER];
                      00074 
                      00075 ;/** USB FIXED LOCATION VARIABLES ***********************************/
                      00076 ;#if defined(__18CXX)
                      00077 ;    #if defined(__18F14K50) || defined(__18F13K50) || defined(__18LF14K50) || defined(__18LF13K50)
                      00078 ;        #pragma udata USB_BDT=0x200     //See Linker Script,usb2:0x200-0x2FF(256-byte)
                      00079 ;    #else
                      00080 ;        #pragma udata USB_BDT=0x400     //See Linker Script,usb4:0x400-0x4FF(256-byte)
                      00081 ;    #endif
                      00082 ;#endif
                      00083 
                      00084 ;/********************************************************************
                      00085 ; * Section A: Buffer Descriptor Table
                      00086 ; * - 0x400 - 0x4FF(max)
                      00087 ; * - USB_MAX_EP_NUMBER is defined in usb_config.h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 31


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00088 ; *******************************************************************/
                      00089 ;#if (USB_PING_PONG_MODE == USB_PING_PONG__NO_PING_PONG)
                      00090 ;    volatile BDT_ENTRY BDT[(USB_MAX_EP_NUMBER + 1) * 2] __attribute__ ((aligned (512)));
                      00091 ;#elif (USB_PING_PONG_MODE == USB_PING_PONG__EP0_OUT_ONLY)
                      00092 ;    volatile BDT_ENTRY BDT[((USB_MAX_EP_NUMBER + 1) * 2)+1] __attribute__ ((aligned (512)));
                      00093 ;#elif (USB_PING_PONG_MODE == USB_PING_PONG__FULL_PING_PONG)
                      00094 ;    volatile BDT_ENTRY BDT[(USB_MAX_EP_NUMBER + 1) * 4] __attribute__ ((aligned (512)));
                      00095 ;#elif (USB_PING_PONG_MODE == USB_PING_PONG__ALL_BUT_EP0)
                      00096 ;    volatile BDT_ENTRY BDT[((USB_MAX_EP_NUMBER + 1) * 4)-2] __attribute__ ((aligned (512)));
                      00097 ;#else
                      00098 ;    #error "No ping pong mode defined."
                      00099 ;#endif
                      00100 
                      00101 ;//#if defined(__18CXX)
                      00102 ;//#pragma udata usbram5=0x400     //See Linker Script,usb5:0x500-0x5FF(256-byte)
                      00103 ;//#endif
                      00104 
                      00105 ;/********************************************************************
                      00106 ; * Section B: EP0 Buffer Space
                      00107 ; *******************************************************************/
                      00108 ;volatile CTRL_TRF_SETUP SetupPkt;           // 8-byte only
                      00109 ;volatile BYTE CtrlTrfData[USB_EP0_BUFF_SIZE];
                      00110 
                      00111 ;/********************************************************************
                      00112 ; * Section C: non-EP0 Buffer Space
                      00113 ; *******************************************************************/
                      00114 ;// Can provide compile time option to do software pingpong
                      00115 ;#if defined(USB_USE_HID)
                      00116 ;volatile unsigned char hid_report_out[HID_INT_OUT_EP_SIZE];
                      00117 ;volatile unsigned char hid_report_in[HID_INT_IN_EP_SIZE];
                      00118 ;#endif
                      00119 
                      00120 ;#if defined(USB_USE_MSD)
                      00121 ;       //volatile far USB_MSD_CBW_CSW msd_cbw_csw;
                      00122 ;       volatile USB_MSD_CBW msd_cbw;
                      00123 ;       volatile USB_MSD_CSW msd_csw;
                      00124 ;       //#pragma udata
                      00125 
                      00126 ;       #if defined(__18CXX)
                      00127 ;               #pragma udata myMSD=MSD_BUFFER_ADDRESS
                      00128 ;       #endif
                      00129 ;       volatile char msd_buffer[512];
                      00130 ;#endif
                      00131 
                      00132 ;#if defined(__18CXX)
                      00133 ;#pragma udata
                      00134 ;#endif
                      00135 
                      00136 ;/** DECLARATIONS ***************************************************/
                      00137 ;#pragma code
                      00138 
                      00139 ; Put Address into source pointer
                      00140 mSetSourcePointer macro Address
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 32


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00141         movlw   low (Address)
                      00142         movwf   pSrc
                      00143         movlw   high (Address)
                      00144         movwf   pSrc + 1
                      00145         movlw   upper (Address)
                      00146         movwf   pSrc + 2
                      00147         endm
                      00148 
                      00149 ; Put Address into destination pointer
                      00150 mSetDestinationPointer macro Address
                      00151         movlw   low (Address)
                      00152         movwf   pDst
                      00153         movlw   high (Address)
                      00154         movwf   pDst + 1
                      00155         endm
                      00156 
                      00157 ; Get count from first location of ROM table pointed to by pSrc
                      00158 mGetRomTableCount macro
                      00159         movff   pSrc, TBLPTRL           ; Set source address
                      00160         movff   pSrc + 1, TBLPTRH
                      00161         movff   pSrc + 2, TBLPTRU
                      00162         tblrd   *                       ; Read count
                      00163         movff   TABLAT, inCount
                      00164         clrf    inCount + 1
                      00165         endm
                      00166 
                      00167 ;//DOM-IGNORE-BEGIN
                      00168 ;/****************************************************************************
                      00169 ;  Function:
                      00170 ;    void USBDeviceInit(void)
                      00171 
                      00172 ;  Description:
                      00173 ;    This function initializes the device stack
                      00174 ;    it in the default state
                      00175 
                      00176 ;  Precondition:
                      00177 ;    None
                      00178 
                      00179 ;  Parameters:
                      00180 ;    None
                      00181 
                      00182 ;  Return Values:
                      00183 ;    None
                      00184 
                      00185 ;  Remarks:
                      00186 ;    The USB module will be completely reset including
                      00187 ;    all of the internal variables, registers, and
                      00188 ;    interrupt flags.
                      00189 ;  ***************************************************************************/
                      00190 ;//DOM-IGNORE-END
                      00191 ;void USBDeviceInit(void)
000178                00192 USBDeviceInit
                      00193 ;{
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 33


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00194 ;    BYTE i;
                      00195 
                      00196 ;    // Clear all USB error flags
                      00197 ;    USBClearInterruptRegister(U1EIR);
                      00198 #if (UEIR < 0xf60)
                      00199         BANKSEL UEIR
                      00200 #endif
000178 6A6A           00201         clrf    UEIR                    ; Clear all USB error flags
                      00202 
                      00203 ;    // Clears all USB interrupts     
                      00204 ;    USBClearInterruptRegister(U1IR);
00017A 6A68           00205         clrf    UIR                     ; Clear all USB interrupts
                      00206 
                      00207 ;    U1EIE = 0x9F;                   // Unmask all USB error interrupts
                      00208 #if (UEIE < 0xf60)
                      00209         BANKSEL UEIE
                      00210 #endif
00017C 0E9F           00211         movlw   0x9f                    ; Unmask all USB error interrupts
00017E 6E6B           00212         movwf   UEIE
                      00213 ;    U1IE = 0xFB;                    // Enable all interrupts except ACTVIE
                      00214 ;#if (UIE < 0xf60)
                      00215 ;       BANKSEL UIE
                      00216 ;#endif
000180 0EFB           00217         movlw   0xfb                    ; Enable all interrupts except ACTVIE
000182 6E69           00218         movwf   UIE
                      00219 
                      00220 ;    //power up the module
                      00221 ;    USBPowerModule();
                      00222 ;       rcall   USBPowerModule          ; Does nothing
                      00223 
                      00224 ;    //set the address of the BDT (if applicable)
                      00225 ;    USBSetBDTAddress(BDT);
                      00226 ;       rcall   USBSetBDTAddress        ; Does nothing
                      00227 
                      00228 ;    // Reset all of the Ping Pong buffers
                      00229 ;    USBPingPongBufferReset = 1;
                      00230 ;       bsf     USBPingPongBufferReset
                      00231 ;    USBPingPongBufferReset = 0;
                      00232 ;       bcf     USBPingPongBufferReset
                      00233 
                      00234 ;    // Reset to default address
                      00235 ;    U1ADDR = 0x00;
                      00236 ;#if (UADDR < 0xf60)
                      00237 ;       BANKSEL UADDR
                      00238 ;#endif
000184 6A6E           00239         clrf    UADDR                   ; Reset to default address
                      00240 
                      00241 ;    //Clear all of the endpoint control registers
                      00242 ;    memset((void*)&U1EP1,0x00,(USB_MAX_EP_NUMBER-1));
000186 EE2F F071      00243         lfsr    2, UEP1                 ; Clear all of the endpoint control registers
00018A 0E02           00244         movlw   USB_MAX_EP_NUMBER
00018C                00245 USBDeviceInitEPLoop
00018C 6ADE           00246         clrf    POSTINC2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 34


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00018E 2EE8           00247         decfsz  WREG, F
000190 D7FD           00248         bra     USBDeviceInitEPLoop
                      00249 
                      00250 ;    //Clear all of the BDT entries
                      00251 ;    for(i=0;i<(sizeof(BDT)/sizeof(BDT_ENTRY));i++)
                      00252 ;    {
                      00253 ;        BDT[i].Val = 0x00;
                      00254 ;    }
                      00255 
                      00256 ;    // Initialize EP0 as a Ctrl EP
                      00257 ;    U1EP0 = EP_CTRL|USB_HANDSHAKE_ENABLED;
                      00258 ;#if (UEP0 < 0xf60)
                      00259 ;       BANKSEL UEP0
                      00260 ;#endif
000192 0E16           00261         movlw   EP_CTRL|USB_HANDSHAKE_ENABLED   ; Initialize EP0 as a Ctrl EP
000194 6E70           00262         movwf   UEP0
                      00263 
                      00264 ;    // Flush any pending transactions
                      00265 ;    while(USBTransactionCompleteIF == 1)
                      00266 ;    {
                      00267 ;        USBClearInterruptFlag(USBTransactionCompleteIFReg,USBTransactionCompleteIFBitNum);
                      00268 ;    }
000196 D007           00269         bra     USBDeviceInitFlush1     ; Simulate while
000198                00270 USBDeviceInitFlushLoop
000198 9668           00271         bcf     UIR, TRNIF              ; Flush any pending transactions
00019A 0000           00272         nop
00019C 0000           00273         nop
00019E 0000           00274         nop
0001A0 0000           00275         nop
0001A2 0000           00276         nop
0001A4 0000           00277         nop
0001A6                00278 USBDeviceInitFlush1
0001A6 B668           00279         btfsc   UIR, TRNIF
0001A8 D7F7           00280         bra     USBDeviceInitFlushLoop
                      00281 
                      00282 ;    //clear all of the internal pipe information
                      00283 ;    inPipes[0].info.Val = 0;
0001AA 0104           00284         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0001AC 6B2C           00285         clrf    info
                      00286 ;    outPipes[0].info.Val = 0;
0001AE 6B2D           00287         clrf    outfo
                      00288 ;    outPipes[0].wCount.Val = 0;
0001B0 6B26           00289         clrf    outCount
0001B2 6B27           00290         clrf    outCount + 1
                      00291 
0001B4 6B2E           00292         clrf    RemoteWakeup
                      00293 
                      00294 ;    // Make sure packet processing is enabled
                      00295 ;    USBPacketDisable = 0;
0001B6 986D           00296         bcf     UCON, PKTDIS            ; Make sure packet processing is enabled
                      00297 
                      00298 ;    //Get ready for the first packet
                      00299 ;    pBDTEntryIn[0] = (volatile BDT_ENTRY*)&BDT[EP0_IN_EVEN];
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 35


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00300 
                      00301 ;    // Clear active configuration
                      00302 ;    USBActiveConfiguration = 0;
0001B8 6B20           00303         clrf    USBActiveConfiguration  ; Clear active configuration
                      00304 
                      00305 ;    //Indicate that we are now in the detached state
                      00306 ;    USBDeviceState = DETACHED_STATE;
0001BA 0E00           00307         movlw   DETACHED_STATE          ; Indicate that we are now in the detached state
0001BC 6F1F           00308         movwf   USBDeviceState
0001BE 0012           00309         return
                      00310 ;}
                      00311 
                      00312 ;//DOM-IGNORE-BEGIN
                      00313 ;/****************************************************************************
                      00314 ;  Function:
                      00315 ;    void USBDeviceTasks(void)
                      00316 
                      00317 ;  Description:
                      00318 ;    This function is the main state machine of the 
                      00319 ;    USB device side stack.  This function should be
                      00320 ;    called periodically to receive and transmit
                      00321 ;    packets through the stack.  This function should
                      00322 ;    be called  preferably once every 100us 
                      00323 ;    during the enumeration process.  After the
                      00324 ;    enumeration process this function still needs to
                      00325 ;    be called periodically to respond to various
                      00326 ;    situations on the bus but is more relaxed in its
                      00327 ;    time requirements.  This function should also
                      00328 ;    be called at least as fast as the OUT data
                      00329 ;    expected from the PC.
                      00330 
                      00331 ;  Precondition:
                      00332 ;    None
                      00333 
                      00334 ;  Parameters:
                      00335 ;    None
                      00336 
                      00337 ;  Return Values:
                      00338 ;    None
                      00339 
                      00340 ;  Remarks:
                      00341 ;    None
                      00342 ;  ***************************************************************************/
                      00343 ;//DOM-IGNORE-END
                      00344 ;void USBDeviceTasks(void)
0001C0                00345 USBDeviceTasks
                      00346 ;{
                      00347 ;       BYTE i;
                      00348 
0001C0 0104           00349         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00350 #ifdef USE_USB_BUS_SENSE_IO
                      00351 ;    //If we aren't attached to the bus
                      00352 ;    if(USB_BUS_SENSE != 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 36


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00353         btfsc   USB_BUS_SENSE           ; If we aren't attached to the bus
                      00354         bra     USBDeviceTasksCheckDetached
                      00355 ;    {
                      00356 ;        // Disable module & detach from bus
                      00357 ;        U1CON = 0;
                      00358         clrf    UCON                    ; Disable module & detach from bus
                      00359 
                      00360 ;        // Mask all USB interrupts
                      00361 ;        U1IE = 0;
                      00362 #if (UIE < 0xf60)
                      00363         BANKSEL UIE
                      00364 #endif
                      00365         clrf    UIE                     ; Mask all USB interrupts
                      00366 
                      00367 ;        //Move to the detached state
                      00368 ;        USBDeviceState = DETACHED_STATE;
                      00369         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00370         movlw   DETACHED_STATE          ; Move to the detached state
                      00371         movwf   USBDeviceState
                      00372 
                      00373 ;        //return so that we don't go through the rest of 
                      00374 ;        //the state machine
                      00375 ;        return;
                      00376         return                          ; Return so that we don't go through the rest of the state machi
                            ne
                      00377 ;    }
                      00378 #endif
                      00379 
0001C2                00380 USBDeviceTasksCheckDetached
                      00381 ;    //if we are in the detached state
                      00382 ;    if(USBDeviceState == DETACHED_STATE)
0001C2 0E00           00383         movlw   DETACHED_STATE
0001C4 631F           00384         cpfseq  USBDeviceState
0001C6 D00A           00385         bra     USBDeviceTasksCheckAttached
                      00386 ;    {
                      00387 ;        //#if defined(__18CXX)
                      00388 ;            U1CON = 0;                           // Disable module & detach from bus
0001C8 6A6D           00389         clrf    UCON                    ; Disable module & detach from bus
                      00390 ;        //#else
                      00391 ;        //#endif
                      00392 
                      00393 ;        // Mask all USB interrupts
                      00394 ;        U1IE = 0;
                      00395 #if (UIE < 0xf60)
                      00396         BANKSEL UIE
                      00397 #endif
0001CA 6A69           00398         clrf    UIE                     ; Mask all USB interrupts
                      00399 
                      00400 ;        // Enable module & attach to bus
                      00401 ;        while(!U1CONbits.USBEN){U1CONbits.USBEN = 1;}
0001CC                00402 USBDeviceTasksCDLoop
0001CC 866D           00403         bsf     UCON, USBEN             ; Enable module & attach to bus
0001CE A66D           00404         btfss   UCON, USBEN
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 37


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0001D0 D7FD           00405         bra     USBDeviceTasksCDLoop
                      00406 
                      00407 ;        //moved to the attached state
                      00408 ;        USBDeviceState = ATTACHED_STATE;
0001D2 0104           00409         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0001D4 0E01           00410         movlw   ATTACHED_STATE
0001D6 6F1F           00411         movwf   USBDeviceState
                      00412 
                      00413 ;        //Enable/set things like: pull ups, full/low-speed mode,
                      00414 ;        //set the ping pong mode, and set internal transceiver
                      00415 ;        SetConfigurationOptions();
                      00416 #if (UCFG < 0xf60)
                      00417         BANKSEL UCFG
                      00418 #endif
0001D8 0E14           00419         movlw   UCFG_VAL                ; Enable/set things like: pull ups, full/low-speed mode...
0001DA 6E6F           00420         movwf   UCFG
                      00421 ;    }
                      00422 
0001DC                00423 USBDeviceTasksCheckAttached
                      00424 ;    if(USBDeviceState == ATTACHED_STATE)
0001DC 0E01           00425         movlw   ATTACHED_STATE
0001DE 631F           00426         cpfseq  USBDeviceState
0001E0 D009           00427         bra     USBDeviceTasksA
                      00428 ;    {
                      00429 ;        /*
                      00430 ;         * After enabling the USB module, it takes some time for the
                      00431 ;         * voltage on the D+ or D- line to rise high enough to get out
                      00432 ;         * of the SE0 condition. The USB Reset interrupt should not be
                      00433 ;         * unmasked until the SE0 condition is cleared. This helps
                      00434 ;         * prevent the firmware from misinterpreting this unique event
                      00435 ;         * as a USB bus reset from the USB host.
                      00436 ;         */
                      00437 
                      00438 ;        if(!USBSE0Event)
0001E2 BA6D           00439         btfsc   UCON, SE0
0001E4 D007           00440         bra     USBDeviceTasksA
                      00441 ;        {
                      00442 ;            USBClearInterruptRegister(U1IR);// Clear all USB interrupts
0001E6 6A68           00443         clrf    UIR                     ; Clear all USB interrupts
                      00444 ;            U1IE=0;                        // Mask all USB interrupts
                      00445 #if (UIE < 0xf60)
                      00446         BANKSEL UIE
                      00447 #endif
0001E8 6A69           00448         clrf    UIE                     ; Mask all USB interrupts
                      00449 ;            USBResetIE = 1;             // Unmask RESET interrupt
0001EA 8069           00450         bsf     UIE, URSTIE             ; Unmask RESET interrupt
                      00451 ;            USBIdleIE = 1;             // Unmask IDLE interrupt
0001EC 8869           00452         bsf     UIE, IDLEIE             ; Unmask IDLE interrupt
                      00453 ;            USBDeviceState = POWERED_STATE;
0001EE 0104           00454         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0001F0 0E02           00455         movlw   POWERED_STATE
0001F2 6F1F           00456         movwf   USBDeviceState
                      00457 ;        }
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 38


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00458 ;    }
                      00459 
0001F4                00460 USBDeviceTasksA
                      00461 ;    /*
                      00462 ;     * Task A: Service USB Activity Interrupt
                      00463 ;     */
                      00464 ;    if(USBActivityIF && USBActivityIE)
0001F4 A468           00465         btfss   UIR, ACTVIF
0001F6 D002           00466         bra     USBDeviceTasks1
                      00467 #if (UIE < 0xf60)
                      00468         BANKSEL UIE
                      00469 #endif
0001F8 B469           00470         btfsc   UIE, ACTVIE
                      00471 ;    {
                      00472 ;        USBWakeFromSuspend();
0001FA D84C           00473         rcall   USBWakeFromSuspend
                      00474 ;    }
                      00475 
0001FC                00476 USBDeviceTasks1
                      00477 ;    /*
                      00478 ;     * Pointless to continue servicing if the device is in suspend mode.
                      00479 ;     */
                      00480 ;    if(USBSuspendControl==1)
0001FC B26D           00481         btfsc   UCON, SUSPND            ; Are we suspended?
                      00482 ;    {
                      00483 ;        return;
0001FE 0012           00484         return                          ; Pointless to continue servicing if the device is in suspend mo
                            de.
                      00485 ;    }
                      00486 
                      00487 ;    /*
                      00488 ;     * Task B: Service USB Bus Reset Interrupt.
                      00489 ;     * When bus reset is received during suspend, ACTVIF will be set first,
                      00490 ;     * once the UCONbits.SUSPND is clear, then the URSTIF bit will be asserted.
                      00491 ;     * This is why URSTIF is checked after ACTVIF.
                      00492 ;     *
                      00493 ;     * The USB reset flag is masked when the USB state is in
                      00494 ;     * DETACHED_STATE or ATTACHED_STATE, and therefore cannot
                      00495 ;     * cause a USB reset event during these two states.
                      00496 ;     */
                      00497 ;    if(USBResetIF && USBResetIE)
000200 A068           00498         btfss   UIR, URSTIF             ; USB Bus Reset Interrupt?
000202 D00E           00499         bra     USBDeviceTasks2
                      00500 #if (UIE < 0xf60)
                      00501         BANKSEL UIE
                      00502 #endif
000204 A069           00503         btfss   UIE, URSTIE
000206 D00C           00504         bra     USBDeviceTasks2
                      00505 ;    {
                      00506 ;        USBDeviceInit();
000208 DFB7           00507         rcall   USBDeviceInit
                      00508 ;        USBDeviceState = DEFAULT_STATE;
00020A 0104           00509         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 39


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00020C 0E04           00510         movlw   DEFAULT_STATE
00020E 6F1F           00511         movwf   USBDeviceState
                      00512 
                      00513 ;        /********************************************************************
                      00514 ;        Bug Fix: Feb 26, 2007 v2.1 (#F1)
                      00515 ;        *********************************************************************
                      00516 ;        In the original firmware, if an OUT token is sent by the host
                      00517 ;        before a SETUP token is sent, the firmware would respond with an ACK.
                      00518 ;        This is not a correct response, the firmware should have sent a STALL.
                      00519 ;        This is a minor non-compliance since a compliant host should not
                      00520 ;        send an OUT before sending a SETUP token. The fix allows a SETUP
                      00521 ;        transaction to be accepted while stalling OUT transactions.
                      00522 ;        ********************************************************************/
                      00523 ;        BDT[EP0_OUT_EVEN].ADR = (BYTE*)&SetupPkt;
000210 0E2F           00524         movlw   low SetupPkt
000212 6F02           00525         movwf   ep0Bo + ADRL
000214 0E04           00526         movlw   high SetupPkt
000216 6F03           00527         movwf   ep0Bo + ADRH
                      00528 ;        BDT[EP0_OUT_EVEN].CNT = USB_EP0_BUFF_SIZE;
000218 0E08           00529         movlw   USB_EP0_BUFF_SIZE
00021A 6F01           00530         movwf   ep0Bo + Cnt
                      00531 ;        BDT[EP0_OUT_EVEN].STAT.Val &= ~_STAT_MASK;
                      00532 ;       movf    ep0Bo + Stat, W
                      00533 ;       andlw   ~_STAT_MASK
                      00534 ;        BDT[EP0_OUT_EVEN].STAT.Val |= _USIE|_DAT0|_DTSEN|_BSTALL;
                      00535 ;       iorlw   _USIE|_DAT0|_DTSEN|_BSTALL
00021C 0E8C           00536         movlw   _USIE|_DAT0|_DTSEN|_BSTALL
00021E 6F00           00537         movwf   ep0Bo + Stat
                      00538 ;    }
                      00539 
000220                00540 USBDeviceTasks2
                      00541 ;    /*
                      00542 ;     * Task C: Service other USB interrupts
                      00543 ;     */
                      00544 ;    if(USBIdleIF && USBIdleIE)
000220 A868           00545         btfss   UIR, IDLEIF
000222 D004           00546         bra     USBDeviceTasks3
                      00547 #if (UIE < 0xf60)
                      00548         BANKSEL UIE
                      00549 #endif
000224 A869           00550         btfss   UIE, IDLEIE
000226 D002           00551         bra     USBDeviceTasks3
                      00552 ;    {
                      00553 ;        USBSuspend();
000228 D831           00554         rcall   USBSuspend
                      00555 ;        USBClearInterruptFlag(USBIdleIFReg,USBIdleIFBitNum);
00022A 9868           00556         bcf     UIR, IDLEIF
                      00557 ;    }
                      00558 
00022C                00559 USBDeviceTasks3
                      00560 ;    if(USBSOFIF && USBSOFIE)
00022C AC68           00561         btfss   UIR, SOFIF
00022E D004           00562         bra     USBDeviceTasks4
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 40


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00563 #if (UIE < 0xf60)
                      00564         BANKSEL UIE
                      00565 #endif
000230 AC69           00566         btfss   UIE, SOFIE
000232 D002           00567         bra     USBDeviceTasks4
                      00568 ;    {
                      00569 ;        USBCB_SOF_Handler();    // Required callback, see usbcallbacks.c
000234 DBD6           00570         rcall   USBCB_SOF_Handler
                      00571 ;        USBClearInterruptFlag(USBSOFIFReg,USBSOFIFBitNum);
000236 9C68           00572         bcf     UIR, SOFIF
                      00573 ;    }
                      00574 
000238                00575 USBDeviceTasks4
                      00576  ;   if(USBStallIF && USBStallIE)
000238 AA68           00577         btfss   UIR, STALLIF
00023A D002           00578         bra     USBDeviceTasks5
                      00579 #if (UIE < 0xf60)
                      00580         BANKSEL UIE
                      00581 #endif
00023C BA69           00582         btfsc   UIE, STALLIE
                      00583 ;    {
                      00584 ;        USBStallHandler();
00023E D818           00585         rcall   USBStallHandler
                      00586 ;    }
                      00587 
000240                00588 USBDeviceTasks5
                      00589 ;    if(USBErrorIF && USBErrorIE)
000240 A268           00590         btfss   UIR, UERRIF
000242 D004           00591         bra     USBDeviceTasks6
                      00592 #if (UIE < 0xf60)
                      00593         BANKSEL UIE
                      00594 #endif
000244 A269           00595         btfss   UIE, UERRIE
000246 D002           00596         bra     USBDeviceTasks6
                      00597 ;    {
                      00598 ;        USBCBErrorHandler();    // Required callback, see usbcallbacks.c
000248 DBCD           00599         rcall   USBCBErrorHandler
                      00600 ;        USBClearInterruptRegister(U1EIR);               // This clears UERRIF
00024A 6A68           00601         clrf    UIR                     ; This clears UERRIF
                      00602 ;    }
                      00603 
00024C                00604 USBDeviceTasks6
                      00605 ;    /*
                      00606 ;     * Pointless to continue servicing if the host has not sent a bus reset.
                      00607 ;     * Once bus reset is received, the device transitions into the DEFAULT
                      00608 ;     * state and is ready for communication.
                      00609 ;     */
                      00610 ;    if(USBDeviceState < DEFAULT_STATE) return;
00024C 0104           00611         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00024E 0E04           00612         movlw   DEFAULT_STATE
000250 5D1F           00613         subwf   USBDeviceState, W
000252 E30D           00614         bnc     USBDriverTasksExit
                      00615 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 41


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00616 ;    /*
                      00617 ;     * Task D: Servicing USB Transaction Complete Interrupt
                      00618 ;     */
                      00619 ;    if(USBTransactionCompleteIE)
                      00620 #if (UIE < 0xf60)
                      00621         BANKSEL UIE
                      00622 #endif
000254 A669           00623         btfss   UIE, TRNIE
000256 0012           00624         return
                      00625 ;    {
                      00626 ;           for(i = 0; i < 4; i++)      //Drain or deplete the USAT FIFO entries.  If the USB FIFO ever 
                            gets full, USB bandwidth 
                      00627 ;               {                                               //utilization can be compromised, and th
                            e device won't be able to receive SETUP packets.
000258 0104           00628         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
00025A 0E04           00629         movlw   4                       ; Drain or deplete the USAT FIFO entries.  If the USB FIFO ever 
                            gets full, USB bandwidth
00025C 6F2B           00630         movwf   bTRNIFCount             ; utilization can be compromised, and the device won't be able t
                            o receive SETUP packets.
00025E                00631 USBDeviceTasks7
                      00632 ;                   if(USBTransactionCompleteIF)
00025E A668           00633         btfss   UIR, TRNIF
000260 0012           00634         return
                      00635 ;                   {
                      00636 ;                       USTATcopy = U1STAT;
000262 506C           00637         movf    USTAT, W
000264 6F29           00638         movwf   USTATcopy
                      00639 
                      00640 ;                       USBClearInterruptFlag(USBTransactionCompleteIFReg,USBTransactionCompleteIFBitNum
                            );
000266 9668           00641         bcf     UIR, TRNIF
                      00642 
                      00643 ;                       /*
                      00644 ;                        * USBCtrlEPService only services transactions over EP0.
                      00645 ;                        * It ignores all other EP transactions.
                      00646 ;                        */
                      00647 ;                       USBCtrlEPService();
000268 D81C           00648         rcall   USBCtrlEPService
                      00649 ;                   }//end if(USBTransactionCompleteIF)
                      00650 ;                   else
                      00651 ;                       break;  //USTAT FIFO must be empty.
                      00652 ;               }//end for()
00026A 2F2B           00653         decfsz  bTRNIFCount, F
00026C D7F8           00654         bra     USBDeviceTasks7
                      00655 ;       }//end if(USBTransactionCompleteIE)
00026E                00656 USBDriverTasksExit
00026E 0012           00657         return
                      00658 
                      00659 ;}//end of USBDeviceTasks()
                      00660 
                      00661 ;/********************************************************************
                      00662 ; * Function:        void USBStallHandler(void)
                      00663 ; *
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 42


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00664 ; * PreCondition:    None
                      00665 ; *
                      00666 ; * Input:           None
                      00667 ; *
                      00668 ; * Output:          None
                      00669 ; *
                      00670 ;; * Side Effects:    
                      00671 ; *
                      00672 ; * Overview:        This function handles the event of a STALL 
                      00673 ; *                  occuring on the bus
                      00674 ; *
                      00675 ; * Note:            None
                      00676 ; *******************************************************************/
                      00677 ;void USBStallHandler(void)
000270                00678 USBStallHandler
                      00679 ;{
                      00680 ;    /*
                      00681 ;     * Does not really have to do anything here,
                      00682 ;     * even for the control endpoint.
                      00683 ;     * All BDs of Endpoint 0 are owned by SIE right now,
                      00684 ;     * but once a Setup Transaction is received, the ownership
                      00685 ;     * for EP0_OUT will be returned to CPU.
                      00686 ;     * When the Setup Transaction is serviced, the ownership
                      00687 ;     * for EP0_IN will then be forced back to CPU by firmware.
                      00688 ;     */
                      00689 ;
                      00690 ;    /* v2b fix */
                      00691 ;    if(U1EP0bits.EPSTALL == 1)
                      00692 #if (UEP0 < 0xf60)
                      00693         BANKSEL UEP0
                      00694 #endif
000270 A070           00695         btfss   UEP0, EPSTALL
000272 D00A           00696         bra     USBStallHandlerExit
                      00697 ;    {
                      00698 ;        // UOWN - if 0, owned by CPU, if 1, owned by SIE
                      00699 ;        if((pBDTEntryEP0OutCurrent->STAT.Val == _USIE) && (pBDTEntryIn[0]->STAT.Val == (_USIE|_BSTALL))
                            )
000274 0104           00700         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
000276 0E80           00701         movlw   _USIE                   ; UOWN - if 0, owned by CPU, if 1, owned by SIE
000278 6300           00702         cpfseq  ep0Bo + Stat
00027A D006           00703         bra     USBStallHandlerExit
00027C 0E84           00704         movlw   _USIE|_BSTALL
00027E 6304           00705         cpfseq  ep0Bi + Stat
000280 D003           00706         bra     USBStallHandlerExit
                      00707 ;        {
                      00708 ;            // Set ep0Bo to stall also
                      00709 ;            pBDTEntryEP0OutCurrent->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;
000282 0E8C           00710         movlw   _USIE|_DAT0|_DTSEN|_BSTALL      ; Set ep0Bo to stall also
000284 6F00           00711         movwf   ep0Bo + Stat
                      00712 ;        }//end if
                      00713 ;        U1EP0bits.EPSTALL = 0;               // Clear stall status
                      00714 #if (UEP0 < 0xf60)
                      00715         BANKSEL UEP0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 43


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00716 #endif
000286 9070           00717         bcf     UEP0, EPSTALL           ; Clear stall status
                      00718 ;    }//end if
                      00719 
000288                00720 USBStallHandlerExit
                      00721 ;    USBClearInterruptFlag(USBSTALLIFReg,USBSTALLIFBitNum);
000288 9A68           00722         bcf     UIR, STALLIF
00028A 0012           00723         return
                      00724 ;}
                      00725 
                      00726 ;/********************************************************************
                      00727 ; * Function:        void USBSuspend(void)
                      00728 ; *
                      00729 ; * PreCondition:    None
                      00730 ; *
                      00731 ; * Input:           None
                      00732 ; *
                      00733 ; * Output:          None
                      00734 ; *
                      00735 ; * Side Effects:    
                      00736 ; *
                      00737 ; * Overview:        This function handles if the host tries to 
                      00738 ; *                  suspend the device
                      00739 ; *
                      00740 ; * Note:            None
                      00741 ; *******************************************************************/
                      00742 ;void USBSuspend(void)
00028C                00743 USBSuspend
                      00744 ;{
                      00745 ;    /*
                      00746 ;     * NOTE: Do not clear UIRbits.ACTVIF here!
                      00747 ;     * Reason:
                      00748 ;     * ACTVIF is only generated once an IDLEIF has been generated.
                      00749 ;     * This is a 1:1 ratio interrupt generation.
                      00750 ;     * For every IDLEIF, there will be only one ACTVIF regardless of
                      00751 ;     * the number of subsequent bus transitions.
                      00752 ;     *
                      00753 ;     * If the ACTIF is cleared here, a problem could occur when:
                      00754 ;     * [       IDLE       ][bus activity ->
                      00755 ;     * <--- 3 ms ----->     ^
                      00756 ;     *                ^     ACTVIF=1
                      00757 ;     *                IDLEIF=1
                      00758 ;     *  #           #           #           #   (#=Program polling flags)
                      00759 ;     *                          ^
                      00760 ;     *                          This polling loop will see both
                      00761 ;     *                          IDLEIF=1 and ACTVIF=1.
                      00762 ;     *                          However, the program services IDLEIF first
                      00763 ;     *                          because ACTIVIE=0.
                      00764 ;     *                          If this routine clears the only ACTIVIF,
                      00765 ;     *                          then it can never get out of the suspend
                      00766 ;     *                          mode.
                      00767 ;     */
                      00768 ;    USBActivityIE = 1;                     // Enable bus activity interrupt
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 44


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00769 #if (UIE < 0xf60)
                      00770         BANKSEL UIE
                      00771 #endif
00028C 8469           00772         bsf     UIE, ACTVIE             ; Enable bus activity interrupt
                      00773 ;    USBClearInterruptFlag(USBIdleIFReg,USBIdleIFBitNum);
00028E 9868           00774         bcf     UIR, IDLEIF
                      00775 
                      00776 ;#if defined(__18CXX)
                      00777 ;    U1CONbits.SUSPND = 1;                   // Put USB module in power conserve
000290 826D           00778         bsf     UCON, SUSPND            ; Put USB module in power conserve
                      00779                                         ; mode, SIE clock inactive
                      00780 ;#endif
                      00781 
                      00782 
                      00783 ;    /*
                      00784 ;     * At this point the PIC can go into sleep,idle, or
                      00785 ;     * switch to a slower clock, etc.  This should be done in the
                      00786 ;     * USBCBSuspend() if necessary.
                      00787 ;     */
                      00788 ;    USBCBSuspend();             // Required callback, see usbcallbacks.c
000292 D3A5           00789         bra     USBCBSuspend
                      00790 ;}
                      00791 
                      00792 ;/********************************************************************
                      00793 ; * Function:        void USBWakeFromSuspend(void)
                      00794 ; *
                      00795 ; * PreCondition:    None
                      00796 ; *
                      00797 ; * Input:           None
                      00798 ; *
                      00799 ; * Output:          None
                      00800 ; *
                      00801 ; * Side Effects:    None
                      00802 ; *
                      00803 ; * Overview:
                      00804 ; *
                      00805 ; * Note:            None
                      00806 ; *******************************************************************/
                      00807 ;void USBWakeFromSuspend(void)
000294                00808 USBWakeFromSuspend
                      00809 ;{
                      00810 ;    #if defined(__18CXX)
                      00811 ;    U1CONbits.SUSPND = 0;                   // Bring USB module out of power conserve
                      00812 ;                                            // mode.
000294 926D           00813         bcf     UCON, SUSPND            ; Bring USB module out of power conserve mode
                      00814 ;    #endif
                      00815 
                      00816 ;    /*
                      00817 ;     * If using clock switching, the place to restore the original
                      00818 ;     * microcontroller core clock frequency is in the USBCBWakeFromSuspend() callback
                      00819 ;     */
                      00820 ;    USBCBWakeFromSuspend(); // Required callback, see usbcallbacks.c
000296 DBA4           00821         rcall   USBCBWakeFromSuspend
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 45


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00822 
                      00823 ;    USBActivityIE = 0;
                      00824 #if (UIE < 0xf60)
                      00825         BANKSEL UIE
                      00826 #endif
000298 9469           00827         bcf     UIE, ACTVIE
                      00828 
                      00829 ;    /********************************************************************
                      00830 ;    Bug Fix: Feb 26, 2007 v2.1
                      00831 ;    *********************************************************************
                      00832 ;    The ACTVIF bit cannot be cleared immediately after the USB module wakes
                      00833 ;    up from Suspend or while the USB module is suspended. A few clock cycles
                      00834 ;    are required to synchronize the internal hardware state machine before
                      00835 ;    the ACTIVIF bit can be cleared by firmware. Clearing the ACTVIF bit
                      00836 ;    before the internal hardware is synchronized may not have an effect on
                      00837 ;    the value of ACTVIF. Additonally, if the USB module uses the clock from
                      00838 ;    the 96 MHz PLL source, then after clearing the SUSPND bit, the USB
                      00839 ;    module may not be immediately operational while waiting for the 96 MHz
                      00840 ;    PLL to lock.
                      00841 ;    ********************************************************************/
                      00842 
                      00843 ;    // UIRbits.ACTVIF = 0;                      // Removed
                      00844 ;    #if defined(__18CXX)
                      00845 ;    while(USBActivityIF)
00029A                00846 USBWakeFromSuspendLoop
00029A A468           00847         btfss   UIR, ACTVIF
00029C 0012           00848         return
                      00849 ;    #endif
                      00850 ;    {
                      00851 ;        USBClearInterruptFlag(USBActivityIFReg,USBActivityIFBitNum);
00029E 9468           00852         bcf     UIR, ACTVIF
                      00853 ;    }  // Added
0002A0 D7FC           00854         bra     USBWakeFromSuspendLoop
                      00855 
                      00856 ;}//end USBWakeFromSuspend
                      00857 
                      00858 ;/********************************************************************
                      00859 ; * Function:        void USBCtrlEPService(void)
                      00860 ; *
                      00861 ; * PreCondition:    USTAT is loaded with a valid endpoint address.
                      00862 ; *
                      00863 ; * Input:           None
                      00864 ; *
                      00865 ; * Output:          None
                      00866 ; *
                      00867 ; * Side Effects:    None
                      00868 ; *
                      00869 ; * Overview:        USBCtrlEPService checks for three transaction
                      00870 ; *                  types that it knows how to service and services
                      00871 ; *                  them:
                      00872 ; *                  1. EP0 SETUP
                      00873 ; *                  2. EP0 OUT
                      00874 ; *                  3. EP0 IN
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 46


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00875 ; *                  It ignores all other types (i.e. EP1, EP2, etc.)
                      00876 ; *
                      00877 ; * Note:            None
                      00878 ; *******************************************************************/
                      00879 ;void USBCtrlEPService(void)
0002A2                00880 USBCtrlEPService
                      00881 ;{
0002A2 0104           00882         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00883 ;       //If the last packet was a EP0 OUT packet
                      00884 ;    if((USTATcopy & USTAT_EP0_PP_MASK) == USTAT_EP0_OUT_EVEN)
0002A4 5129           00885         movf    USTATcopy, W
0002A6 0BFD           00886         andlw   USTAT_EP0_PP_MASK
0002A8 0800           00887         sublw   USTAT_EP0_OUT
0002AA E105           00888         bnz     USBCtrlEPService1
                      00889 ;    {
                      00890 ;               //Point to the EP0 OUT buffer of the buffer that arrived
                      00891 ;        #if defined(__18CXX)
                      00892 ;            pBDTEntryEP0OutCurrent = (volatile BDT_ENTRY*)&BDT[(USTATcopy & USTAT_EP_MASK)>>1];
                      00893 ;        #elif defined(__C30__)
                      00894 ;            pBDTEntryEP0OutCurrent = (volatile BDT_ENTRY*)&BDT[(USTATcopy & USTAT_EP_MASK)>>2];
                      00895 ;        #else
                      00896 ;            #error "unimplemented"
                      00897 ;        #endif
                      00898 
                      00899 ;               //Set the next out to the current out packet
                      00900 ;        pBDTEntryEP0OutNext = pBDTEntryEP0OutCurrent;
                      00901 ;               //Toggle it to the next ping pong buffer (if applicable)
                      00902 ;        ((BYTE_VAL*)&pBDTEntryEP0OutNext)->Val ^= USB_NEXT_EP0_OUT_PING_PONG;
                      00903 
                      00904 ;               //If the current EP0 OUT buffer has a SETUP token
                      00905 ;        if(pBDTEntryEP0OutCurrent->STAT.PID == SETUP_TOKEN)
0002AC 5100           00906         movf    ep0Bo + Stat, W
0002AE 0B3C           00907         andlw   0x3c                    ; Mask to PID
0002B0 0834           00908         sublw   (SETUP_TOKEN) << 2
                      00909 ;        {
                      00910 ;                       //Handle the control transfer
                      00911 ;            USBCtrlTrfSetupHandler();
0002B2 E006           00912         bz      USBCtrlTrfSetupHandler
                      00913 ;        }
                      00914 ;        else
                      00915 ;        {
                      00916 ;                       //Handle the DATA transfer
                      00917 ;            USBCtrlTrfOutHandler();
0002B4 D013           00918         bra     USBCtrlTrfOutHandler
                      00919 ;        }
                      00920 ;    }
                      00921 ;    else if((USTATcopy & USTAT_EP0_PP_MASK) == USTAT_EP0_IN)
0002B6                00922 USBCtrlEPService1
0002B6 5129           00923         movf    USTATcopy, W
0002B8 0BFD           00924         andlw   USTAT_EP0_PP_MASK
0002BA 0804           00925         sublw   USTAT_EP0_IN
                      00926 ;    {
                      00927 ;               //Otherwise the transmission was and EP0 IN
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 47


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00928 ;               //  so take care of the IN transfer
                      00929 ;        USBCtrlTrfInHandler();
0002BC E014           00930         bz      USBCtrlTrfInHandler
                      00931 ;    }
0002BE 0012           00932         return
                      00933 
                      00934 ;}//end USBCtrlEPService
                      00935 
                      00936 ;/********************************************************************
                      00937 ; * Function:        void USBCtrlTrfSetupHandler(void)
                      00938 ; *
                      00939 ; * PreCondition:    SetupPkt buffer is loaded with valid USB Setup Data
                      00940 ; *
                      00941 ; * Input:           None
                      00942 ; *
                      00943 ; * Output:          None
                      00944 ; *
                      00945 ; * Side Effects:    None
                      00946 ; *
                      00947 ; * Overview:        This routine is a task dispatcher and has 3 stages.
                      00948 ; *                  1. It initializes the control transfer state machine.
                      00949 ; *                  2. It calls on each of the module that may know how to
                      00950 ; *                     service the Setup Request from the host.
                      00951 ; *                     Module Example: USBD, HID, CDC, MSD, ...
                      00952 ; *                     A callback function, USBCBCheckOtherReq(),
                      00953 ; *                     is required to call other module handlers.
                      00954 ; *                  3. Once each of the modules has had a chance to check if
                      00955 ; *                     it is responsible for servicing the request, stage 3
                      00956 ; *                     then checks direction of the transfer to determine how
                      00957 ; *                     to prepare EP0 for the control transfer.
                      00958 ; *                     Refer to USBCtrlEPServiceComplete() for more details.
                      00959 ; *
                      00960 ; * Note:            Microchip USB Firmware has three different states for
                      00961 ; *                  the control transfer state machine:
                      00962 ; *                  1. WAIT_SETUP
                      00963 ; *                  2. CTRL_TRF_TX
                      00964 ; *                  3. CTRL_TRF_RX
                      00965 ; *                  Refer to firmware manual to find out how one state
                      00966 ; *                  is transitioned to another.
                      00967 ; *
                      00968 ; *                  A Control Transfer is composed of many USB transactions.
                      00969 ; *                  When transferring data over multiple transactions,
                      00970 ; *                  it is important to keep track of data source, data
                      00971 ; *                  destination, and data count. These three parameters are
                      00972 ; *                  stored in pSrc,pDst, and wCount. A flag is used to
                      00973 ; *                  note if the data source is from ROM or RAM.
                      00974 ; *
                      00975 ; *******************************************************************/
                      00976 ;void USBCtrlTrfSetupHandler(void)
0002C0                00977 USBCtrlTrfSetupHandler
                      00978 ;{
0002C0 0104           00979         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00980 ;       //if the SIE currently owns the buffer
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 48


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00981 ;    if(pBDTEntryIn[0]->STAT.UOWN != 0)
                      00982 ;    {
                      00983 ;               //give control back to the CPU
                      00984 ;               //  Compensate for after a STALL
                      00985 ;        pBDTEntryIn[0]->STAT.Val = _UCPU;           
                      00986 ;    }
0002C2 0E00           00987         movlw   _UCPU
0002C4 BF04           00988         btfsc   ep0Bi + Stat, UOWN
0002C6 6F04           00989         movwf   ep0Bi + Stat
                      00990 
                      00991 ;       //Keep track of if a short packet has been sent yet or not
                      00992 ;    shortPacketStatus = SHORT_PKT_NOT_USED;
0002C8 0E00           00993         movlw   SHORT_PKT_NOT_USED
0002CA 6F28           00994         movwf   shortPacketStatus
                      00995 
                      00996 ;    /* Stage 1 */
                      00997 ;    controlTransferState = WAIT_SETUP;
0002CC 0E00           00998         movlw   WAIT_SETUP
0002CE 6F23           00999         movwf   controlTransferState
                      01000 
                      01001 ;    inPipes[0].wCount.Val = 0;
0002D0 6B24           01002         clrf    inCount
0002D2 6B25           01003         clrf    inCount + 1
                      01004 ;    inPipes[0].info.Val = 0;
0002D4 6B2C           01005         clrf    info
                      01006 
                      01007 ;    /* Stage 2 */
                      01008 ;    USBCheckStdRequest();
0002D6 D854           01009         rcall   USBCheckStdRequest
                      01010 ;    USBCBCheckOtherReq();   // Required callback, see usbcallbacks.c
0002D8 DB86           01011         rcall   USBCBCheckOtherReq      ; Class request
                      01012 
                      01013 ;    /* Stage 3 */
                      01014 ;    USBCtrlEPServiceComplete();
0002DA D15C           01015         bra     USBCtrlEPServiceComplete
                      01016 
                      01017 ;}//end USBCtrlTrfSetupHandler
                      01018 
                      01019 ;/******************************************************************************
                      01020 ; * Function:        void USBCtrlTrfOutHandler(void)
                      01021 ; *
                      01022 ; * PreCondition:    None
                      01023 ; *
                      01024 ; * Input:           None
                      01025 ; *
                      01026 ; * Output:          None
                      01027 ; *
                      01028 ; * Side Effects:    None
                      01029 ; *
                      01030 ; * Overview:        This routine handles an OUT transaction according to
                      01031 ; *                  which control transfer state is currently active.
                      01032 ; *
                      01033 ; * Note:            Note that if the the control transfer was from
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 49


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01034 ; *                  host to device, the session owner should be notified
                      01035 ; *                  at the end of each OUT transaction to service the
                      01036 ; *                  received data.
                      01037 ; *
                      01038 ; *****************************************************************************/
                      01039 ;void USBCtrlTrfOutHandler(void)
0002DC                01040 USBCtrlTrfOutHandler
                      01041 ;{
0002DC 0104           01042         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01043 ;    if(controlTransferState == CTRL_TRF_RX)
0002DE 0E02           01044         movlw   CTRL_TRF_RX
0002E0 6323           01045         cpfseq  controlTransferState
0002E2 D023           01046         bra     USBPrepareForNextSetupTrf
                      01047 ;    {
                      01048 ;        USBCtrlTrfRxService();
0002E4 D1F5           01049         bra     USBCtrlTrfRxService
                      01050 
                      01051 ;    }
                      01052 ;    else    // CTRL_TRF_TX
                      01053 ;    {
                      01054 ;        USBPrepareForNextSetupTrf();
                      01055 ;    }
                      01056 ;}
                      01057 
                      01058 ;/******************************************************************************
                      01059 ; * Function:        void USBCtrlTrfInHandler(void)
                      01060 ; *
                      01061 ; * PreCondition:    None
                      01062 ; *
                      01063 ; * Input:           None
                      01064 ; *
                      01065 ; * Output:          None
                      01066 ; *
                      01067 ; * Side Effects:    None
                      01068 ; *
                      01069 ; * Overview:        This routine handles an IN transaction according to
                      01070 ; *                  which control transfer state is currently active.
                      01071 ; *
                      01072 ; *
                      01073 ; * Note:            A Set Address Request must not change the acutal address
                      01074 ; *                  of the device until the completion of the control
                      01075 ; *                  transfer. The end of the control transfer for Set Address
                      01076 ; *                  Request is an IN transaction. Therefore it is necessary
                      01077 ; *                  to service this unique situation when the condition is
                      01078 ; *                  right. Macro mUSBCheckAdrPendingState is defined in
                      01079 ; *                  usb9.h and its function is to specifically service this
                      01080 ; *                  event.
                      01081 ; *****************************************************************************/
                      01082 ;void USBCtrlTrfInHandler(void)
0002E6                01083 USBCtrlTrfInHandler
                      01084 ;{
0002E6 0104           01085         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01086 ;    BYTE lastDTS;
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 50


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01087 
                      01088 ;    lastDTS = pBDTEntryIn[0]->STAT.DTS;
0002E8 6B2A           01089         clrf    lastDTS
0002EA BD04           01090         btfsc   ep0Bi + Stat, DTS
0002EC 692A           01091         setf    lastDTS
                      01092 
                      01093 ;    //switch to the next ping pong buffer
                      01094 ;    ((BYTE_VAL*)&pBDTEntryIn[0])->Val ^= USB_NEXT_EP0_IN_PING_PONG;
                      01095 
                      01096 ;    //mUSBCheckAdrPendingState();       // Must check if in ADR_PENDING_STATE
                      01097 ;    if(USBDeviceState == ADR_PENDING_STATE)
0002EE 0E08           01098         movlw   ADR_PENDING_STATE       ; Must check if in ADR_PENDING_STATE
0002F0 631F           01099         cpfseq  USBDeviceState
0002F2 D007           01100         bra     USBCtrlTrfInHandler1
                      01101 ;    {
                      01102 ;        U1ADDR = SetupPkt.bDevADR.Val;
0002F4 5131           01103         movf    SetupPkt + bDevADR, W
                      01104 #if (UADDR < 0xf60)
                      01105         BANKSEL UADDR
                      01106 #endif
0002F6 6E6E           01107         movwf   UADDR
                      01108 ;        if(U1ADDR > 0)
                      01109 ;        {
                      01110 ;            USBDeviceState=ADDRESS_STATE;
                      01111 ;        }
                      01112 ;        else
                      01113 ;        {
                      01114 ;            USBDeviceState=DEFAULT_STATE;
                      01115 ;        }
0002F8 0104           01116         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0002FA 0E10           01117         movlw   ADDRESS_STATE           ; If UADDR > 0
0002FC B4D8           01118         btfsc   STATUS, Z               ; Set from above
0002FE 0E04           01119         movlw   DEFAULT_STATE
000300 6F1F           01120         movwf   USBDeviceState
                      01121 ;    }//end if
                      01122 
                      01123 
000302                01124 USBCtrlTrfInHandler1
                      01125 ;    if(controlTransferState == CTRL_TRF_TX)
000302 0E01           01126         movlw   CTRL_TRF_TX
000304 6323           01127         cpfseq  controlTransferState
000306 D011           01128         bra     USBPrepareForNextSetupTrf
                      01129 ;    {
                      01130 ;        pBDTEntryIn[0]->ADR = (BYTE *)CtrlTrfData;
000308 0E37           01131         movlw   low CtrlTrfData
00030A 6F06           01132         movwf   ep0Bi + ADRL
00030C 0E04           01133         movlw   high CtrlTrfData
00030E 6F07           01134         movwf   ep0Bi + ADRH
                      01135 ;        USBCtrlTrfTxService();
000310 D990           01136         rcall   USBCtrlTrfTxService
                      01137 
                      01138 ;        /* v2b fix */
                      01139 ;        if(shortPacketStatus == SHORT_PKT_SENT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 51


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000312 0104           01140         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
000314 0E02           01141         movlw   SHORT_PKT_SENT
000316 6328           01142         cpfseq  shortPacketStatus
000318 D003           01143         bra     USBCtrlTrfInHandler2
                      01144 ;        {
                      01145 ;            // If a short packet has been sent, don't want to send any more,
                      01146 ;            // stall next time if host is still trying to read.
                      01147 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_BSTALL;
00031A 0E84           01148         movlw   _USIE|_BSTALL           ; If a short packet has been sent, don't want to send any more,
00031C 6F04           01149         movwf   ep0Bi + Stat            ; stall next time if host is still trying to read.
00031E 0012           01150         return
                      01151 ;        }
                      01152 ;        else
000320                01153 USBCtrlTrfInHandler2
                      01154 ;        {
                      01155 ;            if(lastDTS == 0)
                      01156 ;            {
                      01157 ;                pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
                      01158 ;            }
                      01159 ;            else
                      01160 ;            {
                      01161 ;                pBDTEntryIn[0]->STAT.Val = _USIE|_DAT0|_DTSEN;
                      01162 ;            }
000320 0EC8           01163         movlw   _USIE|_DAT1|_DTSEN
000322 672A           01164         tstfsz  lastDTS
000324 0E88           01165         movlw   _USIE|_DAT0|_DTSEN
000326 6F04           01166         movwf   ep0Bi + Stat
000328 0012           01167         return
                      01168 ;        }//end if(...)else
                      01169 ;    }
                      01170 ;    else // CTRL_TRF_RX
                      01171 ;    {
                      01172 ;        USBPrepareForNextSetupTrf();
                      01173 ;    }
                      01174 ;}
                      01175 
                      01176 ;/********************************************************************
                      01177 ; * Function:        void USBPrepareForNextSetupTrf(void)
                      01178 ; *
                      01179 ; * PreCondition:    None
                      01180 ; *
                      01181 ; * Input:           None
                      01182 ; *
                      01183 ; * Output:          None
                      01184 ; *
                      01185 ; * Side Effects:    None
                      01186 ; *
                      01187 ; * Overview:        The routine forces EP0 OUT to be ready for a new
                      01188 ; *                  Setup transaction, and forces EP0 IN to be owned
                      01189 ; *                  by CPU.
                      01190 ; *
                      01191 ; * Note:            None
                      01192 ; *******************************************************************/
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 52


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01193 ;void USBPrepareForNextSetupTrf(void)
00032A                01194 USBPrepareForNextSetupTrf
                      01195 ;{
00032A 0104           01196         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01197 ;    /********************************************************************
                      01198 ;    Bug Fix: Feb 26, 2007 v2.1
                      01199 ;    *********************************************************************
                      01200 ;    Facts:
                      01201 ;    A Setup Packet should never be stalled. (USB 2.0 Section 8.5.3)
                      01202 ;    If a Setup PID is detected by the SIE, the DTSEN setting is ignored.
                      01203 ;    This causes a problem at the end of a control write transaction.
                      01204 ;    In USBCtrlEPServiceComplete(), during a control write (Host to Device),
                      01205 ;    the EP0_OUT is setup to write any data to the CtrlTrfData buffer.
                      01206 ;    If <SETUP[0]><IN[1]> is completed and USBCtrlTrfInHandler() is not
                      01207 ;    called before the next <SETUP[0]> is received, then the latest Setup
                      01208 ;    data will be written to the CtrlTrfData buffer instead of the SetupPkt
                      01209 ;    buffer.
                      01210 ;
                      01211 ;    If USBCtrlTrfInHandler() was called before the latest <SETUP[0]> is
                      01212 ;    received, then there would be no problem,
                      01213 ;    because USBPrepareForNextSetupTrf() would have been called and updated
                      01214 ;    ep0Bo.ADR to point to the SetupPkt buffer.
                      01215 ;
                      01216 ;    Work around:
                      01217 ;    Check for the problem as described above and copy the Setup data from
                      01218 ;    CtrlTrfData to SetupPkt.
                      01219 ;    ********************************************************************/
                      01220 ;    if((controlTransferState == CTRL_TRF_RX) &&
00032C 0E02           01221         movlw   CTRL_TRF_RX
00032E 6323           01222         cpfseq  controlTransferState
000330 D019           01223         bra     USBPrepareForNextSetupTrf1
                      01224 ;       (USBPacketDisable == 1) &&
000332 A86D           01225         btfss   UCON, PKTDIS
000334 D017           01226         bra     USBPrepareForNextSetupTrf1
                      01227 ;       (pBDTEntryEP0OutCurrent->CNT == sizeof(CTRL_TRF_SETUP)) &&
000336 0E08           01228         movlw   USB_EP0_BUFF_SIZE
000338 6301           01229         cpfseq  ep0Bo + Cnt
00033A D014           01230         bra     USBPrepareForNextSetupTrf1
                      01231 ;       (pBDTEntryEP0OutCurrent->STAT.PID == SETUP_TOKEN) &&
00033C 5100           01232         movf    ep0Bo + Stat, W
00033E 0B3C           01233         andlw   0x3c                    ; Mask to PID
000340 0834           01234         sublw   (SETUP_TOKEN) << 2
000342 E110           01235         bnz     USBPrepareForNextSetupTrf1
                      01236 ;       (pBDTEntryEP0OutNext->STAT.UOWN == 0))
000344 BF00           01237         btfsc   ep0Bo + Stat, UOWN
000346 D00E           01238         bra     USBPrepareForNextSetupTrf1
                      01239 ;    {
                      01240 ;        unsigned char setup_cnt;
                      01241 
                      01242 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
000348 0E2F           01243         movlw   low SetupPkt
00034A 6F02           01244         movwf   ep0Bo + ADRL
00034C 0E04           01245         movlw   high SetupPkt
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 53


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00034E 6F03           01246         movwf   ep0Bo + ADRH
                      01247 
                      01248 ;        // The Setup data was written to the CtrlTrfData buffer, must copy
                      01249 ;        // it back to the SetupPkt buffer so that it can be processed correctly
                      01250 ;        // by USBCtrlTrfSetupHandler().
                      01251 ;        for(setup_cnt = 0; setup_cnt < sizeof(CTRL_TRF_SETUP); setup_cnt++)
                      01252 ;        {
                      01253 ;            *(((BYTE*)&SetupPkt)+setup_cnt) = *(((BYTE*)&CtrlTrfData)+setup_cnt);
                      01254 ;        }//end for
000350 EE14 F037      01255         lfsr    1, CtrlTrfData
000354 EE24 F02F      01256         lfsr    2, SetupPkt
000358 0E08           01257         movlw   USB_EP0_BUFF_SIZE
00035A                01258 USBPrepareForNextSetupTrfLoop
00035A CFE6 FFDE      01259         movff   POSTINC1, POSTINC2
00035E 2EE8           01260         decfsz  WREG, F
000360 D7FC           01261         bra     USBPrepareForNextSetupTrfLoop
000362 D00C           01262         bra     USBPrepareForNextSetupTrf2
                      01263 ;    }
                      01264 ;    /* End v3b fix */
                      01265 ;    else
000364                01266 USBPrepareForNextSetupTrf1
                      01267 ;    {
                      01268 ;        controlTransferState = WAIT_SETUP;
000364 0E00           01269         movlw   WAIT_SETUP
000366 6F23           01270         movwf   controlTransferState
                      01271 ;        pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;      // Defined in usb_config.h
000368 0E08           01272         movlw   USB_EP0_BUFF_SIZE
00036A 6F01           01273         movwf   ep0Bo + Cnt
                      01274 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
00036C 0E2F           01275         movlw   low SetupPkt
00036E 6F02           01276         movwf   ep0Bo + ADRL
000370 0E04           01277         movlw   high SetupPkt
000372 6F03           01278         movwf   ep0Bo + ADRH
                      01279 
                      01280 ;        /********************************************************************
                      01281 ;        Bug Fix: Feb 26, 2007 v2.1 (#F1)
                      01282 ;        *********************************************************************
                      01283 ;        In the original firmware, if an OUT token is sent by the host
                      01284 ;        before a SETUP token is sent, the firmware would respond with an ACK.
                      01285 ;        This is not a correct response, the firmware should have sent a STALL.
                      01286 ;        This is a minor non-compliance since a compliant host should not
                      01287 ;        send an OUT before sending a SETUP token. The fix allows a SETUP
                      01288 ;        transaction to be accepted while stalling OUT transactions.
                      01289 ;        ********************************************************************/
                      01290 ;        //ep0Bo.Stat.Val = _USIE|_DAT0|_DTSEN;        // Removed
                      01291 ;        pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;  //Added #F1
000374 0E8C           01292         movlw   _USIE|_DAT0|_DTSEN|_BSTALL
000376 6F00           01293         movwf   ep0Bo + Stat
                      01294 
                      01295 ;        /********************************************************************
                      01296 ;        Bug Fix: Feb 26, 2007 v2.1 (#F3)
                      01297 ;        *********************************************************************
                      01298 ;        In the original firmware, if an IN token is sent by the host
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 54


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01299 ;        before a SETUP token is sent, the firmware would respond with an ACK.
                      01300 ;        This is not a correct response, the firmware should have sent a STALL.
                      01301 ;        This is a minor non-compliance since a compliant host should not
                      01302 ;        send an IN before sending a SETUP token.
                      01303 
                      01304 ;        Comment why this fix (#F3) is interfering with fix (#AF1).
                      01305 ;        ********************************************************************/
                      01306 ;        pBDTEntryIn[0]->STAT.Val = _UCPU;             // Should be removed
                      01307 
                      01308 ;        {
                      01309 ;            BDT_ENTRY* p;
                      01310 
                      01311 ;            p = (BDT_ENTRY*)(((unsigned int)pBDTEntryIn[0])^USB_NEXT_EP0_IN_PING_PONG);
                      01312 ;            p->STAT.Val = _UCPU;
000378 0E00           01313         movlw   _UCPU                   ; EP0 IN buffer initialization
00037A 6F04           01314         movwf   ep0Bi + Stat
                      01315 ;        }
                      01316 
                      01317 ;        //ep0Bi.Stat.Val = _USIE|_BSTALL;   // Should be added #F3
                      01318 ;    }
                      01319 
00037C                01320 USBPrepareForNextSetupTrf2
                      01321 ;    //if someone is still expecting data from the control transfer
                      01322 ;    //  then make sure to terminate that request and let them know that
                      01323 ;    //  they are done
                      01324 ;    if(outPipes[0].info.bits.busy == 1)
                      01325 ;    {
                      01326 ;        if(outPipes[0].pFunc != NULL)
                      01327 ;        {
                      01328 ;            outPipes[0].pFunc();
                      01329 ;        }
                      01330 ;        outPipes[0].info.bits.busy = 0;
00037C 9F2D           01331         bcf     outfo, busy
                      01332 ;    }
00037E 0012           01333         return
                      01334 
                      01335 ;}//end USBPrepareForNextSetupTrf
                      01336 
                      01337 ;/********************************************************************
                      01338 ; * Function:        void USBCheckStdRequest(void)
                      01339 ; *
                      01340 ; * PreCondition:    None
                      01341 ; *
                      01342 ; * Input:           None
                      01343 ; *
                      01344 ; * Output:          None
                      01345 ; *
                      01346 ; * Side Effects:    None
                      01347 ; *
                      01348 ; * Overview:        This routine checks the setup data packet to see
                      01349 ; *                  if it knows how to handle it
                      01350 ; *
                      01351 ; * Note:            None
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 55


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01352 ; *******************************************************************/
                      01353 ;void USBCheckStdRequest(void)
000380                01354 USBCheckStdRequest
                      01355 ;{
000380 0104           01356         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01357 ;    if(SetupPkt.RequestType != STANDARD) return;
000382 512F           01358         movf    SetupPkt, W             ; RequestType = STANDARD?
000384 0B60           01359         andlw   0x60                    ; Mask to proper bits
000386 0800           01360         sublw   (STANDARD) << 5
000388 E106           01361         bnz     USBCheckStdRequestExit  ; No
                      01362 
                      01363 ;    switch(SetupPkt.bRequest)
                      01364 ;    {
                      01365 ;        case SET_ADR:
00038A 0E05           01366         movlw   SET_ADR                 ; Handle request
00038C 6330           01367         cpfseq  SetupPkt + bRequest
00038E D004           01368         bra     USBCheckStdRequest1
                      01369 ;            inPipes[0].info.bits.busy = 1;            // This will generate a zero length packet
000390 8F2C           01370         bsf     info, busy
                      01371 ;            USBDeviceState = ADR_PENDING_STATE;       // Update state only
000392 0E08           01372         movlw   ADR_PENDING_STATE       ; Update state only
000394 6F1F           01373         movwf   USBDeviceState
                      01374 ;            /* See USBCtrlTrfInHandler() for the next step */
                      01375 ;            break;
000396                01376 USBCheckStdRequestExit
000396 0012           01377         return
000398                01378 USBCheckStdRequest1
                      01379 ;        case GET_DSC:
000398 0E06           01380         movlw   GET_DSC
00039A 5D30           01381         subwf   SetupPkt + bRequest, W
00039C E06E           01382         bz      USBStdGetDscHandler
                      01383 ;       cpfseq  SetupPkt + bRequest
                      01384 ;       bra     USBCheckStdRequest2
                      01385 ;            USBStdGetDscHandler();
                      01386 ;       bra     USBStdGetDscHandler
                      01387 ;            break;
                      01388 ;USBCheckStdRequest2
                      01389 ;        case SET_CFG:
00039E 0E09           01390         movlw   SET_CFG
0003A0 6330           01391         cpfseq  SetupPkt + bRequest
0003A2 D001           01392         bra     USBCheckStdRequest3
                      01393 ;            USBStdSetCfgHandler();
0003A4 D1C3           01394         bra     USBStdSetCfgHandler
                      01395 ;            break;
0003A6                01396 USBCheckStdRequest3
                      01397 ;        case GET_CFG:
0003A6 0E08           01398         movlw   GET_CFG
0003A8 6330           01399         cpfseq  SetupPkt + bRequest
0003AA D00C           01400         bra     USBCheckStdRequest4
                      01401 ;            inPipes[0].pSrc.bRam = (BYTE*)&USBActiveConfiguration;         // Set Source
                      01402         mSetSourcePointer USBActiveConfiguration
0003AC 0E20               M         movlw   low (USBActiveConfiguration)
0003AE 6F1A               M         movwf   pSrc
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 56


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003B0 0E04               M         movlw   high (USBActiveConfiguration)
0003B2 6F1B               M         movwf   pSrc + 1
0003B4 0E00               M         movlw   upper (USBActiveConfiguration)
0003B6 6F1C               M         movwf   pSrc + 2
                      01403 ;            inPipes[0].info.bits.ctrl_trf_mem = _RAM;               // Set memory type
0003B8 812C           01404         bsf     info, ctrl_trf_mem      ; Indicate RAM
                      01405 ;            inPipes[0].wCount.v[0] = 1;                         // Set data count
0003BA 0E01           01406         movlw   1
0003BC 6F24           01407         movwf   inCount
0003BE 6B25           01408         clrf    inCount + 1
                      01409 ;            inPipes[0].info.bits.busy = 1;
0003C0 8F2C           01410         bsf     info, busy
                      01411 ;            break;
0003C2 0012           01412         return
0003C4                01413 USBCheckStdRequest4
                      01414 ;        case GET_STATUS:
0003C4 0E00           01415         movlw   GET_STATUS
0003C6 6330           01416         cpfseq  SetupPkt + bRequest
0003C8 D001           01417         bra     USBCheckStdRequest5
                      01418 ;            USBStdGetStatusHandler();
0003CA D0BC           01419         bra     USBStdGetStatusHandler
                      01420 ;            break;
0003CC                01421 USBCheckStdRequest5
                      01422 ;        case CLR_FEATURE:
0003CC 0E01           01423         movlw   CLR_FEATURE
0003CE 5D30           01424         subwf   SetupPkt + bRequest, W
0003D0 E022           01425         bz      USBStdFeatureReqHandler
                      01426 ;       cpfseq  SetupPkt + bRequest
                      01427 ;       bra     USBCheckStdRequest6
                      01428 ;       bra     USBStdFeatureReqHandler
                      01429 ;USBCheckStdRequest6
                      01430 ;        case SET_FEATURE:
0003D2 0E03           01431         movlw   SET_FEATURE
0003D4 5D30           01432         subwf   SetupPkt + bRequest, W
0003D6 E01F           01433         bz      USBStdFeatureReqHandler
                      01434 ;       cpfseq  SetupPkt + bRequest
                      01435 ;       bra     USBCheckStdRequest7
                      01436 ;            USBStdFeatureReqHandler();
                      01437 ;       bra     USBStdFeatureReqHandler
                      01438 ;            break;
                      01439 ;USBCheckStdRequest7
                      01440 ;        case GET_INTF:
0003D8 0E0A           01441         movlw   GET_INTF
0003DA 6330           01442         cpfseq  SetupPkt + bRequest
0003DC D00E           01443         bra     USBCheckStdRequest8
                      01444 ;            inPipes[0].pSrc.bRam = (BYTE*)&USBAlternateInterface+SetupPkt.bIntfID;  // Set source
                      01445         mSetSourcePointer USBAlternateInterface
0003DE 0E21               M         movlw   low (USBAlternateInterface)
0003E0 6F1A               M         movwf   pSrc
0003E2 0E04               M         movlw   high (USBAlternateInterface)
0003E4 6F1B               M         movwf   pSrc + 1
0003E6 0E00               M         movlw   upper (USBAlternateInterface)
0003E8 6F1C               M         movwf   pSrc + 2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 57


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0003EA 5133           01446         movf    SetupPkt + bIntfID, W
0003EC 271A           01447         addwf   pSrc, F
                      01448 ;            inPipes[0].info.bits.ctrl_trf_mem = _RAM;               // Set memory type
0003EE 812C           01449         bsf     info, ctrl_trf_mem      ; Indicate RAM
                      01450 ;            inPipes[0].wCount.v[0] = 1;                         // Set data count
0003F0 0E01           01451         movlw   1
0003F2 6F24           01452         movwf   inCount
0003F4 6B25           01453         clrf    inCount + 1
                      01454 ;            inPipes[0].info.bits.busy = 1;
0003F6 8F2C           01455         bsf     info, busy
                      01456 ;            break;
0003F8 0012           01457         return
0003FA                01458 USBCheckStdRequest8
                      01459 ;        case SET_INTF:
0003FA 0E0B           01460         movlw   SET_INTF
0003FC 6330           01461         cpfseq  SetupPkt + bRequest
0003FE D007           01462         bra     USBCheckStdRequest9
                      01463 ;            inPipes[0].info.bits.busy = 1;
000400 8F2C           01464         bsf     info, busy
                      01465 ;            USBAlternateInterface[SetupPkt.bIntfID] = SetupPkt.bAltID;
000402 EE24 F021      01466         lfsr    2, USBAlternateInterface
000406 5133           01467         movf    SetupPkt + bIntfID, W
000408 C431 FFDB      01468         movff   SetupPkt + bAltID, PLUSW2
                      01469 ;            break;
00040C 0012           01470         return
00040E                01471 USBCheckStdRequest9
                      01472 ;        case SET_DSC:
00040E 0E07           01473         movlw   SET_DSC
000410 6330           01474         cpfseq  SetupPkt + bRequest
000412 0012           01475         return
                      01476 ;            USBCBStdSetDscHandler();
000414 D2E9           01477         bra     USBCBStdSetDscHandler
                      01478 ;            break;
                      01479 ;        case SYNCH_FRAME:
                      01480 ;        default:
                      01481 ;            break;
                      01482 ;    }//end switch
                      01483 ;}//end USBCheckStdRequest
                      01484 
                      01485 ;/********************************************************************
                      01486 ; * Function:        void USBStdFeatureReqHandler(void)
                      01487 ; *
                      01488 ; * PreCondition:    None
                      01489 ; *
                      01490 ; * Input:           None
                      01491 ; *
                      01492 ; * Output:          None
                      01493 ; *
                      01494 ; * Side Effects:    None
                      01495 ; *
                      01496 ; * Overview:        This routine handles the standard SET & CLEAR
                      01497 ; *                  FEATURES requests
                      01498 ; *
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 58


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01499 ; * Note:            None
                      01500 ; *******************************************************************/
                      01501 ;void USBStdFeatureReqHandler(void)
000416                01502 USBStdFeatureReqHandler
                      01503 ;{
000416 0104           01504         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01505 ;    BDT_ENTRY *p;
                      01506 ;    unsigned int* pUEP;             
                      01507 
                      01508 ;    if((SetupPkt.bFeature == DEVICE_REMOTE_WAKEUP)&&
000418 0E01           01509         movlw   DEVICE_REMOTE_WAKEUP    ; If Feature = DEVICE_REMOTE_WAKEUP &
00041A 6331           01510         cpfseq  SetupPkt + bFeature
00041C D009           01511         bra     USBStdFeatureReqHandler1
                      01512 ;       (SetupPkt.Recipient == RCPT_DEV))
00041E 512F           01513         movf    SetupPkt, W             ; Recipient = RCPT_DEV?
000420 0B1F           01514         andlw   0x1f                    ; Mask to lower 5 bits
000422 0800           01515         sublw   RCPT_DEV
000424 E105           01516         bnz     USBStdFeatureReqHandler1        ; No
                      01517 ;    {
                      01518 ;        inPipes[0].info.bits.busy = 1;
000426 8F2C           01519         bsf     info, busy
                      01520 ;        if(SetupPkt.bRequest == SET_FEATURE)
                      01521 ;            RemoteWakeup = TRUE;
                      01522 ;        else
                      01523 ;            RemoteWakeup = FALSE;
000428 692E           01524         setf    RemoteWakeup            ; Preset RemoteWakeup to 1
00042A 0E03           01525         movlw   SET_FEATURE             ; Request = SET_FEATURE?
00042C 6330           01526         cpfseq  SetupPkt + bRequest
00042E 6B2E           01527         clrf    RemoteWakeup            ; No, RemoteWakeup = 0
                      01528 ;    }//end if
                      01529 
000430                01530 USBStdFeatureReqHandler1
                      01531 ;    if((SetupPkt.bFeature == ENDPOINT_HALT)&&
000430 0E00           01532         movlw   ENDPOINT_HALT           ; If Feature = ENDPOINT_HALT &
000432 6331           01533         cpfseq  SetupPkt + bFeature
000434                01534 USBStdFeatureReqHandlerExit
000434 0012           01535         return
                      01536 ;       (SetupPkt.Recipient == RCPT_EP)&&
000436 512F           01537         movf    SetupPkt, W             ; Recepient = RCPT_EP &
000438 0B1F           01538         andlw   0x1f                    ; Mask to lower 5 bits
00043A 0802           01539         sublw   RCPT_EP
00043C E1FB           01540         bnz     USBStdFeatureReqHandlerExit
                      01541 ;       (SetupPkt.EPNum != 0))
00043E 5133           01542         movf    SetupPkt + bEPID, W     ; EPNum != 0
000440 0B0F           01543         andlw   0x0f                    ; Mask to EPNum
000442 E0F8           01544         bz      USBStdFeatureReqHandlerExit
                      01545 ;    {
                      01546 ;        BYTE i;
                      01547 
                      01548 ;        inPipes[0].info.bits.busy = 1;
000444 8F2C           01549         bsf     info, busy
                      01550 ;        /* Must do address calculation here */
                      01551 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 59


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01552 ;               //loop for each of the possible ping-pong buffers
                      01553 ;        for(i=0; i<2; i++)
                      01554 ;        {
                      01555 ;                       //point to the first EP0 OUT ping pong buffer
                      01556 ;            p = (BDT_ENTRY*)&BDT[EP0_OUT_EVEN];
                      01557 
                      01558 ;                       //jump from this endpoint to the requested endpoint
                      01559 ;            p += EP(SetupPkt.EPNum,SetupPkt.EPDir,i);
000446 D811           01560         rcall   USBCalcEPAddress        ; Put endpoint buffer address in FSR2
                      01561 
                      01562 ;                       //if it was a SET_FEATURE request
                      01563 ;            if(SetupPkt.bRequest == SET_FEATURE)
000448 0E03           01564         movlw   SET_FEATURE             ; Request = SET_FEATURE?
00044A 6330           01565         cpfseq  SetupPkt + bRequest
00044C D003           01566         bra     USBStdFeatureReqHandler2        ; No
                      01567 ;            {
                      01568 ;                               //Then STALL the endpoint
                      01569 ;                p->STAT.Val = _USIE|_BSTALL;
00044E 0E84           01570         movlw   _USIE|_BSTALL
000450 6EDF           01571         movwf   INDF2                   ; Put in endpoint buffer
000452 0012           01572         return
                      01573 ;            }
                      01574 ;            else
000454                01575 USBStdFeatureReqHandler2
                      01576 ;            {
                      01577 ;                               //If it was not a SET_FEATURE
                      01578 ;                               //point to the appropriate UEP register
                      01579 ;                pUEP = (unsigned int*)(&U1EP0+SetupPkt.EPNum);
                      01580 ; Point FSR1 to endpoint table
000454 EE1F F070      01581         lfsr    1, UEP0                 ; FSR2 = beginning of endpoint table
000458 5133           01582         movf    SetupPkt + bEPID, W     ; Add in endpoint number
00045A 26E1           01583         addwf   FSR1L, F
                      01584 
                      01585 ;                               //Clear the STALL bit in the UEP register
                      01586 ;                *pUEP &= ~UEP_STALL;
00045C 0EFE           01587         movlw   ~UEP_STALL
00045E 16E7           01588         andwf   INDF1, F
                      01589 
                      01590 ;                if(SetupPkt.EPDir == 1) // IN
                      01591 ;                {
                      01592 ;                                       //If the endpoint is an IN endpoint then we
                      01593 ;                                       //  need to return it to the CPU and reset the
                      01594 ;                                       //  DTS bit so that the next transfer is correct
                      01595 ;                    p->STAT.Val = _UCPU|_DAT1;
                      01596 ;                }
                      01597 ;                else
                      01598 ;                {
                      01599 ;                                       //If the endpoint was an OUT endpoint then we
                      01600 ;                                       //  need to give control of the endpoint back to
                      01601 ;                                       //  the SIE so that the function driver can
                      01602 ;                                       //  receive the data as they expected.  Also need
                      01603 ;                                       //  to set the DTS bit so the next packet will be
                      01604 ;                                       //  correct
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 60


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01605 ;                    p->STAT.Val = _USIE|_DAT1|_DTSEN;
                      01606 ;                }
000460 0E40           01607         movlw   _UCPU|_DAT1             ; IN
000462 AF33           01608         btfss   SetupPkt + bEPID, EPDir ; EPDir = 1 (IN)?
000464 0EC8           01609         movlw   _USIE|_DAT1|_DTSEN      ; No - OUT
000466 6EDF           01610         movwf   INDF2                   ; Put in endpoint buffer
000468 0012           01611         return
                      01612 ;            }//end if
                      01613 ;        }
                      01614 
                      01615 ;    }//end if
                      01616 ;}//end USBStdFeatureReqHandler
                      01617 
                      01618 ; Put endpoint buffer address in FSR2 (ep0Bo+(EPNum*8)+(EPDir*4))
00046A                01619 USBCalcEPAddress
00046A EE24 F000      01620         lfsr    2, ep0Bo                ; Point FSR2 to beginning of buffer area
00046E 4533           01621         rlncf   SetupPkt + bEPID, W     ; Move endpoint direction to C
000470 3533           01622         rlcf    SetupPkt + bEPID, W     ; Endpoint number * 8 (roll in ep direction)
000472 46E8           01623         rlncf   WREG, F
000474 46E8           01624         rlncf   WREG, F
000476 26D9           01625         addwf   FSR2L, F                ; Add to FSR2 (can't overflow to FSR2H)
000478 0012           01626         return
                      01627 
                      01628 ;/********************************************************************
                      01629 ; * Function:        void USBStdGetDscHandler(void)
                      01630 ; *
                      01631 ; * PreCondition:    None
                      01632 ; *
                      01633 ; * Input:           None
                      01634 ; *
                      01635 ; * Output:          None
                      01636 ; *
                      01637 ; * Side Effects:    None
                      01638 ; *
                      01639 ; * Overview:        This routine handles the standard GET_DESCRIPTOR
                      01640 ; *                  request.
                      01641 ; *
                      01642 ; * Note:            None
                      01643 ; *******************************************************************/
                      01644 ;void USBStdGetDscHandler(void)
00047A                01645 USBStdGetDscHandler
                      01646 ;{
00047A 0104           01647         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01648 ;    if(SetupPkt.bmRequestType == 0x80)
00047C 0E80           01649         movlw   0x80
00047E 632F           01650         cpfseq  SetupPkt + bmRequestType
000480 0012           01651         return
                      01652 ;    {
                      01653 ;        inPipes[0].info.Val = USB_INPIPES_ROM | USB_INPIPES_BUSY | USB_INPIPES_INCLUDE_ZERO;
000482 0EC0           01654         movlw   USB_INPIPES_ROM | USB_INPIPES_BUSY | USB_INPIPES_INCLUDE_ZERO
000484 6F2C           01655         movwf   info
                      01656 
                      01657 ;        switch(SetupPkt.bDescriptorType)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 61


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01658 ;        {
                      01659 ;            case USB_DESCRIPTOR_DEVICE:
000486 0E01           01660         movlw   USB_DESCRIPTOR_DEVICE
000488 6332           01661         cpfseq  SetupPkt + bDescriptorType
00048A D011           01662         bra     USBStdGetDscHandler1
                      01663 ;                #if !defined(USB_USER_DEVICE_DESCRIPTOR)
                      01664 ;                    inPipes[0].pSrc.bRom = (ROM BYTE*)&device_dsc;
                      01665 ;                #else
                      01666 ;                    inPipes[0].pSrc.bRom = (ROM BYTE*)USB_USER_DEVICE_DESCRIPTOR;
                      01667 ;                #endif
                      01668         mSetSourcePointer DeviceDescriptor
00048C 0E48               M         movlw   low (DeviceDescriptor)
00048E 6F1A               M         movwf   pSrc
000490 0E0A               M         movlw   high (DeviceDescriptor)
000492 6F1B               M         movwf   pSrc + 1
000494 0E00               M         movlw   upper (DeviceDescriptor)
000496 6F1C               M         movwf   pSrc + 2
                      01669 ;                inPipes[0].wCount.Val = sizeof(device_dsc);
                      01670         mGetRomTableCount               ; Set wCount
000498 C41A FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
00049C C41B FFF7          M         movff   pSrc + 1, TBLPTRH
0004A0 C41C FFF8          M         movff   pSrc + 2, TBLPTRU
0004A4 0008               M         tblrd   *                       ; Read count
0004A6 CFF5 F424          M         movff   TABLAT, inCount
0004AA 6B25               M         clrf    inCount + 1
0004AC 0012           01671         return
                      01672 ;                break;
0004AE                01673 USBStdGetDscHandler1
                      01674 ;            case USB_DESCRIPTOR_CONFIGURATION:
0004AE 0E02           01675         movlw   USB_DESCRIPTOR_CONFIGURATION
0004B0 6332           01676         cpfseq  SetupPkt + bDescriptorType
0004B2 D025           01677         bra     USBStdGetDscHandler2
                      01678 ;                #if !defined(USB_USER_CONFIG_DESCRIPTOR)
                      01679 ;                    inPipes[0].pSrc.bRom = *(USB_CD_Ptr+SetupPkt.bDscIndex);
                      01680 ;                #else
                      01681 ;                    inPipes[0].pSrc.bRom = *(USB_USER_CONFIG_DESCRIPTOR+SetupPkt.bDscIndex);
                      01682 ;                #endif
                      01683 ;       mSetSourcePointer Config1
0004B4 6AF8           01684         clrf    TBLPTRU
0004B6 6AF7           01685         clrf    TBLPTRH
0004B8 4531           01686         rlncf   SetupPkt + bDscIndex, W ; Index * 4
0004BA 46E8           01687         rlncf   WREG, F
0004BC 0F6C           01688         addlw   low (USB_CD_Ptr)        ; Add element offset to low address
0004BE 6EF6           01689         movwf   TBLPTRL
0004C0 0E0A           01690         movlw   high (USB_CD_Ptr)
0004C2 22F7           01691         addwfc  TBLPTRH, F
0004C4 0E00           01692         movlw   upper (USB_CD_Ptr)
0004C6 22F8           01693         addwfc  TBLPTRU, F
0004C8 0009           01694         tblrd   *+                      ; Get the data to TABLAT and move pointer forward
0004CA CFF5 F41A      01695         movff   TABLAT, pSrc            ; Get low source address
0004CE 0009           01696         tblrd   *+
0004D0 CFF5 F41B      01697         movff   TABLAT, pSrc + 1        ; Get high source address
0004D4 0008           01698         tblrd   *
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 62


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0004D6 CFF5 F41C      01699         movff   TABLAT, pSrc + 2        ; Get upper source address
                      01700 ;                inPipes[0].wCount.Val = *(inPipes[0].pSrc.wRom+1);                // Set data count
0004DA C41A FFF6      01701         movff   pSrc, TBLPTRL           ; Set wCount to total length
0004DE C41B FFF7      01702         movff   pSrc + 1, TBLPTRH
0004E2 C41C FFF8      01703         movff   pSrc + 2, TBLPTRU
0004E6 0009           01704         tblrd   *+                      ; Skip 4 locations
0004E8 0009           01705         tblrd   *+
0004EA 0009           01706         tblrd   *+
0004EC 0009           01707         tblrd   *+
0004EE 0009           01708         tblrd   *+                      ; Read count low
0004F0 CFF5 F424      01709         movff   TABLAT, inCount
0004F4 0009           01710         tblrd   *+                      ; Ignore RETLW opcode
0004F6 0009           01711         tblrd   *+                      ; Read count high
0004F8 CFF5 F425      01712         movff   TABLAT, inCount + 1
0004FC 0012           01713         return
                      01714 ;               break;
0004FE                01715 USBStdGetDscHandler2
                      01716 ;            case USB_DESCRIPTOR_STRING:
0004FE 0E03           01717         movlw   USB_DESCRIPTOR_STRING
000500 6332           01718         cpfseq  SetupPkt + bDescriptorType
000502 D01E           01719         bra     USBStdGetDscHandler3
                      01720 ;                inPipes[0].pSrc.bRom = *(USB_SD_Ptr+SetupPkt.bDscIndex);
000504 6AF8           01721         clrf    TBLPTRU
000506 6AF7           01722         clrf    TBLPTRH
000508 4531           01723         rlncf   SetupPkt + bDscIndex, W ; Index * 4
00050A 46E8           01724         rlncf   WREG, F
00050C 0F58           01725         addlw   low (USB_SD_Ptr)        ; Add element offset to low address
00050E 6EF6           01726         movwf   TBLPTRL
000510 0E0D           01727         movlw   high (USB_SD_Ptr)
000512 22F7           01728         addwfc  TBLPTRH, F
000514 0E00           01729         movlw   upper (USB_SD_Ptr)
000516 22F8           01730         addwfc  TBLPTRU, F
000518 0009           01731         tblrd   *+                      ; Get the data to TABLAT and move pointer forward
00051A CFF5 F41A      01732         movff   TABLAT, pSrc            ; Get low source address
00051E 0009           01733         tblrd   *+
000520 CFF5 F41B      01734         movff   TABLAT, pSrc + 1        ; Get high source address
000524 0008           01735         tblrd   *
000526 CFF5 F41C      01736         movff   TABLAT, pSrc + 2        ; Get upper source address
                      01737 ;                inPipes[0].wCount.Val = *inPipes[0].pSrc.bRom;                    // Set data count
                      01738         mGetRomTableCount               ; Set wCount
00052A C41A FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
00052E C41B FFF7          M         movff   pSrc + 1, TBLPTRH
000532 C41C FFF8          M         movff   pSrc + 2, TBLPTRU
000536 0008               M         tblrd   *                       ; Read count
000538 CFF5 F424          M         movff   TABLAT, inCount
00053C 6B25               M         clrf    inCount + 1
00053E 0012           01739         return
                      01740 ;                break;
000540                01741 USBStdGetDscHandler3
                      01742 ;            default:
                      01743 ;                inPipes[0].info.Val = 0;
000540 6B2C           01744         clrf    info
000542 0012           01745         return
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 63


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01746 ;                break;
                      01747 ;        }//end switch
                      01748 ;    }//end if
                      01749 ;}//end USBStdGetDscHandler
                      01750 
                      01751 ;/********************************************************************
                      01752 ; * Function:        void USBStdGetStatusHandler(void)
                      01753 ; *
                      01754 ; * PreCondition:    None
                      01755 ; *
                      01756 ; * Input:           None
                      01757 ; *
                      01758 ; * Output:          None
                      01759 ; *
                      01760 ; * Side Effects:    None
                      01761 ; *
                      01762 ; * Overview:        This routine handles the standard GET_STATUS request
                      01763 ; *
                      01764 ; * Note:            None
                      01765 ; *******************************************************************/
                      01766 ;void USBStdGetStatusHandler(void)
000544                01767 USBStdGetStatusHandler
                      01768 ;{
000544 0104           01769         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01770 ;    CtrlTrfData[0] = 0;                 // Initialize content
000546 6B37           01771         clrf    CtrlTrfData             ; Initialize content
                      01772 ;    CtrlTrfData[1] = 0;
000548 6B38           01773         clrf    CtrlTrfData + 1
                      01774 
                      01775 ;    switch(SetupPkt.Recipient)
                      01776 ;    {
                      01777 ;        case RCPT_DEV:
00054A 512F           01778         movf    SetupPkt, W             ; Recipient = RCPT_DEV?
00054C 0B1F           01779         andlw   0x1f                    ; Mask to lower 5 bits
00054E 0800           01780         sublw   RCPT_DEV
000550 E104           01781         bnz     USBStdGetStatusHandler1 ; No
                      01782 ;            inPipes[0].info.bits.busy = 1;
000552 8F2C           01783         bsf     info, busy
                      01784 ;            /*
                      01785 ;             * [0]: bit0: Self-Powered Status [0] Bus-Powered [1] Self-Powered
                      01786 ;             *      bit1: RemoteWakeup        [0] Disabled    [1] Enabled
                      01787 ;             */
                      01788 ;            if(self_power == 1) // self_power is defined in HardwareProfile.h
                      01789 #ifdef USB_SELF_POWER
                      01790             {
                      01791 ;                CtrlTrfData[0]|=0x01;
                      01792         bsf     CtrlTrfData, 0
                      01793             }
                      01794 #endif
                      01795 
                      01796 ;            if(RemoteWakeup == TRUE)
                      01797 ;            {
                      01798 ;                CtrlTrfData[0]|=0x02;
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 64


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01799 ;            }
000554 672E           01800         tstfsz  RemoteWakeup
000556 8337           01801         bsf     CtrlTrfData, 1
000558 D010           01802         bra     USBStdGetStatusHandlerExit
                      01803 ;            break;
00055A                01804 USBStdGetStatusHandler1
                      01805 ;        case RCPT_INTF:
00055A 512F           01806         movf    SetupPkt, W             ; Recipient = RCPT_INTF?
00055C 0B1F           01807         andlw   0x1f                    ; Mask to lower 5 bits
00055E 0801           01808         sublw   RCPT_INTF
000560 E102           01809         bnz     USBStdGetStatusHandler2 ; No
                      01810 ;            inPipes[0].info.bits.busy = 1;     // No data to update
000562 8F2C           01811         bsf     info, busy
000564 D00A           01812         bra     USBStdGetStatusHandlerExit
                      01813 ;            break;
000566                01814 USBStdGetStatusHandler2
                      01815 ;        case RCPT_EP:
000566 512F           01816         movf    SetupPkt, W             ; Recipient = RCPT_EP?
000568 0B1F           01817         andlw   0x1f                    ; Mask to lower 5 bits
00056A 0802           01818         sublw   RCPT_EP
00056C E106           01819         bnz     USBStdGetStatusHandlerExit      ; No
                      01820 ;            inPipes[0].info.bits.busy = 1;
00056E 8F2C           01821         bsf     info, busy
                      01822 ;            /*
                      01823 ;             * [0]: bit0: Halt Status [0] Not Halted [1] Halted
                      01824 ;             */
                      01825 ;            {
                      01826 ;                BDT_ENTRY *p;
                      01827 ;                p = (BDT_ENTRY*)&BDT[EP0_OUT_EVEN];
                      01828 ;                p += EP(SetupPkt.EPNum,SetupPkt.EPDir,0);
000570 DF7C           01829         rcall   USBCalcEPAddress        ; Put endpoint buffer address in FSR2
                      01830     
                      01831 ;                if(p->STAT.Val & _BSTALL)    // Use _BSTALL as a bit mask
000572 50DF           01832         movf    INDF2, W
000574 0B04           01833         andlw   _BSTALL
000576 E001           01834         bz      USBStdGetStatusHandlerExit
                      01835 ;                    CtrlTrfData[0]=0x01;    // Set bit0
                      01836 ;       movlw   0x01
                      01837 ;       movwf   CtrlTrfData
000578 8137           01838         bsf     CtrlTrfData, 0
                      01839 ;                break;
                      01840 ;            }
                      01841 ;    }//end switch
                      01842 
00057A                01843 USBStdGetStatusHandlerExit
                      01844 ;    if(inPipes[0].info.bits.busy == 1)
00057A AF2C           01845         btfss   info, busy
00057C 0012           01846         return
                      01847 ;    {
                      01848 ;        inPipes[0].pSrc.bRam = (BYTE*)&CtrlTrfData;            // Set Source
                      01849         mSetSourcePointer CtrlTrfData
00057E 0E37               M         movlw   low (CtrlTrfData)
000580 6F1A               M         movwf   pSrc
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 65


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000582 0E04               M         movlw   high (CtrlTrfData)
000584 6F1B               M         movwf   pSrc + 1
000586 0E00               M         movlw   upper (CtrlTrfData)
000588 6F1C               M         movwf   pSrc + 2
                      01850 ;        inPipes[0].info.bits.ctrl_trf_mem = _RAM;               // Set memory type
00058A 812C           01851         bsf     info, ctrl_trf_mem      ; Indicate RAM
                      01852 ;        inPipes[0].wCount.v[0] = 2;                         // Set data count
00058C 0E02           01853         movlw   2                       ; Set count
00058E 6F24           01854         movwf   inCount
000590 6B25           01855         clrf    inCount + 1
000592 0012           01856         return
                      01857 ;    }//end if(...)
                      01858 ;}//end USBStdGetStatusHandler
                      01859 
                      01860 ;/******************************************************************************
                      01861 ; * Function:        void USBCtrlEPServiceComplete(void)
                      01862 ; *
                      01863 ; * PreCondition:    None
                      01864 ; *
                      01865 ; * Input:           None
                      01866 ; *
                      01867 ; * Output:          None
                      01868 ; *
                      01869 ; * Side Effects:    None
                      01870 ; *
                      01871 ; * Overview:        This routine wrap up the ramaining tasks in servicing
                      01872 ; *                  a Setup Request. Its main task is to set the endpoint
                      01873 ; *                  controls appropriately for a given situation. See code
                      01874 ; *                  below.
                      01875 ; *                  There are three main scenarios:
                      01876 ; *                  a) There was no handler for the Request, in this case
                      01877 ; *                     a STALL should be sent out.
                      01878 ; *                  b) The host has requested a read control transfer,
                      01879 ; *                     endpoints are required to be setup in a specific way.
                      01880 ; *                  c) The host has requested a write control transfer, or
                      01881 ; *                     a control data stage is not required, endpoints are
                      01882 ; *                     required to be setup in a specific way.
                      01883 ; *
                      01884 ; *                  Packet processing is resumed by clearing PKTDIS bit.
                      01885 ; *
                      01886 ; * Note:            None
                      01887 ; *****************************************************************************/
                      01888 ;void USBCtrlEPServiceComplete(void)
000594                01889 USBCtrlEPServiceComplete
                      01890 ;{
000594 0104           01891         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      01892 ;    /*
                      01893 ;     * PKTDIS bit is set when a Setup Transaction is received.
                      01894 ;     * Clear to resume packet processing.
                      01895 ;     */
                      01896 ;    USBPacketDisable = 0;
000596 986D           01897         bcf     UCON, PKTDIS
                      01898 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 66


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01899 ;    if(inPipes[0].info.bits.busy == 0)
000598 BF2C           01900         btfsc   info, busy
00059A D01B           01901         bra     USBCtrlEPServiceComplete1
                      01902 ;    {
                      01903 ;        if(outPipes[0].info.bits.busy == 1)
00059C AF2D           01904         btfss   outfo, busy
00059E D00E           01905         bra     USBCtrlEPServiceComplete0
                      01906 ;        {
                      01907 ;            controlTransferState = CTRL_TRF_RX;
0005A0 0E02           01908         movlw   CTRL_TRF_RX
0005A2 6F23           01909         movwf   controlTransferState
                      01910 ;            /*
                      01911 ;             * Control Write:
                      01912 ;             * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>
                      01913 ;             *
                      01914 ;             * 1. Prepare IN EP to respond to early termination
                      01915 ;             *
                      01916 ;             *    This is the same as a Zero Length Packet Response
                      01917 ;             *    for control transfer without a data stage
                      01918 ;             */
                      01919 ;            pBDTEntryIn[0]->CNT = 0;
0005A4 6B05           01920         clrf    ep0Bi + Cnt
                      01921 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
0005A6 0EC8           01922         movlw   _USIE|_DAT1|_DTSEN
0005A8 6F04           01923         movwf   ep0Bi + Stat
                      01924 ;
                      01925 ;            /*
                      01926 ;             * 2. Prepare OUT EP to receive data.
                      01927 ;             */
                      01928 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
0005AA 0E08           01929         movlw   USB_EP0_BUFF_SIZE
0005AC 6F01           01930         movwf   ep0Bo + Cnt
                      01931 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&CtrlTrfData;
0005AE 0E37           01932         movlw   low CtrlTrfData
0005B0 6F02           01933         movwf   ep0Bo + ADRL
0005B2 0E04           01934         movlw   high CtrlTrfData
0005B4 6F03           01935         movwf   ep0Bo + ADRH
                      01936 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT1|_DTSEN;
0005B6 0EC8           01937         movlw   _USIE|_DAT1|_DTSEN
0005B8 6F00           01938         movwf   ep0Bo + Stat
0005BA 0012           01939         return
                      01940 ;        }
                      01941 ;        else
0005BC                01942 USBCtrlEPServiceComplete0
                      01943 ;        {
                      01944 ;            /*
                      01945 ;             * If no one knows how to service this request then stall.
                      01946 ;             * Must also prepare EP0 to receive the next SETUP transaction.
                      01947 ;            */
                      01948 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
0005BC 0E08           01949         movlw   USB_EP0_BUFF_SIZE
0005BE 6F01           01950         movwf   ep0Bo + Cnt
                      01951 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 67


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0005C0 0E2F           01952         movlw   low SetupPkt
0005C2 6F02           01953         movwf   ep0Bo + ADRL
0005C4 0E04           01954         movlw   high SetupPkt
0005C6 6F03           01955         movwf   ep0Bo + ADRH
                      01956 
                      01957 ;            /* v2b fix */
                      01958 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;
0005C8 0E8C           01959         movlw   _USIE|_DAT0|_DTSEN|_BSTALL
0005CA 6F00           01960         movwf   ep0Bo + Stat
                      01961 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_BSTALL; 
0005CC 0E84           01962         movlw   _USIE|_BSTALL
0005CE 6F04           01963         movwf   ep0Bi + Stat
0005D0 0012           01964         return
                      01965 ;        }
                      01966 ;    }
                      01967 ;    else    // A module has claimed ownership of the control transfer session.
0005D2                01968 USBCtrlEPServiceComplete1
                      01969 ;    {
                      01970 ;        if(outPipes[0].info.bits.busy == 0)
0005D2 BF2D           01971         btfsc   outfo, busy
0005D4 D7F3           01972         bra     USBCtrlEPServiceComplete0
                      01973 ;        {
                      01974 ;        if(SetupPkt.DataDir == DEV_TO_HOST)
0005D6 AF2F           01975         btfss   SetupPkt, DataDir
0005D8 D01E           01976         bra     USBCtrlEPServiceComplete2
                      01977 ;        {
                      01978 ;            if(SetupPkt.wLength < inPipes[0].wCount.Val)
                      01979 ;            {
                      01980 ;                inPipes[0].wCount.Val = SetupPkt.wLength;
                      01981 ;            }
0005DA 5125           01982         movf    inCount + 1, W          ; Make sure count does not exceed max length requested by Host
0005DC 5D36           01983         subwf   SetupPkt + wLength + 1, W
0005DE E304           01984         bnc     USBCtrlEPServiceCompleteCopy
0005E0 E107           01985         bnz     USBCtrlEPServiceComplete11
0005E2 5124           01986         movf    inCount, W
0005E4 5D35           01987         subwf   SetupPkt + wLength, W
0005E6 E204           01988         bc      USBCtrlEPServiceComplete11
0005E8                01989 USBCtrlEPServiceCompleteCopy
0005E8 C435 F424      01990         movff   SetupPkt + wLength, inCount     ; Set count to maximum
0005EC C436 F425      01991         movff   SetupPkt + wLength + 1, inCount + 1
0005F0                01992 USBCtrlEPServiceComplete11
                      01993 ;            USBCtrlTrfTxService();
0005F0 D820           01994         rcall   USBCtrlTrfTxService    ; Actually copy the data to EP0 IN buffer
                      01995 ;            controlTransferState = CTRL_TRF_TX;
0005F2 0104           01996         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0005F4 0E01           01997         movlw   CTRL_TRF_TX
0005F6 6F23           01998         movwf   controlTransferState
                      01999 ;            /*
                      02000 ;             * Control Read:
                      02001 ;             * <SETUP[0]><IN[1]><IN[0]>...<OUT[1]> | <SETUP[0]>
                      02002 ;             * 1. Prepare OUT EP to respond to early termination
                      02003 ;             *
                      02004 ;             * NOTE:
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 68


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02005 ;             * If something went wrong during the control transfer,
                      02006 ;             * the last status stage may not be sent by the host.
                      02007 ;             * When this happens, two different things could happen
                      02008 ;             * depending on the host.
                      02009 ;             * a) The host could send out a RESET.
                      02010 ;             * b) The host could send out a new SETUP transaction
                      02011 ;             *    without sending a RESET first.
                      02012 ;             * To properly handle case (b), the OUT EP must be setup
                      02013 ;             * to receive either a zero length OUT transaction, or a
                      02014 ;             * new SETUP transaction.
                      02015 ;             *
                      02016 ;             * Furthermore, the Cnt byte should be set to prepare for
                      02017 ;             * the SETUP data (8-byte or more), and the buffer address
                      02018 ;             * should be pointed to SetupPkt.
                      02019 ;             */
                      02020 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
0005F8 0E08           02021         movlw   USB_EP0_BUFF_SIZE
0005FA 6F01           02022         movwf   ep0Bo + Cnt
                      02023 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
0005FC 0E2F           02024         movlw   low SetupPkt
0005FE 6F02           02025         movwf   ep0Bo + ADRL
000600 0E04           02026         movlw   high SetupPkt
000602 6F03           02027         movwf   ep0Bo + ADRH
                      02028 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE;           // Note: DTSEN is 0!
000604 0E80           02029         movlw   _USIE                   ; Note: DTSEN is 0!
000606 6F00           02030         movwf   ep0Bo + Stat
                      02031 
                      02032 ;            pBDTEntryEP0OutCurrent->CNT = USB_EP0_BUFF_SIZE;
                      02033 ;            pBDTEntryEP0OutCurrent->ADR = (BYTE*)&SetupPkt;
                      02034 ;            pBDTEntryEP0OutCurrent->STAT.Val = _USIE;           // Note: DTSEN is 0!
                      02035 
                      02036 ;            /*
                      02037 ;             * 2. Prepare IN EP to transfer data, Cnt should have
                      02038 ;             *    been initialized by responsible request owner.
                      02039 ;             */
                      02040 ;            pBDTEntryIn[0]->ADR = (BYTE*)&CtrlTrfData;
000608 0E37           02041         movlw   low CtrlTrfData
00060A 6F06           02042         movwf   ep0Bi + ADRL
00060C 0E04           02043         movlw   high CtrlTrfData
00060E 6F07           02044         movwf   ep0Bi + ADRH
                      02045 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
000610 0EC8           02046         movlw   _USIE|_DAT1|_DTSEN
000612 6F04           02047         movwf   ep0Bi + Stat
000614 0012           02048         return
                      02049 ;        }
                      02050 ;        else    // (SetupPkt.DataDir == HOST_TO_DEVICE)
000616                02051 USBCtrlEPServiceComplete2
                      02052 ;        {
                      02053 ;            controlTransferState = CTRL_TRF_RX;
000616 0E02           02054         movlw   CTRL_TRF_RX
000618 6F23           02055         movwf   controlTransferState
                      02056 ;            /*
                      02057 ;             * Control Write:
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 69


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02058 ;             * <SETUP[0]><OUT[1]><OUT[0]>...<IN[1]> | <SETUP[0]>
                      02059 ;             *
                      02060 ;             * 1. Prepare IN EP to respond to early termination
                      02061 ;             *
                      02062 ;             *    This is the same as a Zero Length Packet Response
                      02063 ;             *    for control transfer without a data stage
                      02064 ;             */
                      02065 ;            pBDTEntryIn[0]->CNT = 0;
00061A 6B05           02066         clrf    ep0Bi + Cnt
                      02067 ;            pBDTEntryIn[0]->STAT.Val = _USIE|_DAT1|_DTSEN;
00061C 0EC8           02068         movlw   _USIE|_DAT1|_DTSEN
00061E 6F04           02069         movwf   ep0Bi + Stat
                      02070 
                      02071 ;            /*
                      02072 ;             * 2. Prepare OUT EP to receive data.
                      02073 ;             */
                      02074 ;            pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
000620 0E08           02075         movlw   USB_EP0_BUFF_SIZE
000622 6F01           02076         movwf   ep0Bo + Cnt
                      02077 ;            pBDTEntryEP0OutNext->ADR = (BYTE*)&CtrlTrfData;
000624 0E37           02078         movlw   low CtrlTrfData
000626 6F02           02079         movwf   ep0Bo + ADRL
000628 0E04           02080         movlw   high CtrlTrfData
00062A 6F03           02081         movwf   ep0Bo + ADRH
                      02082 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT1|_DTSEN;
00062C 0EC8           02083         movlw   _USIE|_DAT1|_DTSEN
00062E 6F00           02084         movwf   ep0Bo + Stat
                      02085 ;                       }
                      02086 ;        }
                      02087 ;    }//end if(ctrl_trf_session_owner == MUID_NULL)
                      02088 
000630 0012           02089         return
                      02090 ;}//end USBCtrlEPServiceComplete
                      02091 
                      02092 
                      02093 ;/******************************************************************************
                      02094 ; * Function:        void USBCtrlTrfTxService(void)
                      02095 ; *
                      02096 ; * PreCondition:    pSrc, wCount, and usb_stat.ctrl_trf_mem are setup properly.
                      02097 ; *
                      02098 ; * Input:           None
                      02099 ; *
                      02100 ; * Output:          None
                      02101 ; *
                      02102 ; * Side Effects:    None
                      02103 ; *
                      02104 ; * Overview:        This routine should be called from only two places.
                      02105 ; *                  One from USBCtrlEPServiceComplete() and one from
                      02106 ; *                  USBCtrlTrfInHandler(). It takes care of managing a
                      02107 ; *                  transfer over multiple USB transactions.
                      02108 ; *
                      02109 ; * Note:            This routine works with isochronous endpoint larger than
                      02110 ; *                  256 bytes and is shown here as an example of how to deal
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 70


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02111 ; *                  with BC9 and BC8. In reality, a control endpoint can never
                      02112 ; *                  be larger than 64 bytes.
                      02113 ; *****************************************************************************/
                      02114 ;void USBCtrlTrfTxService(void)
000632                02115 USBCtrlTrfTxService
                      02116 ;{
000632 0104           02117         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      02118 ;    WORD_VAL byteToSend;
                      02119 
                      02120 ;    /*
                      02121 ;     * First, have to figure out how many byte of data to send.
                      02122 ;     */
                      02123 ;    if(inPipes[0].wCount.Val < USB_EP0_BUFF_SIZE)
                      02124 ;    {
                      02125 ;        byteToSend.Val = inPipes[0].wCount.Val;
                      02126 
                      02127 ;        /* v2b fix */
                      02128 ;        if(shortPacketStatus == SHORT_PKT_NOT_USED)
                      02129 ;        {
                      02130 ;            shortPacketStatus = SHORT_PKT_PENDING;
                      02131 ;        }
                      02132 ;        else if(shortPacketStatus == SHORT_PKT_PENDING)
                      02133 ;        {
                      02134 ;            shortPacketStatus = SHORT_PKT_SENT;
                      02135 ;        }//end if
                      02136 ;        /* end v2b fix for this section */
                      02137 ;    }
                      02138 ;    else
                      02139 ;    {
                      02140 ;        byteToSend.Val = USB_EP0_BUFF_SIZE;
                      02141 ;    }
000634 5124           02142         movf    inCount, W              ; Preset wCount bytes to send
000636 6F18           02143         movwf   usb_temp
000638 5125           02144         movf    inCount + 1, W
00063A 6F19           02145         movwf   usb_temp + 1
00063C 0800           02146         sublw   high USB_EP0_BUFF_SIZE  ; Check for count less than maximium length
00063E E103           02147         bnz     USBCtrlTrfTxServiceNotEQ        ; Not equal so we don't need to check the bottom byte
000640 5124           02148         movf    inCount, W
000642 0808           02149         sublw   low USB_EP0_BUFF_SIZE
000644 E011           02150         bz      USBCtrlTrfTxServiceNotLess      ; Equal to
000646                02151 USBCtrlTrfTxServiceNotEQ
000646 E30C           02152         bnc     USBCtrlTrfTxServiceGreater      ; Greater than
000648 0E00           02153         movlw   SHORT_PKT_NOT_USED
00064A 6328           02154         cpfseq  shortPacketStatus
00064C D003           02155         bra     USBCtrlTrfTxServiceNotEQ1
00064E 0E01           02156         movlw   SHORT_PKT_PENDING
000650 6F28           02157         movwf   shortPacketStatus
000652 D00A           02158         bra     USBCtrlTrfTxServiceNotLess
000654                02159 USBCtrlTrfTxServiceNotEQ1
000654 0E01           02160         movlw   SHORT_PKT_PENDING
000656 6328           02161         cpfseq  shortPacketStatus
000658 D007           02162         bra     USBCtrlTrfTxServiceNotLess
00065A 0E02           02163         movlw   SHORT_PKT_SENT
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 71


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00065C 6F28           02164         movwf   shortPacketStatus
00065E D004           02165         bra     USBCtrlTrfTxServiceNotLess
000660                02166 USBCtrlTrfTxServiceGreater
000660 0E08           02167         movlw   low USB_EP0_BUFF_SIZE   ; Send buffer full of bytes
000662 6F18           02168         movwf   usb_temp
000664 0E00           02169         movlw   high USB_EP0_BUFF_SIZE
000666 6F19           02170         movwf   usb_temp + 1
000668                02171 USBCtrlTrfTxServiceNotLess
                      02172 
                      02173 ;    /*
                      02174 ;     * Next, load the number of bytes to send to BC9..0 in buffer descriptor
                      02175 ;     */
                      02176 ;    #if defined(__18CXX)
                      02177 ;        pBDTEntryIn[0]->STAT.BC9 = 0;
                      02178 ;        pBDTEntryIn[0]->STAT.BC8 = 0;
000668 5104           02179         movf    ep0Bi + Stat, W         ; Get full Stat byte
00066A 0BFC           02180         andlw   0xfc                    ; Clear bottom bits
                      02181 ;    #endif
                      02182 ;    pBDTEntryIn[0]->STAT.Val |= byteToSend.byte.HB;
00066C 1119           02183         iorwf   usb_temp + 1, W         ; Put in high bits of bytes to send
00066E 6F04           02184         movwf   ep0Bi + Stat            ; Save it out
                      02185 ;    pBDTEntryIn[0]->CNT = byteToSend.byte.LB;
000670 5118           02186         movf    usb_temp, W             ; Get actual bytes to be sent from the buffer for subtract
000672 6F05           02187         movwf   ep0Bi + Cnt             ; Save low number of bytes to send while we're here
                      02188 
                      02189 ;    /*
                      02190 ;     * Subtract the number of bytes just about to be sent from the total.
                      02191 ;     */
                      02192 ;    inPipes[0].wCount.Val = inPipes[0].wCount.Val - byteToSend.Val;
                      02193 ;       movf    usb_temp, W             ; Subtract actual bytes to be sent from the buffer
000674 5F24           02194         subwf   inCount, F
000676 5119           02195         movf    usb_temp + 1, W
000678 5B25           02196         subwfb  inCount + 1, F
                      02197 
                      02198 ;    pDst = (BYTE*)CtrlTrfData;        // Set destination pointer
00067A EE24 F037      02199         lfsr    2, CtrlTrfData          ; Set destination pointer
                      02200 
00067E 5119           02201         movf    usb_temp + 1, W         ; Check high byte for 0
000680 1118           02202         iorwf   usb_temp, W             ; Check low byte for 0
000682 E025           02203         bz      USBCtrlTrfTxServiceExit ; If both 0 then nothing to send this time
                      02204 ;    if(inPipes[0].info.bits.ctrl_trf_mem == USB_INPIPES_ROM)       // Determine type of memory source
000684 B12C           02205         btfsc   info, ctrl_trf_mem      ; ROM or RAM?
000686 D015           02206         bra     USBCtrlTrfTxServiceRam  ; RAM
                      02207 ;    {
                      02208 ;        while(byteToSend.Val)
                      02209 ;        {
                      02210 ;            *pDst++ = *inPipes[0].pSrc.bRom++;
                      02211 ;            byteToSend.Val--;
                      02212 ;        }//end while(byte_to_send.Val)
000688 C41A FFF6      02213         movff   pSrc, TBLPTRL           ; Move source pointer to TBLPTR
00068C C41B FFF7      02214         movff   pSrc + 1, TBLPTRH
000690 C41C FFF8      02215         movff   pSrc + 2, TBLPTRU
000694                02216 USBCtrlTrfTxServiceRomLoop
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 72


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000694 0009           02217         tblrd   *+
000696 CFF5 FFDE      02218         movff   TABLAT, POSTINC2        ; Copy one buffer to the other
00069A 0009           02219         tblrd   *+                      ; Skip retlw in high location
00069C 0718           02220         decf    usb_temp, F             ; Count down number of bytes
00069E E1FA           02221         bnz     USBCtrlTrfTxServiceRomLoop
0006A0 0719           02222         decf    usb_temp + 1, F
0006A2 E2F8           02223         bc      USBCtrlTrfTxServiceRomLoop
0006A4 CFF6 F41A      02224         movff   TBLPTRL, pSrc           ; Update source pointer
0006A8 CFF7 F41B      02225         movff   TBLPTRH, pSrc + 1
0006AC CFF8 F41C      02226         movff   TBLPTRU, pSrc + 2
0006B0 0012           02227         return
                      02228 ;    }
                      02229 ;    else  // RAM
0006B2                02230 USBCtrlTrfTxServiceRam
                      02231 ;    {
                      02232 ;        while(byteToSend.Val)
                      02233 ;        {
                      02234 ;            *pDst++ = *inPipes[0].pSrc.bRam++;
                      02235 ;            byteToSend.Val--;
                      02236 ;        }//end while(byte_to_send.Val)
0006B2 C41A FFE1      02237         movff   pSrc, FSR1L             ; Move source pointer to FSR1
0006B6 C41B FFE2      02238         movff   pSrc + 1, FSR1H
0006BA                02239 USBCtrlTrfTxServiceRamLoop
0006BA CFE6 FFDE      02240         movff   POSTINC1, POSTINC2      ; Copy one buffer to the other
0006BE 0718           02241         decf    usb_temp, F             ; Count down number of bytes
0006C0 E1FC           02242         bnz     USBCtrlTrfTxServiceRamLoop
0006C2 0719           02243         decf    usb_temp + 1, F
0006C4 E2FA           02244         bc      USBCtrlTrfTxServiceRamLoop
0006C6 CFE1 F41A      02245         movff   FSR1L, pSrc             ; Update source pointer
0006CA CFE2 F41B      02246         movff   FSR1H, pSrc + 1
0006CE                02247 USBCtrlTrfTxServiceExit
0006CE 0012           02248         return
                      02249 ;    }//end if(usb_stat.ctrl_trf_mem == _ROM)
                      02250 
                      02251 ;}//end USBCtrlTrfTxService
                      02252 
                      02253 ;/******************************************************************************
                      02254 ; * Function:        void USBCtrlTrfRxService(void)
                      02255 ; *
                      02256 ; * PreCondition:    pDst and wCount are setup properly.
                      02257 ; *                  pSrc is always &CtrlTrfData
                      02258 ; *                  usb_stat.ctrl_trf_mem is always _RAM.
                      02259 ; *                  wCount should be set to 0 at the start of each control
                      02260 ; *                  transfer.
                      02261 ; *
                      02262 ; * Input:           None
                      02263 ; *
                      02264 ; * Output:          None
                      02265 ; *
                      02266 ; * Side Effects:    None
                      02267 ; *
                      02268 ; * Overview:        *** This routine is only partially complete. Check for
                      02269 ; *                  new version of the firmware.
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 73


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02270 ; *
                      02271 ; * Note:            None
                      02272 ; *****************************************************************************/
                      02273 ;void USBCtrlTrfRxService(void)
0006D0                02274 USBCtrlTrfRxService
                      02275 ;{
0006D0 0104           02276         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      02277 ;    BYTE byteToRead;
                      02278 ;    BYTE i;
                      02279 
                      02280 ;    byteToRead = pBDTEntryEP0OutCurrent->CNT;
0006D2 5101           02281         movf    ep0Bo + Cnt, W
0006D4 6F18           02282         movwf   usb_temp
                      02283 
                      02284 ;    /*
                      02285 ;     * Accumulate total number of bytes read
                      02286 ;     */
                      02287 ;    if(byteToRead > outPipes[0].wCount.Val)
0006D6 6727           02288         tstfsz  outCount + 1    ; If high byte isn't 0 then not less than
0006D8 D003           02289         bra     USBCtrlTrfRxService1
0006DA 5126           02290         movf    outCount, W     ; Get low byte
0006DC 6118           02291         cpfslt  usb_temp
                      02292 ;    {
                      02293 ;        byteToRead = outPipes[0].wCount.Val;
0006DE 6F18           02294         movwf   usb_temp
                      02295 ;    }
                      02296 ;    else
0006E0                02297 USBCtrlTrfRxService1
                      02298 ;    {
                      02299 ;        outPipes[0].wCount.Val = outPipes[0].wCount.Val - byteToRead;
0006E0 5118           02300         movf    usb_temp, W
0006E2 5F26           02301         subwf   outCount, F
0006E4 A0D8           02302         btfss   STATUS, C
0006E6 0727           02303         decf    outCount + 1, F
                      02304 ;    }
                      02305 ;old    inPipes[0].wCount.Val = inPipes[0].wCount.Val + byteToRead.Val;
                      02306 ;       movf    ep0Bo + Cnt, W          ; Get low number of bytes to read
                      02307 ;       movwf   usb_temp                ; usb_temp & usb_temp + 1 are bytes to read
                      02308 ;       addwf   outCount, F             ; Accumulate total number of bytes read
                      02309 ;;      movf    ep0Bo + Stat, W         ; Get high bits to read
                      02310 ;;      andlw   0x03                    ; Mask to the count
                      02311 ;;      movwf   usb_temp + 1            ; Save to high byte of bytes to read
                      02312 ;       movlw   0
                      02313 ;       addwfc  outCount + 1, F         ; Add overflow from low byte (C) and high byte to total number
                      02314 
                      02315 ;    for(i=0;i<byteToRead;i++)
                      02316 ;    {
                      02317 ;        *outPipes[0].pDst.bRam++ = CtrlTrfData[i];
                      02318 ;    }//end while(byteToRead.Val)
0006E8 EE14 F037      02319         lfsr    1, CtrlTrfData          ; Point FSR1 to source
0006EC C41D FFD9      02320         movff   pDst, FSR2L             ; Move destination pointer to FSR2
0006F0 C41E FFDA      02321         movff   pDst + 1, FSR2H
0006F4 5118           02322         movf    usb_temp, W             ; Check low byte for 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 74


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02323 ;       iorwf   usb_temp+ 1, W          ; Check high byte for 0
0006F6 E008           02324         bz      USBCtrlTrfRxServiceExit ; If both 0 then nothing to send this time
0006F8                02325 USBCtrlTrfRxServiceLoop
0006F8 CFE6 FFDE      02326         movff   POSTINC1, POSTINC2      ; Copy one buffer to the other
0006FC 0718           02327         decf    usb_temp, F             ; Count down number of bytes
0006FE E1FC           02328         bnz     USBCtrlTrfRxServiceLoop
                      02329 ;       decf    usb_temp + 1, F
                      02330 ;       bc      USBCtrlTrfRxServiceLoop
000700 CFD9 F41D      02331         movff   FSR2L, pDst             ; Update destination pointer
000704 CFDA F41E      02332         movff   FSR2H, pDst + 1
000708                02333 USBCtrlTrfRxServiceExit
                      02334 
                      02335 ;    //If there is more data to read
                      02336 ;    if(outPipes[0].wCount.Val > 0)
000708 5127           02337         movf    outCount + 1, W         ; Check high byte for 0
00070A 1126           02338         iorwf   outCount, W             ; Check low byte for 0
00070C E009           02339         bz      USBCtrlTrfRxService2
                      02340 ;    {
                      02341 ;        /*
                      02342 ;         * Don't have to worry about overwriting _KEEP bit
                      02343 ;         * because if _KEEP was set, TRNIF would not have been
                      02344 ;         * generated in the first place.
                      02345 ;         */
                      02346 ;        pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
00070E 0104           02347         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
000710 0E08           02348         movlw   USB_EP0_BUFF_SIZE
000712 6F01           02349         movwf   ep0Bo + Cnt
                      02350 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&CtrlTrfData;
000714 0E37           02351         movlw   low CtrlTrfData
000716 6F02           02352         movwf   ep0Bo + ADRL
000718 0E04           02353         movlw   high CtrlTrfData
00071A 6F03           02354         movwf   ep0Bo + ADRH
                      02355 ;        if(pBDTEntryEP0OutCurrent->STAT.DTS == 0)
                      02356 ;        {
                      02357 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT1|_DTSEN;
                      02358 ;        }
                      02359 ;        else
                      02360 ;        {
                      02361 ;            pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN;
                      02362 ;        }
00071C 7D00           02363         btg     ep0Bo + Stat, DTS
                      02364 ;       movlw   _USIE|_DAT1|_DTSEN
                      02365 ;       btfsc   ep0Bo + Stat, DTS
                      02366 ;       movlw   _USIE|_DAT0|_DTSEN
                      02367 ;       movwf   ep0Bo + Stat
00071E 0012           02368         return
                      02369 ;    }
                      02370 ;    else
000720                02371 USBCtrlTrfRxService2
                      02372 ;    {
                      02373 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
000720 0E2F           02374         movlw   low SetupPkt
000722 6F02           02375         movwf   ep0Bo + ADRL
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 75


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000724 0E04           02376         movlw   high SetupPkt
000726 6F03           02377         movwf   ep0Bo + ADRH
                      02378 ;        if(outPipes[0].pFunc != NULL)
                      02379 ;        {
                      02380 ;            outPipes[0].pFunc();
                      02381 ;        }
                      02382 ;        outPipes[0].info.bits.busy = 0;
000728 9F2D           02383         bcf     outfo, busy
                      02384 ;    }
                      02385 
                      02386 ;    // reset ep0Bo.Cnt to USB_EP0_BUFF_SIZE
                      02387 
00072A 0012           02388         return
                      02389 ;}//end USBCtrlTrfRxService
                      02390 
                      02391 ;/********************************************************************
                      02392 ; * Function:        void USBStdSetCfgHandler(void)
                      02393 ; *
                      02394 ; * PreCondition:    None
                      02395 ; *
                      02396 ; * Input:           None
                      02397 ; *
                      02398 ; * Output:          None
                      02399 ; *
                      02400 ; * Side Effects:    None
                      02401 ; *
                      02402 ; * Overview:        This routine first disables all endpoints by
                      02403 ; *                  clearing UEP registers. It then configures
                      02404 ; *                  (initializes) endpoints by calling the callback
                      02405 ; *                  function USBCBInitDevClass().
                      02406 ; *
                      02407 ; * Note:            None
                      02408 ; *******************************************************************/
                      02409 ;void USBStdSetCfgHandler(void)
00072C                02410 USBStdSetCfgHandler
                      02411 ;{
00072C 0104           02412         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      02413 ;    // This will generate a zero length packet
                      02414 ;    inPipes[0].info.bits.busy = 1;
00072E 8F2C           02415         bsf     info, busy
                      02416 
                      02417 ;    //disable all endpoints except endpoint 0
                      02418 ;    memset((void*)&U1EP1,0x00,(USB_MAX_EP_NUMBER-1));
000730 EE2F F071      02419         lfsr    2, UEP1                 ; Reset all non-EP0 UEPn registers
000734 0E02           02420         movlw   USB_MAX_EP_NUMBER
000736                02421 USBStdSetCfgHandlerClearEPLoop
000736 6ADE           02422         clrf    POSTINC2
000738 2EE8           02423         decfsz  WREG, F
00073A D7FD           02424         bra     USBStdSetCfgHandlerClearEPLoop
                      02425 
                      02426 ;    //clear the alternate interface settings
                      02427 ;    memset((void*)&USBAlternateInterface,0x00,USB_MAX_NUM_INT);
00073C EE24 F021      02428         lfsr    2, USBAlternateInterface        ; Clear usb_alt_intf array
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 76


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000740 0E02           02429         movlw   USB_MAX_NUM_INT
000742                02430 USBStdSetCfgHandlerClearAltLoop
000742 6ADE           02431         clrf    POSTINC2
000744 2EE8           02432         decfsz  WREG, F
000746 D7FD           02433         bra     USBStdSetCfgHandlerClearAltLoop
                      02434 
                      02435 ;    //set the current configuration
                      02436 ;    USBActiveConfiguration = SetupPkt.bConfigurationValue;
000748 5131           02437         movf    SetupPkt + bConfigurationValue, W
00074A 6F20           02438         movwf   USBActiveConfiguration
                      02439 
                      02440 ;    //if the configuration value == 0
                      02441 ;    if(SetupPkt.bConfigurationValue == 0)
00074C E103           02442         bnz     USBStdSetCfgHandler1
                      02443 ;    {
                      02444 ;        //Go back to the addressed state
                      02445 ;        USBDeviceState = ADDRESS_STATE;
00074E 0E10           02446         movlw   ADDRESS_STATE           ; SetupPkt + bCfgValue = 0
000750 6F1F           02447         movwf   USBDeviceState
000752 0012           02448         return
                      02449 ;    }
                      02450 ;    else
000754                02451 USBStdSetCfgHandler1
                      02452 ;    {
                      02453 ;        //Otherwise go to the configured state
                      02454 ;        USBDeviceState = CONFIGURED_STATE;
000754 0E20           02455         movlw   CONFIGURED_STATE
000756 6F1F           02456         movwf   USBDeviceState
                      02457 ;        //initialize the required endpoints
                      02458 ;        USBInitEP((BYTE ROM*)(USB_CD_Ptr[USBActiveConfiguration-1]));
                      02459 ;        USBCBInitEP();
000758 D148           02460         bra     USBCBInitEP
                      02461 
                      02462 ;    }//end if(SetupPkt.bConfigurationValue == 0)
                      02463 ;}//end USBStdSetCfgHandler
                      02464 
                      02465 ;/********************************************************************
                      02466 ; * Function:        void USBConfigureEndpoint(BYTE EPNum, BYTE direction)
                      02467 ; *
                      02468 ; * PreCondition:    None
                      02469 ; *
                      02470 ; * Input:           BYTE EPNum - the endpoint to be configured
                      02471 ; *                  BYTE direction - the direction to be configured
                      02472 ; *
                      02473 ; * Output:          None
                      02474 ; *
                      02475 ; * Side Effects:    None
                      02476 ; *
                      02477 ; * Overview:        This function will configure the specified 
                      02478 ; *                  endpoint
                      02479 ; *
                      02480 ; * Note:            None
                      02481 ; *******************************************************************/
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 77


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02482 ;void USBConfigureEndpoint(BYTE EPNum, BYTE direction)
                      02483 ;{
                      02484 ;    volatile BDT_ENTRY* handle;
                      02485 
                      02486 ;    handle = (volatile BDT_ENTRY*)&BDT[EP0_OUT_EVEN];
                      02487 ;    handle += BD(EPNum,direction,0)/sizeof(BDT_ENTRY);
                      02488 
                      02489 ;    handle->STAT.UOWN = 0;
                      02490 
                      02491 ;    if(direction == 0)
                      02492 ;    {
                      02493 ;        pBDTEntryOut[EPNum] = handle;
                      02494 ;    }
                      02495 ;    else
                      02496 ;    {
                      02497 ;        pBDTEntryIn[EPNum] = handle;
                      02498 ;    }
                      02499 
                      02500 ;    #if (USB_PING_PONG_MODE == USB_PING_PONG__FULL_PING_PONG)
                      02501 ;        handle->STAT.DTS = 0;
                      02502 ;        (handle+1)->STAT.DTS = 1;
                      02503 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__NO_PING_PONG)
                      02504 ;        //Set DTS to one because the first thing we will do
                      02505 ;        //when transmitting is toggle the bit
                      02506 ;        handle->STAT.DTS = 1;
                      02507 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__EP0_OUT_ONLY)
                      02508 ;        if(EPNum != 0)
                      02509 ;        {
                      02510 ;            handle->STAT.DTS = 1;
                      02511 ;        }
                      02512 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__ALL_BUT_EP0)    
                      02513 ;        if(EPNum != 0)
                      02514 ;        {
                      02515 ;            handle->STAT.DTS = 0;
                      02516 ;            (handle+1)->STAT.DTS = 1;
                      02517 ;        }
                      02518 ;    #endif
                      02519 ;}
                      02520 
                      02521 ;/********************************************************************
                      02522 ; * Function:        void USBEnableEndpoint(BYTE ep, BYTE options)
                      02523 ; *
                      02524 ; * PreCondition:    None
                      02525 ; *
                      02526 ; * Input:
                      02527 ; *   BYTE ep - the endpoint to be configured
                      02528 ; *   BYTE options - optional settings for the endpoint.
                      02529 ; *        The options should be ORed together to form a 
                      02530 ; *        single options string.  The available options:
                      02531 ; *
                      02532 ; *        USB_HANDSHAKE_ENABLED - enable USB handshaking (ACK, NAK)
                      02533 ; *        USB_HANDSHAKE_DISABLED - disable USB handshaking (ACK, NAK)
                      02534 ; *        USB_OUT_ENABLED - enable the out direction
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 78


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02535 ; *        USB_OUT_DISABLED - disable the out direction
                      02536 ; *        USB_IN_ENABLED - enable the in direction
                      02537 ; *        USB_IN_DISABLED - disable the in direction
                      02538 ; *        USB_ALLOW_SETUP - enable control transfers
                      02539 ; *        USB_DISALLOW_SETUP - disable control transfers
                      02540 ; *        USB_STALL_ENDPOINT - STALL this endpoint
                      02541 ; *
                      02542 ; * Output:          None
                      02543 ; *
                      02544 ; * Side Effects:    None
                      02545 ; *
                      02546 ; * Overview:        This function will enable the specified 
                      02547 ; *                  endpoint with the specified options
                      02548 ; *
                      02549 ; * Note:            None
                      02550 ; *******************************************************************/
                      02551 ;void USBEnableEndpoint(BYTE ep, BYTE options)
                      02552 ;{
                      02553 ;    //Set the options to the appropriate endpoint control register
                      02554 ;    //*((unsigned char*)(&U1EP0+ep)) = options;
                      02555 ;    {
                      02556 ;        unsigned int* p;
                      02557 
                      02558 ;        p = (unsigned int*)(&U1EP0+ep);
                      02559 ;        *p = options;
                      02560 ;    }
                      02561 ;    if(options & USB_OUT_ENABLED)
                      02562 ;    {
                      02563 ;        USBConfigureEndpoint(ep,0);
                      02564 ;    }
                      02565 ;    if(options & USB_IN_ENABLED)
                      02566 ;    {
                      02567 ;        USBConfigureEndpoint(ep,1);
                      02568 ;    }
                      02569 ;}
                      02570 
                      02571 ;  Enable and configure OUT endpoint
                      02572 ; Input:
                      02573 ;  FSR0L is endpoint number
                      02574 ;  FSR1 is endpoint buffer address
                      02575 ;  usb_temp is options
                      02576 ;  W is endpoint buffer size
                      02577 ; Returns:
                      02578 ;  Nada
                      02579 ; Uses
                      02580 ;  FSR0 is BDT pointer
                      02581 ;  FSR1 is endpoint buffer pointer
                      02582 ;  FSR2 is endpoint table pointer
                      02583 
00075A                02584 USBEnableEndpointOut
                      02585 ; Save maximum count at front of endpoint buffer and move buffer pointer up
00075A 6EE6           02586         movwf   POSTINC1                ; Store maximum count at front of endpoint buffer and move up po
                            inter
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 79


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02587 
                      02588 ; Point FSR2 to endpoint table
00075C EE2F F070      02589         lfsr    2, UEP0                 ; FSR2 = beginning of endpoint table
000760 50E9           02590         movf    FSR0L, W                ; Add in endpoint number
000762 26D9           02591         addwf   FSR2L, F
                      02592 
                      02593 ; Enable Out endpoint
000764 5118           02594         movf    usb_temp, W             ; Options to W
000766 6EDF           02595         movwf   INDF2                   ; Options to endpoint table
                      02596 
                      02597 ; Point FSR0 to endpoint BDT
000768 44E9           02598         rlncf   FSR0L, W                ; Endpoint number * 8
00076A 46E8           02599         rlncf   WREG, F
00076C 46E8           02600         rlncf   WREG, F
00076E EE04 F000      02601         lfsr    0, ep0Bo                ; Point FSR0 to beginning of BDT area
000772 26E9           02602         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02603 
                      02604 ; Set endpoint buffer address from FSR1 + 1
000774 0E02           02605         movlw   ADRL                    ; Point to ADRL
000776 CFE1 FFEB      02606         movff   FSR1L, PLUSW0
00077A 0E03           02607         movlw   ADRH                    ; Point to ADRH
00077C CFE2 FFEB      02608         movff   FSR1H, PLUSW0
                      02609 
                      02610 ; Set Cnt to maximum count
000780 50E5           02611         movf    POSTDEC1, W             ; Back up endpoint buffer pointer (no PREDEC1!)
000782 2AE9           02612         incf    FSR0L, F                ; Point to Cnt
000784 CFE7 FFED      02613         movff   INDF1, POSTDEC0         ; Set maximum count and point back to Stat
                      02614 
                      02615 ; Set endpoint status
000788 9EEF           02616         bcf     INDF0, UOWN
00078A 8CEF           02617         bsf     INDF0, DTS
00078C 0012           02618         return
                      02619 
                      02620 ;  Enable and configure IN endpoint
                      02621 ; Input:
                      02622 ;  FSR0L is endpoint number
                      02623 ;  FSR1 is endpoint buffer address
                      02624 ;  usb_temp is options
                      02625 ;  W is endpoint buffer size
                      02626 ; Returns:
                      02627 ;  Nada
                      02628 ; Uses
                      02629 ;  FSR0 is BDT pointer
                      02630 ;  FSR1 is endpoint buffer pointer
                      02631 ;  FSR2 is endpoint table pointer
                      02632 
00078E                02633 USBEnableEndpointIn
                      02634 ; Save maximum count at front of endpoint buffer and move buffer pointer up (no need to put in Cnt for I
                            n)
00078E 6EE6           02635         movwf   POSTINC1                ; Store maximum count at front of endpoint buffer and move up po
                            inter
                      02636 
                      02637 ; Point FSR2 to endpoint table
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 80


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000790 EE2F F070      02638         lfsr    2, UEP0                 ; FSR2 = beginning of endpoint table
000794 50E9           02639         movf    FSR0L, W                ; Add in endpoint number
000796 26D9           02640         addwf   FSR2L, F
                      02641 
                      02642 ; Enable In endpoint
000798 5118           02643         movf    usb_temp, W             ; Options to W
00079A 6EDF           02644         movwf   INDF2                   ; Options to endpoint table
                      02645 
                      02646 ; Point FSR0 to endpoint BDT
00079C 44E9           02647         rlncf   FSR0L, W                ; Endpoint number * 8
00079E 46E8           02648         rlncf   WREG, F
0007A0 46E8           02649         rlncf   WREG, F
0007A2 EE04 F004      02650         lfsr    0, ep0Bi                ; Point FSR0 to beginning of BDT area
0007A6 26E9           02651         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02652 
                      02653 ; Set endpoint buffer address from FSR1
0007A8 0E02           02654         movlw   ADRL                    ; Point to ADRL
0007AA CFE1 FFEB      02655         movff   FSR1L, PLUSW0
0007AE 0E03           02656         movlw   ADRH                    ; Point to ADRH
0007B0 CFE2 FFEB      02657         movff   FSR1H, PLUSW0
                      02658 
                      02659 ; Set endpoint status
0007B4 9EEF           02660         bcf     INDF0, UOWN
0007B6 8CEF           02661         bsf     INDF0, DTS
0007B8 0012           02662         return
                      02663 
                      02664 ;/********************************************************************
                      02665 ; * Function:        void USBStallEndpoint(BYTE ep, BYTE dir)
                      02666 ; *
                      02667 ; * PreCondition:    None
                      02668 ; *
                      02669 ; * Input:
                      02670 ; *   BYTE ep - the endpoint the data will be transmitted on
                      02671 ; *   BYTE dir - the direction of the transfer
                      02672 ; *
                      02673 ; * Output:          None
                      02674 ; *
                      02675 ; * Side Effects:    Endpoint is STALLed
                      02676 ; *
                      02677 ; * Overview:        STALLs the specified endpoint
                      02678 ; *
                      02679 ; * Note:            None
                      02680 ; *******************************************************************/
                      02681 ;void USBStallEndpoint(BYTE ep, BYTE dir)
                      02682 ;USBStallEndpoint
                      02683 ;{
                      02684 ;    BDT_ENTRY *p;
                      02685 
                      02686 ;    if(ep == 0)
                      02687 ;       tstfsz  ep
                      02688 ;       bra     USBStallEndpoint1
                      02689 ;    {
                      02690 ;        /*
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 81


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02691 ;         * If no one knows how to service this request then stall.
                      02692 ;         * Must also prepare EP0 to receive the next SETUP transaction.
                      02693 ;         */
                      02694 ;        pBDTEntryEP0OutNext->CNT = USB_EP0_BUFF_SIZE;
                      02695 ;       movlw   USB_EP0_BUFF_SIZE
                      02696 ;       movwf   ep0Bo + Cnt
                      02697 ;        pBDTEntryEP0OutNext->ADR = (BYTE*)&SetupPkt;
                      02698 ;       movlw   low SetupPkt
                      02699 ;       movwf   ep0Bo + ADRL
                      02700 ;       movlw   high SetupPkt
                      02701 ;       movwf   ep0Bo + ADRH
                      02702 
                      02703 ;        /* v2b fix */
                      02704 ;        pBDTEntryEP0OutNext->STAT.Val = _USIE|_DAT0|_DTSEN|_BSTALL;
                      02705 ;       movlw   _USIE|_DAT0|_DTSEN|_BSTALL
                      02706 ;       movwf   ep0Bo + Stat
                      02707 ;        pBDTEntryIn[0]->STAT.Val = _USIE|_BSTALL; 
                      02708 ;       movlw   _USIE|_BSTALL
                      02709 ;       movwf   ep0Bi + Stat
                      02710 ;       return
                      02711 ;    }
0007BA                02712 USBStallEndpoint1
                      02713 ;    else
                      02714 ;    {
                      02715 ;        p = (BDT_ENTRY*)(&BDT[EP(ep,dir,0)]);
                      02716 ;       lfsr    0, ep0Bo                ; Point FSR0 to beginning of out BDT area
                      02717 ;       tstfsz  dir
                      02718 ;       lfsr    0, ep0Bi                ; Point FSR0 to beginning of in BDT area
                      02719 ;       rlncf   ep, W                   ; Endpoint number * 8
                      02720 ;       rlncf   WREG, F
                      02721 ;       rlncf   WREG, F
                      02722 ;       addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02723 ;        p->STAT.Val |= _BSTALL | _USIE;
                      02724 ;       movlw   _BSTALL | _USIE
                      02725 ;       iorwf   INDF0, F
                      02726 
                      02727 ;        //If the device is in FULL or ALL_BUT_EP0 ping pong modes
                      02728 ;        //then stall that entry as well
                      02729 ;        #if (USB_PING_PONG_MODE == USB_PING_PONG__FULL_PING_PONG) || \
                      02730 ;            (USB_PING_PONG_MODE == USB_PING_PONG__ALL_BUT_EP0)
                      02731     
                      02732 ;        p = (BDT_ENTRY*)(&BDT[EP(ep,dir,1)]);
                      02733 ;        p->STAT.Val |= _BSTALL | _USIE;
                      02734 ;        #endif
                      02735 ;    }
                      02736 ;       return
                      02737 ;}
                      02738 
                      02739 ;/********************************************************************
                      02740 ; * Function:        USB_HANDLE USBTransferOnePacket(
                      02741 ; *                      BYTE ep, 
                      02742 ; *                      BYTE dir, 
                      02743 ; *                      BYTE* data, 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 82


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02744 ; *                      BYTE len)
                      02745 ; *
                      02746 ; * PreCondition:    None
                      02747 ; *
                      02748 ; * Input:
                      02749 ; *   BYTE ep - the endpoint the data will be transmitted on
                      02750 ; *   BYTE dir - the direction of the transfer
                      02751 ;                This value is either OUT_FROM_HOST or IN_TO_HOST
                      02752 ; *   BYTE* data - pointer to the data to be sent
                      02753 ; *   BYTE len - length of the data needing to be sent
                      02754 ; *
                      02755 ; * Output:          None
                      02756 ; *
                      02757 ; * Side Effects:    None
                      02758 ; *
                      02759 ; * Overview:        Transfers one packet over the USB
                      02760 ; *
                      02761 ; * Note:            None
                      02762 ; *******************************************************************/
                      02763 ;USB_HANDLE USBTransferOnePacket(BYTE ep,BYTE dir,BYTE* data,BYTE len)
                      02764 ;{
                      02765 ;    USB_HANDLE handle;
                      02766 
                      02767 ;    //If the direction is IN
                      02768 ;    if(dir != 0)
                      02769 ;    {
                      02770 ;        //point to the IN BDT of the specified endpoint
                      02771 ;        handle = pBDTEntryIn[ep];
                      02772 ;    }
                      02773 ;    else
                      02774 ;    {
                      02775 ;        //else point to the OUT BDT of the specified endpoint
                      02776 ;        handle = pBDTEntryOut[ep];
                      02777 ;    }
                      02778 
                      02779 ;    //Toggle the DTS bit if required
                      02780 ;    #if (USB_PING_PONG_MODE == USB_PING_PONG__NO_PING_PONG)
                      02781 ;        handle->STAT.Val ^= _DTSMASK;
                      02782 ;    #elif (USB_PING_PONG_MODE == USB_PING_PONG__EP0_OUT_ONLY)
                      02783 ;        if(ep != 0)
                      02784 ;        {
                      02785 ;            handle->STAT.Val ^= _DTSMASK;
                      02786 ;        }
                      02787 ;    #endif
                      02788 
                      02789 ;    //Set the data pointer, data length, and enable the endpoint
                      02790 ;    handle->ADR = data;
                      02791 
                      02792 ;    handle->CNT = len;
                      02793 ;    handle->STAT.Val &= _DTSMASK;
                      02794 ;    handle->STAT.Val |= _USIE | _DTSEN;
                      02795 
                      02796 ;    //Point to the next buffer for ping pong purposes.
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 83


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02797 ;    if(dir != 0)
                      02798 ;    {
                      02799 ;        //toggle over the to the next buffer for an IN endpoint
                      02800 ;        ((BYTE_VAL*)&pBDTEntryIn[ep])->Val ^= USB_NEXT_PING_PONG;
                      02801 ;    }
                      02802 ;    else
                      02803 ;    {
                      02804 ;        //toggle over the to the next buffer for an OUT endpoint
                      02805 ;        ((BYTE_VAL*)&pBDTEntryOut[ep])->Val ^= USB_NEXT_PING_PONG;
                      02806 ;    }
                      02807 ;    return handle;
                      02808 ;}
                      02809 
                      02810 ;  Get from OUT endpoint for RX
                      02811 ; Input:
                      02812 ;  FSR0L is endpoint number
                      02813 ;  FSR1 is destination buffer pointer
                      02814 ;  W is max buffer length
                      02815 ; Returns:
                      02816 ;  FSR1 is updated destination buffer pointer
                      02817 ;  W returns number received
                      02818 ;  Carry is clear for buffer not available
                      02819 ; Uses
                      02820 ;  FSR0 is BDT pointer
                      02821 ;  FSR1 is destination buffer pointer
                      02822 ;  FSR2 is endpoint buffer pointer
                      02823 ;  R0 in BANKA is temporary length storage
                      02824 
0007BA                02825 USBRxOnePacket
0007BA                02826 GetUSB
0007BA 0104           02827         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0007BC 6F18           02828         movwf   usb_temp                ; Save max buffer length
                      02829 
                      02830 ; Check to see if we're configured
0007BE 0E20           02831         movlw   CONFIGURED_STATE        ; We might not be configured yet
0007C0 5D1F           02832         subwf   USBDeviceState, W
0007C2 0E00           02833         movlw   0                       ; 0 characters received, so far
0007C4 90D8           02834         bcf     STATUS, C               ; Clear Carry for possible error return
0007C6 E109           02835         bnz     GetUSBNotReady          ; We're not configured
                      02836 
                      02837 ; Point FSR0 to requested endpoint Out BDT
0007C8 44E9           02838         rlncf   FSR0L, W                ; Endpoint number * 8
0007CA 46E8           02839         rlncf   WREG, F
0007CC 46E8           02840         rlncf   WREG, F
0007CE EE04 F000      02841         lfsr    0, ep0Bo                ; Point FSR0 to beginning of BDT area
0007D2 26E9           02842         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02843 
0007D4 0E00           02844         movlw   0                       ; 0 characters received, so far
0007D6 90D8           02845         bcf     STATUS, C               ; Clear Carry for possible error return
0007D8 BEEF           02846         btfsc   INDF0, UOWN             ; Who owns the buffer (Stat, UOWN)?
0007DA                02847 GetUSBNotReady
0007DA 0012           02848         return                          ; Busy (we don't)
                      02849 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 84


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02850 ; Get endpoint buffer address to FSR2
0007DC 0E02           02851         movlw   ADRL                    ; Point to ADRL
0007DE CFEB FFD9      02852         movff   PLUSW0, FSR2L
0007E2 0E03           02853         movlw   ADRH                    ; Point to ADRH
0007E4 CFEB FFDA      02854         movff   PLUSW0, FSR2H
                      02855 
0007E8 50EC           02856         movf    PREINC0, W              ; Get Cnt
0007EA 6118           02857         cpfslt  usb_temp                ; Make sure it's not longer than the buffer
0007EC 6F18           02858         movwf   usb_temp                ; It's OK, save returned length
                      02859 
0007EE 0EFF           02860         movlw   -1
0007F0 50DB           02861         movf    PLUSW2, W               ; Get maximum length from in front of endpoint buffer
0007F2 6EED           02862         movwf   POSTDEC0                ; Reset max length and point back to Stat
                      02863 
0007F4 5118           02864         movf    usb_temp, W             ; Get count to W
0007F6 E004           02865         bz      GetPutUSBZero           ; Nothing received
                      02866 
0007F8                02867 GetUSBLoop
0007F8 CFDE FFE6      02868         movff   POSTINC2, POSTINC1      ; Copy endpoint buffer to destination buffer
0007FC 2EE8           02869         decfsz  WREG, F                 ; Count down number of bytes
0007FE D7FC           02870         bra     GetUSBLoop
                      02871 
000800                02872 GetPutUSBZero
000800 0E40           02873         movlw   _DTSMASK                ; Save only DTS bit
000802 16EF           02874         andwf   INDF0, F
000804 7CEF           02875         btg     INDF0, DTS              ; Toggle DTS bit
000806 0E88           02876         movlw   _USIE|_DTSEN            ; Turn ownership to SIE
000808 12EF           02877         iorwf   INDF0, F
00080A 5118           02878         movf    usb_temp, W             ; Return number of bytes received
00080C 80D8           02879         bsf     STATUS, C               ; Set Carry for non-error return
00080E 0012           02880         return
                      02881 
                      02882 ;  Fill IN endpoint for TX
                      02883 ; Input:
                      02884 ;  FSR0L is endpoint number
                      02885 ;  FSR1 is source buffer pointer
                      02886 ;  W is count
                      02887 ; Returns:
                      02888 ;  FSR1 is updated source buffer pointer
                      02889 ;  W returns number sent
                      02890 ;  Carry is clear for buffer not available
                      02891 ; Uses:
                      02892 ;  FSR0 is BDT pointer
                      02893 ;  FSR1 is source buffer pointer
                      02894 ;  FSR2 is endpoint buffer pointer
                      02895 ;  R0 in BANKA is temporary length storage
                      02896 
000810                02897 USBTxOnePacket
000810                02898 PutUSB
000810 0104           02899         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
000812 6F18           02900         movwf   usb_temp                ; Save count
                      02901 
                      02902 ; Check to see if we're configured
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 85


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000814 0E20           02903         movlw   CONFIGURED_STATE        ; We might not be configured yet
000816 5D1F           02904         subwf   USBDeviceState, W
000818 0E00           02905         movlw   0                       ; 0 characters sent, so far
00081A 90D8           02906         bcf     STATUS, C               ; Clear Carry for possible error return
00081C E109           02907         bnz     PutUSBNotReady          ; We're not configured
                      02908 
                      02909 ; Point FSR0 to requested endpoint In BDT
00081E 44E9           02910         rlncf   FSR0L, W                ; Endpoint number * 8
000820 46E8           02911         rlncf   WREG, F
000822 46E8           02912         rlncf   WREG, F
000824 EE04 F004      02913         lfsr    0, ep0Bi                ; Point FSR0 to beginning of BDT area
000828 26E9           02914         addwf   FSR0L, F                ; Add endpoint offset to FSR0 (can't overflow to FSR0H)
                      02915 
00082A 0E00           02916         movlw   0                       ; 0 characters sent, so far
00082C 90D8           02917         bcf     STATUS, C               ; Clear Carry for possible error return
00082E BEEF           02918         btfsc   INDF0, UOWN             ; Who owns the buffer (Stat, UOWN)?
000830                02919 PutUSBNotReady
000830 0012           02920         return                          ; Busy (we don't)
                      02921 
                      02922 ; Get endpoint buffer address to FSR2
000832 0E02           02923         movlw   ADRL                    ; Point to ADRL
000834 CFEB FFD9      02924         movff   PLUSW0, FSR2L
000838 0E03           02925         movlw   ADRH                    ; Point to ADRH
00083A CFEB FFDA      02926         movff   PLUSW0, FSR2H
                      02927 
00083E 0EFF           02928         movlw   -1
000840 50DB           02929         movf    PLUSW2, W               ; Get maximum length from in front of endpoint buffer
                      02930 
000842 6118           02931         cpfslt  usb_temp                ; Find number of bytes to send this time
000844 6F18           02932         movwf   usb_temp                ; Too big - send maximum allowed length
                      02933 
000846 2AE9           02934         incf    FSR0L, F                ; Point to Cnt
000848 5118           02935         movf    usb_temp, W             ; Get number to send
00084A 6EED           02936         movwf   POSTDEC0                ; Put length into Cnt and point back to Stat
00084C E0D9           02937         bz      GetPutUSBZero           ; Zero to send
                      02938 
00084E                02939 PutUSBLoop
00084E CFE6 FFDE      02940         movff   POSTINC1, POSTINC2      ; Copy source buffer to endpoint buffer
000852 2EE8           02941         decfsz  WREG, F                 ; Count down number of bytes to transfer
000854 D7FC           02942         bra     PutUSBLoop
000856 D7D4           02943         bra     GetPutUSBZero
                      02944 
                      02945 ;/********************************************************************
                      02946 ; * Function:        void USBClearInterruptFlag(BYTE* reg, BYTE flag)
                      02947 ; *
                      02948 ; * PreCondition:    None
                      02949 ; *
                      02950 ; * Input:           
                      02951 ; *   BYTE* reg - the register address holding the interrupt flag
                      02952 ; *   BYTE flag - the bit number needing to be cleared
                      02953 ; *
                      02954 ; * Output:          None
                      02955 ; *
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 86


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02956 ; * Side Effects:    None
                      02957 ; *
                      02958 ; * Overview:        clears the specified interrupt flag.
                      02959 ; *
                      02960 ; * Note:            
                      02961 ; *******************************************************************/
                      02962 ;void USBClearInterruptFlag(BYTE* reg, BYTE flag)
                      02963 ;{
                      02964 ;    #if defined(__18CXX)
                      02965 ;        *reg &= ~(0x01<<flag);
                      02966 ;    #elif defined(__C30__)
                      02967 ;        *reg = (0x01<<flag);        
                      02968 ;    #endif
                      02969 ;}
                      02970 ;/** EOF USBDevice.c *****************************************************/
                      00006 
                      00007 ;/********************************************************************
                      00008 ; FileName:             usb_function_hid.c
                      00009 ; Dependencies: See INCLUDES section
                      00010 ; Processor:            PIC18 or PIC24 USB Microcontrollers
                      00011 ; Hardware:             The code is natively intended to be used on the following
                      00012 ;                               hardware platforms: PICDEM FS USB Demo Board, 
                      00013 ;                               PIC18F87J50 FS USB Plug-In Module, or
                      00014 ;                               Explorer 16 + PIC24 USB PIM.  The firmware may be
                      00015 ;                               modified for use on other USB platforms by editing the
                      00016 ;                               HardwareProfile.h file.
                      00017 ; Complier:     Microchip C18 (for PIC18) or C30 (for PIC24)
                      00018 ; Company:              Microchip Technology, Inc.
                      00019 
                      00020 ; Software License Agreement:
                      00021 
                      00022 ; The software supplied herewith by Microchip Technology Incorporated
                      00023 ; (the Company) for its PIC Microcontroller is intended and
                      00024 ; supplied to you, the Companys customer, for use solely and
                      00025 ; exclusively on Microchip PIC Microcontroller products. The
                      00026 ; software is owned by the Company and/or its supplier, and is
                      00027 ; protected under applicable copyright laws. All rights are reserved.
                      00028 ; Any use in violation of the foregoing restrictions may subject the
                      00029 ; user to criminal sanctions under applicable laws, as well as to
                      00030 ; civil liability for the breach of the terms and conditions of this
                      00031 ; license.
                      00032 
                      00033 ; THIS SOFTWARE IS PROVIDED IN AN AS IS CONDITION. NO WARRANTIES,
                      00034 ; WHETHER EXPRESS, IMPLIED OR STATUTORY, INCLUDING, BUT NOT LIMITED
                      00035 ; TO, IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A
                      00036 ; PARTICULAR PURPOSE APPLY TO THIS SOFTWARE. THE COMPANY SHALL NOT,
                      00037 ; IN ANY CIRCUMSTANCES, BE LIABLE FOR SPECIAL, INCIDENTAL OR
                      00038 ; CONSEQUENTIAL DAMAGES, FOR ANY REASON WHATSOEVER.
                      00039 
                      00040 ;********************************************************************
                      00041 ; File Description:
                      00042 
                      00043 ; Change History:
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 87


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00044 ;  Rev   Date         Description
                      00045 ;  1.0   11/19/2004   Initial release
                      00046 ;  2.1   02/26/2007   Updated for simplicity and to use common
                      00047 ;                     coding style
                      00048 ;*******************************************************************/
                      00049 
                      00050 ;/** INCLUDES *******************************************************/
                      00051 ;#include "GenericTypeDefs.h"
                      00052 ;#include "Compiler.h"
                      00053 ;#include "usb_config.h"
                      00054 ;#include "./USB/usb_device.h"
                      00055 ;#include "./USB/usb_function_hid.h"
                      00056 
                      00057 ;/** VARIABLES ******************************************************/
                      00058 ;#pragma udata
                      00059 ;BYTE idle_rate;
                      00060 ;BYTE active_protocol;   // [0] Boot Protocol [1] Report Protocol
                      00061 ;BYTE hid_rpt_rx_len;
                      00062 
                      00063 ;/** PRIVATE PROTOTYPES *********************************************/
                      00064 ;void HIDGetReportHandler(void);
                      00065 ;void HIDSetReportHandler(void);
                      00066 
                      00067 ;/** DECLARATIONS ***************************************************/
                      00068 ;#pragma code
                      00069 
                      00070 ;/** CLASS SPECIFIC REQUESTS ****************************************/
                      00071 ;/********************************************************************
                      00072 ; * Function:        void USBCheckHIDRequest(void)
                      00073 ; *
                      00074 ; * PreCondition:    None
                      00075 ; *
                      00076 ; * Input:           None
                      00077 ; *
                      00078 ; * Output:          None
                      00079 ; *
                      00080 ; * Side Effects:    None
                      00081 ; *
                      00082 ; * Overview:        This routine checks the setup data packet to see
                      00083 ; *                  if it knows how to handle it
                      00084 ; *
                      00085 ; * Note:            None
                      00086 ; *******************************************************************/
                      00087 ;//void USBCheckHIDRequest(void)
000858                00088 USBCheckHIDRequest
                      00089 ;//{
000858 0104           00090         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00091 ;//    if(SetupPkt.Recipient != RCPT_INTF) return;
00085A 512F           00092         movf    SetupPkt, W             ; Recipient = RCPT_INTF?
00085C 0B1F           00093         andlw   0x1f                    ; Mask to lower 5 bits
00085E 0801           00094         sublw   RCPT_INTF
000860 E105           00095         bnz     USBCheckHIDRequestExit  ; No
                      00096 ;//    if(SetupPkt.bIntfID != HID_DEV_INTF_ID) return;
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 88


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000862 0E01           00097         movlw HID_DEV_INTF_ID ; IntfID = HID_DEV_INTF_ID?
000864 5D33           00098         subwf SetupPkt + bIntfID, W
000866 E020           00099         bz      USBCheckHIDRequest3     ; Yes         
                      00100 ;//    if(SetupPkt.bIntfID != HID_INTF_ID) return;
000868 0E00           00101         movlw   HID_INTF_ID             ; IntfID = HID_INTF_ID?
00086A 6333           00102         cpfseq  SetupPkt + bIntfID
                      00103 
00086C                00104 USBCheckHIDRequestExit
00086C 0012           00105         return                          ; No
                      00106     
                      00107 ;    /*
                      00108 ;     * There are two standard requests that hid.c may support.
                      00109 ;     * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);
                      00110 ;     * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);
                      00111 ;     */
                      00112 ;//    if(SetupPkt.bRequest == GET_DSC)
00086E 0E06           00113         movlw   GET_DSC                 ; Request = GET_DSC?
000870 6330           00114         cpfseq  SetupPkt + bRequest
000872 D05C           00115         bra     USBCheckHIDRequestClass ; No
                      00116 ;//    {
                      00117 ;//        switch(SetupPkt.bDescriptorType)
                      00118 ;//        {
                      00119 ;//            case DSC_HID:           
000874 0E21           00120         movlw   DSC_HID                 ; DescriptorType = DSC_HID?
000876 6332           00121         cpfseq  SetupPkt + bDescriptorType
000878 D034           00122         bra     USBCheckHIDRequest1     ; No
                      00123 ;//                if(USBActiveConfiguration == 1)
00087A 0E01           00124         movlw   1                       ; USBActiveConfiguration = 1?
00087C 6320           00125         cpfseq  USBActiveConfiguration
00087E D056           00126         bra     USBCheckHIDRequestClass ; No
                      00127 ;//                {
                      00128 ;//                    USBEP0SendROMPtr(
                      00129 ;//                        (ROM BYTE*)&configDescriptor1 + 18,
                      00130 ;//                        sizeof(USB_HID_DSC)+3,     // RRoj hack
                      00131 ;//                        USB_EP0_INCLUDE_ZERO);
                      00132         mSetSourcePointer HIDDescriptor1
000880 0E94               M         movlw   low (HIDDescriptor1)
000882 6F1A               M         movwf   pSrc
000884 0E0A               M         movlw   high (HIDDescriptor1)
000886 6F1B               M         movwf   pSrc + 1
000888 0E00               M         movlw   upper (HIDDescriptor1)
00088A 6F1C               M         movwf   pSrc + 2
                      00133         mGetRomTableCount               ; Set wCount
00088C C41A FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
000890 C41B FFF7          M         movff   pSrc + 1, TBLPTRH
000894 C41C FFF8          M         movff   pSrc + 2, TBLPTRU
000898 0008               M         tblrd   *                       ; Read count
00089A CFF5 F424          M         movff   TABLAT, inCount
00089E 6B25               M         clrf    inCount + 1
                      00134 ;//     clrf    info
0008A0 912C           00135         bcf     info, ctrl_trf_mem      ; Indicate ROM
0008A2 8D2C           00136         bsf     info, includeZero       ; Include a trailing zero packet
0008A4 8F2C           00137         bsf     info, busy
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 89


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0008A6 D042           00138         bra     USBCheckHIDRequestClass
                      00139 
                      00140 ;//                }
                      00141 ;//                break;
0008A8                00142 USBCheckHIDRequest3
                      00143 ;    /*
                      00144 ;     * There are two standard requests that hid.c may support.
                      00145 ;     * 1. GET_DSC(DSC_HID,DSC_RPT,DSC_PHY);
                      00146 ;     * 2. SET_DSC(DSC_HID,DSC_RPT,DSC_PHY);
                      00147 ;     */
                      00148 ;//    if(SetupPkt.bRequest == GET_DSC)
0008A8 0E06           00149         movlw   GET_DSC                 ; Request = GET_DSC?
0008AA 6330           00150         cpfseq  SetupPkt + bRequest
0008AC D03F           00151         bra     USBCheckHIDRequestClass ; No
                      00152 ;//    {
                      00153 ;//        switch(SetupPkt.bDescriptorType)
                      00154 ;//        {
                      00155 ;//            case DSC_HID:           
0008AE 0E21           00156         movlw   DSC_HID                 ; DescriptorType = DSC_HID?
0008B0 6332           00157         cpfseq  SetupPkt + bDescriptorType
0008B2 D017           00158         bra     USBCheckHIDRequest1     ; No
                      00159 ;//                if(USBActiveConfiguration == 1)
0008B4 0E01           00160         movlw   1                       ; USBActiveConfiguration = 1?
0008B6 6320           00161         cpfseq  USBActiveConfiguration
0008B8 D039           00162         bra     USBCheckHIDRequestClass ; No
                      00163 ;//                {
                      00164 ;//                    USBEP0SendROMPtr(
                      00165 ;//                        (ROM BYTE*)&configDescriptor1 + 18,
                      00166 ;//                        sizeof(USB_HID_DSC)+3,     // RRoj hack
                      00167 ;//                        USB_EP0_INCLUDE_ZERO);
                      00168 
                      00169         mSetSourcePointer HIDDescriptor2
0008BA 0EC6               M         movlw   low (HIDDescriptor2)
0008BC 6F1A               M         movwf   pSrc
0008BE 0E0A               M         movlw   high (HIDDescriptor2)
0008C0 6F1B               M         movwf   pSrc + 1
0008C2 0E00               M         movlw   upper (HIDDescriptor2)
0008C4 6F1C               M         movwf   pSrc + 2
                      00170         mGetRomTableCount               ; Set wCount
0008C6 C41A FFF6          M         movff   pSrc, TBLPTRL           ; Set source address
0008CA C41B FFF7          M         movff   pSrc + 1, TBLPTRH
0008CE C41C FFF8          M         movff   pSrc + 2, TBLPTRU
0008D2 0008               M         tblrd   *                       ; Read count
0008D4 CFF5 F424          M         movff   TABLAT, inCount
0008D8 6B25               M         clrf    inCount + 1
                      00171 ;//     clrf    info
0008DA 912C           00172         bcf     info, ctrl_trf_mem      ; Indicate ROM
0008DC 8D2C           00173         bsf     info, includeZero       ; Include a trailing zero packet
0008DE 8F2C           00174         bsf     info, busy
0008E0 D025           00175         bra     USBCheckHIDRequestClass
                      00176 
0008E2                00177 USBCheckHIDRequest1
                      00178 ;            case DSC_RPT:
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 90


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00179 
0008E2 0E01           00180         movlw HID_DEV_INTF_ID ; IntfID = HID_DEV_INTF_ID?
0008E4 5D33           00181         subwf SetupPkt + bIntfID, W
0008E6 E05E           00182         bz      USBCheckHIDRequest4     ; Yes
                      00183 
0008E8 0E22           00184         movlw   DSC_RPT                 ; DescriptorType = DSC_RPT?
0008EA 6332           00185         cpfseq  SetupPkt + bDescriptorType
0008EC D01A           00186         bra     USBCheckHIDRequest2     ; No
                      00187 ;                if(USBActiveConfiguration == 1)
0008EE 0E01           00188         movlw   1                       ; USBActiveConfiguration = 1?
0008F0 6320           00189         cpfseq  USBActiveConfiguration
0008F2 D01C           00190         bra     USBCheckHIDRequestClass ; No
                      00191 ;                {
                      00192 ;                    USBEP0SendROMPtr(
                      00193 ;                        (ROM BYTE*)&hid_rpt01,
                      00194 ;                        sizeof(hid_rpt01),     //See usbcfg.h
                      00195 ;                        USB_EP0_INCLUDE_ZERO);
                      00196 
                      00197                 mSetSourcePointer ReportDescriptor1
0008F4 0EF4               M         movlw   low (ReportDescriptor1)
0008F6 6F1A               M         movwf   pSrc
0008F8 0E0A               M         movlw   high (ReportDescriptor1)
0008FA 6F1B               M         movwf   pSrc + 1
0008FC 0E00               M         movlw   upper (ReportDescriptor1)
0008FE 6F1C               M         movwf   pSrc + 2
000900 0EA2           00198                 movlw   low (ReportDescriptor1Len)      ; Set wCount
000902 6EF6           00199                 movwf   TBLPTRL
000904 0E0A           00200                 movlw   high (ReportDescriptor1Len)
000906 6EF7           00201                 movwf   TBLPTRH
000908 0E00           00202                 movlw   upper (ReportDescriptor1Len)
00090A 6EF8           00203                 movwf   TBLPTRU
00090C 0009           00204             tblrd   *+                  ; Read count low
00090E CFF5 F424      00205                 movff   TABLAT, inCount
000912 0009           00206             tblrd   *+                  ; Skip next
000914 0008           00207         tblrd   *                       ; Read count high
000916 CFF5 F425      00208                 movff   TABLAT, inCount + 1
                      00209 ;//     clrf    info
00091A 912C           00210                 bcf     info, ctrl_trf_mem      ; Indicate ROM
00091C 8D2C           00211                 bsf     info, includeZero       ; Include a trailing zero packet
00091E 8F2C           00212                 bsf     info, busy
000920 D005           00213                 bra     USBCheckHIDRequestClass
                      00214 ;//                }
                      00215 ;//                break;
000922                00216 USBCheckHIDRequest2
                      00217 ;//            case DSC_PHY:
000922 0E23           00218         movlw   DSC_PHY                 ; DescriptorType = DSC_PHY?
000924 6332           00219         cpfseq  SetupPkt + bDescriptorType
000926 D002           00220         bra     USBCheckHIDRequestClass
                      00221 ;                USBEP0Transmit(USB_EP0_NO_DATA);
000928 6B2C           00222         clrf    info
00092A 8F2C           00223         bsf     info, busy
                      00224 ;                break;
                      00225 ;        }//end switch(SetupPkt.bDescriptorType)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 91


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00226 ;    }//end if(SetupPkt.bRequest == GET_DSC)
                      00227     
00092C                00228 USBCheckHIDRequestClass
                      00229 ;    if(SetupPkt.RequestType != CLASS) return;
00092C 512F           00230         movf    SetupPkt, W             ; RequestType = CLASS?
00092E 0B60           00231         andlw   0x60                    ; Mask to proper bits
000930 0820           00232         sublw   (CLASS) << 5
000932 E19C           00233         bnz     USBCheckHIDRequestExit  ; No
                      00234 ;    switch(SetupPkt.bRequest)
                      00235 ;    {
                      00236 ;        case GET_REPORT:
000934 0E01           00237         movlw   GET_REPORT              ; Request = GET_REPORT?
000936 5D30           00238         subwf   SetupPkt + bRequest, W
                      00239 ;            HIDGetReportHandler();
000938 E033           00240         bz      HIDGetReportHandler     ; Yes
                      00241 ;            break;
                      00242 ;        case SET_REPORT:
00093A 0E09           00243         movlw   SET_REPORT              ; Request = SET_REPORT?
00093C 5D30           00244         subwf   SetupPkt + bRequest, W
                      00245 ;            HIDSetReportHandler();            
00093E E031           00246         bz      HIDSetReportHandler     ; Yes
                      00247 ;            break;
                      00248 ;        case GET_IDLE:
000940 0E02           00249         movlw   GET_IDLE                ; Request = GET_IDLE?
000942 6330           00250         cpfseq  SetupPkt + bRequest
000944 D00D           00251         bra     USBCheckHIDRequestClass1        ; No
                      00252 ;            USBEP0SendRAMPtr(
                      00253 ;                (BYTE*)&idle_rate,
                      00254 ;                1,
                      00255 ;                USB_EP0_INCLUDE_ZERO);
                      00256         mSetSourcePointer idle_rate
000946 0E3F               M         movlw   low (idle_rate)
000948 6F1A               M         movwf   pSrc
00094A 0E04               M         movlw   high (idle_rate)
00094C 6F1B               M         movwf   pSrc + 1
00094E 0E00               M         movlw   upper (idle_rate)
000950 6F1C               M         movwf   pSrc + 2
000952 0E01           00257         movlw   1
000954 6F24           00258         movwf   inCount
000956 6B25           00259         clrf    inCount + 1
                      00260 ;       clrf    info
000958 812C           00261         bsf     info, ctrl_trf_mem      ; Indicate RAM
00095A 8D2C           00262         bsf     info, includeZero       ; Include a trailing zero packet
00095C 8F2C           00263         bsf     info, busy
00095E 0012           00264         return
                      00265 ;            break;
000960                00266 USBCheckHIDRequestClass1
                      00267 ;        case SET_IDLE:
000960 0E0A           00268         movlw   SET_IDLE                ; Request = SET_IDLE?
000962 6330           00269         cpfseq  SetupPkt + bRequest
000964 D005           00270         bra     USBCheckHIDRequestClass2        ; No
                      00271 ;            USBEP0Transmit(USB_EP0_NO_DATA);
000966 6B2C           00272         clrf    info
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 92


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000968 8F2C           00273         bsf     info, busy
                      00274 ;            idle_rate = SetupPkt.W_Value.byte.HB;
00096A C432 F43F      00275         movff   SetupPkt + wValue + 1, idle_rate
00096E 0012           00276         return
                      00277 ;            break;
000970                00278 USBCheckHIDRequestClass2
                      00279 ;        case GET_PROTOCOL:
000970 0E03           00280         movlw   GET_PROTOCOL            ; Request = GET_PROTOCOL?
000972 6330           00281         cpfseq  SetupPkt + bRequest
000974 D00D           00282         bra     USBCheckHIDRequestClass3        ; No
                      00283 ;            USBEP0SendRAMPtr(
                      00284 ;                (BYTE*)&active_protocol,
                      00285 ;                1,
                      00286 ;                USB_EP0_NO_OPTIONS);
                      00287         mSetSourcePointer active_protocol
000976 0E40               M         movlw   low (active_protocol)
000978 6F1A               M         movwf   pSrc
00097A 0E04               M         movlw   high (active_protocol)
00097C 6F1B               M         movwf   pSrc + 1
00097E 0E00               M         movlw   upper (active_protocol)
000980 6F1C               M         movwf   pSrc + 2
000982 0E01           00288         movlw   1
000984 6F24           00289         movwf   inCount
000986 6B25           00290         clrf    inCount + 1
000988 6B2C           00291         clrf    info
00098A 812C           00292         bsf     info, ctrl_trf_mem      ; Indicate RAM
00098C 8F2C           00293         bsf     info, busy
00098E 0012           00294         return
                      00295 ;            break;
000990                00296 USBCheckHIDRequestClass3
                      00297 ;        case SET_PROTOCOL:
000990 0E0B           00298         movlw   SET_PROTOCOL            ; Request = SET_PROTOCOL?
000992 6330           00299         cpfseq  SetupPkt + bRequest
000994 0012           00300         return                          ; No
                      00301 ;            USBEP0Transmit(USB_EP0_NO_DATA);
000996 6B2C           00302         clrf    info
000998 8F2C           00303         bsf     info, busy
                      00304 ;            active_protocol = SetupPkt.W_Value.byte.LB;
00099A C431 F440      00305         movff   SetupPkt + wValue, active_protocol
                      00306 ;            break;
                      00307 ;    }//end switch(SetupPkt.bRequest)
00099E 0012           00308         return
                      00309 ;}//end USBCheckHIDRequest
                      00310 
                      00311 ;void HIDGetReportHandler(void)
0009A0                00312 HIDGetReportHandler
                      00313 ;{
0009A0 0012           00314         return
                      00315 ;}//end HIDGetReportHandler
                      00316 
                      00317 ;void HIDSetReportHandler(void)
0009A2                00318 HIDSetReportHandler
                      00319 ;{
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 93


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0009A2 0012           00320         return
                      00321 ;}//end HIDSetReportHandler
                      00322 
0009A4                00323 USBCheckHIDRequest4
                      00324 ;            case DSC_RPT:             
0009A4 0E22           00325         movlw   DSC_RPT                 ; DescriptorType = DSC_RPT?
0009A6 6332           00326         cpfseq  SetupPkt + bDescriptorType
0009A8 D7BC           00327         bra     USBCheckHIDRequest2     ; No
                      00328 ;                if(USBActiveConfiguration == 1)
0009AA 0E01           00329         movlw   1                       ; USBActiveConfiguration = 1?
0009AC 6320           00330         cpfseq  USBActiveConfiguration
0009AE D7BE           00331         bra     USBCheckHIDRequestClass ; No
                      00332 ;                {
                      00333 ;                    USBEP0SendROMPtr(
                      00334 ;                        (ROM BYTE*)&hid_rpt01,
                      00335 ;                        sizeof(hid_rpt01),     //See usbcfg.h
                      00336 ;                        USB_EP0_INCLUDE_ZERO);
                      00337 
                      00338 
                      00339                 mSetSourcePointer ReportDescriptor2
0009B0 0E70               M         movlw   low (ReportDescriptor2)
0009B2 6F1A               M         movwf   pSrc
0009B4 0E0C               M         movlw   high (ReportDescriptor2)
0009B6 6F1B               M         movwf   pSrc + 1
0009B8 0E00               M         movlw   upper (ReportDescriptor2)
0009BA 6F1C               M         movwf   pSrc + 2
0009BC 0EA2           00340                 movlw   low (ReportDescriptor1Len)      ; Set wCount
0009BE 6EF6           00341                 movwf   TBLPTRL
0009C0 0E0A           00342                 movlw   high (ReportDescriptor1Len)
0009C2 6EF7           00343                 movwf   TBLPTRH
0009C4 0E00           00344                 movlw   upper (ReportDescriptor1Len)
0009C6 6EF8           00345                 movwf   TBLPTRU
0009C8 0009           00346             tblrd   *+                  ; Read count low
0009CA CFF5 F424      00347                 movff   TABLAT, inCount
0009CE 0009           00348             tblrd   *+                  ; Skip next
0009D0 0008           00349             tblrd   *                   ; Read count high
0009D2 CFF5 F425      00350                 movff   TABLAT, inCount + 1
                      00351 ;//     clrf    info
0009D6 912C           00352                 bcf     info, ctrl_trf_mem      ; Indicate ROM
0009D8 8D2C           00353                 bsf     info, includeZero       ; Include a trailing zero packet
0009DA 8F2C           00354                 bsf     info, busy
0009DC D7A7           00355                 bra     USBCheckHIDRequestClass
                      00356 ;//                }
                      00357 ;//                break;
                      00358 
                      00359 ;/** USER API *******************************************************/
                      00360 
                      00361 ;/********************************************************************
                      00362 ; * Function:        void HIDInitEP(void)
                      00363 ; *
                      00364 ; * PreCondition:    None
                      00365 ; *
                      00366 ; * Input:           None
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 94


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00367 ; *
                      00368 ; * Output:          None
                      00369 ; *
                      00370 ; * Side Effects:    None
                      00371 ; *
                      00372 ; * Overview:        HIDInitEP initializes HID endpoints, buffer
                      00373 ; *                  descriptors, internal state-machine, and
                      00374 ; *                  variables. It should be called after the USB
                      00375 ; *                  host has sent out a SET_CONFIGURATION request.
                      00376 ; *                  See USBStdSetCfgHandler() in usbd.c for examples.
                      00377 ; *
                      00378 ; * Note:            None
                      00379 ; *******************************************************************/
                      00380 ;#if !defined(USB_DYNAMIC_EP_CONFIG)
                      00381 ;void HIDInitEP(void)
                      00382 ;{   
                      00383 ;}//end HIDInitEP
                      00384 ;#endif
                      00385 
                      00386 ;// ****************************************************************************************************
                            **
                      00387 ;// ************** USB Callback Functions **************************************************************
                            **
                      00388 ;// ****************************************************************************************************
                            **
                      00389 ;// The USB firmware stack will call the callback functions USBCBxxx() in response to certain USB relate
                            d
                      00390 ;// events.  For example, if the host PC is powering down, it will stop sending out Start of Frame (SOF)
                      00391 ;// packets to your device.  In response to this, all USB devices are supposed to decrease their power
                      00392 ;// consumption from the USB Vbus to <2.5mA each.  The USB module detects this condition (which accordin
                            g
                      00393 ;// to the USB specifications is 3+ms of no bus activity/SOF packets) and then calls the USBCBSuspend()
                      00394 ;// function.  You should modify these callback functions to take appropriate actions for each of these
                      00395 ;// conditions.  For example, in the USBCBSuspend(), you may wish to add code that will decrease power
                      00396 ;// consumption from Vbus to <2.5mA (such as by clock switching, turning off LEDs, putting the
                      00397 ;// microcontroller to sleep, etc.).  Then, in the USBCBWakeFromSuspend() function, you may then wish to
                      00398 ;// add code that undoes the power saving things done in the USBCBSuspend() function.
                      00399 
                      00400 ;// The USBCBSendResume() function is special, in that the USB stack will not automatically call this
                      00401 ;// function.  This function is meant to be called from the application firmware instead.  See the
                      00402 ;// additional comments near the function.
                      00403 
                      00404 ;/******************************************************************************
                      00405 ; * Function:        void USBCBSuspend(void)
                      00406 ; *
                      00407 ; * PreCondition:    None
                      00408 ; *
                      00409 ; * Input:           None
                      00410 ; *
                      00411 ; * Output:          None
                      00412 ; *
                      00413 ; * Side Effects:    None
                      00414 ; *
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 95


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00415 ; * Overview:        Call back that is invoked when a USB suspend is detected
                      00416 ; *
                      00417 ; * Note:            None
                      00418 ; *****************************************************************************/
                      00419 ;void USBCBSuspend(void)
0009DE                00420 USBCBSuspend
                      00421 ;{
                      00422 ;       //Example power saving code.  Insert appropriate code here for the desired
                      00423 ;       //application behavior.  If the microcontroller will be put to sleep, a
                      00424 ;       //process similar to that shown below may be used:
                      00425         
                      00426 ;       //ConfigureIOPinsForLowPower();
                      00427 ;       //SaveStateOfAllInterruptEnableBits();
                      00428 ;       //DisableAllInterruptEnableBits();
                      00429 ;       //EnableOnlyTheInterruptsWhichWillBeUsedToWakeTheMicro();       //should enable at least USBActi
                            vityIF as a wake source
                      00430 ;       //Sleep();
                      00431 ;       //RestoreStateOfAllPreviouslySavedInterruptEnableBits();        //Preferrably, this should be do
                            ne in the USBCBWakeFromSuspend() function instead.
                      00432 ;       //RestoreIOPinsToNormal();                                                                      
                            //Preferrably, this should be done in the USBCBWakeFromSuspend() function instead.
                      00433 
                      00434 ;       //IMPORTANT NOTE: Do not clear the USBActivityIF (ACTVIF) bit here.  This bit is 
                      00435 ;       //cleared inside the usb_device.c file.  Clearing USBActivityIF here will cause 
                      00436 ;       //things to not work as intended.       
                      00437         
                      00438 
                      00439 ;    #if defined(__C30__)
                      00440 ;    #if 0
                      00441 ;        U1EIR = 0xFFFF;
                      00442 ;        U1IR = 0xFFFF;
                      00443 ;        U1OTGIR = 0xFFFF;
                      00444 ;        IFS5bits.USB1IF = 0;
                      00445 ;        IEC5bits.USB1IE = 1;
                      00446 ;        U1OTGIEbits.ACTVIE = 1;
                      00447 ;        U1OTGIRbits.ACTVIF = 1;
                      00448 ;        TRISA &= 0xFF3F;
                      00449 ;        LATAbits.LATA6 = 1;
                      00450 ;        Sleep();
                      00451 ;        LATAbits.LATA6 = 0;
                      00452 ;    #endif
                      00453 ;    #endif
0009DE 0012           00454         return
                      00455 ;}
                      00456 
                      00457 
                      00458 ;/******************************************************************************
                      00459 ; * Function:        void _USB1Interrupt(void)
                      00460 ; *
                      00461 ; * PreCondition:    None
                      00462 ; *
                      00463 ; * Input:           None
                      00464 ; *
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 96


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00465 ; * Output:          None
                      00466 ; *
                      00467 ; * Side Effects:    None
                      00468 ; *
                      00469 ; * Overview:        This function is called when the USB interrupt bit is set
                      00470 ; *                                     In this example the interrupt is only used when the device
                      00471 ; *                                     goes to sleep when it receives a USB suspend command
                      00472 ; *
                      00473 ; * Note:            None
                      00474 ; *****************************************************************************/
                      00475 ;#if 0
                      00476 ;void __attribute__ ((interrupt)) _USB1Interrupt(void)
                      00477 ;{
                      00478 ;    #if !defined(self_powered)
                      00479 ;        if(U1OTGIRbits.ACTVIF)
                      00480 ;        {
                      00481 ;            LATAbits.LATA7 = 1;
                      00482 ;        
                      00483 ;            IEC5bits.USB1IE = 0;
                      00484 ;            U1OTGIEbits.ACTVIE = 0;
                      00485 ;            IFS5bits.USB1IF = 0;
                      00486 ;        
                      00487 ;            //USBClearInterruptFlag(USBActivityIFReg,USBActivityIFBitNum);
                      00488 ;            USBClearInterruptFlag(USBIdleIFReg,USBIdleIFBitNum);
                      00489 ;            //USBSuspendControl = 0;
                      00490 ;            LATAbits.LATA7 = 0;
                      00491 ;        }
                      00492 ;    #endif
                      00493 ;}
                      00494 ;#endif
                      00495 
                      00496 ;/******************************************************************************
                      00497 ; * Function:        void USBCBWakeFromSuspend(void)
                      00498 ; *
                      00499 ; * PreCondition:    None
                      00500 ; *
                      00501 ; * Input:           None
                      00502 ; *
                      00503 ; * Output:          None
                      00504 ; *
                      00505 ; * Side Effects:    None
                      00506 ; *
                      00507 ; * Overview:        The host may put USB peripheral devices in low power
                      00508 ; *                                     suspend mode (by "sending" 3+ms of idle).  Once in suspend
                      00509 ; *                                     mode, the host may wake the device back up by sending non-
                      00510 ; *                                     idle state signalling.
                      00511 ; *                                     
                      00512 ; *                                     This call back is invoked when a wakeup from USB suspend 
                      00513 ; *                                     is detected.
                      00514 ; *
                      00515 ; * Note:            None
                      00516 ; *****************************************************************************/
                      00517 ;void USBCBWakeFromSuspend(void)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 97


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0009E0                00518 USBCBWakeFromSuspend
                      00519 ;{
                      00520 ;       // If clock switching or other power savings measures were taken when
                      00521 ;       // executing the USBCBSuspend() function, now would be a good time to
                      00522 ;       // switch back to normal full power run mode conditions.  The host allows
                      00523 ;       // a few milliseconds of wakeup time, after which the device must be 
                      00524 ;       // fully back to normal, and capable of receiving and processing USB
                      00525 ;       // packets.  In order to do this, the USB module must receive proper
                      00526 ;       // clocking (IE: 48MHz clock must be available to SIE for full speed USB
                      00527 ;       // operation).
0009E0 0012           00528         return
                      00529 ;}
                      00530 
                      00531 ;/********************************************************************
                      00532 ; * Function:        void USBCB_SOF_Handler(void)
                      00533 ; *
                      00534 ; * PreCondition:    None
                      00535 ; *
                      00536 ; * Input:           None
                      00537 ; *
                      00538 ; * Output:          None
                      00539 ; *
                      00540 ; * Side Effects:    None
                      00541 ; *
                      00542 ; * Overview:        The USB host sends out a SOF packet to full-speed
                      00543 ; *                  devices every 1 ms. This interrupt may be useful
                      00544 ; *                  for isochronous pipes. End designers should
                      00545 ; *                  implement callback routine as necessary.
                      00546 ; *
                      00547 ; * Note:            None
                      00548 ; *******************************************************************/
                      00549 ;void USBCB_SOF_Handler(void)
0009E2                00550 USBCB_SOF_Handler
                      00551 ;{
                      00552 ;    // No need to clear UIRbits.SOFIF to 0 here.
                      00553 ;    // Callback caller is already doing that.
0009E2 0012           00554         return
                      00555 ;}
                      00556 
                      00557 ;/*******************************************************************
                      00558 ; * Function:        void USBCBErrorHandler(void)
                      00559 ; *
                      00560 ; * PreCondition:    None
                      00561 ; *
                      00562 ; * Input:           None
                      00563 ; *
                      00564 ; * Output:          None
                      00565 ; *
                      00566 ; * Side Effects:    None
                      00567 ; *
                      00568 ; * Overview:        The purpose of this callback is mainly for
                      00569 ; *                  debugging during development. Check UEIR to see
                      00570 ; *                  which error causes the interrupt.
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 98


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00571 ; *
                      00572 ; * Note:            None
                      00573 ; *******************************************************************/
                      00574 ;void USBCBErrorHandler(void)
0009E4                00575 USBCBErrorHandler
                      00576 ;{
                      00577 ;    // No need to clear UEIR to 0 here.
                      00578 ;    // Callback caller is already doing that.
                      00579 
                      00580 ;       // Typically, user firmware does not need to do anything special
                      00581 ;       // if a USB error occurs.  For example, if the host sends an OUT
                      00582 ;       // packet to your device, but the packet gets corrupted (ex:
                      00583 ;       // because of a bad connection, or the user unplugs the
                      00584 ;       // USB cable during the transmission) this will typically set
                      00585 ;       // one or more USB error interrupt flags.  Nothing specific
                      00586 ;       // needs to be done however, since the SIE will automatically
                      00587 ;       // send a "NAK" packet to the host.  In response to this, the
                      00588 ;       // host will normally retry to send the packet again, and no
                      00589 ;       // data loss occurs.  The system will typically recover
                      00590 ;       // automatically, without the need for application firmware
                      00591 ;       // intervention.
                      00592         
                      00593 ;       // Nevertheless, this callback function is provided, such as
                      00594 ;       // for debugging purposes.
0009E4 0012           00595         return
                      00596 ;}
                      00597 
                      00598 
                      00599 ;/*******************************************************************
                      00600 ; * Function:        void USBCBCheckOtherReq(void)
                      00601 ; *
                      00602 ; * PreCondition:    None
                      00603 ; *
                      00604 ; * Input:           None
                      00605 ; *
                      00606 ; * Output:          None
                      00607 ; *
                      00608 ; * Side Effects:    None
                      00609 ; *
                      00610 ; * Overview:        When SETUP packets arrive from the host, some
                      00611 ; *                                     firmware must process the request and respond
                      00612 ; *                                     appropriately to fulfill the request.  Some of
                      00613 ; *                                     the SETUP packets will be for standard
                      00614 ; *                                     USB "chapter 9" (as in, fulfilling chapter 9 of
                      00615 ; *                                     the official USB specifications) requests, while
                      00616 ; *                                     others may be specific to the USB device class
                      00617 ; *                                     that is being implemented.  For example, a HID
                      00618 ; *                                     class device needs to be able to respond to
                      00619 ; *                                     "GET REPORT" type of requests.  This
                      00620 ; *                                     is not a standard USB chapter 9 request, and 
                      00621 ; *                                     therefore not handled by usb_device.c.  Instead
                      00622 ; *                                     this request should be handled by class specific 
                      00623 ; *                                     firmware, such as that contained in usb_function_hid.c.
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 99


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00624 ; *
                      00625 ; * Note:            None
                      00626 ; *****************************************************************************/
                      00627 ;void USBCBCheckOtherReq(void)
0009E6                00628 USBCBCheckOtherReq
                      00629 ;{
                      00630 ;    USBCheckHIDRequest();
0009E6 D738           00631         bra     USBCheckHIDRequest
                      00632 ;}//end
                      00633 
                      00634 
                      00635 ;/*******************************************************************
                      00636 ; * Function:        void USBCBStdSetDscHandler(void)
                      00637 ; *
                      00638 ; * PreCondition:    None
                      00639 ; *
                      00640 ; * Input:           None
                      00641 ; *
                      00642 ; * Output:          None
                      00643 ; *
                      00644 ; * Side Effects:    None
                      00645 ; *
                      00646 ; * Overview:        The USBCBStdSetDscHandler() callback function is
                      00647 ; *                                     called when a SETUP, bRequest: SET_DESCRIPTOR request
                      00648 ; *                                     arrives.  Typically SET_DESCRIPTOR requests are
                      00649 ; *                                     not used in most applications, and it is
                      00650 ; *                                     optional to support this type of request.
                      00651 ; *
                      00652 ; * Note:            None
                      00653 ; *****************************************************************************/
                      00654 ;void USBCBStdSetDscHandler(void)
0009E8                00655 USBCBStdSetDscHandler
                      00656 ;{
                      00657 ;    // Must claim session ownership if supporting this request
0009E8 0012           00658         return
                      00659 ;}//end
                      00660 
                      00661 
                      00662 ;/******************************************************************************
                      00663 ; * Function:        void USBCBInitEP(void)
                      00664 ; *
                      00665 ; * PreCondition:    None
                      00666 ; *
                      00667 ; * Input:           None
                      00668 ; *
                      00669 ; * Output:          None
                      00670 ; *
                      00671 ; * Side Effects:    None
                      00672 ; *
                      00673 ; * Overview:        This function is called when the device becomes
                      00674 ; *                  initialized, which occurs after the host sends a
                      00675 ; *                                     SET_CONFIGURATION (wValue not = 0) request.  This 
                      00676 ; *                                     callback function should initialize the endpoints 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 100


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00677 ; *                                     for the device's usage according to the current 
                      00678 ; *                                     configuration.
                      00679 ; *
                      00680 ; * Note:            None
                      00681 ; *****************************************************************************/
                      00682 ;void USBCBInitEP(void)
0009EA                00683 USBCBInitEP
                      00684 ;{
                      00685 ; Enable the HID endpoint
                      00686 ;    USBEnableEndpoint(HID_EP,USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP);
                      00687 ; Enable and configure OUT endpoint
0009EA 0104           00688         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0009EC 0E01           00689         movlw   HID_EP
0009EE 6EE9           00690         movwf   FSR0L                   ; Endpoint number
0009F0 0E1E           00691         movlw   USB_OUT_ENABLED|USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP
0009F2 6F18           00692         movwf   usb_temp                ; Options
0009F4 EE14 F041      00693         lfsr    1, hid_report_out       ; Endpoint buffer
0009F8 0E10           00694         movlw   HID_INT_OUT_EP_SIZE     ; Endpoint size
0009FA DEAF           00695         rcall   USBEnableEndpointOut
                      00696 
                      00697 ; Enable and configure IN endpoint
0009FC 0104           00698         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
0009FE 0E01           00699         movlw   HID_EP
000A00 6EE9           00700         movwf   FSR0L                   ; Endpoint number
000A02 0E1E           00701         movlw   USB_OUT_ENABLED|USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP
000A04 6F18           00702         movwf   usb_temp                ; Options
000A06 EE14 F052      00703         lfsr    1, hid_report_in        ; Endpoint buffer
000A0A 0E10           00704         movlw   HID_INT_IN_EP_SIZE      ; Endpoint size
000A0C DEC0           00705         rcall   USBEnableEndpointIn
                      00706 
                      00707 ;    USBEnableEndpoint(HID_DEV_EP,USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP);
                      00708 ; Enable and configure OUT endpoint
000A0E 0104           00709         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
000A10 0E02           00710         movlw   HID_DEV_EP
000A12 6EE9           00711         movwf   FSR0L                   ; Endpoint number
000A14 0E1E           00712         movlw   USB_OUT_ENABLED|USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP
000A16 6F18           00713         movwf   usb_temp                ; Options
000A18 EE14 F063      00714         lfsr    1, hid_dev_report_out   ; Endpoint buffer
000A1C 0E10           00715         movlw   HID_DEV_INT_OUT_EP_SIZE ; Endpoint size
000A1E DE9D           00716         rcall   USBEnableEndpointOut
                      00717 
                      00718 ; Enable and configure IN endpoint
000A20 0104           00719         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
000A22 0E02           00720         movlw   HID_DEV_EP
000A24 6EE9           00721         movwf   FSR0L                   ; Endpoint number
000A26 0E1E           00722         movlw   USB_OUT_ENABLED|USB_IN_ENABLED|USB_HANDSHAKE_ENABLED|USB_DISALLOW_SETUP
000A28 6F18           00723         movwf   usb_temp                ; Options
000A2A EE14 F074      00724         lfsr    1, hid_dev_report_in    ; Endpoint buffer
000A2E 0E10           00725         movlw   HID_DEV_INT_IN_EP_SIZE  ; Endpoint size
000A30 D6AE           00726         bra     USBEnableEndpointIn
                      00727 ;}
                      00728 
                      00729 ;/********************************************************************
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 101


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00730 ; * Function:        void USBCBSendResume(void)
                      00731 ; *
                      00732 ; * PreCondition:    None
                      00733 ; *
                      00734 ; * Input:           None
                      00735 ; *
                      00736 ; * Output:          None
                      00737 ; *
                      00738 ; * Side Effects:    None
                      00739 ; *
                      00740 ; * Overview:        The USB specifications allow some types of USB
                      00741 ; *                                     peripheral devices to wake up a host PC (such
                      00742 ; *                                     as if it is in a low power suspend to RAM state).
                      00743 ; *                                     This can be a very useful feature in some
                      00744 ; *                                     USB applications, such as an Infrared remote
                      00745 ; *                                     control receiver.  If a user presses the "power"
                      00746 ; *                                     button on a remote control, it is nice that the
                      00747 ; *                                     IR receiver can detect this signalling, and then
                      00748 ; *                                     send a USB "command" to the PC to wake up.
                      00749 ; *                                     
                      00750 ; *                                     The USBCBSendResume() "callback" function is used
                      00751 ; *                                     to send this special USB signalling which wakes 
                      00752 ; *                                     up the PC.  This function may be called by
                      00753 ; *                                     application firmware to wake up the PC.  This
                      00754 ; *                                     function should only be called when:
                      00755 ; *                                     
                      00756 ; *                                     1.  The USB driver used on the host PC supports
                      00757 ; *                                             the remote wakeup capability.
                      00758 ; *                                     2.  The USB configuration descriptor indicates
                      00759 ; *                                             the device is remote wakeup capable in the
                      00760 ; *                                             bmAttributes field.
                      00761 ; *                                     3.  The USB host PC is currently sleeping,
                      00762 ; *                                             and has previously sent your device a SET 
                      00763 ; *                                             FEATURE setup packet which "armed" the
                      00764 ; *                                             remote wakeup capability.   
                      00765 ; *
                      00766 ; *                                     This callback should send a RESUME signal that
                      00767 ; *                  has the period of 1-15ms.
                      00768 ; *
                      00769 ; * Note:            Interrupt vs. Polling
                      00770 ; *                  -Primary clock
                      00771 ; *                  -Secondary clock ***** MAKE NOTES ABOUT THIS *******
                      00772 ; *                   > Can switch to primary first by calling USBCBWakeFromSuspend()
                      00773  
                      00774 ; *                  The modifiable section in this routine should be changed
                      00775 ; *                  to meet the application needs. Current implementation
                      00776 ; *                  temporary blocks other functions from executing for a
                      00777 ; *                  period of 1-13 ms depending on the core frequency.
                      00778 ; *
                      00779 ; *                  According to USB 2.0 specification section 7.1.7.7,
                      00780 ; *                  "The remote wakeup device must hold the resume signaling
                      00781 ; *                  for at lest 1 ms but for no more than 15 ms."
                      00782 ; *                  The idea here is to use a delay counter loop, using a
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 102


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00783 ; *                  common value that would work over a wide range of core
                      00784 ; *                  frequencies.
                      00785 ; *                  That value selected is 1800. See table below:
                      00786 ; *                  ==========================================================
                      00787 ; *                  Core Freq(MHz)      MIP         RESUME Signal Period (ms)
                      00788 ; *                  ==========================================================
                      00789 ; *                      48              12          1.05
                      00790 ; *                       4              1           12.6
                      00791 ; *                  ==========================================================
                      00792 ; *                  * These timing could be incorrect when using code
                      00793 ; *                    optimization or extended instruction mode,
                      00794 ; *                    or when having other interrupts enabled.
                      00795 ; *                    Make sure to verify using the MPLAB SIM's Stopwatch
                      00796 ; *                    and verify the actual signal on an oscilloscope.
                      00797 ; *******************************************************************/
                      00798 ;void USBCBSendResume(void)
000A32                00799 USBCBSendResume
                      00800 ;{
000A32 0104           00801         movlb   high _USBMEMORYADDRESS  ; Point to proper bank
                      00802 ;    static WORD delay_count;
                      00803     
                      00804 ;    USBResumeControl = 1;                // Start RESUME signaling
000A34 846D           00805         bsf     UCON, RESUME            ; Start RESUME signaling
                      00806     
                      00807 ;    delay_count = 1800U;                // Set RESUME line for 1-13 ms
                      00808 ;    do
                      00809 ;    {
                      00810 ;        delay_count--;
                      00811 ;    }while(delay_count);
000A36 0E10           00812         movlw   0x10                    ; Set RESUME line for 1-13 ms
000A38 6EDA           00813         movwf   FSR2H                   ; Using FSR2 as temp
000A3A 6AD9           00814         clrf    FSR2L
000A3C                00815 USBCBSendResumeLoop
000A3C 2ED9           00816         decfsz  FSR2L, F
000A3E D7FE           00817         bra     USBCBSendResumeLoop
000A40 2EDA           00818         decfsz  FSR2H, F
000A42 D7FC           00819         bra     USBCBSendResumeLoop
                      00820 ;    USBResumeControl = 0;
000A44 946D           00821         bcf     UCON, RESUME
000A46 0012           00822         return
                      00823 ;}
                      00824 
                      00825 ;/** EOF hid.c ******************************************************/
                      00426 
                      00427 ; ******************************************************************
                      00428 ; This table is polled by the host immediately after USB Reset has been released.
                      00429 ; This table defines the maximum packet size EP0 can take.
                      00430 ; See section 9.6.1 of the Rev 1.0 USB specification.
                      00431 ; These fields are application DEPENDENT. Modify these to meet
                      00432 ; your specifications.
                      00433 ; ******************************************************************
000A48                00434 DeviceDescriptor
000A48 0C12           00435         retlw   (EndDeviceDescriptor-DeviceDescriptor)/2        ; bLength Length of this descriptor
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 103


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000A4A 0C01           00436         retlw   USB_DESCRIPTOR_DEVICE ; bDescType This is a DEVICE descriptor
000A4C 0C00           00437         retlw   0x00            ; bcdUSBUSB Revision 1.10 (low byte)
000A4E 0C02           00438         retlw   0x02            ; high byte
000A50 0C00           00439         retlw   0x00            ; bDeviceClass zero means each interface operates independently
000A52 0C00           00440         retlw   0x00            ; bDeviceSubClass
000A54 0C00           00441         retlw   0x00            ; bDeviceProtocol
000A56 0C08           00442         retlw   USB_EP0_BUFF_SIZE ; bMaxPacketSize for EP0
                      00443 
                      00444         ; idVendor (low byte, high byte)
000A58 0C32           00445         retlw   0x32
000A5A 0C15           00446         retlw   0x15
                      00447 
                      00448         ; idProduct (low byte, high byte)
000A5C 0C07           00449         retlw   0x07
000A5E 0C10           00450         retlw   0x10
                      00451 
000A60 0C00           00452     retlw       0x00          ; bcdDevice (low byte)
000A62 0C01           00453         retlw   0x01         ; (high byte)
000A64 0C01           00454         retlw   0x01         ; iManufacturer (string index)
000A66 0C02           00455         retlw   0x02         ; iProduct      (string index) 
000A68 0C03           00456         retlw   0x03         ; iSerialNumber (string index)
000A6A 0C01           00457         retlw   NUM_CONFIGURATIONS ; bNumConfigurations
000A6C                00458 EndDeviceDescriptor
                      00459 
                      00460 ; ******************************************************************
                      00461 ; This table is retrieved by the host after the address has been set.
                      00462 ; This table defines the configurations available for the device.
                      00463 ; See section 9.6.2 of the Rev 1.0 USB specification (page 184).
                      00464 ; These fields are application DEPENDENT. 
                      00465 ; Modify these to meet your specifications.
                      00466 ; ******************************************************************
                      00467 ; Configuration pointer table
000A6C                00468 USB_CD_Ptr
000A6C                00469 Configs
000A6C 0A70           00470         db      low Config1, high Config1
000A6E 0000           00471         db      upper Config1, 0
                      00472 
                      00473 ; Configuration Descriptor
000A70                00474 Config1
000A70 0C09           00475         retlw   (Interface1-Config1)/2  ; bLength Length of this descriptor
000A72 0C02           00476         retlw   USB_DESCRIPTOR_CONFIGURATION ; bDescType 2=CONFIGURATION
000A74                00477 Config1Len
000A74 0C42           00478         retlw   low ((EndConfig1 - Config1)/2)  ; Length of this configuration
000A76 0C00           00479         retlw   high ((EndConfig1 - Config1)/2)
000A78 0C02           00480         retlw   NUM_INTERFACES          ; bNumInterfaces Number of interfaces
000A7A 0C01           00481         retlw   0x01            ; bConfigValue Configuration Value
000A7C 0C00           00482         retlw   0x00            ; iConfig (string index)
000A7E 0CC0           00483         retlw   _DEFAULT|_SELF  ; bmAttributes attributes - bus powered  
000A80 0C32           00484         retlw   0x32     ; Max power consumption (2X mA)
000A82                00485 Interface1
000A82 0C09           00486         retlw   (HIDDescriptor1-Interface1)/2   ; length of descriptor
000A84 0C04           00487         retlw   USB_DESCRIPTOR_INTERFACE
000A86 0C00           00488         retlw   0x00            ; number of interface, 0 based array
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 104


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000A88 0C00           00489         retlw   0x00            ; alternate setting
000A8A 0C01           00490         retlw   0x01            ; number of endpoints used in this interface
000A8C 0C03           00491         retlw   0x03            ; interface class - assigned by the USB
000A8E 0C00           00492         retlw   0x00            ; boot device
000A90 0C00           00493         retlw   0x00            ; interface protocol
000A92 0C02           00494         retlw   0x02            ; index to string descriptor that describes this interface
000A94                00495 HIDDescriptor1
000A94 0C09           00496         retlw   (Endpoint1In-HIDDescriptor1)/2  ; descriptor size (9 bytes)
000A96 0C21           00497     retlw       DSC_HID         ; descriptor type (HID)
000A98 0C11           00498         retlw   0x11            ; HID class release number (1.11)
000A9A 0C01           00499         retlw   0x01
000A9C 0C00           00500     retlw       0x00            ; Localized country code (none)
000A9E 0C01           00501     retlw       0x01            ; # of HID class descriptor to follow (1)
000AA0 0C22           00502     retlw       0x22            ; Report descriptor type (HID)
000AA2                00503 ReportDescriptor1Len
000AA2 0CBE           00504         retlw   low ((EndReportDescriptor1-ReportDescriptor1)/2)
000AA4 0C00           00505         retlw   high ((EndReportDescriptor1-ReportDescriptor1)/2)
000AA6                00506 Endpoint1In
000AA6 0C07           00507         retlw   (Interface2-Endpoint1In)/2      ; length of descriptor
000AA8 0C05           00508         retlw   USB_DESCRIPTOR_ENDPOINT
000AAA 0C81           00509         retlw   HID_EP|_EP_IN           ; EP1, In
000AAC 0C03           00510         retlw   _INT            ; Interrupt
000AAE 0C10           00511         retlw   low (HID_INT_IN_EP_SIZE)                ; This should be the size of the endpoint buffer
000AB0 0C00           00512         retlw   high (HID_INT_IN_EP_SIZE)
000AB2 0C01           00513         retlw   0x01                        ; Polling interval
                      00514 ;EndPoint1Out
                      00515 ;       retlw   (Interface2-EndPoint1Out)/2     ; Length of this Endpoint Descriptor
                      00516 ;       retlw   USB_DESCRIPTOR_ENDPOINT         ; bDescriptorType = 5 for Endpoint Descriptor
                      00517 ;       retlw   HID_EP|_EP_OUT          ; Endpoint number & direction
                      00518 ;       retlw   _INT            ; Transfer type supported by this Endpoint
                      00519 ;       retlw   low (HID_INT_OUT_EP_SIZE)               ; This should be the size of the endpoint buffer
                      00520 ;       retlw   high (HID_INT_OUT_EP_SIZE)
                      00521 ;       retlw   0x01                        ; Polling interval
000AB4                00522 Interface2
000AB4 0C09           00523     retlw   (HIDDescriptor2-Interface2)/2   ; length of descriptor
000AB6 0C04           00524     retlw   USB_DESCRIPTOR_INTERFACE        ; INTERFACE descriptor type
000AB8 0C01           00525     retlw   0x01        ; number of interface, 0 based array
000ABA 0C00           00526     retlw   0x00        ; alternate setting
000ABC 0C02           00527     retlw   0x02        ; number of endpoints used in this interface
000ABE 0C03           00528     retlw   0x03        ; interface class - assigned by the USB
000AC0 0C00           00529     retlw   0x00        ; boot device
000AC2 0C00           00530     retlw   0x00        ; interface protocol
000AC4 0C04           00531     retlw   0x04        ; index to string descriptor that describes this interface
000AC6                00532 HIDDescriptor2
000AC6 0C09           00533     retlw   (Endpoint2In-HIDDescriptor2)/2  ; descriptor size (9 bytes)
000AC8 0C21           00534     retlw   DSC_HID     ; descriptor type (HID)
000ACA 0C11           00535     retlw   0x11        ; HID class release number (1.11)
000ACC 0C01           00536     retlw   0x01
000ACE 0C00           00537     retlw   0x00        ; Localized country code (none)
000AD0 0C01           00538     retlw   0x01        ; # of HID class descriptor to follow (1)
000AD2 0C22           00539     retlw   0x22        ; Report descriptor type (HID)
000AD4                00540 ReportDescriptor2Len
000AD4 0C74           00541     retlw   low ((EndReportDescriptor2-ReportDescriptor2)/2)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 105


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000AD6 0C00           00542     retlw   high ((EndReportDescriptor2-ReportDescriptor2)/2)
000AD8                00543 Endpoint2In
000AD8 0C07           00544     retlw   (EndPoint2Out-Endpoint2In)/2    ; length of descriptor
000ADA 0C05           00545     retlw   USB_DESCRIPTOR_ENDPOINT
000ADC 0C82           00546     retlw   HID_DEV_EP|_EP02_IN       ; EP2, In
000ADE 0C03           00547     retlw   _INT        ; Interrupt
000AE0 0C10           00548     retlw   low (HID_DEV_INT_IN_EP_SIZE)        ; This should be the size of the endpoint buffer
000AE2 0C00           00549     retlw   high (HID_DEV_INT_IN_EP_SIZE)
000AE4 0C01           00550     retlw   0x01                        ; Polling interval
000AE6                00551 EndPoint2Out
000AE6 0C07           00552     retlw   (EndConfig1-EndPoint2Out)/2 ; Length of this Endpoint Descriptor
000AE8 0C05           00553     retlw   USB_DESCRIPTOR_ENDPOINT     ; bDescriptorType = 5 for Endpoint Descriptor
000AEA 0C02           00554     retlw   HID_DEV_EP|_EP02_OUT      ; Endpoint number & direction
000AEC 0C03           00555     retlw   _INT        ; Transfer type supported by this Endpoint
000AEE 0C10           00556     retlw   low (HID_DEV_INT_OUT_EP_SIZE)       ; This should be the size of the endpoint buffer
000AF0 0C00           00557     retlw   high (HID_DEV_INT_OUT_EP_SIZE)
000AF2 0C01           00558     retlw   0x01                        ; Polling interval
000AF4                00559 EndConfig1
                      00560 
000AF4                00561 ReportDescriptor1
000AF4 0C05           00562     retlw   0x05 ; USAGE_PAGE (generic desktop Choose the usage page "mouse" is on      
000AF6 0C01           00563     retlw   0x01 ; LOW
                      00564     
000AF8 0C09           00565     retlw   0x09 ; USAGE Device is a Gamepad        
000AFA 0C05           00566     retlw   0x05 ; LOW
                      00567     
000AFC 0CA1           00568     retlw   0xA1 ; COLLECTION (APPLICATION)     
000AFE 0C01           00569     retlw   0x01 ; LOW
                      00570     
000B00 0C85           00571     retlw   0x85 ; REPORT_ID (1 Pad1)
000B02 0C01           00572     retlw   0x01 ; LOW
                      00573     
000B04 0CA1           00574     retlw   0xA1 ; Colection Physycal       
000B06 0C00           00575     retlw   0x00 ; LOW
                      00576     
000B08 0C09           00577     retlw   0x09 ; usage x      
000B0A 0C30           00578     retlw   0x30 ;
                      00579     
000B0C 0C09           00580     retlw   0x09 ; usage y      
000B0E 0C31           00581     retlw   0x31 ;
                      00582         
000B10 0C15           00583     retlw   0x15 ; logical minimun 0
000B12 0C00           00584     retlw   0x00 ;
                      00585     
000B14 0C26           00586     retlw   0x26 ; logical maximun -1
000B16 0CFF           00587     retlw   0xFF ;
000B18 0CFF           00588     retlw   0xFF ;
                      00589     
000B1A 0C35           00590     retlw   0x35 ; Physical Minimum (0)
000B1C 0C00           00591     retlw   0x00 ;
                      00592     
000B1E 0C46           00593     retlw   0x46 ; Physical Maximum (-1)
000B20 0CFF           00594     retlw   0xFF ;
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 106


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B22 0CFF           00595     retlw   0xFF ;
                      00596     
000B24 0C95           00597     retlw   0x95 ; REPORT_COUNT 2       
000B26 0C02           00598     retlw   0x02 ;
                      00599     
000B28 0C75           00600     retlw   0x75 ; report size 16       
000B2A 0C10           00601     retlw   0x10 ;
                      00602     
000B2C 0C81           00603     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)   
000B2E 0C02           00604     retlw   0x02 ;
                      00605     
000B30 0CC0           00606     retlw   0xC0 ; END_COLLECTION
                      00607 ;******************************************
                      00608     
000B32 0CA1           00609     retlw   0xA1 ; Colection Physycal       
000B34 0C00           00610     retlw   0x00 ; LOW
                      00611     
000B36 0C09           00612     retlw   0x09 ; usage Rx     
000B38 0C33           00613     retlw   0x33 ;
                      00614     
000B3A 0C09           00615     retlw   0x09 ; usage Ry     
000B3C 0C34           00616     retlw   0x34 ;
                      00617         
000B3E 0C15           00618     retlw   0x15 ; logical minimun 0
000B40 0C00           00619     retlw   0x00 ;
                      00620     
000B42 0C26           00621     retlw   0x26 ; logical maximun (-1)
000B44 0CFF           00622     retlw   0xFF ;
000B46 0CFF           00623     retlw   0xFF ;
                      00624     
000B48 0C35           00625     retlw   0x35 ; Physical Minimum (0)
000B4A 0C00           00626     retlw   0x00 ;
                      00627     
000B4C 0C46           00628     retlw   0x46 ; Physical Maximum (-1)
000B4E 0CFF           00629     retlw   0xFF ;
000B50 0CFF           00630     retlw   0xFF ;
                      00631     
000B52 0C95           00632     retlw   0x95 ; REPORT_COUNT 2       
000B54 0C02           00633     retlw   0x02 ;
                      00634     
000B56 0C75           00635     retlw   0x75 ; report size 16       
000B58 0C10           00636     retlw   0x10 ;
                      00637     
000B5A 0C81           00638     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)   
000B5C 0C02           00639     retlw   0x02 ;
                      00640     
000B5E 0CC0           00641     retlw   0xC0 ; END_COLLECTION
                      00642 ;******************************************
                      00643 
000B60 0C05           00644     retlw   0x05 ; USAGE_PAGE (Button)      
000B62 0C09           00645     retlw   0x09 ; low
                      00646     
000B64 0C19           00647     retlw   0x19 ; Usage Minimum (Button 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 107


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000B66 0C01           00648     retlw   0x01 ;
                      00649     
000B68 0C29           00650     retlw   0x29 ; Usage Maximum (Button 9)
000B6A 0C09           00651     retlw   0x09 ;
                      00652     
000B6C 0C95           00653     retlw   0x95 ; report count 9      
000B6E 0C09           00654     retlw   0x09 ;
                      00655     
000B70 0C75           00656     retlw   0x75 ; report size 1        
000B72 0C01           00657     retlw   0x01 ;
                      00658     
000B74 0C81           00659     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)     
000B76 0C02           00660     retlw   0x02 ;
                      00661     
000B78 0C05           00662     retlw   0x05 ; Usage Page (Generic Desktop)
000B7A 0C01           00663     retlw   0x01 ;
                      00664     
000B7C 0C09           00665     retlw   0x09 ; Usage (Hat Switch)
000B7E 0C39           00666     retlw   0x39 ;
                      00667     
000B80 0C15           00668     retlw   0x15 ;  Logical Minimum (1)
000B82 0C01           00669     retlw   0x01 ;
                      00670     
000B84 0C25           00671     retlw   0x25 ; Logical Maximum (8)
000B86 0C08           00672     retlw   0x08 ;
                      00673     
000B88 0C35           00674     retlw   0x35 ; Physical Minimum (0)
000B8A 0C00           00675     retlw   0x00 ;
                      00676     
000B8C 0C46           00677     retlw   0x46 ; Physical Maximum (4155)
000B8E 0C3B           00678     retlw   0x3B ;
000B90 0C10           00679     retlw   0x10 ;
                      00680     
000B92 0C66           00681     retlw   0x66 ; Unit (None)
000B94 0C0E           00682     retlw   0x0E ;
000B96 0C00           00683     retlw   0x00 ;
                      00684     
000B98 0C75           00685     retlw   0x75 ; report size 4
000B9A 0C04           00686     retlw   0x04 ;
                      00687     
000B9C 0C95           00688     retlw   0x95 ; report count 1
000B9E 0C01           00689     retlw   0x01 ;
                      00690     
000BA0 0C81           00691     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,Null,Bit)
000BA2 0C42           00692     retlw   0x42 ; LOW
                      00693     
000BA4 0C75           00694     retlw   0x75 ; report size 3
000BA6 0C03           00695     retlw   0x03 ;
                      00696     
000BA8 0C95           00697     retlw   0x95 ; report count 1
000BAA 0C01           00698     retlw   0x01 ;
                      00699     
000BAC 0C81           00700     retlw   0x81 ; (Cnst,Var,Abs,NWrp,Lin,Pref,NNul,Bit)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 108


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000BAE 0C03           00701     retlw   0x03 ; LOW
                      00702     
000BB0 0CC0           00703     retlw   0xC0 ; END_COLLECTION
                      00704 
                      00705 ;***********************************************************************
                      00706 ;*                       GamePAD 2                                     *
                      00707 ;***********************************************************************
                      00708 
000BB2 0C05           00709     retlw   0x05 ; USAGE_PAGE (generic desktop Choose the usage page "mouse" is on      
000BB4 0C01           00710     retlw   0x01 ; LOW
                      00711     
000BB6 0C09           00712     retlw   0x09 ; USAGE Device is a Gamepad        
000BB8 0C05           00713     retlw   0x05 ; LOW
                      00714     
000BBA 0CA1           00715     retlw   0xA1 ; COLLECTION (APPLICATION)     
000BBC 0C01           00716     retlw   0x01 ; LOW
                      00717     
000BBE 0C85           00718     retlw   0x85 ; REPORT_ID (2 Pad2)
000BC0 0C02           00719     retlw   0x02 ; LOW
                      00720     
000BC2 0CA1           00721     retlw   0xA1 ; Colection Physycal       
000BC4 0C00           00722     retlw   0x00 ; LOW
                      00723     
000BC6 0C09           00724     retlw   0x09 ; usage x      
000BC8 0C30           00725     retlw   0x30 ;
                      00726     
000BCA 0C09           00727     retlw   0x09 ; usage y      
000BCC 0C31           00728     retlw   0x31 ;
                      00729         
000BCE 0C15           00730     retlw   0x15 ; logical minimun 0
000BD0 0C00           00731     retlw   0x00 ;
                      00732     
000BD2 0C26           00733     retlw   0x26 ; logical maximun -1
000BD4 0CFF           00734     retlw   0xFF ;
000BD6 0CFF           00735     retlw   0xFF ;
                      00736     
000BD8 0C35           00737     retlw   0x35 ; Physical Minimum (0)
000BDA 0C00           00738     retlw   0x00 ;
                      00739     
000BDC 0C46           00740     retlw   0x46 ; Physical Maximum (-1)
000BDE 0CFF           00741     retlw   0xFF ;
000BE0 0CFF           00742     retlw   0xFF ;
                      00743     
000BE2 0C95           00744     retlw   0x95 ; REPORT_COUNT 2       
000BE4 0C02           00745     retlw   0x02 ;
                      00746     
000BE6 0C75           00747     retlw   0x75 ; report size 16       
000BE8 0C10           00748     retlw   0x10 ;
                      00749     
000BEA 0C81           00750     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)   
000BEC 0C02           00751     retlw   0x02 ;
                      00752     
000BEE 0CC0           00753     retlw   0xC0 ; END_COLLECTION
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 109


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00754 ;******************************************
                      00755     
000BF0 0CA1           00756     retlw   0xA1 ; Colection Physycal       
000BF2 0C00           00757     retlw   0x00 ; LOW
                      00758     
000BF4 0C09           00759     retlw   0x09 ; usage Rx     
000BF6 0C33           00760     retlw   0x33 ;
                      00761     
000BF8 0C09           00762     retlw   0x09 ; usage Ry     
000BFA 0C34           00763     retlw   0x34 ;
                      00764         
000BFC 0C15           00765     retlw   0x15 ; logical minimun 0
000BFE 0C00           00766     retlw   0x00 ;
                      00767     
000C00 0C26           00768     retlw   0x26 ; logical maximun (-1)
000C02 0CFF           00769     retlw   0xFF ;
000C04 0CFF           00770     retlw   0xFF ;
                      00771     
000C06 0C35           00772     retlw   0x35 ; Physical Minimum (0)
000C08 0C00           00773     retlw   0x00 ;
                      00774     
000C0A 0C46           00775     retlw   0x46 ; Physical Maximum (-1)
000C0C 0CFF           00776     retlw   0xFF ;
000C0E 0CFF           00777     retlw   0xFF ;
                      00778     
000C10 0C95           00779     retlw   0x95 ; REPORT_COUNT 2       
000C12 0C02           00780     retlw   0x02 ;
                      00781     
000C14 0C75           00782     retlw   0x75 ; report size 16       
000C16 0C10           00783     retlw   0x10 ;
                      00784     
000C18 0C81           00785     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)   
000C1A 0C02           00786     retlw   0x02 ;
                      00787     
000C1C 0CC0           00788     retlw   0xC0 ; END_COLLECTION
                      00789 ;******************************************
                      00790 
000C1E 0C05           00791     retlw   0x05 ; USAGE_PAGE (Button)      
000C20 0C09           00792     retlw   0x09 ; low
                      00793     
000C22 0C19           00794     retlw   0x19 ; Usage Minimum (Button 1)
000C24 0C01           00795     retlw   0x01 ;
                      00796     
000C26 0C29           00797     retlw   0x29 ; Usage Maximum (Button 10)
000C28 0C0A           00798     retlw   0x0A ;
                      00799     
000C2A 0C95           00800     retlw   0x95 ; report count 10      
000C2C 0C0A           00801     retlw   0x0A ;
                      00802     
000C2E 0C75           00803     retlw   0x75 ; report size 1        
000C30 0C01           00804     retlw   0x01 ;
                      00805     
000C32 0C81           00806     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)     
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 110


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C34 0C02           00807     retlw   0x02 ;
                      00808     
000C36 0C05           00809     retlw   0x05 ; Usage Page (Generic Desktop)
000C38 0C01           00810     retlw   0x01 ;
                      00811     
000C3A 0C09           00812     retlw   0x09 ; Usage (Hat Switch)
000C3C 0C39           00813     retlw   0x39 ;
                      00814     
000C3E 0C15           00815     retlw   0x15 ;  Logical Minimum (1)
000C40 0C01           00816     retlw   0x01 ;
                      00817     
000C42 0C25           00818     retlw   0x25 ; Logical Maximum (8)
000C44 0C08           00819     retlw   0x08 ;
                      00820     
000C46 0C35           00821     retlw   0x35 ; Physical Minimum (0)
000C48 0C00           00822     retlw   0x00 ;
                      00823     
000C4A 0C46           00824     retlw   0x46 ; Physical Maximum (4155)
000C4C 0C3B           00825     retlw   0x3B ;
000C4E 0C10           00826     retlw   0x10 ;
                      00827     
000C50 0C66           00828     retlw   0x66 ; Unit (None)
000C52 0C0E           00829     retlw   0x0E ;
000C54 0C00           00830     retlw   0x00 ;
                      00831     
000C56 0C75           00832     retlw   0x75 ; report size 4
000C58 0C04           00833     retlw   0x04 ;
                      00834     
000C5A 0C95           00835     retlw   0x95 ; report count 1
000C5C 0C01           00836     retlw   0x01 ;
                      00837     
000C5E 0C81           00838     retlw   0x81 ; Input (Data,Var,Abs,NWrp,Lin,Pref,Null,Bit)
000C60 0C42           00839     retlw   0x42 ; LOW
                      00840     
000C62 0C75           00841     retlw   0x75 ; report size 2
000C64 0C02           00842     retlw   0x02 ;
                      00843     
000C66 0C95           00844     retlw   0x95 ; report count 1
000C68 0C01           00845     retlw   0x01 ;
                      00846     
000C6A 0C81           00847     retlw   0x81 ; (Cnst,Var,Abs,NWrp,Lin,Pref,NNul,Bit)
000C6C 0C03           00848     retlw   0x03 ; LOW
                      00849         
000C6E 0CC0           00850     retlw   0xC0 ; END_COLLECTION
                      00851 
000C70                00852 EndReportDescriptor1
                      00853 
000C70                00854 ReportDescriptor2
                      00855 
                      00856 ;***************************************
                      00857 ;*            Keyboard Emu             *
                      00858 ;***************************************
000C70 0C05           00859     retlw   0x05 ; USAGE_PAGE (generic desktop)     
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 111


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000C72 0C01           00860     retlw   0x01 ; LOW
                      00861     
000C74 0C09           00862     retlw   0x09 ; USAGE Key        
000C76 0C06           00863     retlw   0x06 ; LOW
                      00864     
000C78 0CA1           00865     retlw   0xA1 ; COLLECTION (APPLICATION)     
000C7A 0C01           00866     retlw   0x01 ; LOW
                      00867     
000C7C 0C85           00868     retlw   0x85 ; REPORT_ID (1)
000C7E 0C01           00869     retlw   0x01 ; LOW
                      00870     
000C80 0C05           00871     retlw   0x05 ; USAGE_PAGE (kbrd/keypad)     
000C82 0C07           00872     retlw   0x07 ; LOW
                      00873     
000C84 0C75           00874     retlw   0x75 ; report size 1
000C86 0C01           00875     retlw   0x01 ;
                      00876     
000C88 0C95           00877     retlw   0x95 ; report count 8
000C8A 0C08           00878     retlw   0x08 ;
                      00879     
000C8C 0C19           00880     retlw   0x19 ; Usage Minimum (0xE0)
000C8E 0CE0           00881     retlw   0xE0 ;
                      00882     
000C90 0C29           00883     retlw   0x29 ; Usage Maximum (0xE7)
000C92 0CE7           00884     retlw   0xE7 ;
                      00885     
000C94 0C15           00886     retlw   0x15 ; logical minimun      
000C96 0C00           00887     retlw   0x00 ;
                      00888     
000C98 0C25           00889     retlw   0x25 ; logical maximun      
000C9A 0C01           00890     retlw   0x01 ;
                      00891     
000C9C 0C81           00892     retlw   0x81 ; input  (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)
000C9E 0C02           00893     retlw   0x02 ;
                      00894     
000CA0 0C75           00895     retlw   0x75 ; report size 8
000CA2 0C08           00896     retlw   0x08 ;
                      00897     
000CA4 0C95           00898     retlw   0x95 ; report count 6
000CA6 0C06           00899     retlw   0x06 ;
                      00900     
000CA8 0C15           00901     retlw   0x15 ; logical minimun      
000CAA 0C00           00902     retlw   0x00 ;
                      00903     
000CAC 0C25           00904     retlw   0x25 ; logical maximun      
000CAE 0C64           00905     retlw   0x64 ;
                      00906     
000CB0 0C05           00907     retlw   0x05 ; USAGE_PAGE (kbrd/keypad)     
000CB2 0C07           00908     retlw   0x07 ; LOW
                      00909     
000CB4 0C19           00910     retlw   0x19 ; Usage Minimum (0x00)
000CB6 0C00           00911     retlw   0x00 ;
                      00912     
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 112


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000CB8 0C29           00913     retlw   0x29 ; Usage Maximum (0x65)
000CBA 0C65           00914     retlw   0x65 ;
                      00915     
000CBC 0C81           00916     retlw   0x81 ; input  (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)
000CBE 0C00           00917     retlw   0x00 ;
                      00918     
000CC0 0CC0           00919     retlw   0xC0 ; END_COLLECTION
                      00920 
                      00921 
                      00922 ;***************************************
                      00923 ;*            Mouse Emu                *
                      00924 ;***************************************
000CC2 0C05           00925     retlw   0x05 ; USAGE_PAGE (generic desktop)     
000CC4 0C01           00926     retlw   0x01 ; LOW
                      00927     
000CC6 0C09           00928     retlw   0x09 ; USAGE Mouse      
000CC8 0C02           00929     retlw   0x02 ; LOW
                      00930     
000CCA 0CA1           00931     retlw   0xA1 ; COLLECTION (APPLICATION)     
000CCC 0C01           00932     retlw   0x01 ; LOW
                      00933     
000CCE 0C85           00934     retlw   0x85 ; REPORT_ID (2)
000CD0 0C02           00935     retlw   0x02 ; LOW
                      00936     
000CD2 0C09           00937     retlw   0x09 ; USAGE_PAGE (Pointer)     
000CD4 0C01           00938     retlw   0x01 ; LOW
                      00939     
000CD6 0CA1           00940     retlw   0xA1 ; COLLECTION (Physical)    
000CD8 0C00           00941     retlw   0x00 ;
                      00942     
000CDA 0C05           00943     retlw   0x05 ; USAGE_PAGE (Button)
000CDC 0C09           00944     retlw   0x09 ;
                      00945     
000CDE 0C19           00946     retlw   0x19 ; Usage Minimum (Button 1)
000CE0 0C01           00947     retlw   0x01 ;
                      00948     
000CE2 0C29           00949     retlw   0x29 ; Usage Maximum (Button 2)
000CE4 0C02           00950     retlw   0x02 ;
                      00951     
000CE6 0C15           00952     retlw   0x15 ; logical minimun      
000CE8 0C00           00953     retlw   0x00 ;
                      00954     
000CEA 0C25           00955     retlw   0x25 ; logical maximun      
000CEC 0C01           00956     retlw   0x01 ;
                      00957     
000CEE 0C75           00958     retlw   0x75 ; report size 1
000CF0 0C01           00959     retlw   0x01 ;
                      00960     
000CF2 0C95           00961     retlw   0x95 ; report count 3
000CF4 0C02           00962     retlw   0x02 ;
                      00963     
000CF6 0C81           00964     retlw   0x81 ; input  (Data,Var,Abs,NWrp,Lin,Pref,NNul,Bit)
000CF8 0C02           00965     retlw   0x02 ;
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 113


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      00966     
000CFA 0C95           00967     retlw   0x95 ; report count 3       
000CFC 0C06           00968     retlw   0x06 ;
                      00969     
000CFE 0C81           00970     retlw   0x81 ; input (Data,Var,Abs) 
000D00 0C03           00971     retlw   0x03 ;
                      00972     
000D02 0C05           00973     retlw   0x05 ; USAGE_PAGE (Generic Desktop)     
000D04 0C01           00974     retlw   0x01 ; LOW
                      00975     
000D06 0C09           00976     retlw   0x09 ; Usage(X)
000D08 0C30           00977     retlw   0x30 ;
                      00978     
000D0A 0C09           00979     retlw   0x09 ; Usage(Y)
000D0C 0C31           00980     retlw   0x31 ;
                      00981     
000D0E 0C15           00982     retlw   0x15 ; logical minimun (-127)       
000D10 0C81           00983     retlw   0x81 ;
                      00984     
000D12 0C25           00985     retlw   0x25 ; logical maximun (127)        
000D14 0C7F           00986     retlw   0x7F ;
                      00987     
000D16 0C75           00988     retlw   0x75 ; report size 8
000D18 0C08           00989     retlw   0x08 ;
                      00990     
000D1A 0C95           00991     retlw   0x95 ; report count 2
000D1C 0C02           00992     retlw   0x02 ;
                      00993     
000D1E 0C81           00994     retlw   0x81 ; INPUT (Data,Var,Rel) 
000D20 0C06           00995     retlw   0x06 ;
                      00996     
000D22 0CC0           00997     retlw   0xC0 ; END_COLLECTION
000D24 0CC0           00998     retlw   0xC0 ; END_COLLECTION
                      00999     
                      01000     
                      01001 ;***************************************
                      01002 ;*          Volume Control             *
                      01003 ;***************************************
000D26 0C05           01004     retlw   0x05 ; USAGE_PAGE (Consumer Devices)        
000D28 0C0C           01005     retlw   0x0C ; LOW
                      01006     
000D2A 0C09           01007     retlw   0x09 ; USAGE (Consumer Control)     
000D2C 0C01           01008     retlw   0x01 ; LOW
                      01009     
000D2E 0CA1           01010     retlw   0xA1 ; COLLECTION (APPLICATION)     
000D30 0C01           01011     retlw   0x01 ; LOW
                      01012     
000D32 0C85           01013     retlw   0x85 ; REPORT_ID (3 Media)
000D34 0C03           01014     retlw   0x03 ; LOW
                      01015     
000D36 0C19           01016     retlw   0x19 ; Usage Minimum (0x00)
000D38 0C00           01017     retlw   0x00 ;
                      01018     
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 114


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D3A 0C2A           01019     retlw   0x2A ; Usage Maximum (0xAC format)
000D3C 0C3C           01020     retlw   0x3C ;
000D3E 0C02           01021     retlw   0x02
                      01022     
000D40 0C15           01023     retlw   0x15 ; logical minimun      
000D42 0C00           01024     retlw   0x00 ;
                      01025     
000D44 0C26           01026     retlw   0x26 ; logical maximun (572)        
000D46 0C3C           01027     retlw   0x3C ;
000D48 0C02           01028     retlw   0x02 ;
                      01029 
000D4A 0C95           01030     retlw   0x95 ; report count 1
000D4C 0C01           01031     retlw   0x01 ;
                      01032     
000D4E 0C75           01033     retlw   0x75 ; report size 16
000D50 0C10           01034     retlw   0x10 ;
                      01035     
000D52 0C81           01036     retlw   0x81 ; input  (Data,Var,Abs)
000D54 0C00           01037     retlw   0x00 ;
                      01038     
000D56 0CC0           01039     retlw   0xC0 ; END_COLLECTION
                      01040 
                      01041 ;***************************************
                      01042 ;*          ConfigInterface            *
                      01043 ;***************************************
                      01044 
000D58                01045 EndReportDescriptor2
                      01046 
                      01047 ; String pointer table
000D58                01048 USB_SD_Ptr
000D58                01049 Strings
000D58 0D6C           01050         db      low String0, high String0
000D5A 0000           01051         db      upper String0, 0
000D5C 0D74           01052         db      low String1, high String1
000D5E 0000           01053         db      upper String1, 0
000D60 0D84           01054         db      low String2, high String2
000D62 0000           01055         db      upper String2, 0
000D64 0DB8           01056         db      low String3, high String3
000D66 0000           01057                 db      upper String3, 0
000D68 0DD8           01058         db      low String4, high String4
000D6A 0000           01059                 db      upper String4, 0
                      01060         ;db     low String5, high String5
                      01061         ;   db  upper String5, 0
                      01062 
000D6C                01063 String0
000D6C 0C04           01064         retlw   (String1-String0)/2     ; Length of string
000D6E 0C03           01065         retlw   USB_DESCRIPTOR_STRING   ; Descriptor type 3
000D70 0C09           01066         retlw   0x09                    ; Language ID (as defined by MS 0x0409)
000D72 0C04           01067         retlw   0x04
                      01068 
                      01069 ; company name
000D74                01070 String1
000D74 0C08           01071         retlw   (String2-String1)/2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 115


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000D76 0C03           01072         retlw   USB_DESCRIPTOR_STRING
                      01073         
000D78 0C44           01074         retlw   'D'
000D7A 0C00           01075         retlw   0x00
000D7C 0C43           01076         retlw   'C'
000D7E 0C00           01077         retlw   0x00
000D80 0C4C           01078         retlw   'L'
000D82 0C00           01079         retlw   0x00
                      01080         
                      01081 ; product name  
000D84                01082 String2
000D84 0C1A           01083         retlw   (String3-String2)/2
000D86 0C03           01084         retlw   USB_DESCRIPTOR_STRING
                      01085             
000D88 0C41           01086         retlw   'A'
000D8A 0C00           01087         retlw   0x00
000D8C 0C52           01088         retlw   'R'
000D8E 0C00           01089         retlw   0x00
000D90 0C43           01090         retlw   'C'
000D92 0C00           01091         retlw   0x00
000D94 0C41           01092         retlw   'A'
000D96 0C00           01093         retlw   0x00
000D98 0C44           01094         retlw   'D'
000D9A 0C00           01095         retlw   0x00
000D9C 0C45           01096         retlw   'E'
000D9E 0C00           01097         retlw   0x00
000DA0 0C20           01098         retlw   ' '
000DA2 0C00           01099         retlw   0x00
000DA4 0C4A           01100         retlw   'J'
000DA6 0C00           01101         retlw   0x00
000DA8 0C41           01102         retlw   'A'
000DAA 0C00           01103         retlw   0x00
000DAC 0C4D           01104         retlw   'M'
000DAE 0C00           01105         retlw   0x00
000DB0 0C4D           01106         retlw   'M'
000DB2 0C00           01107         retlw   0x00
000DB4 0C41           01108         retlw   'A'
000DB6 0C00           01109         retlw   0x00
                      01110 ; serial number
000DB8                01111 String3
000DB8 0C10           01112         retlw   (String4-String3)/2
000DBA 0C03           01113         retlw   USB_DESCRIPTOR_STRING
                      01114         
000DBC 0C4A           01115         retlw   'J'
000DBE 0C00           01116         retlw   0x00
000DC0 0C56           01117         retlw   'V'
000DC2 0C00           01118         retlw   0x00
000DC4 0C53           01119         retlw   'S'
000DC6 0C00           01120         retlw   0x00
000DC8 0C30           01121         retlw   '0'
000DCA 0C00           01122         retlw   0x00
000DCC 0C30           01123         retlw   '0'
000DCE 0C00           01124         retlw   0x00
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 116


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000DD0 0C30           01125         retlw   '0'
000DD2 0C00           01126         retlw   0x00
000DD4 0C30           01127         retlw   '0'
000DD6 0C00           01128         retlw   0x00
                      01129 
000DD8                01130 String4
000DD8 0C10           01131     retlw       (String5-String4)/2
000DDA 0C03           01132         retlw   USB_DESCRIPTOR_STRING
                      01133         
000DDC 0C43           01134         retlw   'C'
000DDE 0C00           01135         retlw   0x00
000DE0 0C4F           01136         retlw   'O'
000DE2 0C00           01137         retlw   0x00
000DE4 0C4E           01138         retlw   'N'
000DE6 0C00           01139         retlw   0x00
000DE8 0C54           01140         retlw   'T'
000DEA 0C00           01141         retlw   0x00
000DEC 0C52           01142         retlw   'R'
000DEE 0C00           01143         retlw   0x00
000DF0 0C4F           01144         retlw   'O'
000DF2 0C00           01145         retlw   0x00
000DF4 0C4C           01146         retlw   'L'
000DF6 0C00           01147         retlw   0x00
                      01148         
000DF8                01149 String5
                      01150 
                      01151 
                      01152         ENDASM?
                      01153 
                      01154 
                      01155 ; C:\TEMP\DCLFI32V1.0\DES_FIRMAC01.BAS  00764   hid_desc_end
                      01156 
                      01157         LABEL?L _hid_desc_end   
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _hid_desc_end
                          M         XALL
                          M     else
000DF8                    M _hid_desc_end
                          M     endif
                      01158 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00040   DEFINE OSC 48
                      01159 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00042   Define ADC_BITS     10  ' Set number of bits in result
                      01160 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00043   Define ADC_CLOCK     3  ' Set clock source (3=rc)
                      01161 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00044   Define ADC_SAMPLEUS 50  ' Set sampling time in uS
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 117


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01162 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00047   DEFINE HSER_RCSTA 90h 
                      01163 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00050   DEFINE HSER_TXSTA 24h 
                      01164 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00053   DEFINE HSER_BAUD 115200
                      01165 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00055   USBBufferSizeMax   con 8  ' maximum buffer size
                      01166 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00056   USBBufferSizeTX    con 11  ' output
                      01167 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00057   USBMediaTX         con 3
                      01168 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00058   USBkeyTX           con 8
                      01169 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00059   USBBufferSizeRX    con 8  ' input
                      01170 
                      01171 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00111   TRISA =%10100011
                      01172         MOVE?CB 0A3h, TRISA
                          M         CHK?RP  TRISA
                          M     if (((TRISA) & 8000h) != PREV_ALT)
                          M       if ((TRISA) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISA) & 8000h
                          M     endif
                          M     if ((((TRISA) & 0fffh) > BANKA_END) & (((TRISA) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISA) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (TRISA)
                          M PREV_BANK = high (TRISA)
                          M       endif
                          M     endif
                          M     if (low (0A3h) == 0)
                          M         clrf    TRISA
                          M     else
                          M       if (low (0A3h) == 255)
                          M         setf    TRISA
                          M       else
000DF8 0EA3               M         movlw   low (0A3h)
000DFA 6E92               M         movwf   TRISA
                          M       endif
                          M     endif
                      01173 
                      01174 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00112   ADCON1=%00001101
                      01175         MOVE?CB 00Dh, ADCON1
                          M         CHK?RP  ADCON1
                          M     if (((ADCON1) & 8000h) != PREV_ALT)
                          M       if ((ADCON1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (ADCON1) & 8000h
                          M     endif
                          M     if ((((ADCON1) & 0fffh) > BANKA_END) & (((ADCON1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((ADCON1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (ADCON1)
                          M PREV_BANK = high (ADCON1)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 118


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (low (00Dh) == 0)
                          M         clrf    ADCON1
                          M     else
                          M       if (low (00Dh) == 255)
                          M         setf    ADCON1
                          M       else
000DFC 0E0D               M         movlw   low (00Dh)
000DFE 6EC1               M         movwf   ADCON1
                          M       endif
                          M     endif
                      01176 
                      01177 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00113   ADCON2=%10000000
                      01178         MOVE?CB 080h, ADCON2
                          M         CHK?RP  ADCON2
                          M     if (((ADCON2) & 8000h) != PREV_ALT)
                          M       if ((ADCON2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (ADCON2) & 8000h
                          M     endif
                          M     if ((((ADCON2) & 0fffh) > BANKA_END) & (((ADCON2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((ADCON2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (ADCON2)
                          M PREV_BANK = high (ADCON2)
                          M       endif
                          M     endif
                          M     if (low (080h) == 0)
                          M         clrf    ADCON2
                          M     else
                          M       if (low (080h) == 255)
                          M         setf    ADCON2
                          M       else
000E00 0E80               M         movlw   low (080h)
000E02 6EC0               M         movwf   ADCON2
                          M       endif
                          M     endif
                      01179 
                      01180 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00115   TRISB=%11111111
                      01181         MOVE?CB 0FFh, TRISB
                          M         CHK?RP  TRISB
                          M     if (((TRISB) & 8000h) != PREV_ALT)
                          M       if ((TRISB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISB) & 8000h
                          M     endif
                          M     if ((((TRISB) & 0fffh) > BANKA_END) & (((TRISB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISB) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 119


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (TRISB)
                          M PREV_BANK = high (TRISB)
                          M       endif
                          M     endif
                          M     if (low (0FFh) == 0)
                          M         clrf    TRISB
                          M     else
                          M       if (low (0FFh) == 255)
000E04 6893               M         setf    TRISB
                          M       else
                          M         movlw   low (0FFh)
                          M         movwf   TRISB
                          M       endif
                          M     endif
                      01182 
                      01183 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00116   TRISC=%10010010
                      01184         MOVE?CB 092h, TRISC
                          M         CHK?RP  TRISC
                          M     if (((TRISC) & 8000h) != PREV_ALT)
                          M       if ((TRISC) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISC) & 8000h
                          M     endif
                          M     if ((((TRISC) & 0fffh) > BANKA_END) & (((TRISC) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISC) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (TRISC)
                          M PREV_BANK = high (TRISC)
                          M       endif
                          M     endif
                          M     if (low (092h) == 0)
                          M         clrf    TRISC
                          M     else
                          M       if (low (092h) == 255)
                          M         setf    TRISC
                          M       else
000E06 0E92               M         movlw   low (092h)
000E08 6E94               M         movwf   TRISC
                          M       endif
                          M     endif
                      01185 
                      01186 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00117   TRISD=%11110000
                      01187         MOVE?CB 0F0h, TRISD
                          M         CHK?RP  TRISD
                          M     if (((TRISD) & 8000h) != PREV_ALT)
                          M       if ((TRISD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISD) & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 120


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((TRISD) & 0fffh) > BANKA_END) & (((TRISD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (TRISD)
                          M PREV_BANK = high (TRISD)
                          M       endif
                          M     endif
                          M     if (low (0F0h) == 0)
                          M         clrf    TRISD
                          M     else
                          M       if (low (0F0h) == 255)
                          M         setf    TRISD
                          M       else
000E0A 0EF0               M         movlw   low (0F0h)
000E0C 6E95               M         movwf   TRISD
                          M       endif
                          M     endif
                      01188 
                      01189 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00118   TRISE=%0111
                      01190         MOVE?CB 007h, TRISE
                          M         CHK?RP  TRISE
                          M     if (((TRISE) & 8000h) != PREV_ALT)
                          M       if ((TRISE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (TRISE) & 8000h
                          M     endif
                          M     if ((((TRISE) & 0fffh) > BANKA_END) & (((TRISE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((TRISE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (TRISE)
                          M PREV_BANK = high (TRISE)
                          M       endif
                          M     endif
                          M     if (low (007h) == 0)
                          M         clrf    TRISE
                          M     else
                          M       if (low (007h) == 255)
                          M         setf    TRISE
                          M       else
000E0E 0E07               M         movlw   low (007h)
000E10 6E96               M         movwf   TRISE
                          M       endif
                          M     endif
                      01191 
                      01192 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00119   PORTD=0
                      01193         MOVE?CB 000h, PORTD
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 121


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E12 6A83               M         clrf    PORTD
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    PORTD
                          M       else
                          M         movlw   low (000h)
                          M         movwf   PORTD
                          M       endif
                          M     endif
                      01194 
                      01195 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00120   PORTC=%100
                      01196         MOVE?CB 004h, PORTC
                          M         CHK?RP  PORTC
                          M     if (((PORTC) & 8000h) != PREV_ALT)
                          M       if ((PORTC) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTC) & 8000h
                          M     endif
                          M     if ((((PORTC) & 0fffh) > BANKA_END) & (((PORTC) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTC) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTC)
                          M PREV_BANK = high (PORTC)
                          M       endif
                          M     endif
                          M     if (low (004h) == 0)
                          M         clrf    PORTC
                          M     else
                          M       if (low (004h) == 255)
                          M         setf    PORTC
                          M       else
000E14 0E04               M         movlw   low (004h)
000E16 6E82               M         movwf   PORTC
                          M       endif
                          M     endif
                      01197 
                      01198 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00121   PORTA.6=0
                      01199         MOVE?CT 000h, _PORTA??6
                          M         CHK?RP  PORTA
                          M     if (((PORTA) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 122


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((PORTA) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTA) & 8000h
                          M     endif
                          M     if ((((PORTA) & 0fffh) > BANKA_END) & (((PORTA) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTA) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTA)
                          M PREV_BANK = high (PORTA)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PORTA,  006h
                          M     else
000E18 9C80               M         bcf     PORTA,  006h
                          M     endif
                      01200 
                      01201 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00123   OUTPUTS0=0
                      01202         MOVE?CB 000h, _OUTPUTS0
                          M         CHK?RP  _OUTPUTS0
                          M     if (((_OUTPUTS0) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS0) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS0) & 0fffh) > BANKA_END) & (((_OUTPUTS0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS0)
                          M PREV_BANK = high (_OUTPUTS0)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E1A 6B6B               M         clrf    _OUTPUTS0
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _OUTPUTS0
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _OUTPUTS0
                          M       endif
                          M     endif
                      01203 
                      01204 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00124   OUTPUTS1=0
                      01205         MOVE?CB 000h, _OUTPUTS1
                          M         CHK?RP  _OUTPUTS1
                          M     if (((_OUTPUTS1) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS1) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 123


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS1) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS1) & 0fffh) > BANKA_END) & (((_OUTPUTS1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS1)
                          M PREV_BANK = high (_OUTPUTS1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E1C 6B6C               M         clrf    _OUTPUTS1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _OUTPUTS1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _OUTPUTS1
                          M       endif
                          M     endif
                      01206 
                      01207 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00125   OUTPUTS2=0
                      01208         MOVE?CB 000h, _OUTPUTS2
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E1E 6B6D               M         clrf    _OUTPUTS2
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _OUTPUTS2
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _OUTPUTS2
                          M       endif
                          M     endif
                      01209 
                      01210 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00134   RESET:
                      01211 
                      01212         LABEL?L _RESET  
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 124


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _RESET
                          M         XALL
                          M     else
000E20                    M _RESET
                          M     endif
                      01213 
                      01214 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00135   clear
                      01215         CLEAR?  
  0000                    M     local loop
                          M       ifdef USE_LFSR
                          M         lfsr    0, RAM_END
                          M       else
                          M         MOVE?CW RAM_END, FSR0L
                          M     ifdef USE_LINKER
                          M         CHK?RP  FSR0L
                          M         movlw   low (RAM_END)
                          M         movwf   FSR0L
                          M         movlw   high (RAM_END)
                          M         movwf   (FSR0L) + 1
                          M     else
                          M         MOVE?CB low (RAM_END), FSR0L
                          M         CHK?RP  FSR0L
                          M     if (((FSR0L) & 8000h) != PREV_ALT)
                          M       if ((FSR0L) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (FSR0L) & 8000h
                          M     endif
                          M     if ((((FSR0L) & 0fffh) > BANKA_END) & (((FSR0L) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((FSR0L) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (FSR0L)
                          M PREV_BANK = high (FSR0L)
                          M       endif
                          M     endif
                          M     if (low (low (RAM_END)) == 0)
                          M         clrf    FSR0L
                          M     else
                          M       if (low (low (RAM_END)) == 255)
000E20 68E9               M         setf    FSR0L
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 125


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlw   low (low (RAM_END))
                          M         movwf   FSR0L
                          M       endif
                          M     endif
                          M         MOVE?CB high (RAM_END), (FSR0L) + 1
                          M         CHK?RP  (FSR0L) + 1
                          M     if ((((FSR0L) + 1) & 8000h) != PREV_ALT)
                          M       if (((FSR0L) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((FSR0L) + 1) & 8000h
                          M     endif
                          M     if (((((FSR0L) + 1) & 0fffh) > BANKA_END) & ((((FSR0L) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((FSR0L) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((FSR0L) + 1)
                          M PREV_BANK = high ((FSR0L) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (RAM_END)) == 0)
                          M         clrf    (FSR0L) + 1
                          M     else
                          M       if (low (high (RAM_END)) == 255)
                          M         setf    (FSR0L) + 1
                          M       else
000E22 0E07               M         movlw   low (high (RAM_END))
000E24 6EEA               M         movwf   (FSR0L) + 1
                          M       endif
                          M     endif
                          M     endif
                          M       endif
000E26 6AED               M loop    clrf    POSTDEC0
000E28 50E9               M         movf    FSR0L, W
000E2A 10EA               M         iorwf   FSR0H, W
000E2C E1FC               M         bnz     loop
000E2E 6AEF               M         clrf    INDF0
                      01216 
                      01217 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00136   LATC.0=1
                      01218         MOVE?CT 001h, _LATC??0
                          M         CHK?RP  LATC
                          M     if (((LATC)  & 8000h) != PREV_ALT)
                          M       if ((LATC)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATC)  & 8000h
                          M     endif
                          M     if ((((LATC)  & 0fffh) > BANKA_END) & (((LATC)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATC)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATC)
                          M PREV_BANK = high (LATC)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 126


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
000E30 808B               M         bsf     LATC,   000h
                          M     else
                          M         bcf     LATC,   000h
                          M     endif
                      01219 
                      01220 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00138   READ 1,CHUTES0
                      01221         READADDRESS?C   001h
                          M     ifdef EEADRH
                          M         MOVE?CW (001h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 001h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    EEADR
                          M       else
000E32 0E01               M         movlw   low (001h)
000E34 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01222         READ?B  _CHUTES0
                          M         L?CALL  READ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 127


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    READ
                          M     else
                          M       if ((READ)  < 1)
                          M         call    READ
                          M       else
                          M         if ((READ)  > $)
                          M         call    READ
                          M         else
                          M           if ((READ)  < ($ - 3ffh))
000E36 EC5E F000          M         call    READ
                          M           else
                          M         rcall   READ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
000E3A 6F9E               M         movwf   _CHUTES0
                      01223 
                      01224 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00139   READ 2,CHUTES1
                      01225         READADDRESS?C   002h
                          M     ifdef EEADRH
                          M         MOVE?CW (002h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 002h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 128


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    EEADR
                          M       else
000E3C 0E02               M         movlw   low (002h)
000E3E 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01226         READ?B  _CHUTES1
                          M         L?CALL  READ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    READ
                          M     else
                          M       if ((READ)  < 1)
                          M         call    READ
                          M       else
                          M         if ((READ)  > $)
                          M         call    READ
                          M         else
                          M           if ((READ)  < ($ - 3ffh))
000E40 EC5E F000          M         call    READ
                          M           else
                          M         rcall   READ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 129


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
000E44 6F9F               M         movwf   _CHUTES1
                      01227 
                      01228 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00140   if CHUTES0=255 then CHUTES0=0 : write 1,CHUTES0
                      01229         CMPNE?BCL       _CHUTES0, 0FFh, L00001
                          M     if (((0FFh) > -100h) & ((0FFh) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000E46 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
000E48 519E               M         movf    _CHUTES0, W
000E4A 08FF               M         sublw   0FFh
                          M         BIT?GOTO 0, STATUS, Z, L00001
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00001))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 130


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00001
                          M       else
                          M         if ((L00001) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M         else
                          M           if ((L00001) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M           else
                          M             if ((L00001) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00001
                          M             else
                          M         bov     L00001
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
000E4C A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00001
                          M       else
                          M         if ((L00001) < 1)
                          M         goto    L00001
                          M         else
                          M           if ((L00001) > $)
000E4E EF2F F007          M         goto    L00001
                          M           else
                          M             if ((L00001) < ($ - 3ffh))
                          M         goto    L00001
                          M             else
                          M         bra     L00001
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 131


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         L?GOTO  L00001
                          M     endif
                      01230         MOVE?CB 000h, _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E52 6B9E               M         clrf    _CHUTES0
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _CHUTES0
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _CHUTES0
                          M       endif
                          M     endif
                      01231         WRITEADDRESS?C  001h
                          M     ifdef EEADRH
                          M         MOVE?CW (001h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 001h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    EEADR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 132


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
000E54 0E01               M         movlw   low (001h)
000E56 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01232         WRITE?B _CHUTES0
                          M         MOVE?BA _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
000E58 519E               M         movf    _CHUTES0, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
000E5A EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01233         LABEL?L L00001  
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 133


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00001
                          M         XALL
                          M     else
000E5E                    M L00001
                          M     endif
                      01234 
                      01235 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00141   if CHUTES1=255 then CHUTES1=0 : write 2,chutes1
                      01236         CMPNE?BCL       _CHUTES1, 0FFh, L00003
                          M     if (((0FFh) > -100h) & ((0FFh) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000E5E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
000E60 519F               M         movf    _CHUTES1, W
000E62 08FF               M         sublw   0FFh
                          M         BIT?GOTO 0, STATUS, Z, L00003
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00003))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 134


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M       else
                          M         if ((L00003) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M         else
                          M           if ((L00003) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M           else
                          M             if ((L00003) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00003
                          M             else
                          M         bov     L00003
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
000E64 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00003
                          M       else
                          M         if ((L00003) < 1)
                          M         goto    L00003
                          M         else
                          M           if ((L00003) > $)
000E66 EF3B F007          M         goto    L00003
                          M           else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 135


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             if ((L00003) < ($ - 3ffh))
                          M         goto    L00003
                          M             else
                          M         bra     L00003
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00003
                          M     endif
                      01237         MOVE?CB 000h, _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E6A 6B9F               M         clrf    _CHUTES1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _CHUTES1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _CHUTES1
                          M       endif
                          M     endif
                      01238         WRITEADDRESS?C  002h
                          M     ifdef EEADRH
                          M         MOVE?CW (002h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 002h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 136


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    EEADR
                          M       else
000E6C 0E02               M         movlw   low (002h)
000E6E 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01239         WRITE?B _CHUTES1
                          M         MOVE?BA _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
000E70 519F               M         movf    _CHUTES1, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 137


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
000E72 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01240         LABEL?L L00003  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00003
                          M         XALL
                          M     else
000E76                    M L00003
                          M     endif
                      01241 
                      01242 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00142   read 3,VConfig  ;commcounter,Autocounter,coinSlot1,coinS
                            lot2,counter Enable 
                      01243         READADDRESS?C   003h
                          M     ifdef EEADRH
                          M         MOVE?CW (003h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 003h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (003h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (003h) == 255)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 138


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         setf    EEADR
                          M       else
000E76 0E03               M         movlw   low (003h)
000E78 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01244         READ?B  _VConfig
                          M         L?CALL  READ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    READ
                          M     else
                          M       if ((READ)  < 1)
                          M         call    READ
                          M       else
                          M         if ((READ)  > $)
                          M         call    READ
                          M         else
                          M           if ((READ)  < ($ - 3ffh))
000E7A EC5E F000          M         call    READ
                          M           else
                          M         rcall   READ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB _VConfig
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
000E7E 6FA0               M         movwf   _VConfig
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 139


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01245 
                      01246 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00143   read 4,Temp
                      01247         READADDRESS?C   004h
                          M     ifdef EEADRH
                          M         MOVE?CW (004h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 004h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (004h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (004h) == 255)
                          M         setf    EEADR
                          M       else
000E80 0E04               M         movlw   low (004h)
000E82 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01248         READ?B  _Temp
                          M         L?CALL  READ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    READ
                          M     else
                          M       if ((READ)  < 1)
                          M         call    READ
                          M       else
                          M         if ((READ)  > $)
                          M         call    READ
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 140


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((READ)  < ($ - 3ffh))
000E84 EC5E F000          M         call    READ
                          M           else
                          M         rcall   READ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB _Temp
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
000E88 6F9D               M         movwf   _Temp
                      01249 
                      01250 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00145   if temp !="A" then
                      01251         CMPEQ?BCL       _Temp, 041h, L00005
                          M     if (((041h) > -100h) & ((041h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000E8A 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _Temp
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
000E8C 519D               M         movf    _Temp, W
000E8E 0841               M         sublw   041h
                          M         BIT?GOTO 1, STATUS, Z, L00005
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 141


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00005))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M       else
                          M         if ((L00005) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M         else
                          M           if ((L00005) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M           else
                          M             if ((L00005) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00005
                          M             else
                          M         bov     L00005
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
000E90 B4D8               M         btfsc   STATUS, Z
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 142


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00005
                          M       else
                          M         if ((L00005) < 1)
                          M         goto    L00005
                          M         else
                          M           if ((L00005) > $)
000E92 EF63 F007          M         goto    L00005
                          M           else
                          M             if ((L00005) < ($ - 3ffh))
                          M         goto    L00005
                          M             else
                          M         bra     L00005
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      01252 
                      01253 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00146       CHUTES0=0
                      01254         MOVE?CB 000h, _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E96 6B9E               M         clrf    _CHUTES0
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _CHUTES0
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _CHUTES0
                          M       endif
                          M     endif
                      01255 
                      01256 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00147       CHUTES1=0
                      01257         MOVE?CB 000h, _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 143


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
000E98 6B9F               M         clrf    _CHUTES1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _CHUTES1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _CHUTES1
                          M       endif
                          M     endif
                      01258 
                      01259 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00148       VConfig=%00011111
                      01260         MOVE?CB 01Fh, _VConfig
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
                          M     if (low (01Fh) == 0)
                          M         clrf    _VConfig
                          M     else
                          M       if (low (01Fh) == 255)
                          M         setf    _VConfig
                          M       else
000E9A 0E1F               M         movlw   low (01Fh)
000E9C 6FA0               M         movwf   _VConfig
                          M       endif
                          M     endif
                      01261 
                      01262 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00149       write 1,CHUTES0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 144


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01263         WRITEADDRESS?C  001h
                          M     ifdef EEADRH
                          M         MOVE?CW (001h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 001h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    EEADR
                          M       else
000E9E 0E01               M         movlw   low (001h)
000EA0 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01264         WRITE?B _CHUTES0
                          M         MOVE?BA _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
000EA2 519E               M         movf    _CHUTES0, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 145


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
000EA4 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01265 
                      01266 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00150       write 2,CHUTES1
                      01267         WRITEADDRESS?C  002h
                          M     ifdef EEADRH
                          M         MOVE?CW (002h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 002h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    EEADR
                          M       else
000EA8 0E02               M         movlw   low (002h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 146


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000EAA 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01268         WRITE?B _CHUTES1
                          M         MOVE?BA _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
000EAC 519F               M         movf    _CHUTES1, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
000EAE EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01269 
                      01270 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00151       write 3,VConfig
                      01271         WRITEADDRESS?C  003h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 147


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef EEADRH
                          M         MOVE?CW (003h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 003h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (003h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (003h) == 255)
                          M         setf    EEADR
                          M       else
000EB2 0E03               M         movlw   low (003h)
000EB4 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01272         WRITE?B _VConfig
                          M         MOVE?BA _VConfig
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
000EB6 51A0               M         movf    _VConfig, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 148


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
000EB8 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01273 
                      01274 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00152       write 4,"A"
                      01275         WRITEADDRESS?C  004h
                          M     ifdef EEADRH
                          M         MOVE?CW (004h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 004h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (004h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (004h) == 255)
                          M         setf    EEADR
                          M       else
000EBC 0E04               M         movlw   low (004h)
000EBE 6EA9               M         movwf   EEADR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 149


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     endif
                      01276         WRITE?C 041h
000EC0 0E41               M         movlw   041h
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
000EC2 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01277 
                      01278 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00153   endif
                      01279         LABEL?L L00005  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00005
                          M         XALL
                          M     else
000EC6                    M L00005
                          M     endif
                      01280 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 150


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01281 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00155   if VConfig.1=1 then outputs2.6=1 ;on coinSlot1
                      01282         CMPNE?TCL       _VConfig??1, 001h, L00007
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _VConfig, 001h, L00007
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000EC6 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _VConfig, 001h, L00007
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00007))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_VConfig) > BANKA_END) & ((_VConfig) < (0f01h + BANKA_END)))
000EC8 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
000ECA A3A0               M         btfss   _VConfig, 001h
                          M       else
                          M         btfsc   _VConfig, 001h
                          M       endif
000ECC 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 151


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M       else
                          M         if ((L00007) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M         else
                          M           if ((L00007) > $)
000ECE B6D8               M         btfsc   STATUS, OV
000ED0 EF6B F007          M         goto    L00007
                          M           else
                          M             if ((L00007) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00007
                          M             else
                          M         bov     L00007
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _VConfig, 001h
                          M       else
                          M         btfsc   _VConfig, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00007
                          M       else
                          M         if ((L00007) < 1)
                          M         goto    L00007
                          M         else
                          M           if ((L00007) > $)
                          M         goto    L00007
                          M           else
                          M             if ((L00007) < ($ - 3ffh))
                          M         goto    L00007
                          M             else
                          M         bra     L00007
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00007
                          M       endif
                          M     endif
                      01283         MOVE?CT 001h, _OUTPUTS2??6
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 152


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
000ED4 8D6D               M         bsf     _OUTPUTS2, 006h
                          M     else
                          M         bcf     _OUTPUTS2, 006h
                          M     endif
                      01284         LABEL?L L00007  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00007
                          M         XALL
                          M     else
000ED6                    M L00007
                          M     endif
                      01285 
                      01286 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00156   if VConfig.2=1 then outputs2.7=1 ;on coinSlot2
                      01287         CMPNE?TCL       _VConfig??2, 001h, L00009
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _VConfig, 002h, L00009
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000ED6 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _VConfig, 002h, L00009
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00009))
                          M         CLRWDT?
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 153


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     if (((_VConfig) > BANKA_END) & ((_VConfig) < (0f01h + BANKA_END)))
000ED8 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
000EDA A5A0               M         btfss   _VConfig, 002h
                          M       else
                          M         btfsc   _VConfig, 002h
                          M       endif
000EDC 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00009
                          M       else
                          M         if ((L00009) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00009
                          M         else
                          M           if ((L00009) > $)
000EDE B6D8               M         btfsc   STATUS, OV
000EE0 EF73 F007          M         goto    L00009
                          M           else
                          M             if ((L00009) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00009
                          M             else
                          M         bov     L00009
                          M             endif
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 154


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _VConfig, 002h
                          M       else
                          M         btfsc   _VConfig, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00009
                          M       else
                          M         if ((L00009) < 1)
                          M         goto    L00009
                          M         else
                          M           if ((L00009) > $)
                          M         goto    L00009
                          M           else
                          M             if ((L00009) < ($ - 3ffh))
                          M         goto    L00009
                          M             else
                          M         bra     L00009
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00009
                          M       endif
                          M     endif
                      01288         MOVE?CT 001h, _OUTPUTS2??7
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
000EE4 8F6D               M         bsf     _OUTPUTS2, 007h
                          M     else
                          M         bcf     _OUTPUTS2, 007h
                          M     endif
                      01289         LABEL?L L00009  
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 155


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00009
                          M         XALL
                          M     else
000EE6                    M L00009
                          M     endif
                      01290 
                      01291 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00157   gosub wout
                      01292         GOSUB?L _wout
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _wout
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _wout
                          M     else
                          M       if ((_wout) < 1)
                          M         call    _wout
                          M       else
                          M         if ((_wout) > $)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 156


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000EE6 EC8B F00C          M         call    _wout
                          M         else
                          M           if ((_wout) < ($ - 3ffh))
                          M         call    _wout
                          M           else
                          M         rcall   _wout
                          M           endif
                          M         endif
                          M       endif
                          M     endif
000EEA                    M dlabel
                      01293 
                      01294 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00159   USBInit
                      01295         USBINIT?        
                          M   ifdef USE_USB_BUS_SENSE_IO
                          M         tris_usb_bus_sense = 1  ; Set to input
                          M   endif
                          M   ifdef USE_SELF_POWER_SENSE_IO
                          M         tris_self_power = 1     ; Set to input
                          M   endif
                          M         L?CALL  USBDeviceInit   ; Finish initialization
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceInit
                          M     else
                          M       if ((USBDeviceInit) < 1)
                          M         call    USBDeviceInit
                          M       else
                          M         if ((USBDeviceInit) > $)
                          M         call    USBDeviceInit
                          M         else
                          M           if ((USBDeviceInit) < ($ - 3ffh))
000EEA ECBC F000          M         call    USBDeviceInit
                          M           else
                          M         rcall   USBDeviceInit
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 157


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
000EEE ECB7 F000          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01296 
                      01297 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00161   AllFlags.1=1
                      01298         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
000EF2 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      01299 
                      01300 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00162   AllFlags.2=1
                      01301         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 158


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
000EF4 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      01302 
                      01303 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00163   ANALOG1=32768
                      01304         MOVE?CW 08000h, _ANALOG1
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG1
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG1
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG1) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG1
                          M         CHK?RP  _ANALOG1
                          M     if (((_ANALOG1) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG1) & 8000h
                          M     endif
                          M     if ((((_ANALOG1) & 0fffh) > BANKA_END) & (((_ANALOG1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG1)
                          M PREV_BANK = high (_ANALOG1)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000EF6 6B72               M         clrf    _ANALOG1
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG1
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG1
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG1) + 1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 159


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  (_ANALOG1) + 1
                          M     if ((((_ANALOG1) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG1) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG1) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG1) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG1) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG1) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG1) + 1)
                          M PREV_BANK = high ((_ANALOG1) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG1) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG1) + 1
                          M       else
000EF8 0E80               M         movlw   low (high (08000h))
000EFA 6F73               M         movwf   (_ANALOG1) + 1
                          M       endif
                          M     endif
                          M     endif
                      01305 
                      01306 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00164   ANALOG5=32768
                      01307         MOVE?CW 08000h, _ANALOG5
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG5
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG5
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG5) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG5
                          M         CHK?RP  _ANALOG5
                          M     if (((_ANALOG5) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG5) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG5) & 8000h
                          M     endif
                          M     if ((((_ANALOG5) & 0fffh) > BANKA_END) & (((_ANALOG5) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG5) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG5)
                          M PREV_BANK = high (_ANALOG5)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 160


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000EFC 6B7A               M         clrf    _ANALOG5
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG5
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG5
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG5) + 1
                          M         CHK?RP  (_ANALOG5) + 1
                          M     if ((((_ANALOG5) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG5) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG5) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG5) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG5) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG5) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG5) + 1)
                          M PREV_BANK = high ((_ANALOG5) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG5) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG5) + 1
                          M       else
000EFE 0E80               M         movlw   low (high (08000h))
000F00 6F7B               M         movwf   (_ANALOG5) + 1
                          M       endif
                          M     endif
                          M     endif
                      01308 
                      01309 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00165   ANALOG7=32768
                      01310         MOVE?CW 08000h, _ANALOG7
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG7
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG7
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG7) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG7
                          M         CHK?RP  _ANALOG7
                          M     if (((_ANALOG7) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG7) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 161


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (_ANALOG7) & 8000h
                          M     endif
                          M     if ((((_ANALOG7) & 0fffh) > BANKA_END) & (((_ANALOG7) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG7) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG7)
                          M PREV_BANK = high (_ANALOG7)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000F02 6B7E               M         clrf    _ANALOG7
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG7
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG7
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG7) + 1
                          M         CHK?RP  (_ANALOG7) + 1
                          M     if ((((_ANALOG7) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG7) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG7) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG7) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG7) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG7) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG7) + 1)
                          M PREV_BANK = high ((_ANALOG7) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG7) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG7) + 1
                          M       else
000F04 0E80               M         movlw   low (high (08000h))
000F06 6F7F               M         movwf   (_ANALOG7) + 1
                          M       endif
                          M     endif
                          M     endif
                      01311 
                      01312 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00166   ANALOG3=32768
                      01313         MOVE?CW 08000h, _ANALOG3
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG3
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG3
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 162


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG3) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG3
                          M         CHK?RP  _ANALOG3
                          M     if (((_ANALOG3) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG3) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG3) & 8000h
                          M     endif
                          M     if ((((_ANALOG3) & 0fffh) > BANKA_END) & (((_ANALOG3) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG3) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG3)
                          M PREV_BANK = high (_ANALOG3)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000F08 6B76               M         clrf    _ANALOG3
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG3
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG3
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG3) + 1
                          M         CHK?RP  (_ANALOG3) + 1
                          M     if ((((_ANALOG3) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG3) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG3) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG3) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG3) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG3) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG3) + 1)
                          M PREV_BANK = high ((_ANALOG3) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG3) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG3) + 1
                          M       else
000F0A 0E80               M         movlw   low (high (08000h))
000F0C 6F77               M         movwf   (_ANALOG3) + 1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 163


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     endif
                      01314 
                      01315 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00168   ANALOG6=32768
                      01316         MOVE?CW 08000h, _ANALOG6
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG6
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG6
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG6) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG6
                          M         CHK?RP  _ANALOG6
                          M     if (((_ANALOG6) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG6) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG6) & 8000h
                          M     endif
                          M     if ((((_ANALOG6) & 0fffh) > BANKA_END) & (((_ANALOG6) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG6) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG6)
                          M PREV_BANK = high (_ANALOG6)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000F0E 6B7C               M         clrf    _ANALOG6
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG6
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG6
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG6) + 1
                          M         CHK?RP  (_ANALOG6) + 1
                          M     if ((((_ANALOG6) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG6) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG6) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG6) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG6) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG6) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG6) + 1)
                          M PREV_BANK = high ((_ANALOG6) + 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 164


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG6) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG6) + 1
                          M       else
000F10 0E80               M         movlw   low (high (08000h))
000F12 6F7D               M         movwf   (_ANALOG6) + 1
                          M       endif
                          M     endif
                          M     endif
                      01317 
                      01318 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00169   ANALOG0=32768
                      01319         MOVE?CW 08000h, _ANALOG0
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG0
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG0
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG0) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG0
                          M         CHK?RP  _ANALOG0
                          M     if (((_ANALOG0) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG0) & 8000h
                          M     endif
                          M     if ((((_ANALOG0) & 0fffh) > BANKA_END) & (((_ANALOG0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG0)
                          M PREV_BANK = high (_ANALOG0)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000F14 6B70               M         clrf    _ANALOG0
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG0
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG0
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG0) + 1
                          M         CHK?RP  (_ANALOG0) + 1
                          M     if ((((_ANALOG0) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG0) + 1) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 165


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG0) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG0) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG0) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG0) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG0) + 1)
                          M PREV_BANK = high ((_ANALOG0) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG0) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG0) + 1
                          M       else
000F16 0E80               M         movlw   low (high (08000h))
000F18 6F71               M         movwf   (_ANALOG0) + 1
                          M       endif
                          M     endif
                          M     endif
                      01320 
                      01321 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00170   ANALOG2=32768
                      01322         MOVE?CW 08000h, _ANALOG2
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG2
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG2
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG2) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG2
                          M         CHK?RP  _ANALOG2
                          M     if (((_ANALOG2) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG2) & 8000h
                          M     endif
                          M     if ((((_ANALOG2) & 0fffh) > BANKA_END) & (((_ANALOG2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG2)
                          M PREV_BANK = high (_ANALOG2)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000F1A 6B74               M         clrf    _ANALOG2
                          M     else
                          M       if (low (low (08000h)) == 255)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 166


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         setf    _ANALOG2
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG2
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG2) + 1
                          M         CHK?RP  (_ANALOG2) + 1
                          M     if ((((_ANALOG2) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG2) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG2) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG2) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG2) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG2) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG2) + 1)
                          M PREV_BANK = high ((_ANALOG2) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG2) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG2) + 1
                          M       else
000F1C 0E80               M         movlw   low (high (08000h))
000F1E 6F75               M         movwf   (_ANALOG2) + 1
                          M       endif
                          M     endif
                          M     endif
                      01323 
                      01324 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00171   ANALOG4=32768
                      01325         MOVE?CW 08000h, _ANALOG4
                          M     ifdef USE_LINKER
                          M         CHK?RP  _ANALOG4
                          M         movlw   low (08000h)
                          M         movwf   _ANALOG4
                          M         movlw   high (08000h)
                          M         movwf   (_ANALOG4) + 1
                          M     else
                          M         MOVE?CB low (08000h), _ANALOG4
                          M         CHK?RP  _ANALOG4
                          M     if (((_ANALOG4) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG4) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG4) & 8000h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 167


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_ANALOG4) & 0fffh) > BANKA_END) & (((_ANALOG4) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG4) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG4)
                          M PREV_BANK = high (_ANALOG4)
                          M       endif
                          M     endif
                          M     if (low (low (08000h)) == 0)
000F20 6B78               M         clrf    _ANALOG4
                          M     else
                          M       if (low (low (08000h)) == 255)
                          M         setf    _ANALOG4
                          M       else
                          M         movlw   low (low (08000h))
                          M         movwf   _ANALOG4
                          M       endif
                          M     endif
                          M         MOVE?CB high (08000h), (_ANALOG4) + 1
                          M         CHK?RP  (_ANALOG4) + 1
                          M     if ((((_ANALOG4) + 1) & 8000h) != PREV_ALT)
                          M       if (((_ANALOG4) + 1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((_ANALOG4) + 1) & 8000h
                          M     endif
                          M     if (((((_ANALOG4) + 1) & 0fffh) > BANKA_END) & ((((_ANALOG4) + 1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if ((((_ANALOG4) + 1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((_ANALOG4) + 1)
                          M PREV_BANK = high ((_ANALOG4) + 1)
                          M       endif
                          M     endif
                          M     if (low (high (08000h)) == 0)
                          M         clrf    (_ANALOG4) + 1
                          M     else
                          M       if (low (high (08000h)) == 255)
                          M         setf    (_ANALOG4) + 1
                          M       else
000F22 0E80               M         movlw   low (high (08000h))
000F24 6F79               M         movwf   (_ANALOG4) + 1
                          M       endif
                          M     endif
                          M     endif
                      01326 
                      01327 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00173   MainLoop:
                      01328 
                      01329         LABEL?L _MainLoop       
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 168


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _MainLoop
                          M         XALL
                          M     else
000F26                    M _MainLoop
                          M     endif
                      01330 
                      01331 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00175       GOSUB READIN
                      01332         GOSUB?L _READIN
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _READIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _READIN
                          M     else
                          M       if ((_READIN) < 1)
                          M         call    _READIN
                          M       else
                          M         if ((_READIN) > $)
000F26 EC11 F009          M         call    _READIN
                          M         else
                          M           if ((_READIN) < ($ - 3ffh))
                          M         call    _READIN
                          M           else
                          M         rcall   _READIN
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 169


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
000F2A                    M dlabel
                      01333 
                      01334 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00177       if chutes0>0 or CHUTES1>0 then gosub COUNTER
                      01335         CMPGT?BCB       _CHUTES0, 000h, T1
                          M     if ((000h) < 0)
                          M         CHK?RP  T1
                          M         setf    T1
                          M     else
                          M       if ((000h) < 0ffh)
                          M         MOVE?BB _CHUTES0, R0
000F2A C09E F002          M         movff   _CHUTES0, R0
                          M         MOVE?CA 000h
000F2E 0E00               M         movlw   low (000h)
                          M         L?CALL  CMPGTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGTB
                          M     else
                          M       if ((CMPGTB) < 1)
                          M         call    CMPGTB
                          M       else
                          M         if ((CMPGTB) > $)
                          M         call    CMPGTB
                          M         else
                          M           if ((CMPGTB) < ($ - 3ffh))
000F30 EC91 F000          M         call    CMPGTB
                          M           else
                          M         rcall   CMPGTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 170


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
000F34 6E14               M         movwf   T1
                          M       else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M       endif
                          M     endif
                      01336         CMPGT?BCB       _CHUTES1, 000h, T2
                          M     if ((000h) < 0)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((000h) < 0ffh)
                          M         MOVE?BB _CHUTES1, R0
000F36 C09F F002          M         movff   _CHUTES1, R0
                          M         MOVE?CA 000h
000F3A 0E00               M         movlw   low (000h)
                          M         L?CALL  CMPGTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGTB
                          M     else
                          M       if ((CMPGTB) < 1)
                          M         call    CMPGTB
                          M       else
                          M         if ((CMPGTB) > $)
                          M         call    CMPGTB
                          M         else
                          M           if ((CMPGTB) < ($ - 3ffh))
000F3C EC91 F000          M         call    CMPGTB
                          M           else
                          M         rcall   CMPGTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 171


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
000F40 6E16               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      01337         LOR?BBW T1, T2, T2
                          M         MOVE?BB T1,   R0
000F42 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
000F46 5016               M         movf    T2,  W
                          M         L?CALL  LOR
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 172


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    LOR
                          M     else
                          M       if ((LOR)   < 1)
                          M         call    LOR
                          M       else
                          M         if ((LOR)   > $)
                          M         call    LOR
                          M         else
                          M           if ((LOR)   < ($ - 3ffh))
000F48 ECB2 F000          M         call    LOR
                          M           else
                          M         rcall   LOR
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
000F4C 6E16               M         movwf   T2
000F4E 6E17               M         movwf   T2   + 1
                      01338         CMPF?WL T2, L00011
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000F50 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 173


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
000F52 5016               M         movf    T2,  W
000F54 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00011
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00011))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00011
                          M       else
                          M         if ((L00011) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00011
                          M         else
                          M           if ((L00011) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00011
                          M           else
                          M             if ((L00011) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00011
                          M             else
                          M         bov     L00011
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 174


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
000F56 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00011
                          M       else
                          M         if ((L00011) < 1)
                          M         goto    L00011
                          M         else
                          M           if ((L00011) > $)
000F58 EFB0 F007          M         goto    L00011
                          M           else
                          M             if ((L00011) < ($ - 3ffh))
                          M         goto    L00011
                          M             else
                          M         bra     L00011
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01339         GOSUB?L _COUNTER
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _COUNTER
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 175


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    _COUNTER
                          M     else
                          M       if ((_COUNTER) < 1)
                          M         call    _COUNTER
                          M       else
                          M         if ((_COUNTER) > $)
000F5C EC1A F00C          M         call    _COUNTER
                          M         else
                          M           if ((_COUNTER) < ($ - 3ffh))
                          M         call    _COUNTER
                          M           else
                          M         rcall   _COUNTER
                          M           endif
                          M         endif
                          M       endif
                          M     endif
000F60                    M dlabel
                      01340         LABEL?L L00011  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00011
                          M         XALL
                          M     else
000F60                    M L00011
                          M     endif
                      01341 
                      01342 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00179       if AllFlags.0=1 then
                      01343         CMPNE?TCL       _AllFlags??0, 001h, L00013
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _AllFlags, 000h, L00013
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000F60 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _AllFlags, 000h, L00013
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00013))
                          M         CLRWDT?
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 176


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     if (((_AllFlags) > BANKA_END) & ((_AllFlags) < (0f01h + BANKA_END)))
000F62 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
000F64 A160               M         btfss   _AllFlags, 000h
                          M       else
                          M         btfsc   _AllFlags, 000h
                          M       endif
000F66 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M       else
                          M         if ((L00013) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M         else
                          M           if ((L00013) > $)
000F68 B6D8               M         btfsc   STATUS, OV
000F6A EFB8 F007          M         goto    L00013
                          M           else
                          M             if ((L00013) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00013
                          M             else
                          M         bov     L00013
                          M             endif
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 177


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _AllFlags, 000h
                          M       else
                          M         btfsc   _AllFlags, 000h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00013
                          M       else
                          M         if ((L00013) < 1)
                          M         goto    L00013
                          M         else
                          M           if ((L00013) > $)
                          M         goto    L00013
                          M           else
                          M             if ((L00013) < ($ - 3ffh))
                          M         goto    L00013
                          M             else
                          M         bra     L00013
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00013
                          M       endif
                          M     endif
                      01344 
                      01345 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00180           AllFlags.0=0
                      01346         MOVE?CT 000h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 000h
                          M     else
000F6E 9160               M         bcf     _AllFlags, 000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 178


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01347 
                      01348 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00181       endif
                      01349         LABEL?L L00013  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00013
                          M         XALL
                          M     else
000F70                    M L00013
                          M     endif
                      01350 
                      01351 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00183       if AllFlags.1=1 then
                      01352         CMPNE?TCL       _AllFlags??1, 001h, L00015
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _AllFlags, 001h, L00015
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
000F70 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _AllFlags, 001h, L00015
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00015))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_AllFlags) > BANKA_END) & ((_AllFlags) < (0f01h + BANKA_END)))
000F72 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 179


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
000F74 A360               M         btfss   _AllFlags, 001h
                          M       else
                          M         btfsc   _AllFlags, 001h
                          M       endif
000F76 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M       else
                          M         if ((L00015) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M         else
                          M           if ((L00015) > $)
000F78 B6D8               M         btfsc   STATUS, OV
000F7A EF11 F008          M         goto    L00015
                          M           else
                          M             if ((L00015) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00015
                          M             else
                          M         bov     L00015
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _AllFlags, 001h
                          M       else
                          M         btfsc   _AllFlags, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00015
                          M       else
                          M         if ((L00015) < 1)
                          M         goto    L00015
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 180


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00015) > $)
                          M         goto    L00015
                          M           else
                          M             if ((L00015) < ($ - 3ffh))
                          M         goto    L00015
                          M             else
                          M         bra     L00015
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00015
                          M       endif
                          M     endif
                      01353 
                      01354 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00184           AllFlags.1=0
                      01355         MOVE?CT 000h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 001h
                          M     else
000F7E 9360               M         bcf     _AllFlags, 001h
                          M     endif
                      01356 
                      01357 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00185           idtx=1
                      01358         MOVE?CB 001h, _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 181


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _IDTX
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _IDTX
                          M       else
000F80 0E01               M         movlw   low (001h)
000F82 6F9C               M         movwf   _IDTX
                          M       endif
                          M     endif
                      01359 
                      01360 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00186           USBBuffer[0]=1
                      01361         MOVE?CB 001h, _USBBuffer
                          M         CHK?RP  _USBBuffer
                          M     if (((_USBBuffer) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer) & 8000h
                          M     endif
                          M     if ((((_USBBuffer) & 0fffh) > BANKA_END) & (((_USBBuffer) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBuffer) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer)
                          M PREV_BANK = high (_USBBuffer)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _USBBuffer
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _USBBuffer
                          M       else
000F84 0E01               M         movlw   low (001h)
000F86 6F90               M         movwf   _USBBuffer
                          M       endif
                          M     endif
                      01362 
                      01363 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00187           USBBuffer[1]=ANALOG1.lowbyte
                      01364         MOVE?BB _ANALOG1??LOWBYTE, _USBBuffer + 00001h
000F88 C072 F091          M         movff   _ANALOG1??LOWBYTE, _USBBuffer + 00001h
                      01365 
                      01366 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00188           USBBuffer[2]=ANALOG1.highbyte
                      01367         MOVE?BB _ANALOG1??HIGHBYTE, _USBBuffer + 00002h
000F8C C073 F092          M         movff   _ANALOG1??HIGHBYTE, _USBBuffer + 00002h
                      01368 
                      01369 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00189           USBBuffer[3]=ANALOG5.lowbyte
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 182


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01370         MOVE?BB _ANALOG5??LOWBYTE, _USBBuffer + 00003h
000F90 C07A F093          M         movff   _ANALOG5??LOWBYTE, _USBBuffer + 00003h
                      01371 
                      01372 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00190           USBBuffer[4]=ANALOG5.highbyte
                      01373         MOVE?BB _ANALOG5??HIGHBYTE, _USBBuffer + 00004h
000F94 C07B F094          M         movff   _ANALOG5??HIGHBYTE, _USBBuffer + 00004h
                      01374 
                      01375 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00191           USBBuffer[5]=ANALOG7.lowbyte
                      01376         MOVE?BB _ANALOG7??LOWBYTE, _USBBuffer + 00005h
000F98 C07E F095          M         movff   _ANALOG7??LOWBYTE, _USBBuffer + 00005h
                      01377 
                      01378 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00192           USBBuffer[6]=ANALOG7.highbyte
                      01379         MOVE?BB _ANALOG7??HIGHBYTE, _USBBuffer + 00006h
000F9C C07F F096          M         movff   _ANALOG7??HIGHBYTE, _USBBuffer + 00006h
                      01380 
                      01381 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00193           USBBuffer[7]=ANALOG3.lowbyte
                      01382         MOVE?BB _ANALOG3??LOWBYTE, _USBBuffer + 00007h
000FA0 C076 F097          M         movff   _ANALOG3??LOWBYTE, _USBBuffer + 00007h
                      01383 
                      01384 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00194           USBBuffer[8]=ANALOG3.highbyte
                      01385         MOVE?BB _ANALOG3??HIGHBYTE, _USBBuffer + 00008h
000FA4 C077 F098          M         movff   _ANALOG3??HIGHBYTE, _USBBuffer + 00008h
                      01386 
                      01387 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00196           Temp.0=FunctionKeys.0
                      01388         MOVE?TT _FunctionKeys??0, _Temp??0
                          M     if (((_FunctionKeys) <= BANKA_END) | ((_FunctionKeys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _FunctionKeys, 000h
                          M         bsf     _Temp,  000h
                          M         btfss   _FunctionKeys, 000h
                          M         bcf     _Temp,  000h
                          M     else
                          M       if (((_FunctionKeys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
000FA8 B161               M         btfsc   _FunctionKeys, 000h
000FAA 819D               M         bsf     _Temp,  000h
000FAC A161               M         btfss   _FunctionKeys, 000h
000FAE 919D               M         bcf     _Temp,  000h
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 183


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _FunctionKeys
                          M         btfsc   _FunctionKeys, 000h
                          M         bsf     _Temp,  000h
                          M         btfss   _FunctionKeys, 000h
                          M         bcf     _Temp,  000h
                          M           else
                          M         MOVE?TA _FunctionKeys, 000h
                          M         MOVE?AT _Temp,  000h
                          M           endif
                          M       endif
                          M     endif
                      01389 
                      01390 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00197           Temp.1=FunctionKeys.3
                      01391         MOVE?TT _FunctionKeys??3, _Temp??1
                          M     if (((_FunctionKeys) <= BANKA_END) | ((_FunctionKeys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _FunctionKeys, 003h
                          M         bsf     _Temp,  001h
                          M         btfss   _FunctionKeys, 003h
                          M         bcf     _Temp,  001h
                          M     else
                          M       if (((_FunctionKeys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
000FB0 B761               M         btfsc   _FunctionKeys, 003h
000FB2 839D               M         bsf     _Temp,  001h
000FB4 A761               M         btfss   _FunctionKeys, 003h
000FB6 939D               M         bcf     _Temp,  001h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _FunctionKeys
                          M         btfsc   _FunctionKeys, 003h
                          M         bsf     _Temp,  001h
                          M         btfss   _FunctionKeys, 003h
                          M         bcf     _Temp,  001h
                          M           else
                          M         MOVE?TA _FunctionKeys, 003h
                          M         MOVE?AT _Temp,  001h
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 184


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                      01392 
                      01393 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00198           Temp.2=P1Keys.0
                      01394         MOVE?TT _P1Keys??0, _Temp??2
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 000h
                          M         bsf     _Temp,  002h
                          M         btfss   _P1Keys, 000h
                          M         bcf     _Temp,  002h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
000FB8 B162               M         btfsc   _P1Keys, 000h
000FBA 859D               M         bsf     _Temp,  002h
000FBC A162               M         btfss   _P1Keys, 000h
000FBE 959D               M         bcf     _Temp,  002h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 000h
                          M         bsf     _Temp,  002h
                          M         btfss   _P1Keys, 000h
                          M         bcf     _Temp,  002h
                          M           else
                          M         MOVE?TA _P1Keys, 000h
                          M         MOVE?AT _Temp,  002h
                          M           endif
                          M       endif
                          M     endif
                      01395 
                      01396 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00199           Temp.3=P1Keys.5
                      01397         MOVE?TT _P1Keys??5, _Temp??3
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 005h
                          M         bsf     _Temp,  003h
                          M         btfss   _P1Keys, 005h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 185


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     _Temp,  003h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
000FC0 BB62               M         btfsc   _P1Keys, 005h
000FC2 879D               M         bsf     _Temp,  003h
000FC4 AB62               M         btfss   _P1Keys, 005h
000FC6 979D               M         bcf     _Temp,  003h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 005h
                          M         bsf     _Temp,  003h
                          M         btfss   _P1Keys, 005h
                          M         bcf     _Temp,  003h
                          M           else
                          M         MOVE?TA _P1Keys, 005h
                          M         MOVE?AT _Temp,  003h
                          M           endif
                          M       endif
                          M     endif
                      01398 
                      01399 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00200           Temp.4=P1Keys.6
                      01400         MOVE?TT _P1Keys??6, _Temp??4
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 006h
                          M         bsf     _Temp,  004h
                          M         btfss   _P1Keys, 006h
                          M         bcf     _Temp,  004h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 186


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
000FC8 BD62               M         btfsc   _P1Keys, 006h
000FCA 899D               M         bsf     _Temp,  004h
000FCC AD62               M         btfss   _P1Keys, 006h
000FCE 999D               M         bcf     _Temp,  004h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 006h
                          M         bsf     _Temp,  004h
                          M         btfss   _P1Keys, 006h
                          M         bcf     _Temp,  004h
                          M           else
                          M         MOVE?TA _P1Keys, 006h
                          M         MOVE?AT _Temp,  004h
                          M           endif
                          M       endif
                          M     endif
                      01401 
                      01402 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00201           Temp.5=P1Keys.7
                      01403         MOVE?TT _P1Keys??7, _Temp??5
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 007h
                          M         bsf     _Temp,  005h
                          M         btfss   _P1Keys, 007h
                          M         bcf     _Temp,  005h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
000FD0 BF62               M         btfsc   _P1Keys, 007h
000FD2 8B9D               M         bsf     _Temp,  005h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 187


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

000FD4 AF62               M         btfss   _P1Keys, 007h
000FD6 9B9D               M         bcf     _Temp,  005h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 007h
                          M         bsf     _Temp,  005h
                          M         btfss   _P1Keys, 007h
                          M         bcf     _Temp,  005h
                          M           else
                          M         MOVE?TA _P1Keys, 007h
                          M         MOVE?AT _Temp,  005h
                          M           endif
                          M       endif
                          M     endif
                      01404 
                      01405 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00202           Temp.6=P1Keys.8
                      01406         MOVE?TT _P1Keys??8, _Temp??6
                          M     if (((_P1Keys + 001h) <= BANKA_END) | ((_P1Keys + 001h) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys + 001h, 000h
                          M         bsf     _Temp,  006h
                          M         btfss   _P1Keys + 001h, 000h
                          M         bcf     _Temp,  006h
                          M     else
                          M       if (((_P1Keys + 001h) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys + 001h
                          M     if (((_P1Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P1Keys + 001h) & 0fffh) > BANKA_END) & (((_P1Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys + 001h)
                          M PREV_BANK = high (_P1Keys + 001h)
                          M       endif
                          M     endif
000FD8 B163               M         btfsc   _P1Keys + 001h, 000h
000FDA 8D9D               M         bsf     _Temp,  006h
000FDC A163               M         btfss   _P1Keys + 001h, 000h
000FDE 9D9D               M         bcf     _Temp,  006h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys + 001h
                          M         btfsc   _P1Keys + 001h, 000h
                          M         bsf     _Temp,  006h
                          M         btfss   _P1Keys + 001h, 000h
                          M         bcf     _Temp,  006h
                          M           else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 188


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?TA _P1Keys + 001h, 000h
                          M         MOVE?AT _Temp,  006h
                          M           endif
                          M       endif
                          M     endif
                      01407 
                      01408 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00203           Temp.7=P1Keys.9
                      01409         MOVE?TT _P1Keys??9, _Temp??7
                          M     if (((_P1Keys + 001h) <= BANKA_END) | ((_P1Keys + 001h) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys + 001h, 001h
                          M         bsf     _Temp,  007h
                          M         btfss   _P1Keys + 001h, 001h
                          M         bcf     _Temp,  007h
                          M     else
                          M       if (((_P1Keys + 001h) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys + 001h
                          M     if (((_P1Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P1Keys + 001h) & 0fffh) > BANKA_END) & (((_P1Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys + 001h)
                          M PREV_BANK = high (_P1Keys + 001h)
                          M       endif
                          M     endif
000FE0 B363               M         btfsc   _P1Keys + 001h, 001h
000FE2 8F9D               M         bsf     _Temp,  007h
000FE4 A363               M         btfss   _P1Keys + 001h, 001h
000FE6 9F9D               M         bcf     _Temp,  007h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys + 001h
                          M         btfsc   _P1Keys + 001h, 001h
                          M         bsf     _Temp,  007h
                          M         btfss   _P1Keys + 001h, 001h
                          M         bcf     _Temp,  007h
                          M           else
                          M         MOVE?TA _P1Keys + 001h, 001h
                          M         MOVE?AT _Temp,  007h
                          M           endif
                          M       endif
                          M     endif
                      01410 
                      01411 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00205           USBBuffer[9]=Temp;P1Keys.lowbyte
                      01412         MOVE?BB _Temp, _USBBuffer + 00009h
000FE8 C09D F099          M         movff   _Temp, _USBBuffer + 00009h
                      01413 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 189


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01414 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00207           Temp.0=P1Keys.10
                      01415         MOVE?TT _P1Keys??10, _Temp??0
                          M     if (((_P1Keys + 001h) <= BANKA_END) | ((_P1Keys + 001h) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys + 001h, 002h
                          M         bsf     _Temp,  000h
                          M         btfss   _P1Keys + 001h, 002h
                          M         bcf     _Temp,  000h
                          M     else
                          M       if (((_P1Keys + 001h) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys + 001h
                          M     if (((_P1Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P1Keys + 001h) & 0fffh) > BANKA_END) & (((_P1Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys + 001h)
                          M PREV_BANK = high (_P1Keys + 001h)
                          M       endif
                          M     endif
000FEC B563               M         btfsc   _P1Keys + 001h, 002h
000FEE 819D               M         bsf     _Temp,  000h
000FF0 A563               M         btfss   _P1Keys + 001h, 002h
000FF2 919D               M         bcf     _Temp,  000h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys + 001h
                          M         btfsc   _P1Keys + 001h, 002h
                          M         bsf     _Temp,  000h
                          M         btfss   _P1Keys + 001h, 002h
                          M         bcf     _Temp,  000h
                          M           else
                          M         MOVE?TA _P1Keys + 001h, 002h
                          M         MOVE?AT _Temp,  000h
                          M           endif
                          M       endif
                          M     endif
                      01416 
                      01417 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00208           Temp.1=P1Keys.1
                      01418         MOVE?TT _P1Keys??1, _Temp??1
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 001h
                          M         bsf     _Temp,  001h
                          M         btfss   _P1Keys, 001h
                          M         bcf     _Temp,  001h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 190


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
000FF4 B362               M         btfsc   _P1Keys, 001h
000FF6 839D               M         bsf     _Temp,  001h
000FF8 A362               M         btfss   _P1Keys, 001h
000FFA 939D               M         bcf     _Temp,  001h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 001h
                          M         bsf     _Temp,  001h
                          M         btfss   _P1Keys, 001h
                          M         bcf     _Temp,  001h
                          M           else
                          M         MOVE?TA _P1Keys, 001h
                          M         MOVE?AT _Temp,  001h
                          M           endif
                          M       endif
                          M     endif
                      01419 
                      01420 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00209           Temp.2=P1Keys.2
                      01421         MOVE?TT _P1Keys??2, _Temp??2
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 002h
                          M         bsf     _Temp,  002h
                          M         btfss   _P1Keys, 002h
                          M         bcf     _Temp,  002h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 191


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
000FFC B562               M         btfsc   _P1Keys, 002h
000FFE 859D               M         bsf     _Temp,  002h
001000 A562               M         btfss   _P1Keys, 002h
001002 959D               M         bcf     _Temp,  002h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 002h
                          M         bsf     _Temp,  002h
                          M         btfss   _P1Keys, 002h
                          M         bcf     _Temp,  002h
                          M           else
                          M         MOVE?TA _P1Keys, 002h
                          M         MOVE?AT _Temp,  002h
                          M           endif
                          M       endif
                          M     endif
                      01422 
                      01423 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00210           Temp.3=P1Keys.3
                      01424         MOVE?TT _P1Keys??3, _Temp??3
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 003h
                          M         bsf     _Temp,  003h
                          M         btfss   _P1Keys, 003h
                          M         bcf     _Temp,  003h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
001004 B762               M         btfsc   _P1Keys, 003h
001006 879D               M         bsf     _Temp,  003h
001008 A762               M         btfss   _P1Keys, 003h
00100A 979D               M         bcf     _Temp,  003h
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 192


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 003h
                          M         bsf     _Temp,  003h
                          M         btfss   _P1Keys, 003h
                          M         bcf     _Temp,  003h
                          M           else
                          M         MOVE?TA _P1Keys, 003h
                          M         MOVE?AT _Temp,  003h
                          M           endif
                          M       endif
                          M     endif
                      01425 
                      01426 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00211           Temp.4=P1Keys.4
                      01427         MOVE?TT _P1Keys??4, _Temp??4
                          M     if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P1Keys, 004h
                          M         bsf     _Temp,  004h
                          M         btfss   _P1Keys, 004h
                          M         bcf     _Temp,  004h
                          M     else
                          M       if (((_P1Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
00100C B962               M         btfsc   _P1Keys, 004h
00100E 899D               M         bsf     _Temp,  004h
001010 A962               M         btfss   _P1Keys, 004h
001012 999D               M         bcf     _Temp,  004h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _P1Keys, 004h
                          M         bsf     _Temp,  004h
                          M         btfss   _P1Keys, 004h
                          M         bcf     _Temp,  004h
                          M           else
                          M         MOVE?TA _P1Keys, 004h
                          M         MOVE?AT _Temp,  004h
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 193


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                      01428 
                      01429 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00212           Temp.5=0
                      01430         MOVE?CT 000h, _Temp??5
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _Temp,  005h
                          M     else
001014 9B9D               M         bcf     _Temp,  005h
                          M     endif
                      01431 
                      01432 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00213           Temp.6=0
                      01433         MOVE?CT 000h, _Temp??6
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _Temp,  006h
                          M     else
001016 9D9D               M         bcf     _Temp,  006h
                          M     endif
                      01434 
                      01435 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00214           Temp.7=0
                      01436         MOVE?CT 000h, _Temp??7
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 194


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _Temp,  007h
                          M     else
001018 9F9D               M         bcf     _Temp,  007h
                          M     endif
                      01437 
                      01438 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00216           USBBuffer[10]=Temp;P1Keys.highbyte
                      01439         MOVE?BB _Temp, _USBBuffer + 0000Ah
00101A C09D F09A          M         movff   _Temp, _USBBuffer + 0000Ah
                      01440 
                      01441 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00217           gosub DoUSBOut
                      01442         GOSUB?L _DoUSBOut
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBOut
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 195


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    _DoUSBOut
                          M     else
                          M       if ((_DoUSBOut) < 1)
                          M         call    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) > $)
00101E ECB4 F00C          M         call    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) < ($ - 3ffh))
                          M         call    _DoUSBOut
                          M           else
                          M         rcall   _DoUSBOut
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001022                    M dlabel
                      01443 
                      01444 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00218       endif
                      01445         LABEL?L L00015  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00015
                          M         XALL
                          M     else
001022                    M L00015
                          M     endif
                      01446 
                      01447 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00220       if AllFlags.2=1 then
                      01448         CMPNE?TCL       _AllFlags??2, 001h, L00017
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _AllFlags, 002h, L00017
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001022 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _AllFlags, 002h, L00017
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00017))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 196


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_AllFlags) > BANKA_END) & ((_AllFlags) < (0f01h + BANKA_END)))
001024 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001026 A560               M         btfss   _AllFlags, 002h
                          M       else
                          M         btfsc   _AllFlags, 002h
                          M       endif
001028 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M       else
                          M         if ((L00017) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M         else
                          M           if ((L00017) > $)
00102A B6D8               M         btfsc   STATUS, OV
00102C EF6D F008          M         goto    L00017
                          M           else
                          M             if ((L00017) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00017
                          M             else
                          M         bov     L00017
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 197


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _AllFlags, 002h
                          M       else
                          M         btfsc   _AllFlags, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00017
                          M       else
                          M         if ((L00017) < 1)
                          M         goto    L00017
                          M         else
                          M           if ((L00017) > $)
                          M         goto    L00017
                          M           else
                          M             if ((L00017) < ($ - 3ffh))
                          M         goto    L00017
                          M             else
                          M         bra     L00017
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00017
                          M       endif
                          M     endif
                      01449 
                      01450 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00221           AllFlags.2=0
                      01451         MOVE?CT 000h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 002h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 198


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
001030 9560               M         bcf     _AllFlags, 002h
                          M     endif
                      01452 
                      01453 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00222           idtx=1
                      01454         MOVE?CB 001h, _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _IDTX
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _IDTX
                          M       else
001032 0E01               M         movlw   low (001h)
001034 6F9C               M         movwf   _IDTX
                          M       endif
                          M     endif
                      01455 
                      01456 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00223           USBBuffer[0]=2
                      01457         MOVE?CB 002h, _USBBuffer
                          M         CHK?RP  _USBBuffer
                          M     if (((_USBBuffer) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer) & 8000h
                          M     endif
                          M     if ((((_USBBuffer) & 0fffh) > BANKA_END) & (((_USBBuffer) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBuffer) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer)
                          M PREV_BANK = high (_USBBuffer)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _USBBuffer
                          M     else
                          M       if (low (002h) == 255)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 199


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         setf    _USBBuffer
                          M       else
001036 0E02               M         movlw   low (002h)
001038 6F90               M         movwf   _USBBuffer
                          M       endif
                          M     endif
                      01458 
                      01459 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00224           USBBuffer[1]=ANALOG6.lowbyte
                      01460         MOVE?BB _ANALOG6??LOWBYTE, _USBBuffer + 00001h
00103A C07C F091          M         movff   _ANALOG6??LOWBYTE, _USBBuffer + 00001h
                      01461 
                      01462 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00225           USBBuffer[2]=ANALOG6.highbyte
                      01463         MOVE?BB _ANALOG6??HIGHBYTE, _USBBuffer + 00002h
00103E C07D F092          M         movff   _ANALOG6??HIGHBYTE, _USBBuffer + 00002h
                      01464 
                      01465 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00226           USBBuffer[3]=ANALOG0.lowbyte
                      01466         MOVE?BB _ANALOG0??LOWBYTE, _USBBuffer + 00003h
001042 C070 F093          M         movff   _ANALOG0??LOWBYTE, _USBBuffer + 00003h
                      01467 
                      01468 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00227           USBBuffer[4]=ANALOG0.highbyte
                      01469         MOVE?BB _ANALOG0??HIGHBYTE, _USBBuffer + 00004h
001046 C071 F094          M         movff   _ANALOG0??HIGHBYTE, _USBBuffer + 00004h
                      01470 
                      01471 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00228           USBBuffer[5]=ANALOG2.lowbyte
                      01472         MOVE?BB _ANALOG2??LOWBYTE, _USBBuffer + 00005h
00104A C074 F095          M         movff   _ANALOG2??LOWBYTE, _USBBuffer + 00005h
                      01473 
                      01474 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00229           USBBuffer[6]=ANALOG2.highbyte
                      01475         MOVE?BB _ANALOG2??HIGHBYTE, _USBBuffer + 00006h
00104E C075 F096          M         movff   _ANALOG2??HIGHBYTE, _USBBuffer + 00006h
                      01476 
                      01477 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00230           USBBuffer[7]=ANALOG4.lowbyte
                      01478         MOVE?BB _ANALOG4??LOWBYTE, _USBBuffer + 00007h
001052 C078 F097          M         movff   _ANALOG4??LOWBYTE, _USBBuffer + 00007h
                      01479 
                      01480 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00231           USBBuffer[8]=ANALOG4.highbyte
                      01481         MOVE?BB _ANALOG4??HIGHBYTE, _USBBuffer + 00008h
001056 C079 F098          M         movff   _ANALOG4??HIGHBYTE, _USBBuffer + 00008h
                      01482 
                      01483 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00233           Temp.0=FunctionKeys.1
                      01484         MOVE?TT _FunctionKeys??1, _Temp??0
                          M     if (((_FunctionKeys) <= BANKA_END) | ((_FunctionKeys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _FunctionKeys, 001h
                          M         bsf     _Temp,  000h
                          M         btfss   _FunctionKeys, 001h
                          M         bcf     _Temp,  000h
                          M     else
                          M       if (((_FunctionKeys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 200


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
00105A B361               M         btfsc   _FunctionKeys, 001h
00105C 819D               M         bsf     _Temp,  000h
00105E A361               M         btfss   _FunctionKeys, 001h
001060 919D               M         bcf     _Temp,  000h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _FunctionKeys
                          M         btfsc   _FunctionKeys, 001h
                          M         bsf     _Temp,  000h
                          M         btfss   _FunctionKeys, 001h
                          M         bcf     _Temp,  000h
                          M           else
                          M         MOVE?TA _FunctionKeys, 001h
                          M         MOVE?AT _Temp,  000h
                          M           endif
                          M       endif
                          M     endif
                      01485 
                      01486 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00234           Temp.1=FunctionKeys.2
                      01487         MOVE?TT _FunctionKeys??2, _Temp??1
                          M     if (((_FunctionKeys) <= BANKA_END) | ((_FunctionKeys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _FunctionKeys, 002h
                          M         bsf     _Temp,  001h
                          M         btfss   _FunctionKeys, 002h
                          M         bcf     _Temp,  001h
                          M     else
                          M       if (((_FunctionKeys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 201


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
001062 B561               M         btfsc   _FunctionKeys, 002h
001064 839D               M         bsf     _Temp,  001h
001066 A561               M         btfss   _FunctionKeys, 002h
001068 939D               M         bcf     _Temp,  001h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _FunctionKeys
                          M         btfsc   _FunctionKeys, 002h
                          M         bsf     _Temp,  001h
                          M         btfss   _FunctionKeys, 002h
                          M         bcf     _Temp,  001h
                          M           else
                          M         MOVE?TA _FunctionKeys, 002h
                          M         MOVE?AT _Temp,  001h
                          M           endif
                          M       endif
                          M     endif
                      01488 
                      01489 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00235           Temp.2=FunctionKeys.4
                      01490         MOVE?TT _FunctionKeys??4, _Temp??2
                          M     if (((_FunctionKeys) <= BANKA_END) | ((_FunctionKeys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _FunctionKeys, 004h
                          M         bsf     _Temp,  002h
                          M         btfss   _FunctionKeys, 004h
                          M         bcf     _Temp,  002h
                          M     else
                          M       if (((_FunctionKeys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
00106A B961               M         btfsc   _FunctionKeys, 004h
00106C 859D               M         bsf     _Temp,  002h
00106E A961               M         btfss   _FunctionKeys, 004h
001070 959D               M         bcf     _Temp,  002h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _FunctionKeys
                          M         btfsc   _FunctionKeys, 004h
                          M         bsf     _Temp,  002h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 202


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfss   _FunctionKeys, 004h
                          M         bcf     _Temp,  002h
                          M           else
                          M         MOVE?TA _FunctionKeys, 004h
                          M         MOVE?AT _Temp,  002h
                          M           endif
                          M       endif
                          M     endif
                      01491 
                      01492 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00236           Temp.3=P2Keys.0
                      01493         MOVE?TT _P2Keys??0, _Temp??3
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 000h
                          M         bsf     _Temp,  003h
                          M         btfss   _P2Keys, 000h
                          M         bcf     _Temp,  003h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
001072 B164               M         btfsc   _P2Keys, 000h
001074 879D               M         bsf     _Temp,  003h
001076 A164               M         btfss   _P2Keys, 000h
001078 979D               M         bcf     _Temp,  003h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 000h
                          M         bsf     _Temp,  003h
                          M         btfss   _P2Keys, 000h
                          M         bcf     _Temp,  003h
                          M           else
                          M         MOVE?TA _P2Keys, 000h
                          M         MOVE?AT _Temp,  003h
                          M           endif
                          M       endif
                          M     endif
                      01494 
                      01495 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00237           Temp.4=P2Keys.5
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 203


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01496         MOVE?TT _P2Keys??5, _Temp??4
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 005h
                          M         bsf     _Temp,  004h
                          M         btfss   _P2Keys, 005h
                          M         bcf     _Temp,  004h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
00107A BB64               M         btfsc   _P2Keys, 005h
00107C 899D               M         bsf     _Temp,  004h
00107E AB64               M         btfss   _P2Keys, 005h
001080 999D               M         bcf     _Temp,  004h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 005h
                          M         bsf     _Temp,  004h
                          M         btfss   _P2Keys, 005h
                          M         bcf     _Temp,  004h
                          M           else
                          M         MOVE?TA _P2Keys, 005h
                          M         MOVE?AT _Temp,  004h
                          M           endif
                          M       endif
                          M     endif
                      01497 
                      01498 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00238           Temp.5=P2Keys.6
                      01499         MOVE?TT _P2Keys??6, _Temp??5
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 006h
                          M         bsf     _Temp,  005h
                          M         btfss   _P2Keys, 006h
                          M         bcf     _Temp,  005h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 204


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
001082 BD64               M         btfsc   _P2Keys, 006h
001084 8B9D               M         bsf     _Temp,  005h
001086 AD64               M         btfss   _P2Keys, 006h
001088 9B9D               M         bcf     _Temp,  005h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 006h
                          M         bsf     _Temp,  005h
                          M         btfss   _P2Keys, 006h
                          M         bcf     _Temp,  005h
                          M           else
                          M         MOVE?TA _P2Keys, 006h
                          M         MOVE?AT _Temp,  005h
                          M           endif
                          M       endif
                          M     endif
                      01500 
                      01501 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00239           Temp.6=P2Keys.7
                      01502         MOVE?TT _P2Keys??7, _Temp??6
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 007h
                          M         bsf     _Temp,  006h
                          M         btfss   _P2Keys, 007h
                          M         bcf     _Temp,  006h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 205


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
00108A BF64               M         btfsc   _P2Keys, 007h
00108C 8D9D               M         bsf     _Temp,  006h
00108E AF64               M         btfss   _P2Keys, 007h
001090 9D9D               M         bcf     _Temp,  006h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 007h
                          M         bsf     _Temp,  006h
                          M         btfss   _P2Keys, 007h
                          M         bcf     _Temp,  006h
                          M           else
                          M         MOVE?TA _P2Keys, 007h
                          M         MOVE?AT _Temp,  006h
                          M           endif
                          M       endif
                          M     endif
                      01503 
                      01504 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00240           Temp.7=P2Keys.8
                      01505         MOVE?TT _P2Keys??8, _Temp??7
                          M     if (((_P2Keys + 001h) <= BANKA_END) | ((_P2Keys + 001h) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys + 001h, 000h
                          M         bsf     _Temp,  007h
                          M         btfss   _P2Keys + 001h, 000h
                          M         bcf     _Temp,  007h
                          M     else
                          M       if (((_P2Keys + 001h) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys + 001h
                          M     if (((_P2Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P2Keys + 001h) & 0fffh) > BANKA_END) & (((_P2Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys + 001h)
                          M PREV_BANK = high (_P2Keys + 001h)
                          M       endif
                          M     endif
001092 B165               M         btfsc   _P2Keys + 001h, 000h
001094 8F9D               M         bsf     _Temp,  007h
001096 A165               M         btfss   _P2Keys + 001h, 000h
001098 9F9D               M         bcf     _Temp,  007h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 206


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _P2Keys + 001h
                          M         btfsc   _P2Keys + 001h, 000h
                          M         bsf     _Temp,  007h
                          M         btfss   _P2Keys + 001h, 000h
                          M         bcf     _Temp,  007h
                          M           else
                          M         MOVE?TA _P2Keys + 001h, 000h
                          M         MOVE?AT _Temp,  007h
                          M           endif
                          M       endif
                          M     endif
                      01506 
                      01507 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00242           USBBuffer[9]=Temp;P2Keys.lowbyte
                      01508         MOVE?BB _Temp, _USBBuffer + 00009h
00109A C09D F099          M         movff   _Temp, _USBBuffer + 00009h
                      01509 
                      01510 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00244           Temp.0=P2Keys.9
                      01511         MOVE?TT _P2Keys??9, _Temp??0
                          M     if (((_P2Keys + 001h) <= BANKA_END) | ((_P2Keys + 001h) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys + 001h, 001h
                          M         bsf     _Temp,  000h
                          M         btfss   _P2Keys + 001h, 001h
                          M         bcf     _Temp,  000h
                          M     else
                          M       if (((_P2Keys + 001h) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys + 001h
                          M     if (((_P2Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P2Keys + 001h) & 0fffh) > BANKA_END) & (((_P2Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys + 001h)
                          M PREV_BANK = high (_P2Keys + 001h)
                          M       endif
                          M     endif
00109E B365               M         btfsc   _P2Keys + 001h, 001h
0010A0 819D               M         bsf     _Temp,  000h
0010A2 A365               M         btfss   _P2Keys + 001h, 001h
0010A4 919D               M         bcf     _Temp,  000h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys + 001h
                          M         btfsc   _P2Keys + 001h, 001h
                          M         bsf     _Temp,  000h
                          M         btfss   _P2Keys + 001h, 001h
                          M         bcf     _Temp,  000h
                          M           else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 207


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?TA _P2Keys + 001h, 001h
                          M         MOVE?AT _Temp,  000h
                          M           endif
                          M       endif
                          M     endif
                      01512 
                      01513 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00245           Temp.1=P2Keys.10
                      01514         MOVE?TT _P2Keys??10, _Temp??1
                          M     if (((_P2Keys + 001h) <= BANKA_END) | ((_P2Keys + 001h) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys + 001h, 002h
                          M         bsf     _Temp,  001h
                          M         btfss   _P2Keys + 001h, 002h
                          M         bcf     _Temp,  001h
                          M     else
                          M       if (((_P2Keys + 001h) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys + 001h
                          M     if (((_P2Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P2Keys + 001h) & 0fffh) > BANKA_END) & (((_P2Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys + 001h)
                          M PREV_BANK = high (_P2Keys + 001h)
                          M       endif
                          M     endif
0010A6 B565               M         btfsc   _P2Keys + 001h, 002h
0010A8 839D               M         bsf     _Temp,  001h
0010AA A565               M         btfss   _P2Keys + 001h, 002h
0010AC 939D               M         bcf     _Temp,  001h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys + 001h
                          M         btfsc   _P2Keys + 001h, 002h
                          M         bsf     _Temp,  001h
                          M         btfss   _P2Keys + 001h, 002h
                          M         bcf     _Temp,  001h
                          M           else
                          M         MOVE?TA _P2Keys + 001h, 002h
                          M         MOVE?AT _Temp,  001h
                          M           endif
                          M       endif
                          M     endif
                      01515 
                      01516 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00246           Temp.2=P2Keys.1
                      01517         MOVE?TT _P2Keys??1, _Temp??2
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 208


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   _P2Keys, 001h
                          M         bsf     _Temp,  002h
                          M         btfss   _P2Keys, 001h
                          M         bcf     _Temp,  002h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
0010AE B364               M         btfsc   _P2Keys, 001h
0010B0 859D               M         bsf     _Temp,  002h
0010B2 A364               M         btfss   _P2Keys, 001h
0010B4 959D               M         bcf     _Temp,  002h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 001h
                          M         bsf     _Temp,  002h
                          M         btfss   _P2Keys, 001h
                          M         bcf     _Temp,  002h
                          M           else
                          M         MOVE?TA _P2Keys, 001h
                          M         MOVE?AT _Temp,  002h
                          M           endif
                          M       endif
                          M     endif
                      01518 
                      01519 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00247           Temp.3=P2Keys.2
                      01520         MOVE?TT _P2Keys??2, _Temp??3
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 002h
                          M         bsf     _Temp,  003h
                          M         btfss   _P2Keys, 002h
                          M         bcf     _Temp,  003h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 209


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
0010B6 B564               M         btfsc   _P2Keys, 002h
0010B8 879D               M         bsf     _Temp,  003h
0010BA A564               M         btfss   _P2Keys, 002h
0010BC 979D               M         bcf     _Temp,  003h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 002h
                          M         bsf     _Temp,  003h
                          M         btfss   _P2Keys, 002h
                          M         bcf     _Temp,  003h
                          M           else
                          M         MOVE?TA _P2Keys, 002h
                          M         MOVE?AT _Temp,  003h
                          M           endif
                          M       endif
                          M     endif
                      01521 
                      01522 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00248           Temp.4=P2Keys.3
                      01523         MOVE?TT _P2Keys??3, _Temp??4
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 003h
                          M         bsf     _Temp,  004h
                          M         btfss   _P2Keys, 003h
                          M         bcf     _Temp,  004h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 210


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
0010BE B764               M         btfsc   _P2Keys, 003h
0010C0 899D               M         bsf     _Temp,  004h
0010C2 A764               M         btfss   _P2Keys, 003h
0010C4 999D               M         bcf     _Temp,  004h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 003h
                          M         bsf     _Temp,  004h
                          M         btfss   _P2Keys, 003h
                          M         bcf     _Temp,  004h
                          M           else
                          M         MOVE?TA _P2Keys, 003h
                          M         MOVE?AT _Temp,  004h
                          M           endif
                          M       endif
                          M     endif
                      01524 
                      01525 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00249           Temp.5=P2Keys.4
                      01526         MOVE?TT _P2Keys??4, _Temp??5
                          M     if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _Temp
                          M         btfsc   _P2Keys, 004h
                          M         bsf     _Temp,  005h
                          M         btfss   _P2Keys, 004h
                          M         bcf     _Temp,  005h
                          M     else
                          M       if (((_P2Keys) & 0f00h) == ((_Temp) & 0f00h))
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
0010C6 B964               M         btfsc   _P2Keys, 004h
0010C8 8B9D               M         bsf     _Temp,  005h
0010CA A964               M         btfss   _P2Keys, 004h
0010CC 9B9D               M         bcf     _Temp,  005h
                          M       else
                          M           if (((_Temp)  <= BANKA_END) | ((_Temp)  >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _P2Keys, 004h
                          M         bsf     _Temp,  005h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 211


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfss   _P2Keys, 004h
                          M         bcf     _Temp,  005h
                          M           else
                          M         MOVE?TA _P2Keys, 004h
                          M         MOVE?AT _Temp,  005h
                          M           endif
                          M       endif
                          M     endif
                      01527 
                      01528 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00250           Temp.6=0
                      01529         MOVE?CT 000h, _Temp??6
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _Temp,  006h
                          M     else
0010CE 9D9D               M         bcf     _Temp,  006h
                          M     endif
                      01530 
                      01531 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00251           Temp.7=0
                      01532         MOVE?CT 000h, _Temp??7
                          M         CHK?RP  _Temp
                          M     if (((_Temp) & 8000h) != PREV_ALT)
                          M       if ((_Temp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_Temp) & 8000h
                          M     endif
                          M     if ((((_Temp) & 0fffh) > BANKA_END) & (((_Temp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_Temp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_Temp)
                          M PREV_BANK = high (_Temp)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _Temp,  007h
                          M     else
0010D0 9F9D               M         bcf     _Temp,  007h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 212


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01533 
                      01534 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00253           USBBuffer[10]=Temp;P2Keys.highbyte
                      01535         MOVE?BB _Temp, _USBBuffer + 0000Ah
0010D2 C09D F09A          M         movff   _Temp, _USBBuffer + 0000Ah
                      01536 
                      01537 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00254           gosub DoUSBOut
                      01538         GOSUB?L _DoUSBOut
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBOut
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _DoUSBOut
                          M     else
                          M       if ((_DoUSBOut) < 1)
                          M         call    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) > $)
0010D6 ECB4 F00C          M         call    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) < ($ - 3ffh))
                          M         call    _DoUSBOut
                          M           else
                          M         rcall   _DoUSBOut
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0010DA                    M dlabel
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 213


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01539 
                      01540 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00255       endif
                      01541         LABEL?L L00017  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00017
                          M         XALL
                          M     else
0010DA                    M L00017
                          M     endif
                      01542 
                      01543 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00257       if AllFlags.3=1 then
                      01544         CMPNE?TCL       _AllFlags??3, 001h, L00019
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _AllFlags, 003h, L00019
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0010DA 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _AllFlags, 003h, L00019
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00019))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_AllFlags) > BANKA_END) & ((_AllFlags) < (0f01h + BANKA_END)))
0010DC 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 214


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0010DE A760               M         btfss   _AllFlags, 003h
                          M       else
                          M         btfsc   _AllFlags, 003h
                          M       endif
0010E0 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M       else
                          M         if ((L00019) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M         else
                          M           if ((L00019) > $)
0010E2 B6D8               M         btfsc   STATUS, OV
0010E4 EF0C F009          M         goto    L00019
                          M           else
                          M             if ((L00019) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00019
                          M             else
                          M         bov     L00019
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _AllFlags, 003h
                          M       else
                          M         btfsc   _AllFlags, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00019
                          M       else
                          M         if ((L00019) < 1)
                          M         goto    L00019
                          M         else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 215


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((L00019) > $)
                          M         goto    L00019
                          M           else
                          M             if ((L00019) < ($ - 3ffh))
                          M         goto    L00019
                          M             else
                          M         bra     L00019
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00019
                          M       endif
                          M     endif
                      01545 
                      01546 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00258           AllFlags.3=0
                      01547         MOVE?CT 000h, _AllFlags??3
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 003h
                          M     else
0010E8 9760               M         bcf     _AllFlags, 003h
                          M     endif
                      01548 
                      01549 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00259           idtx=3 'Keyboard
                      01550         MOVE?CB 003h, _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 216


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
                          M     if (low (003h) == 0)
                          M         clrf    _IDTX
                          M     else
                          M       if (low (003h) == 255)
                          M         setf    _IDTX
                          M       else
0010EA 0E03               M         movlw   low (003h)
0010EC 6F9C               M         movwf   _IDTX
                          M       endif
                          M     endif
                      01551 
                      01552 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00260           for i=0  to 7
                      01553         MOVE?CB 000h, _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0010EE 6BA7               M         clrf    _i
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _i
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _i
                          M       endif
                          M     endif
                      01554         LABEL?L L00021  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 217


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         LALL
                          M L00021
                          M         XALL
                          M     else
0010F0                    M L00021
                          M     endif
                      01555         CMPGT?BCL       _i, 007h, L00022
                          M     if ((007h) < 0)
                          M         L?GOTO  L00022
                          M     else
                          M       if ((007h) < 0ffh)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0010F0 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (007h) + 1
0010F2 0E08               M         movlw   low ((007h) + 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0010F4 5DA7               M         subwf   _i,  W
                          M         BIT?GOTO 1, STATUS, C, L00022
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00022))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 218


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00022
                          M       else
                          M         if ((L00022) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00022
                          M         else
                          M           if ((L00022) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00022
                          M           else
                          M             if ((L00022) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00022
                          M             else
                          M         bov     L00022
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, C
                          M       else
0010F6 B0D8               M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00022
                          M       else
                          M         if ((L00022) < 1)
                          M         goto    L00022
                          M         else
                          M           if ((L00022) > $)
0010F8 EF88 F008          M         goto    L00022
                          M           else
                          M             if ((L00022) < ($ - 3ffh))
                          M         goto    L00022
                          M             else
                          M         bra     L00022
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 219


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                      01556 
                      01557 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00261               USBBuffer[i]=0
                      01558         AIN?CBB 000h, _USBBuffer, _i
                          M         MOVE?BA _i
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
0010FC 51A7               M         movf    _i,  W
0010FE 0F90               M         addlw   low (_USBBuffer)
001100 6EE9               M         movwf   FSR0L
001102 0E00               M         movlw   (_USBBuffer) >> 8
001104 6AEA               M         clrf    FSR0H
001106 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 000h, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001108 6AEF               M         clrf    INDF0
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    INDF0
                          M       else
                          M         movlw   low (000h)
                          M         movwf   INDF0
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 220


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01559 
                      01560 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00262           next i
                      01561         NEXT?BCL        _i, 001h, L00021
                          M     if ((001h) == 1)
                          M         CHK?RP  _i
                          M     if (((_i)    & 8000h) != PREV_ALT)
                          M       if ((_i)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_i)    & 8000h
                          M     endif
                          M     if ((((_i)    & 0fffh) > BANKA_END) & (((_i)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_i)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_i)
                          M PREV_BANK = high (_i)
                          M       endif
                          M     endif
00110A 2BA7               M         incf    _i,  F
                          M     else
                          M         movlw   001h
                          M         CHK?RP  _i
                          M         addwf   _i,  F
                          M     endif
                          M     if ((001h) <= 255)
                          M         BIT?GOTO 0, STATUS, C, L00021
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00021))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M       else
                          M         if ((L00021) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M         else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 221


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((L00021) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M           else
                          M             if ((L00021) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00021
                          M             else
                          M         bov     L00021
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00110C A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00021
                          M       else
                          M         if ((L00021) < 1)
                          M         goto    L00021
                          M         else
                          M           if ((L00021) > $)
                          M         goto    L00021
                          M           else
                          M             if ((L00021) < ($ - 3ffh))
                          M         goto    L00021
                          M             else
00110E D7F0               M         bra     L00021
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     endif
                      01562         LABEL?L L00022  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 222


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00022
                          M         XALL
                          M     else
001110                    M L00022
                          M     endif
                      01563 
                      01564 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00263           x=2
                      01565         MOVE?CB 002h, _x
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _x
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    _x
                          M       else
001110 0E02               M         movlw   low (002h)
001112 6FA8               M         movwf   _x
                          M       endif
                          M     endif
                      01566 
                      01567 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00264           if mediak.0=1 then USBBuffer[x]=41 : x=x+1
                      01568         CMPNE?TCL       _MEDIAK??0, 001h, L00023
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 000h, L00023
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001114 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 000h, L00023
                          M     ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 223


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00023))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
001116 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001118 A1A5               M         btfss   _MEDIAK, 000h
                          M       else
                          M         btfsc   _MEDIAK, 000h
                          M       endif
00111A 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00023
                          M       else
                          M         if ((L00023) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00023
                          M         else
                          M           if ((L00023) > $)
00111C B6D8               M         btfsc   STATUS, OV
00111E EF9A F008          M         goto    L00023
                          M           else
                          M             if ((L00023) < ($ - 7fh))
                          M         btfsc   STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 224


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00023
                          M             else
                          M         bov     L00023
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 000h
                          M       else
                          M         btfsc   _MEDIAK, 000h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00023
                          M       else
                          M         if ((L00023) < 1)
                          M         goto    L00023
                          M         else
                          M           if ((L00023) > $)
                          M         goto    L00023
                          M           else
                          M             if ((L00023) < ($ - 3ffh))
                          M         goto    L00023
                          M             else
                          M         bra     L00023
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00023
                          M       endif
                          M     endif
                      01569         AIN?CBB 029h, _USBBuffer, _x
                          M         MOVE?BA _x
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 225


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001122 51A8               M         movf    _x,  W
001124 0F90               M         addlw   low (_USBBuffer)
001126 6EE9               M         movwf   FSR0L
001128 0E00               M         movlw   (_USBBuffer) >> 8
00112A 6AEA               M         clrf    FSR0H
00112C 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 029h, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (029h) == 0)
                          M         clrf    INDF0
                          M     else
                          M       if (low (029h) == 255)
                          M         setf    INDF0
                          M       else
00112E 0E29               M         movlw   low (029h)
001130 6EEF               M         movwf   INDF0
                          M       endif
                          M     endif
                      01570         ADD?BCB _x, 001h, _x
                          M     if ((_x)   == (_x))
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
001132 2BA8               M         incf    _x,   F
                          M       else
                          M         movlw   001h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 226


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _x
                          M         addwf   _x,  F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M         incf    _x,  W
                          M         MOVE?AB _x
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  W
                          M         MOVE?AB _x
                          M       endif
                          M     endif
                      01571         LABEL?L L00023  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00023
                          M         XALL
                          M     else
001134                    M L00023
                          M     endif
                      01572 
                      01573 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00266           if porta.5=1 then
                      01574         CMPNE?TCL       _PORTA??5, 001h, L00025
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, PORTA, 005h,  L00025
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001134 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, PORTA, 005h,  L00025
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00025))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 227


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((PORTA) > BANKA_END) & ((PORTA) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  PORTA
                          M       if ((0)      == 0)
                          M         btfss   PORTA, 005h
                          M       else
                          M         btfsc   PORTA, 005h
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M       else
                          M         if ((L00025) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M         else
                          M           if ((L00025) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M           else
                          M             if ((L00025) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00025
                          M             else
                          M         bov     L00025
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001136 AA80               M         btfss   PORTA, 005h
                          M       else
                          M         btfsc   PORTA, 005h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00025
                          M       else
                          M         if ((L00025) < 1)
                          M         goto    L00025
                          M         else
                          M           if ((L00025) > $)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 228


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001138 EFEE F008          M         goto    L00025
                          M           else
                          M             if ((L00025) < ($ - 3ffh))
                          M         goto    L00025
                          M             else
                          M         bra     L00025
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00025
                          M       endif
                          M     endif
                      01575 
                      01576 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00267               if mediak.1=1 then USBBuffer[x]=82 : x=x+1
                      01577         CMPNE?TCL       _MEDIAK??1, 001h, L00027
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 001h, L00027
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00113C 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 001h, L00027
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00027))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
00113E 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 229


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((0)      == 0)
001140 A3A5               M         btfss   _MEDIAK, 001h
                          M       else
                          M         btfsc   _MEDIAK, 001h
                          M       endif
001142 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M       else
                          M         if ((L00027) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M         else
                          M           if ((L00027) > $)
001144 B6D8               M         btfsc   STATUS, OV
001146 EFAE F008          M         goto    L00027
                          M           else
                          M             if ((L00027) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00027
                          M             else
                          M         bov     L00027
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 001h
                          M       else
                          M         btfsc   _MEDIAK, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00027
                          M       else
                          M         if ((L00027) < 1)
                          M         goto    L00027
                          M         else
                          M           if ((L00027) > $)
                          M         goto    L00027
                          M           else
                          M             if ((L00027) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 230


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00027
                          M             else
                          M         bra     L00027
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00027
                          M       endif
                          M     endif
                      01578         AIN?CBB 052h, _USBBuffer, _x
                          M         MOVE?BA _x
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
00114A 51A8               M         movf    _x,  W
00114C 0F90               M         addlw   low (_USBBuffer)
00114E 6EE9               M         movwf   FSR0L
001150 0E00               M         movlw   (_USBBuffer) >> 8
001152 6AEA               M         clrf    FSR0H
001154 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 052h, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (052h) == 0)
                          M         clrf    INDF0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 231


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if (low (052h) == 255)
                          M         setf    INDF0
                          M       else
001156 0E52               M         movlw   low (052h)
001158 6EEF               M         movwf   INDF0
                          M       endif
                          M     endif
                      01579         ADD?BCB _x, 001h, _x
                          M     if ((_x)   == (_x))
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
00115A 2BA8               M         incf    _x,   F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M         incf    _x,  W
                          M         MOVE?AB _x
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  W
                          M         MOVE?AB _x
                          M       endif
                          M     endif
                      01580         LABEL?L L00027  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 232


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00027
                          M         XALL
                          M     else
00115C                    M L00027
                          M     endif
                      01581 
                      01582 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00268               if mediak.2=1 then USBBuffer[x]=81 : x=x+1
                      01583         CMPNE?TCL       _MEDIAK??2, 001h, L00029
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 002h, L00029
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00115C 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 002h, L00029
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00029))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
00115E 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001160 A5A5               M         btfss   _MEDIAK, 002h
                          M       else
                          M         btfsc   _MEDIAK, 002h
                          M       endif
001162 86D8               M         bsf     STATUS, OV
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 233


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M       else
                          M         if ((L00029) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M         else
                          M           if ((L00029) > $)
001164 B6D8               M         btfsc   STATUS, OV
001166 EFBE F008          M         goto    L00029
                          M           else
                          M             if ((L00029) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00029
                          M             else
                          M         bov     L00029
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 002h
                          M       else
                          M         btfsc   _MEDIAK, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00029
                          M       else
                          M         if ((L00029) < 1)
                          M         goto    L00029
                          M         else
                          M           if ((L00029) > $)
                          M         goto    L00029
                          M           else
                          M             if ((L00029) < ($ - 3ffh))
                          M         goto    L00029
                          M             else
                          M         bra     L00029
                          M             endif
                          M           endif
                          M         endif
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 234


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M       else
                          M         L?GOTO  L00029
                          M       endif
                          M     endif
                      01584         AIN?CBB 051h, _USBBuffer, _x
                          M         MOVE?BA _x
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
00116A 51A8               M         movf    _x,  W
00116C 0F90               M         addlw   low (_USBBuffer)
00116E 6EE9               M         movwf   FSR0L
001170 0E00               M         movlw   (_USBBuffer) >> 8
001172 6AEA               M         clrf    FSR0H
001174 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 051h, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (051h) == 0)
                          M         clrf    INDF0
                          M     else
                          M       if (low (051h) == 255)
                          M         setf    INDF0
                          M       else
001176 0E51               M         movlw   low (051h)
001178 6EEF               M         movwf   INDF0
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 235


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01585         ADD?BCB _x, 001h, _x
                          M     if ((_x)   == (_x))
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
00117A 2BA8               M         incf    _x,   F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M         incf    _x,  W
                          M         MOVE?AB _x
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  W
                          M         MOVE?AB _x
                          M       endif
                          M     endif
                      01586         LABEL?L L00029  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00029
                          M         XALL
                          M     else
00117C                    M L00029
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 236


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01587 
                      01588 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00269               if mediak.3=1 then USBBuffer[x]=80 : x=x+1
                      01589         CMPNE?TCL       _MEDIAK??3, 001h, L00031
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 003h, L00031
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00117C 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 003h, L00031
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00031))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
00117E 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001180 A7A5               M         btfss   _MEDIAK, 003h
                          M       else
                          M         btfsc   _MEDIAK, 003h
                          M       endif
001182 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 237


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M       else
                          M         if ((L00031) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M         else
                          M           if ((L00031) > $)
001184 B6D8               M         btfsc   STATUS, OV
001186 EFCE F008          M         goto    L00031
                          M           else
                          M             if ((L00031) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00031
                          M             else
                          M         bov     L00031
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 003h
                          M       else
                          M         btfsc   _MEDIAK, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00031
                          M       else
                          M         if ((L00031) < 1)
                          M         goto    L00031
                          M         else
                          M           if ((L00031) > $)
                          M         goto    L00031
                          M           else
                          M             if ((L00031) < ($ - 3ffh))
                          M         goto    L00031
                          M             else
                          M         bra     L00031
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00031
                          M       endif
                          M     endif
                      01590         AIN?CBB 050h, _USBBuffer, _x
                          M         MOVE?BA _x
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 238


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
00118A 51A8               M         movf    _x,  W
00118C 0F90               M         addlw   low (_USBBuffer)
00118E 6EE9               M         movwf   FSR0L
001190 0E00               M         movlw   (_USBBuffer) >> 8
001192 6AEA               M         clrf    FSR0H
001194 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 050h, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (050h) == 0)
                          M         clrf    INDF0
                          M     else
                          M       if (low (050h) == 255)
                          M         setf    INDF0
                          M       else
001196 0E50               M         movlw   low (050h)
001198 6EEF               M         movwf   INDF0
                          M       endif
                          M     endif
                      01591         ADD?BCB _x, 001h, _x
                          M     if ((_x)   == (_x))
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 239


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
00119A 2BA8               M         incf    _x,   F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M         incf    _x,  W
                          M         MOVE?AB _x
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  W
                          M         MOVE?AB _x
                          M       endif
                          M     endif
                      01592         LABEL?L L00031  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00031
                          M         XALL
                          M     else
00119C                    M L00031
                          M     endif
                      01593 
                      01594 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00270               if mediak.4=1 then USBBuffer[x]=79 : x=x+1
                      01595         CMPNE?TCL       _MEDIAK??4, 001h, L00033
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 004h, L00033
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 240


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00119C 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 004h, L00033
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00033))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
00119E 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0011A0 A9A5               M         btfss   _MEDIAK, 004h
                          M       else
                          M         btfsc   _MEDIAK, 004h
                          M       endif
0011A2 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00033
                          M       else
                          M         if ((L00033) < 1)
                          M         btfsc   STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 241


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00033
                          M         else
                          M           if ((L00033) > $)
0011A4 B6D8               M         btfsc   STATUS, OV
0011A6 EFDE F008          M         goto    L00033
                          M           else
                          M             if ((L00033) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00033
                          M             else
                          M         bov     L00033
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 004h
                          M       else
                          M         btfsc   _MEDIAK, 004h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00033
                          M       else
                          M         if ((L00033) < 1)
                          M         goto    L00033
                          M         else
                          M           if ((L00033) > $)
                          M         goto    L00033
                          M           else
                          M             if ((L00033) < ($ - 3ffh))
                          M         goto    L00033
                          M             else
                          M         bra     L00033
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00033
                          M       endif
                          M     endif
                      01596         AIN?CBB 04Fh, _USBBuffer, _x
                          M         MOVE?BA _x
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 242


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
0011AA 51A8               M         movf    _x,  W
0011AC 0F90               M         addlw   low (_USBBuffer)
0011AE 6EE9               M         movwf   FSR0L
0011B0 0E00               M         movlw   (_USBBuffer) >> 8
0011B2 6AEA               M         clrf    FSR0H
0011B4 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 04Fh, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (04Fh) == 0)
                          M         clrf    INDF0
                          M     else
                          M       if (low (04Fh) == 255)
                          M         setf    INDF0
                          M       else
0011B6 0E4F               M         movlw   low (04Fh)
0011B8 6EEF               M         movwf   INDF0
                          M       endif
                          M     endif
                      01597         ADD?BCB _x, 001h, _x
                          M     if ((_x)   == (_x))
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 243


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
0011BA 2BA8               M         incf    _x,   F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M         incf    _x,  W
                          M         MOVE?AB _x
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  W
                          M         MOVE?AB _x
                          M       endif
                          M     endif
                      01598         LABEL?L L00033  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00033
                          M         XALL
                          M     else
0011BC                    M L00033
                          M     endif
                      01599 
                      01600 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00271               if mediak.5=1 then USBBuffer[x]=40 : x=x+1
                      01601         CMPNE?TCL       _MEDIAK??5, 001h, L00035
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 005h, L00035
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0011BC 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 005h, L00035
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 244


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00035))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
0011BE 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0011C0 ABA5               M         btfss   _MEDIAK, 005h
                          M       else
                          M         btfsc   _MEDIAK, 005h
                          M       endif
0011C2 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M       else
                          M         if ((L00035) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M         else
                          M           if ((L00035) > $)
0011C4 B6D8               M         btfsc   STATUS, OV
0011C6 EFEE F008          M         goto    L00035
                          M           else
                          M             if ((L00035) < ($ - 7fh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 245


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00035
                          M             else
                          M         bov     L00035
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 005h
                          M       else
                          M         btfsc   _MEDIAK, 005h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00035
                          M       else
                          M         if ((L00035) < 1)
                          M         goto    L00035
                          M         else
                          M           if ((L00035) > $)
                          M         goto    L00035
                          M           else
                          M             if ((L00035) < ($ - 3ffh))
                          M         goto    L00035
                          M             else
                          M         bra     L00035
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00035
                          M       endif
                          M     endif
                      01602         AIN?CBB 028h, _USBBuffer, _x
                          M         MOVE?BA _x
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 246


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
0011CA 51A8               M         movf    _x,  W
0011CC 0F90               M         addlw   low (_USBBuffer)
0011CE 6EE9               M         movwf   FSR0L
0011D0 0E00               M         movlw   (_USBBuffer) >> 8
0011D2 6AEA               M         clrf    FSR0H
0011D4 22EA               M         addwfc  FSR0H, F
                          M         MOVE?CB 028h, INDF0
                          M         CHK?RP  INDF0
                          M     if (((INDF0) & 8000h) != PREV_ALT)
                          M       if ((INDF0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (INDF0) & 8000h
                          M     endif
                          M     if ((((INDF0) & 0fffh) > BANKA_END) & (((INDF0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((INDF0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (INDF0)
                          M PREV_BANK = high (INDF0)
                          M       endif
                          M     endif
                          M     if (low (028h) == 0)
                          M         clrf    INDF0
                          M     else
                          M       if (low (028h) == 255)
                          M         setf    INDF0
                          M       else
0011D6 0E28               M         movlw   low (028h)
0011D8 6EEF               M         movwf   INDF0
                          M       endif
                          M     endif
                      01603         ADD?BCB _x, 001h, _x
                          M     if ((_x)   == (_x))
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M     if (((_x)    & 8000h) != PREV_ALT)
                          M       if ((_x)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_x)    & 8000h
                          M     endif
                          M     if ((((_x)    & 0fffh) > BANKA_END) & (((_x)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_x)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_x)
                          M PREV_BANK = high (_x)
                          M       endif
                          M     endif
0011DA 2BA8               M         incf    _x,   F
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 247


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _x
                          M         incf    _x,  W
                          M         MOVE?AB _x
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _x
                          M         addwf   _x,  W
                          M         MOVE?AB _x
                          M       endif
                          M     endif
                      01604         LABEL?L L00035  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00035
                          M         XALL
                          M     else
0011DC                    M L00035
                          M     endif
                      01605 
                      01606 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00272           endif
                      01607         LABEL?L L00025  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00025
                          M         XALL
                          M     else
0011DC                    M L00025
                          M     endif
                      01608 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 248


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01609 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00274           USBBuffer[0]=1
                      01610         MOVE?CB 001h, _USBBuffer
                          M         CHK?RP  _USBBuffer
                          M     if (((_USBBuffer) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer) & 8000h
                          M     endif
                          M     if ((((_USBBuffer) & 0fffh) > BANKA_END) & (((_USBBuffer) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBuffer) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer)
                          M PREV_BANK = high (_USBBuffer)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _USBBuffer
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _USBBuffer
                          M       else
0011DC 0E01               M         movlw   low (001h)
0011DE 6F90               M         movwf   _USBBuffer
                          M       endif
                          M     endif
                      01611 
                      01612 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00275           USBBuffer[1]=0
                      01613         MOVE?CB 000h, _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0011E0 6B91               M         clrf    _USBBuffer + 00001h
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _USBBuffer + 00001h
                          M       else
                          M         movlw   low (000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 249


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movwf   _USBBuffer + 00001h
                          M       endif
                          M     endif
                      01614 
                      01615 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00276           gosub DoUSBOut
                      01616         GOSUB?L _DoUSBOut
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBOut
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _DoUSBOut
                          M     else
                          M       if ((_DoUSBOut) < 1)
                          M         call    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) > $)
0011E2 ECB4 F00C          M         call    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) < ($ - 3ffh))
                          M         call    _DoUSBOut
                          M           else
                          M         rcall   _DoUSBOut
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0011E6                    M dlabel
                      01617 
                      01618 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00278           idtx=2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 250


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01619         MOVE?CB 002h, _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _IDTX
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    _IDTX
                          M       else
0011E6 0E02               M         movlw   low (002h)
0011E8 6F9C               M         movwf   _IDTX
                          M       endif
                          M     endif
                      01620 
                      01621 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00279           USBBuffer[0]=3
                      01622         MOVE?CB 003h, _USBBuffer
                          M         CHK?RP  _USBBuffer
                          M     if (((_USBBuffer) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer) & 8000h
                          M     endif
                          M     if ((((_USBBuffer) & 0fffh) > BANKA_END) & (((_USBBuffer) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBuffer) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer)
                          M PREV_BANK = high (_USBBuffer)
                          M       endif
                          M     endif
                          M     if (low (003h) == 0)
                          M         clrf    _USBBuffer
                          M     else
                          M       if (low (003h) == 255)
                          M         setf    _USBBuffer
                          M       else
0011EA 0E03               M         movlw   low (003h)
0011EC 6F90               M         movwf   _USBBuffer
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 251


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01623 
                      01624 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00280           if mediak.6=1 then USBBuffer[1]=233
                      01625         CMPNE?TCL       _MEDIAK??6, 001h, L00037
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 006h, L00037
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0011EE 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 006h, L00037
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00037))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
0011F0 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0011F2 ADA5               M         btfss   _MEDIAK, 006h
                          M       else
                          M         btfsc   _MEDIAK, 006h
                          M       endif
0011F4 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 252


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00037
                          M       else
                          M         if ((L00037) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00037
                          M         else
                          M           if ((L00037) > $)
0011F6 B6D8               M         btfsc   STATUS, OV
0011F8 EF00 F009          M         goto    L00037
                          M           else
                          M             if ((L00037) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00037
                          M             else
                          M         bov     L00037
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 006h
                          M       else
                          M         btfsc   _MEDIAK, 006h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00037
                          M       else
                          M         if ((L00037) < 1)
                          M         goto    L00037
                          M         else
                          M           if ((L00037) > $)
                          M         goto    L00037
                          M           else
                          M             if ((L00037) < ($ - 3ffh))
                          M         goto    L00037
                          M             else
                          M         bra     L00037
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00037
                          M       endif
                          M     endif
                      01626         MOVE?CB 0E9h, _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 253


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
                          M     if (low (0E9h) == 0)
                          M         clrf    _USBBuffer + 00001h
                          M     else
                          M       if (low (0E9h) == 255)
                          M         setf    _USBBuffer + 00001h
                          M       else
0011FC 0EE9               M         movlw   low (0E9h)
0011FE 6F91               M         movwf   _USBBuffer + 00001h
                          M       endif
                          M     endif
                      01627         LABEL?L L00037  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00037
                          M         XALL
                          M     else
001200                    M L00037
                          M     endif
                      01628 
                      01629 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00281           if mediak.7=1 then USBBuffer[1]=234
                      01630         CMPNE?TCL       _MEDIAK??7, 001h, L00039
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _MEDIAK, 007h, L00039
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001200 0004               M         clrwdt
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 254


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M         BIT?GOTO 0, _MEDIAK, 007h, L00039
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00039))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_MEDIAK) > BANKA_END) & ((_MEDIAK) < (0f01h + BANKA_END)))
001202 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001204 AFA5               M         btfss   _MEDIAK, 007h
                          M       else
                          M         btfsc   _MEDIAK, 007h
                          M       endif
001206 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00039
                          M       else
                          M         if ((L00039) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00039
                          M         else
                          M           if ((L00039) > $)
001208 B6D8               M         btfsc   STATUS, OV
00120A EF09 F009          M         goto    L00039
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 255


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M             if ((L00039) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00039
                          M             else
                          M         bov     L00039
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _MEDIAK, 007h
                          M       else
                          M         btfsc   _MEDIAK, 007h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00039
                          M       else
                          M         if ((L00039) < 1)
                          M         goto    L00039
                          M         else
                          M           if ((L00039) > $)
                          M         goto    L00039
                          M           else
                          M             if ((L00039) < ($ - 3ffh))
                          M         goto    L00039
                          M             else
                          M         bra     L00039
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00039
                          M       endif
                          M     endif
                      01631         MOVE?CB 0EAh, _USBBuffer + 00001h
                          M         CHK?RP  _USBBuffer + 00001h
                          M     if (((_USBBuffer + 00001h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00001h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00001h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00001h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00001h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 256


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_USBBuffer + 00001h)
                          M       endif
                          M     endif
                          M     if (low (0EAh) == 0)
                          M         clrf    _USBBuffer + 00001h
                          M     else
                          M       if (low (0EAh) == 255)
                          M         setf    _USBBuffer + 00001h
                          M       else
00120E 0EEA               M         movlw   low (0EAh)
001210 6F91               M         movwf   _USBBuffer + 00001h
                          M       endif
                          M     endif
                      01632         LABEL?L L00039  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00039
                          M         XALL
                          M     else
001212                    M L00039
                          M     endif
                      01633 
                      01634 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00282           USBBuffer[2]=0
                      01635         MOVE?CB 000h, _USBBuffer + 00002h
                          M         CHK?RP  _USBBuffer + 00002h
                          M     if (((_USBBuffer + 00002h) & 8000h) != PREV_ALT)
                          M       if ((_USBBuffer + 00002h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBuffer + 00002h) & 8000h
                          M     endif
                          M     if ((((_USBBuffer + 00002h) & 0fffh) > BANKA_END) & (((_USBBuffer + 00002h) & 0fffh) < (0f01h + BANK
                            A_END)))
                          M       if (((_USBBuffer + 00002h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBuffer + 00002h)
                          M PREV_BANK = high (_USBBuffer + 00002h)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001212 6B92               M         clrf    _USBBuffer + 00002h
                          M     else
                          M       if (low (000h) == 255)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 257


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         setf    _USBBuffer + 00002h
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _USBBuffer + 00002h
                          M       endif
                          M     endif
                      01636 
                      01637 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00283           gosub DoUSBOut 
                      01638         GOSUB?L _DoUSBOut
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _DoUSBOut
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _DoUSBOut
                          M     else
                          M       if ((_DoUSBOut) < 1)
                          M         call    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) > $)
001214 ECB4 F00C          M         call    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) < ($ - 3ffh))
                          M         call    _DoUSBOut
                          M           else
                          M         rcall   _DoUSBOut
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 258


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001218                    M dlabel
                      01639 
                      01640 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00284       endif
                      01641         LABEL?L L00019  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00019
                          M         XALL
                          M     else
001218                    M L00019
                          M     endif
                      01642 
                      01643 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00286       USBService
                      01644         USBSERVICE?     
                          M         L?CALL  USBDeviceTasks  ; Interrupt or polling method
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceTasks
                          M     else
                          M       if ((USBDeviceTasks) < 1)
                          M         call    USBDeviceTasks
                          M       else
                          M         if ((USBDeviceTasks) > $)
                          M         call    USBDeviceTasks
                          M         else
                          M           if ((USBDeviceTasks) < ($ - 3ffh))
001218 ECE0 F000          M         call    USBDeviceTasks
                          M           else
                          M         rcall   USBDeviceTasks
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 259


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
00121C ECB7 F000          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01645 
                      01646 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00287   goto mainloop
                      01647         GOTO?L  _MainLoop
                          M         L?GOTO  _MainLoop
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_MainLoop))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    _MainLoop
                          M     else
                          M       if ((_MainLoop) < 1)
                          M         goto    _MainLoop
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 260


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((_MainLoop) > $)
                          M         goto    _MainLoop
                          M         else
                          M           if ((_MainLoop) < ($ - 3ffh))
                          M         goto    _MainLoop
                          M           else
001220 D682               M         bra     _MainLoop
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01648 
                      01649 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00292   READIN:
                      01650 
                      01651         LABEL?L _READIN 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _READIN
                          M         XALL
                          M     else
001222                    M _READIN
                          M     endif
                      01652 
                      01653 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00296       FunctionKeys.1 = ~ PORTD.4   'service-
                      01654         NOT?TT  _PORTD??4, _FunctionKeys??1
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
001222 6AE8               M         clrf    WREG
001224 A883               M         btfss   PORTD, 004h
001226 0F01               M         addlw   1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 261


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
001228 B4D8               M         btfsc   STATUS, Z
00122A 9361               M         bcf     _FunctionKeys, 001h
00122C A4D8               M         btfss   STATUS, Z
00122E 8361               M         bsf     _FunctionKeys, 001h
                      01655 
                      01656 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00297       FunctionKeys.2 = ~ PORTD.5   'Tilt-
                      01657         NOT?TT  _PORTD??5, _FunctionKeys??2
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
001230 6AE8               M         clrf    WREG
001232 AA83               M         btfss   PORTD, 005h
001234 0F01               M         addlw   1
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 262


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
001236 B4D8               M         btfsc   STATUS, Z
001238 9561               M         bcf     _FunctionKeys, 002h
00123A A4D8               M         btfss   STATUS, Z
00123C 8561               M         bsf     _FunctionKeys, 002h
                      01658 
                      01659 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00298       FunctionKeys.4 = ~ PORTD.6   'coin2-
                      01660         NOT?TT  _PORTD??6, _FunctionKeys??4
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
00123E 6AE8               M         clrf    WREG
001240 AC83               M         btfss   PORTD, 006h
001242 0F01               M         addlw   1
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
001244 B4D8               M         btfsc   STATUS, Z
001246 9961               M         bcf     _FunctionKeys, 004h
001248 A4D8               M         btfss   STATUS, Z
00124A 8961               M         bsf     _FunctionKeys, 004h
                      01661 
                      01662 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00299       P2Keys.0 = ~ PORTD.7   'start-
                      01663         NOT?TT  _PORTD??7, _P2Keys??0
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 263


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
00124C 6AE8               M         clrf    WREG
00124E AE83               M         btfss   PORTD, 007h
001250 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
001252 B4D8               M         btfsc   STATUS, Z
001254 9164               M         bcf     _P2Keys, 000h
001256 A4D8               M         btfss   STATUS, Z
001258 8164               M         bsf     _P2Keys, 000h
                      01664 
                      01665 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00301       P2Keys.1 = ~ PORTB.0   'up
                      01666         NOT?TT  _PORTB??0, _P2Keys??1
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
00125A 6AE8               M         clrf    WREG
00125C A081               M         btfss   PORTB, 000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 264


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00125E 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
001260 B4D8               M         btfsc   STATUS, Z
001262 9364               M         bcf     _P2Keys, 001h
001264 A4D8               M         btfss   STATUS, Z
001266 8364               M         bsf     _P2Keys, 001h
                      01667 
                      01668 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00302       P2Keys.2 = ~ PORTB.1   'down
                      01669         NOT?TT  _PORTB??1, _P2Keys??2
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001268 6AE8               M         clrf    WREG
00126A A281               M         btfss   PORTB, 001h
00126C 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 265


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
00126E B4D8               M         btfsc   STATUS, Z
001270 9564               M         bcf     _P2Keys, 002h
001272 A4D8               M         btfss   STATUS, Z
001274 8564               M         bsf     _P2Keys, 002h
                      01670 
                      01671 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00303       P2Keys.3 = ~ PORTB.2   'left
                      01672         NOT?TT  _PORTB??2, _P2Keys??3
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001276 6AE8               M         clrf    WREG
001278 A481               M         btfss   PORTB, 002h
00127A 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
00127C B4D8               M         btfsc   STATUS, Z
00127E 9764               M         bcf     _P2Keys, 003h
001280 A4D8               M         btfss   STATUS, Z
001282 8764               M         bsf     _P2Keys, 003h
                      01673 
                      01674 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00304       P2Keys.4 = ~ PORTB.3   'right
                      01675         NOT?TT  _PORTB??3, _P2Keys??4
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 266


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001284 6AE8               M         clrf    WREG
001286 A681               M         btfss   PORTB, 003h
001288 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
00128A B4D8               M         btfsc   STATUS, Z
00128C 9964               M         bcf     _P2Keys, 004h
00128E A4D8               M         btfss   STATUS, Z
001290 8964               M         bsf     _P2Keys, 004h
                      01676 
                      01677 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00306       P2Keys.5 = ~ PORTB.4   'Button1-
                      01678         NOT?TT  _PORTB??4, _P2Keys??5
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001292 6AE8               M         clrf    WREG
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 267


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001294 A881               M         btfss   PORTB, 004h
001296 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
001298 B4D8               M         btfsc   STATUS, Z
00129A 9B64               M         bcf     _P2Keys, 005h
00129C A4D8               M         btfss   STATUS, Z
00129E 8B64               M         bsf     _P2Keys, 005h
                      01679 
                      01680 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00307       P2Keys.6 = ~ PORTB.5   'Button2-
                      01681         NOT?TT  _PORTB??5, _P2Keys??6
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0012A0 6AE8               M         clrf    WREG
0012A2 AA81               M         btfss   PORTB, 005h
0012A4 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 268


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
0012A6 B4D8               M         btfsc   STATUS, Z
0012A8 9D64               M         bcf     _P2Keys, 006h
0012AA A4D8               M         btfss   STATUS, Z
0012AC 8D64               M         bsf     _P2Keys, 006h
                      01682 
                      01683 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00308       P2Keys.7 = ~ PORTB.6   'Button3-
                      01684         NOT?TT  _PORTB??6, _P2Keys??7
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0012AE 6AE8               M         clrf    WREG
0012B0 AC81               M         btfss   PORTB, 006h
0012B2 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
0012B4 B4D8               M         btfsc   STATUS, Z
0012B6 9F64               M         bcf     _P2Keys, 007h
0012B8 A4D8               M         btfss   STATUS, Z
0012BA 8F64               M         bsf     _P2Keys, 007h
                      01685 
                      01686 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00309       P2Keys.8 = ~ PORTB.7   'Button4-
                      01687         NOT?TT  _PORTB??7, _P2Keys??8
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 269


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0012BC 6AE8               M         clrf    WREG
0012BE AE81               M         btfss   PORTB, 007h
0012C0 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys + 001h
                          M     if (((_P2Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P2Keys + 001h) & 0fffh) > BANKA_END) & (((_P2Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys + 001h)
                          M PREV_BANK = high (_P2Keys + 001h)
                          M       endif
                          M     endif
0012C2 B4D8               M         btfsc   STATUS, Z
0012C4 9165               M         bcf     _P2Keys + 001h, 000h
0012C6 A4D8               M         btfss   STATUS, Z
0012C8 8165               M         bsf     _P2Keys + 001h, 000h
                      01688 
                      01689 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00311       P2Keys.9 = ~ PORTE.2   'Button5-
                      01690         NOT?TT  _PORTE??2, _P2Keys??9
                          M         CHK?RP  PORTE
                          M     if (((PORTE) & 8000h) != PREV_ALT)
                          M       if ((PORTE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTE) & 8000h
                          M     endif
                          M     if ((((PORTE) & 0fffh) > BANKA_END) & (((PORTE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTE)
                          M PREV_BANK = high (PORTE)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 270


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0012CA 6AE8               M         clrf    WREG
0012CC A484               M         btfss   PORTE, 002h
0012CE 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys + 001h
                          M     if (((_P2Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P2Keys + 001h) & 0fffh) > BANKA_END) & (((_P2Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys + 001h)
                          M PREV_BANK = high (_P2Keys + 001h)
                          M       endif
                          M     endif
0012D0 B4D8               M         btfsc   STATUS, Z
0012D2 9365               M         bcf     _P2Keys + 001h, 001h
0012D4 A4D8               M         btfss   STATUS, Z
0012D6 8365               M         bsf     _P2Keys + 001h, 001h
                      01691 
                      01692 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00312       P2Keys.10 = ~ PORTE.1  'Button6-
                      01693         NOT?TT  _PORTE??1, _P2Keys??10
                          M         CHK?RP  PORTE
                          M     if (((PORTE) & 8000h) != PREV_ALT)
                          M       if ((PORTE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTE) & 8000h
                          M     endif
                          M     if ((((PORTE) & 0fffh) > BANKA_END) & (((PORTE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTE)
                          M PREV_BANK = high (PORTE)
                          M       endif
                          M     endif
0012D8 6AE8               M         clrf    WREG
0012DA A284               M         btfss   PORTE, 001h
0012DC 0F01               M         addlw   1
                          M         CHK?RP  _P2Keys + 001h
                          M     if (((_P2Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P2Keys + 001h) & 0fffh) > BANKA_END) & (((_P2Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 271


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_P2Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys + 001h)
                          M PREV_BANK = high (_P2Keys + 001h)
                          M       endif
                          M     endif
0012DE B4D8               M         btfsc   STATUS, Z
0012E0 9565               M         bcf     _P2Keys + 001h, 002h
0012E2 A4D8               M         btfss   STATUS, Z
0012E4 8565               M         bsf     _P2Keys + 001h, 002h
                      01694 
                      01695 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00313       MEDIAK.6 = ~ PORTE.0   'Key Vol+
                      01696         NOT?TT  _PORTE??0, _MEDIAK??6
                          M         CHK?RP  PORTE
                          M     if (((PORTE) & 8000h) != PREV_ALT)
                          M       if ((PORTE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTE) & 8000h
                          M     endif
                          M     if ((((PORTE) & 0fffh) > BANKA_END) & (((PORTE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTE)
                          M PREV_BANK = high (PORTE)
                          M       endif
                          M     endif
0012E6 6AE8               M         clrf    WREG
0012E8 A084               M         btfss   PORTE, 000h
0012EA 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
0012EC B4D8               M         btfsc   STATUS, Z
0012EE 9DA5               M         bcf     _MEDIAK, 006h
0012F0 A4D8               M         btfss   STATUS, Z
0012F2 8DA5               M         bsf     _MEDIAK, 006h
                      01697 
                      01698 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00320       LATA.4=1                     
                      01699         MOVE?CT 001h, _LATA??4
                          M         CHK?RP  LATA
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 272


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0012F4 8889               M         bsf     LATA,   004h
                          M     else
                          M         bcf     LATA,   004h
                          M     endif
                      01700 
                      01701 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00321       pauseus 1 'HC257 PAUSEUS 1
                      01702         PAUSEUS?C       001h
                          M     if (((001h) >> 8) == 0)
0012F6 0E01               M         movlw   001h
                          M         L?CALL  PAUSEUS
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEUS
                          M     else
                          M       if ((PAUSEUS) < 1)
                          M         call    PAUSEUS
                          M       else
                          M         if ((PAUSEUS) > $)
                          M         call    PAUSEUS
                          M         else
                          M           if ((PAUSEUS) < ($ - 3ffh))
0012F8 EC73 F000          M         call    PAUSEUS
                          M           else
                          M         rcall   PAUSEUS
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 273


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?CB (001h) >> 8, R0 + 1
                          M         MOVE?CA low (001h)
                          M         L?CALL  PAUSEUSL
                          M     endif
                      01703 
                      01704 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00324       FunctionKeys.0 = ~ PORTD.4   'test-
                      01705         NOT?TT  _PORTD??4, _FunctionKeys??0
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
0012FC 6AE8               M         clrf    WREG
0012FE A883               M         btfss   PORTD, 004h
001300 0F01               M         addlw   1
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
001302 B4D8               M         btfsc   STATUS, Z
001304 9161               M         bcf     _FunctionKeys, 000h
001306 A4D8               M         btfss   STATUS, Z
001308 8161               M         bsf     _FunctionKeys, 000h
                      01706 
                      01707 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00325       FunctionKeys.3 = ~ PORTD.5   'coin1-
                      01708         NOT?TT  _PORTD??5, _FunctionKeys??3
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 274


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
00130A 6AE8               M         clrf    WREG
00130C AA83               M         btfss   PORTD, 005h
00130E 0F01               M         addlw   1
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
001310 B4D8               M         btfsc   STATUS, Z
001312 9761               M         bcf     _FunctionKeys, 003h
001314 A4D8               M         btfss   STATUS, Z
001316 8761               M         bsf     _FunctionKeys, 003h
                      01709 
                      01710 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00326       P1Keys.0 = ~ PORTD.6   'start-
                      01711         NOT?TT  _PORTD??6, _P1Keys??0
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
001318 6AE8               M         clrf    WREG
00131A AC83               M         btfss   PORTD, 006h
00131C 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 275


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
00131E B4D8               M         btfsc   STATUS, Z
001320 9162               M         bcf     _P1Keys, 000h
001322 A4D8               M         btfss   STATUS, Z
001324 8162               M         bsf     _P1Keys, 000h
                      01712 
                      01713 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00327       P1Keys.1 = ~ PORTD.7   'up
                      01714         NOT?TT  _PORTD??7, _P1Keys??1
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
001326 6AE8               M         clrf    WREG
001328 AE83               M         btfss   PORTD, 007h
00132A 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 276


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
00132C B4D8               M         btfsc   STATUS, Z
00132E 9362               M         bcf     _P1Keys, 001h
001330 A4D8               M         btfss   STATUS, Z
001332 8362               M         bsf     _P1Keys, 001h
                      01715 
                      01716 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00329       P1Keys.2 = ~ PORTB.0   'down
                      01717         NOT?TT  _PORTB??0, _P1Keys??2
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001334 6AE8               M         clrf    WREG
001336 A081               M         btfss   PORTB, 000h
001338 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
00133A B4D8               M         btfsc   STATUS, Z
00133C 9562               M         bcf     _P1Keys, 002h
00133E A4D8               M         btfss   STATUS, Z
001340 8562               M         bsf     _P1Keys, 002h
                      01718 
                      01719 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00330       P1Keys.3 = ~ PORTB.1   'left
                      01720         NOT?TT  _PORTB??1, _P1Keys??3
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 277


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001342 6AE8               M         clrf    WREG
001344 A281               M         btfss   PORTB, 001h
001346 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
001348 B4D8               M         btfsc   STATUS, Z
00134A 9762               M         bcf     _P1Keys, 003h
00134C A4D8               M         btfss   STATUS, Z
00134E 8762               M         bsf     _P1Keys, 003h
                      01721 
                      01722 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00331       P1Keys.4 = ~ PORTB.2   'right
                      01723         NOT?TT  _PORTB??2, _P1Keys??4
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001350 6AE8               M         clrf    WREG
001352 A481               M         btfss   PORTB, 002h
001354 0F01               M         addlw   1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 278


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
001356 B4D8               M         btfsc   STATUS, Z
001358 9962               M         bcf     _P1Keys, 004h
00135A A4D8               M         btfss   STATUS, Z
00135C 8962               M         bsf     _P1Keys, 004h
                      01724 
                      01725 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00332       P1Keys.5 = ~ PORTB.3   'Button1
                      01726         NOT?TT  _PORTB??3, _P1Keys??5
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
00135E 6AE8               M         clrf    WREG
001360 A681               M         btfss   PORTB, 003h
001362 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 279


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
001364 B4D8               M         btfsc   STATUS, Z
001366 9B62               M         bcf     _P1Keys, 005h
001368 A4D8               M         btfss   STATUS, Z
00136A 8B62               M         bsf     _P1Keys, 005h
                      01727 
                      01728 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00334       MEDIAK.1 = ~ PORTD.7
                      01729         NOT?TT  _PORTD??7, _MEDIAK??1
                          M         CHK?RP  PORTD
                          M     if (((PORTD) & 8000h) != PREV_ALT)
                          M       if ((PORTD) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTD) & 8000h
                          M     endif
                          M     if ((((PORTD) & 0fffh) > BANKA_END) & (((PORTD) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTD) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTD)
                          M PREV_BANK = high (PORTD)
                          M       endif
                          M     endif
00136C 6AE8               M         clrf    WREG
00136E AE83               M         btfss   PORTD, 007h
001370 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
001372 B4D8               M         btfsc   STATUS, Z
001374 93A5               M         bcf     _MEDIAK, 001h
001376 A4D8               M         btfss   STATUS, Z
001378 83A5               M         bsf     _MEDIAK, 001h
                      01730 
                      01731 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00335       MEDIAK.2 = ~ PORTB.0
                      01732         NOT?TT  _PORTB??0, _MEDIAK??2
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 280


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
00137A 6AE8               M         clrf    WREG
00137C A081               M         btfss   PORTB, 000h
00137E 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
001380 B4D8               M         btfsc   STATUS, Z
001382 95A5               M         bcf     _MEDIAK, 002h
001384 A4D8               M         btfss   STATUS, Z
001386 85A5               M         bsf     _MEDIAK, 002h
                      01733 
                      01734 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00336       MEDIAK.3 = ~ PORTB.1
                      01735         NOT?TT  _PORTB??1, _MEDIAK??3
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001388 6AE8               M         clrf    WREG
00138A A281               M         btfss   PORTB, 001h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 281


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00138C 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
00138E B4D8               M         btfsc   STATUS, Z
001390 97A5               M         bcf     _MEDIAK, 003h
001392 A4D8               M         btfss   STATUS, Z
001394 87A5               M         bsf     _MEDIAK, 003h
                      01736 
                      01737 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00337       MEDIAK.4 = ~ PORTB.2
                      01738         NOT?TT  _PORTB??2, _MEDIAK??4
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
001396 6AE8               M         clrf    WREG
001398 A481               M         btfss   PORTB, 002h
00139A 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 282


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
00139C B4D8               M         btfsc   STATUS, Z
00139E 99A5               M         bcf     _MEDIAK, 004h
0013A0 A4D8               M         btfss   STATUS, Z
0013A2 89A5               M         bsf     _MEDIAK, 004h
                      01739 
                      01740 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00338       MEDIAK.5 = ~ PORTB.3
                      01741         NOT?TT  _PORTB??3, _MEDIAK??5
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0013A4 6AE8               M         clrf    WREG
0013A6 A681               M         btfss   PORTB, 003h
0013A8 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
0013AA B4D8               M         btfsc   STATUS, Z
0013AC 9BA5               M         bcf     _MEDIAK, 005h
0013AE A4D8               M         btfss   STATUS, Z
0013B0 8BA5               M         bsf     _MEDIAK, 005h
                      01742 
                      01743 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00340       P1Keys.6 = ~ PORTB.4   'Button2
                      01744         NOT?TT  _PORTB??4, _P1Keys??6
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 283


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0013B2 6AE8               M         clrf    WREG
0013B4 A881               M         btfss   PORTB, 004h
0013B6 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
0013B8 B4D8               M         btfsc   STATUS, Z
0013BA 9D62               M         bcf     _P1Keys, 006h
0013BC A4D8               M         btfss   STATUS, Z
0013BE 8D62               M         bsf     _P1Keys, 006h
                      01745 
                      01746 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00341       P1Keys.7 = ~ PORTB.5   'Button3-
                      01747         NOT?TT  _PORTB??5, _P1Keys??7
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0013C0 6AE8               M         clrf    WREG
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 284


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0013C2 AA81               M         btfss   PORTB, 005h
0013C4 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
0013C6 B4D8               M         btfsc   STATUS, Z
0013C8 9F62               M         bcf     _P1Keys, 007h
0013CA A4D8               M         btfss   STATUS, Z
0013CC 8F62               M         bsf     _P1Keys, 007h
                      01748 
                      01749 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00342       P1Keys.8 = ~ PORTB.6   'Button4-
                      01750         NOT?TT  _PORTB??6, _P1Keys??8
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0013CE 6AE8               M         clrf    WREG
0013D0 AC81               M         btfss   PORTB, 006h
0013D2 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys + 001h
                          M     if (((_P1Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P1Keys + 001h) & 0fffh) > BANKA_END) & (((_P1Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys + 001h) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 285


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_P1Keys + 001h)
                          M PREV_BANK = high (_P1Keys + 001h)
                          M       endif
                          M     endif
0013D4 B4D8               M         btfsc   STATUS, Z
0013D6 9163               M         bcf     _P1Keys + 001h, 000h
0013D8 A4D8               M         btfss   STATUS, Z
0013DA 8163               M         bsf     _P1Keys + 001h, 000h
                      01751 
                      01752 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00343       P1Keys.9 = ~ PORTB.7   'Button5-
                      01753         NOT?TT  _PORTB??7, _P1Keys??9
                          M         CHK?RP  PORTB
                          M     if (((PORTB) & 8000h) != PREV_ALT)
                          M       if ((PORTB) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTB) & 8000h
                          M     endif
                          M     if ((((PORTB) & 0fffh) > BANKA_END) & (((PORTB) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTB) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTB)
                          M PREV_BANK = high (PORTB)
                          M       endif
                          M     endif
0013DC 6AE8               M         clrf    WREG
0013DE AE81               M         btfss   PORTB, 007h
0013E0 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys + 001h
                          M     if (((_P1Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P1Keys + 001h) & 0fffh) > BANKA_END) & (((_P1Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys + 001h)
                          M PREV_BANK = high (_P1Keys + 001h)
                          M       endif
                          M     endif
0013E2 B4D8               M         btfsc   STATUS, Z
0013E4 9363               M         bcf     _P1Keys + 001h, 001h
0013E6 A4D8               M         btfss   STATUS, Z
0013E8 8363               M         bsf     _P1Keys + 001h, 001h
                      01754 
                      01755 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00345       P1Keys.10 = ~ PORTE.2  'Button6-
                      01756         NOT?TT  _PORTE??2, _P1Keys??10
                          M         CHK?RP  PORTE
                          M     if (((PORTE) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 286


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((PORTE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTE) & 8000h
                          M     endif
                          M     if ((((PORTE) & 0fffh) > BANKA_END) & (((PORTE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTE)
                          M PREV_BANK = high (PORTE)
                          M       endif
                          M     endif
0013EA 6AE8               M         clrf    WREG
0013EC A484               M         btfss   PORTE, 002h
0013EE 0F01               M         addlw   1
                          M         CHK?RP  _P1Keys + 001h
                          M     if (((_P1Keys + 001h) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys + 001h) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys + 001h) & 8000h
                          M     endif
                          M     if ((((_P1Keys + 001h) & 0fffh) > BANKA_END) & (((_P1Keys + 001h) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys + 001h) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys + 001h)
                          M PREV_BANK = high (_P1Keys + 001h)
                          M       endif
                          M     endif
0013F0 B4D8               M         btfsc   STATUS, Z
0013F2 9563               M         bcf     _P1Keys + 001h, 002h
0013F4 A4D8               M         btfss   STATUS, Z
0013F6 8563               M         bsf     _P1Keys + 001h, 002h
                      01757 
                      01758 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00347       MEDIAK.0 = ~ PORTE.1   'key ESC   
                      01759         NOT?TT  _PORTE??1, _MEDIAK??0
                          M         CHK?RP  PORTE
                          M     if (((PORTE) & 8000h) != PREV_ALT)
                          M       if ((PORTE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTE) & 8000h
                          M     endif
                          M     if ((((PORTE) & 0fffh) > BANKA_END) & (((PORTE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTE)
                          M PREV_BANK = high (PORTE)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 287


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0013F8 6AE8               M         clrf    WREG
0013FA A284               M         btfss   PORTE, 001h
0013FC 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
0013FE B4D8               M         btfsc   STATUS, Z
001400 91A5               M         bcf     _MEDIAK, 000h
001402 A4D8               M         btfss   STATUS, Z
001404 81A5               M         bsf     _MEDIAK, 000h
                      01760 
                      01761 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00348       MEDIAK.7 = ~ PORTE.0   'key Vol-
                      01762         NOT?TT  _PORTE??0, _MEDIAK??7
                          M         CHK?RP  PORTE
                          M     if (((PORTE) & 8000h) != PREV_ALT)
                          M       if ((PORTE) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PORTE) & 8000h
                          M     endif
                          M     if ((((PORTE) & 0fffh) > BANKA_END) & (((PORTE) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PORTE) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PORTE)
                          M PREV_BANK = high (PORTE)
                          M       endif
                          M     endif
001406 6AE8               M         clrf    WREG
001408 A084               M         btfss   PORTE, 000h
00140A 0F01               M         addlw   1
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 288


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
00140C B4D8               M         btfsc   STATUS, Z
00140E 9FA5               M         bcf     _MEDIAK, 007h
001410 A4D8               M         btfss   STATUS, Z
001412 8FA5               M         bsf     _MEDIAK, 007h
                      01763 
                      01764 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00350       LATA.4=0
                      01765         MOVE?CT 000h, _LATA??4
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     LATA,   004h
                          M     else
001414 9889               M         bcf     LATA,   004h
                          M     endif
                      01766 
                      01767 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00352       gosub RPOV
                      01768         GOSUB?L _RPOV
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _RPOV
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 289


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _RPOV
                          M     else
                          M       if ((_RPOV) < 1)
                          M         call    _RPOV
                          M       else
                          M         if ((_RPOV) > $)
001416 ECE8 F00C          M         call    _RPOV
                          M         else
                          M           if ((_RPOV) < ($ - 3ffh))
                          M         call    _RPOV
                          M           else
                          M         rcall   _RPOV
                          M           endif
                          M         endif
                          M       endif
                          M     endif
00141A                    M dlabel
                      01769 
                      01770 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00353       P1Keys.1=pov1.0
                      01771         MOVE?TT _POV1??0, _P1Keys??1
                          M     if (((_POV1) <= BANKA_END) | ((_POV1) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _POV1, 000h
                          M         bsf     _P1Keys, 001h
                          M         btfss   _POV1, 000h
                          M         bcf     _P1Keys, 001h
                          M     else
                          M       if (((_POV1) & 0f00h) == ((_P1Keys) & 0f00h))
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 290


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00141A B1AB               M         btfsc   _POV1, 000h
00141C 8362               M         bsf     _P1Keys, 001h
00141E A1AB               M         btfss   _POV1, 000h
001420 9362               M         bcf     _P1Keys, 001h
                          M       else
                          M           if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV1
                          M         btfsc   _POV1, 000h
                          M         bsf     _P1Keys, 001h
                          M         btfss   _POV1, 000h
                          M         bcf     _P1Keys, 001h
                          M           else
                          M         MOVE?TA _POV1, 000h
                          M         MOVE?AT _P1Keys, 001h
                          M           endif
                          M       endif
                          M     endif
                      01772 
                      01773 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00354       P1Keys.2=pov1.1
                      01774         MOVE?TT _POV1??1, _P1Keys??2
                          M     if (((_POV1) <= BANKA_END) | ((_POV1) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _POV1, 001h
                          M         bsf     _P1Keys, 002h
                          M         btfss   _POV1, 001h
                          M         bcf     _P1Keys, 002h
                          M     else
                          M       if (((_POV1) & 0f00h) == ((_P1Keys) & 0f00h))
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
001422 B3AB               M         btfsc   _POV1, 001h
001424 8562               M         bsf     _P1Keys, 002h
001426 A3AB               M         btfss   _POV1, 001h
001428 9562               M         bcf     _P1Keys, 002h
                          M       else
                          M           if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV1
                          M         btfsc   _POV1, 001h
                          M         bsf     _P1Keys, 002h
                          M         btfss   _POV1, 001h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 291


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     _P1Keys, 002h
                          M           else
                          M         MOVE?TA _POV1, 001h
                          M         MOVE?AT _P1Keys, 002h
                          M           endif
                          M       endif
                          M     endif
                      01775 
                      01776 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00355       P1Keys.3=pov1.2
                      01777         MOVE?TT _POV1??2, _P1Keys??3
                          M     if (((_POV1) <= BANKA_END) | ((_POV1) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _POV1, 002h
                          M         bsf     _P1Keys, 003h
                          M         btfss   _POV1, 002h
                          M         bcf     _P1Keys, 003h
                          M     else
                          M       if (((_POV1) & 0f00h) == ((_P1Keys) & 0f00h))
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
00142A B5AB               M         btfsc   _POV1, 002h
00142C 8762               M         bsf     _P1Keys, 003h
00142E A5AB               M         btfss   _POV1, 002h
001430 9762               M         bcf     _P1Keys, 003h
                          M       else
                          M           if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV1
                          M         btfsc   _POV1, 002h
                          M         bsf     _P1Keys, 003h
                          M         btfss   _POV1, 002h
                          M         bcf     _P1Keys, 003h
                          M           else
                          M         MOVE?TA _POV1, 002h
                          M         MOVE?AT _P1Keys, 003h
                          M           endif
                          M       endif
                          M     endif
                      01778 
                      01779 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00356       P1Keys.4=pov1.3
                      01780         MOVE?TT _POV1??3, _P1Keys??4
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 292


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_POV1) <= BANKA_END) | ((_POV1) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P1Keys
                          M         btfsc   _POV1, 003h
                          M         bsf     _P1Keys, 004h
                          M         btfss   _POV1, 003h
                          M         bcf     _P1Keys, 004h
                          M     else
                          M       if (((_POV1) & 0f00h) == ((_P1Keys) & 0f00h))
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
001432 B7AB               M         btfsc   _POV1, 003h
001434 8962               M         bsf     _P1Keys, 004h
001436 A7AB               M         btfss   _POV1, 003h
001438 9962               M         bcf     _P1Keys, 004h
                          M       else
                          M           if (((_P1Keys) <= BANKA_END) | ((_P1Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV1
                          M         btfsc   _POV1, 003h
                          M         bsf     _P1Keys, 004h
                          M         btfss   _POV1, 003h
                          M         bcf     _P1Keys, 004h
                          M           else
                          M         MOVE?TA _POV1, 003h
                          M         MOVE?AT _P1Keys, 004h
                          M           endif
                          M       endif
                          M     endif
                      01781 
                      01782 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00357       P2Keys.1=pov2.0
                      01783         MOVE?TT _POV2??0, _P2Keys??1
                          M     if (((_POV2) <= BANKA_END) | ((_POV2) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _POV2, 000h
                          M         bsf     _P2Keys, 001h
                          M         btfss   _POV2, 000h
                          M         bcf     _P2Keys, 001h
                          M     else
                          M       if (((_POV2) & 0f00h) == ((_P2Keys) & 0f00h))
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 293


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
00143A B1AC               M         btfsc   _POV2, 000h
00143C 8364               M         bsf     _P2Keys, 001h
00143E A1AC               M         btfss   _POV2, 000h
001440 9364               M         bcf     _P2Keys, 001h
                          M       else
                          M           if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV2
                          M         btfsc   _POV2, 000h
                          M         bsf     _P2Keys, 001h
                          M         btfss   _POV2, 000h
                          M         bcf     _P2Keys, 001h
                          M           else
                          M         MOVE?TA _POV2, 000h
                          M         MOVE?AT _P2Keys, 001h
                          M           endif
                          M       endif
                          M     endif
                      01784 
                      01785 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00358       P2Keys.2=pov2.1
                      01786         MOVE?TT _POV2??1, _P2Keys??2
                          M     if (((_POV2) <= BANKA_END) | ((_POV2) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _POV2, 001h
                          M         bsf     _P2Keys, 002h
                          M         btfss   _POV2, 001h
                          M         bcf     _P2Keys, 002h
                          M     else
                          M       if (((_POV2) & 0f00h) == ((_P2Keys) & 0f00h))
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 294


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
001442 B3AC               M         btfsc   _POV2, 001h
001444 8564               M         bsf     _P2Keys, 002h
001446 A3AC               M         btfss   _POV2, 001h
001448 9564               M         bcf     _P2Keys, 002h
                          M       else
                          M           if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV2
                          M         btfsc   _POV2, 001h
                          M         bsf     _P2Keys, 002h
                          M         btfss   _POV2, 001h
                          M         bcf     _P2Keys, 002h
                          M           else
                          M         MOVE?TA _POV2, 001h
                          M         MOVE?AT _P2Keys, 002h
                          M           endif
                          M       endif
                          M     endif
                      01787 
                      01788 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00359       P2Keys.3=pov2.2
                      01789         MOVE?TT _POV2??2, _P2Keys??3
                          M     if (((_POV2) <= BANKA_END) | ((_POV2) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _POV2, 002h
                          M         bsf     _P2Keys, 003h
                          M         btfss   _POV2, 002h
                          M         bcf     _P2Keys, 003h
                          M     else
                          M       if (((_POV2) & 0f00h) == ((_P2Keys) & 0f00h))
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
00144A B5AC               M         btfsc   _POV2, 002h
00144C 8764               M         bsf     _P2Keys, 003h
00144E A5AC               M         btfss   _POV2, 002h
001450 9764               M         bcf     _P2Keys, 003h
                          M       else
                          M           if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 295


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   _POV2, 002h
                          M         bsf     _P2Keys, 003h
                          M         btfss   _POV2, 002h
                          M         bcf     _P2Keys, 003h
                          M           else
                          M         MOVE?TA _POV2, 002h
                          M         MOVE?AT _P2Keys, 003h
                          M           endif
                          M       endif
                          M     endif
                      01790 
                      01791 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00360       P2Keys.4=pov2.3
                      01792         MOVE?TT _POV2??3, _P2Keys??4
                          M     if (((_POV2) <= BANKA_END) | ((_POV2) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _P2Keys
                          M         btfsc   _POV2, 003h
                          M         bsf     _P2Keys, 004h
                          M         btfss   _POV2, 003h
                          M         bcf     _P2Keys, 004h
                          M     else
                          M       if (((_POV2) & 0f00h) == ((_P2Keys) & 0f00h))
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
001452 B7AC               M         btfsc   _POV2, 003h
001454 8964               M         bsf     _P2Keys, 004h
001456 A7AC               M         btfss   _POV2, 003h
001458 9964               M         bcf     _P2Keys, 004h
                          M       else
                          M           if (((_P2Keys) <= BANKA_END) | ((_P2Keys) >= (0f01h + BANKA_END)))
                          M         CHK?RP  _POV2
                          M         btfsc   _POV2, 003h
                          M         bsf     _P2Keys, 004h
                          M         btfss   _POV2, 003h
                          M         bcf     _P2Keys, 004h
                          M           else
                          M         MOVE?TA _POV2, 003h
                          M         MOVE?AT _P2Keys, 004h
                          M           endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 296


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01793 
                      01794 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00363       if vconfig.3=1 and vconfig.0=1 then
                      01795         CMPEQ?TCB       _VConfig??3, 001h, T1
                          M     if (((001h) == 0) | ((001h) == 1))
00145A 6AE8               M         clrf    WREG
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
                          M       if ((001h) == 0)
                          M         btfss _VConfig, 003h
                          M       else
00145C B7A0               M         btfsc _VConfig, 003h
                          M       endif
00145E 68E8               M         setf    WREG
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001460 6E14               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      01796         CMPEQ?TCB       _VConfig??0, 001h, T2
                          M     if (((001h) == 0) | ((001h) == 1))
001462 6AE8               M         clrf    WREG
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 297


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
                          M       if ((001h) == 0)
                          M         btfss _VConfig, 000h
                          M       else
001464 B1A0               M         btfsc _VConfig, 000h
                          M       endif
001466 68E8               M         setf    WREG
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001468 6E16               M         movwf   T2
                          M     else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M     endif
                      01797         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
00146A C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 298


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00146E 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
001470 ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001474 6E16               M         movwf   T2
001476 6E17               M         movwf   T2   + 1
                      01798         CMPF?WL T2, L00041
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 299


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001478 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00147A 5016               M         movf    T2,  W
00147C 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00041
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00041))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M       else
                          M         if ((L00041) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M         else
                          M           if ((L00041) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M           else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 300


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             if ((L00041) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00041
                          M             else
                          M         bov     L00041
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
00147E B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00041
                          M       else
                          M         if ((L00041) < 1)
                          M         goto    L00041
                          M         else
                          M           if ((L00041) > $)
001480 EFCD F00A          M         goto    L00041
                          M           else
                          M             if ((L00041) < ($ - 3ffh))
                          M         goto    L00041
                          M             else
                          M         bra     L00041
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01799 
                      01800 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00364           if FunctionKeys.3=1 then trigger1 = trigger1 + 1
                      01801         CMPNE?TCL       _FunctionKeys??3, 001h, L00043
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _FunctionKeys, 003h, L00043
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001484 0004               M         clrwdt
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 301


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M         BIT?GOTO 0, _FunctionKeys, 003h, L00043
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00043))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_FunctionKeys) > BANKA_END) & ((_FunctionKeys) < (0f01h + BANKA_END)))
001486 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001488 A761               M         btfss   _FunctionKeys, 003h
                          M       else
                          M         btfsc   _FunctionKeys, 003h
                          M       endif
00148A 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00043
                          M       else
                          M         if ((L00043) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00043
                          M         else
                          M           if ((L00043) > $)
00148C B6D8               M         btfsc   STATUS, OV
00148E EF4A F00A          M         goto    L00043
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 302


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M             if ((L00043) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00043
                          M             else
                          M         bov     L00043
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _FunctionKeys, 003h
                          M       else
                          M         btfsc   _FunctionKeys, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00043
                          M       else
                          M         if ((L00043) < 1)
                          M         goto    L00043
                          M         else
                          M           if ((L00043) > $)
                          M         goto    L00043
                          M           else
                          M             if ((L00043) < ($ - 3ffh))
                          M         goto    L00043
                          M             else
                          M         bra     L00043
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00043
                          M       endif
                          M     endif
                      01802         ADD?BCB _TRIGGER1, 001h, _TRIGGER1
                          M     if ((_TRIGGER1) == (_TRIGGER1))
                          M       if ((001h) == 1)
                          M         CHK?RP  _TRIGGER1
                          M     if (((_TRIGGER1) & 8000h) != PREV_ALT)
                          M       if ((_TRIGGER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TRIGGER1) & 8000h
                          M     endif
                          M     if ((((_TRIGGER1) & 0fffh) > BANKA_END) & (((_TRIGGER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TRIGGER1) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 303


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_TRIGGER1)
                          M PREV_BANK = high (_TRIGGER1)
                          M       endif
                          M     endif
001492 2BA1               M         incf    _TRIGGER1, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TRIGGER1
                          M         addwf   _TRIGGER1, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _TRIGGER1
                          M         incf    _TRIGGER1, W
                          M         MOVE?AB _TRIGGER1
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TRIGGER1
                          M         addwf   _TRIGGER1, W
                          M         MOVE?AB _TRIGGER1
                          M       endif
                          M     endif
                      01803         LABEL?L L00043  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00043
                          M         XALL
                          M     else
001494                    M L00043
                          M     endif
                      01804 
                      01805 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00365           if FunctionKeys.3=0 and trigger1<6 then trigger1
                            =0
                      01806         CMPEQ?TCB       _FunctionKeys??3, 000h, T1
                          M     if (((000h) == 0) | ((000h) == 1))
001494 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 304


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
                          M       if ((000h) == 0)
001496 A761               M         btfss _FunctionKeys, 003h
                          M       else
                          M         btfsc _FunctionKeys, 003h
                          M       endif
001498 68E8               M         setf    WREG
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
00149A 6E14               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      01807         CMPLT?BCB       _TRIGGER1, 006h, T2
                          M     if ((006h) >= 100h)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((006h) > 0)
                          M         MOVE?BB _TRIGGER1, R0
00149C C0A1 F002          M         movff   _TRIGGER1, R0
                          M         MOVE?CA 006h
0014A0 0E06               M         movlw   low (006h)
                          M         L?CALL  CMPLTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 305


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLTB
                          M     else
                          M       if ((CMPLTB) < 1)
                          M         call    CMPLTB
                          M       else
                          M         if ((CMPLTB) > $)
                          M         call    CMPLTB
                          M         else
                          M           if ((CMPLTB) < ($ - 3ffh))
0014A2 EC96 F000          M         call    CMPLTB
                          M           else
                          M         rcall   CMPLTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014A6 6E16               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      01808         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
0014A8 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 306


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014AC 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
0014AE ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014B2 6E16               M         movwf   T2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 307


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0014B4 6E17               M         movwf   T2   + 1
                      01809         CMPF?WL T2, L00045
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0014B6 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014B8 5016               M         movf    T2,  W
0014BA 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00045
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00045))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00045
                          M       else
                          M         if ((L00045) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00045
                          M         else
                          M           if ((L00045) > $)
                          M         btfsc   STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 308


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00045
                          M           else
                          M             if ((L00045) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00045
                          M             else
                          M         bov     L00045
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0014BC B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00045
                          M       else
                          M         if ((L00045) < 1)
                          M         goto    L00045
                          M         else
                          M           if ((L00045) > $)
0014BE EF62 F00A          M         goto    L00045
                          M           else
                          M             if ((L00045) < ($ - 3ffh))
                          M         goto    L00045
                          M             else
                          M         bra     L00045
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01810         MOVE?CB 000h, _TRIGGER1
                          M         CHK?RP  _TRIGGER1
                          M     if (((_TRIGGER1) & 8000h) != PREV_ALT)
                          M       if ((_TRIGGER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TRIGGER1) & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 309


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((_TRIGGER1) & 0fffh) > BANKA_END) & (((_TRIGGER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TRIGGER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TRIGGER1)
                          M PREV_BANK = high (_TRIGGER1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0014C2 6BA1               M         clrf    _TRIGGER1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TRIGGER1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TRIGGER1
                          M       endif
                          M     endif
                      01811         LABEL?L L00045  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00045
                          M         XALL
                          M     else
0014C4                    M L00045
                          M     endif
                      01812 
                      01813 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00366           if FunctionKeys.3=0 and trigger1>5 then trigger1
                            =0 : CHUTES0=CHUTES0+1 : write 1,chutes0
                      01814         CMPEQ?TCB       _FunctionKeys??3, 000h, T1
                          M     if (((000h) == 0) | ((000h) == 1))
0014C4 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 310


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M       if ((000h) == 0)
0014C6 A761               M         btfss _FunctionKeys, 003h
                          M       else
                          M         btfsc _FunctionKeys, 003h
                          M       endif
0014C8 68E8               M         setf    WREG
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0014CA 6E14               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      01815         CMPGT?BCB       _TRIGGER1, 005h, T2
                          M     if ((005h) < 0)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((005h) < 0ffh)
                          M         MOVE?BB _TRIGGER1, R0
0014CC C0A1 F002          M         movff   _TRIGGER1, R0
                          M         MOVE?CA 005h
0014D0 0E05               M         movlw   low (005h)
                          M         L?CALL  CMPGTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGTB
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 311


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((CMPGTB) < 1)
                          M         call    CMPGTB
                          M       else
                          M         if ((CMPGTB) > $)
                          M         call    CMPGTB
                          M         else
                          M           if ((CMPGTB) < ($ - 3ffh))
0014D2 EC91 F000          M         call    CMPGTB
                          M           else
                          M         rcall   CMPGTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014D6 6E16               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      01816         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
0014D8 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 312


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
0014DC 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
0014DE ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014E2 6E16               M         movwf   T2
0014E4 6E17               M         movwf   T2   + 1
                      01817         CMPF?WL T2, L00047
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0014E6 0004               M         clrwdt
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 313


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0014E8 5016               M         movf    T2,  W
0014EA 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00047
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00047))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00047
                          M       else
                          M         if ((L00047) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00047
                          M         else
                          M           if ((L00047) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00047
                          M           else
                          M             if ((L00047) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00047
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 314


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             else
                          M         bov     L00047
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0014EC B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00047
                          M       else
                          M         if ((L00047) < 1)
                          M         goto    L00047
                          M         else
                          M           if ((L00047) > $)
0014EE EF80 F00A          M         goto    L00047
                          M           else
                          M             if ((L00047) < ($ - 3ffh))
                          M         goto    L00047
                          M             else
                          M         bra     L00047
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01818         MOVE?CB 000h, _TRIGGER1
                          M         CHK?RP  _TRIGGER1
                          M     if (((_TRIGGER1) & 8000h) != PREV_ALT)
                          M       if ((_TRIGGER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TRIGGER1) & 8000h
                          M     endif
                          M     if ((((_TRIGGER1) & 0fffh) > BANKA_END) & (((_TRIGGER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TRIGGER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TRIGGER1)
                          M PREV_BANK = high (_TRIGGER1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 315


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0014F2 6BA1               M         clrf    _TRIGGER1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TRIGGER1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TRIGGER1
                          M       endif
                          M     endif
                      01819         ADD?BCB _CHUTES0, 001h, _CHUTES0
                          M     if ((_CHUTES0) == (_CHUTES0))
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
0014F4 2B9E               M         incf    _CHUTES0, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES0
                          M         addwf   _CHUTES0, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES0
                          M         incf    _CHUTES0, W
                          M         MOVE?AB _CHUTES0
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES0
                          M         addwf   _CHUTES0, W
                          M         MOVE?AB _CHUTES0
                          M       endif
                          M     endif
                      01820         WRITEADDRESS?C  001h
                          M     ifdef EEADRH
                          M         MOVE?CW (001h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 001h, EEADR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 316


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    EEADR
                          M       else
0014F6 0E01               M         movlw   low (001h)
0014F8 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01821         WRITE?B _CHUTES0
                          M         MOVE?BA _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
0014FA 519E               M         movf    _CHUTES0, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 317


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
0014FC EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01822         LABEL?L L00047  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00047
                          M         XALL
                          M     else
001500                    M L00047
                          M     endif
                      01823 
                      01824 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00368           if FunctionKeys.4=1 then trigger2 = trigger2 + 1
                      01825         CMPNE?TCL       _FunctionKeys??4, 001h, L00049
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _FunctionKeys, 004h, L00049
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001500 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _FunctionKeys, 004h, L00049
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00049))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 318


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_FunctionKeys) > BANKA_END) & ((_FunctionKeys) < (0f01h + BANKA_END)))
001502 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001504 A961               M         btfss   _FunctionKeys, 004h
                          M       else
                          M         btfsc   _FunctionKeys, 004h
                          M       endif
001506 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M       else
                          M         if ((L00049) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M         else
                          M           if ((L00049) > $)
001508 B6D8               M         btfsc   STATUS, OV
00150A EF88 F00A          M         goto    L00049
                          M           else
                          M             if ((L00049) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00049
                          M             else
                          M         bov     L00049
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 319


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _FunctionKeys, 004h
                          M       else
                          M         btfsc   _FunctionKeys, 004h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00049
                          M       else
                          M         if ((L00049) < 1)
                          M         goto    L00049
                          M         else
                          M           if ((L00049) > $)
                          M         goto    L00049
                          M           else
                          M             if ((L00049) < ($ - 3ffh))
                          M         goto    L00049
                          M             else
                          M         bra     L00049
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00049
                          M       endif
                          M     endif
                      01826         ADD?BCB _TRIGGER2, 001h, _TRIGGER2
                          M     if ((_TRIGGER2) == (_TRIGGER2))
                          M       if ((001h) == 1)
                          M         CHK?RP  _TRIGGER2
                          M     if (((_TRIGGER2) & 8000h) != PREV_ALT)
                          M       if ((_TRIGGER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TRIGGER2) & 8000h
                          M     endif
                          M     if ((((_TRIGGER2) & 0fffh) > BANKA_END) & (((_TRIGGER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TRIGGER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TRIGGER2)
                          M PREV_BANK = high (_TRIGGER2)
                          M       endif
                          M     endif
00150E 2BA2               M         incf    _TRIGGER2, F
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 320


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlw   001h
                          M         CHK?RP  _TRIGGER2
                          M         addwf   _TRIGGER2, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _TRIGGER2
                          M         incf    _TRIGGER2, W
                          M         MOVE?AB _TRIGGER2
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TRIGGER2
                          M         addwf   _TRIGGER2, W
                          M         MOVE?AB _TRIGGER2
                          M       endif
                          M     endif
                      01827         LABEL?L L00049  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00049
                          M         XALL
                          M     else
001510                    M L00049
                          M     endif
                      01828 
                      01829 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00369           if FunctionKeys.4=0 and trigger2<6 then trigger2
                            =0
                      01830         CMPEQ?TCB       _FunctionKeys??4, 000h, T1
                          M     if (((000h) == 0) | ((000h) == 1))
001510 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 321


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M       if ((000h) == 0)
001512 A961               M         btfss _FunctionKeys, 004h
                          M       else
                          M         btfsc _FunctionKeys, 004h
                          M       endif
001514 68E8               M         setf    WREG
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001516 6E14               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      01831         CMPLT?BCB       _TRIGGER2, 006h, T2
                          M     if ((006h) >= 100h)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((006h) > 0)
                          M         MOVE?BB _TRIGGER2, R0
001518 C0A2 F002          M         movff   _TRIGGER2, R0
                          M         MOVE?CA 006h
00151C 0E06               M         movlw   low (006h)
                          M         L?CALL  CMPLTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPLTB
                          M     else
                          M       if ((CMPLTB) < 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 322


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    CMPLTB
                          M       else
                          M         if ((CMPLTB) > $)
                          M         call    CMPLTB
                          M         else
                          M           if ((CMPLTB) < ($ - 3ffh))
00151E EC96 F000          M         call    CMPLTB
                          M           else
                          M         rcall   CMPLTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001522 6E16               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      01832         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001524 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 323


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
001528 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
00152A ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00152E 6E16               M         movwf   T2
001530 6E17               M         movwf   T2   + 1
                      01833         CMPF?WL T2, L00051
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001532 0004               M         clrwdt
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 324


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001534 5016               M         movf    T2,  W
001536 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00051
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00051))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M       else
                          M         if ((L00051) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M         else
                          M           if ((L00051) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M           else
                          M             if ((L00051) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00051
                          M             else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 325


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bov     L00051
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001538 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00051
                          M       else
                          M         if ((L00051) < 1)
                          M         goto    L00051
                          M         else
                          M           if ((L00051) > $)
00153A EFA0 F00A          M         goto    L00051
                          M           else
                          M             if ((L00051) < ($ - 3ffh))
                          M         goto    L00051
                          M             else
                          M         bra     L00051
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01834         MOVE?CB 000h, _TRIGGER2
                          M         CHK?RP  _TRIGGER2
                          M     if (((_TRIGGER2) & 8000h) != PREV_ALT)
                          M       if ((_TRIGGER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TRIGGER2) & 8000h
                          M     endif
                          M     if ((((_TRIGGER2) & 0fffh) > BANKA_END) & (((_TRIGGER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TRIGGER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TRIGGER2)
                          M PREV_BANK = high (_TRIGGER2)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 326


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (low (000h) == 0)
00153E 6BA2               M         clrf    _TRIGGER2
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TRIGGER2
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TRIGGER2
                          M       endif
                          M     endif
                      01835         LABEL?L L00051  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00051
                          M         XALL
                          M     else
001540                    M L00051
                          M     endif
                      01836 
                      01837 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00371           if FunctionKeys.4=0 and trigger2>5 then
                      01838         CMPEQ?TCB       _FunctionKeys??4, 000h, T1
                          M     if (((000h) == 0) | ((000h) == 1))
001540 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
                          M       if ((000h) == 0)
001542 A961               M         btfss _FunctionKeys, 004h
                          M       else
                          M         btfsc _FunctionKeys, 004h
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 327


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001544 68E8               M         setf    WREG
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
001546 6E14               M         movwf   T1
                          M     else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M     endif
                      01839         CMPGT?BCB       _TRIGGER2, 005h, T2
                          M     if ((005h) < 0)
                          M         CHK?RP  T2
                          M         setf    T2
                          M     else
                          M       if ((005h) < 0ffh)
                          M         MOVE?BB _TRIGGER2, R0
001548 C0A2 F002          M         movff   _TRIGGER2, R0
                          M         MOVE?CA 005h
00154C 0E05               M         movlw   low (005h)
                          M         L?CALL  CMPGTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGTB
                          M     else
                          M       if ((CMPGTB) < 1)
                          M         call    CMPGTB
                          M       else
                          M         if ((CMPGTB) > $)
                          M         call    CMPGTB
                          M         else
                          M           if ((CMPGTB) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 328


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00154E EC91 F000          M         call    CMPGTB
                          M           else
                          M         rcall   CMPGTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001552 6E16               M         movwf   T2
                          M       else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M       endif
                          M     endif
                      01840         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001554 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001558 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 329


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
00155A ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00155E 6E16               M         movwf   T2
001560 6E17               M         movwf   T2   + 1
                      01841         CMPF?WL T2, L00053
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001562 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 330


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001564 5016               M         movf    T2,  W
001566 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00053
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00053))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00053
                          M       else
                          M         if ((L00053) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00053
                          M         else
                          M           if ((L00053) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00053
                          M           else
                          M             if ((L00053) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00053
                          M             else
                          M         bov     L00053
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 331


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001568 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00053
                          M       else
                          M         if ((L00053) < 1)
                          M         goto    L00053
                          M         else
                          M           if ((L00053) > $)
00156A EFCD F00A          M         goto    L00053
                          M           else
                          M             if ((L00053) < ($ - 3ffh))
                          M         goto    L00053
                          M             else
                          M         bra     L00053
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01842 
                      01843 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00372               trigger2=0
                      01844         MOVE?CB 000h, _TRIGGER2
                          M         CHK?RP  _TRIGGER2
                          M     if (((_TRIGGER2) & 8000h) != PREV_ALT)
                          M       if ((_TRIGGER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TRIGGER2) & 8000h
                          M     endif
                          M     if ((((_TRIGGER2) & 0fffh) > BANKA_END) & (((_TRIGGER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TRIGGER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TRIGGER2)
                          M PREV_BANK = high (_TRIGGER2)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
00156E 6BA2               M         clrf    _TRIGGER2
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 332


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (low (000h) == 255)
                          M         setf    _TRIGGER2
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TRIGGER2
                          M       endif
                          M     endif
                      01845 
                      01846 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00373               if vconfig.4=1 then 
                      01847         CMPNE?TCL       _VConfig??4, 001h, L00055
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, _VConfig, 004h, L00055
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001570 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _VConfig, 004h, L00055
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00055))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_VConfig) > BANKA_END) & ((_VConfig) < (0f01h + BANKA_END)))
001572 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _VConfig
                          M     if (((_VConfig) & 8000h) != PREV_ALT)
                          M       if ((_VConfig) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_VConfig) & 8000h
                          M     endif
                          M     if ((((_VConfig) & 0fffh) > BANKA_END) & (((_VConfig) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_VConfig) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_VConfig)
                          M PREV_BANK = high (_VConfig)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001574 A9A0               M         btfss   _VConfig, 004h
                          M       else
                          M         btfsc   _VConfig, 004h
                          M       endif
001576 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 333


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00055
                          M       else
                          M         if ((L00055) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00055
                          M         else
                          M           if ((L00055) > $)
001578 B6D8               M         btfsc   STATUS, OV
00157A EFC7 F00A          M         goto    L00055
                          M           else
                          M             if ((L00055) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00055
                          M             else
                          M         bov     L00055
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _VConfig, 004h
                          M       else
                          M         btfsc   _VConfig, 004h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00055
                          M       else
                          M         if ((L00055) < 1)
                          M         goto    L00055
                          M         else
                          M           if ((L00055) > $)
                          M         goto    L00055
                          M           else
                          M             if ((L00055) < ($ - 3ffh))
                          M         goto    L00055
                          M             else
                          M         bra     L00055
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 334


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         L?GOTO  L00055
                          M       endif
                          M     endif
                      01848 
                      01849 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00374                   CHUTES0=CHUTES0+1
                      01850         ADD?BCB _CHUTES0, 001h, _CHUTES0
                          M     if ((_CHUTES0) == (_CHUTES0))
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
00157E 2B9E               M         incf    _CHUTES0, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES0
                          M         addwf   _CHUTES0, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES0
                          M         incf    _CHUTES0, W
                          M         MOVE?AB _CHUTES0
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES0
                          M         addwf   _CHUTES0, W
                          M         MOVE?AB _CHUTES0
                          M       endif
                          M     endif
                      01851 
                      01852 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00375                   write 1,chutes0
                      01853         WRITEADDRESS?C  001h
                          M     ifdef EEADRH
                          M         MOVE?CW (001h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 001h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 335


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    EEADR
                          M       else
001580 0E01               M         movlw   low (001h)
001582 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01854         WRITE?B _CHUTES0
                          M         MOVE?BA _CHUTES0
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
001584 519E               M         movf    _CHUTES0, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 336


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
001586 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01855 
                      01856 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00376               else
                      01857         GOTO?L  L00056
                          M         L?GOTO  L00056
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00056))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00056
                          M     else
                          M       if ((L00056) < 1)
                          M         goto    L00056
                          M       else
                          M         if ((L00056) > $)
00158A EFCD F00A          M         goto    L00056
                          M         else
                          M           if ((L00056) < ($ - 3ffh))
                          M         goto    L00056
                          M           else
                          M         bra     L00056
                          M           endif
                          M         endif
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 337


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      01858         LABEL?L L00055  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00055
                          M         XALL
                          M     else
00158E                    M L00055
                          M     endif
                      01859 
                      01860 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00377                   CHUTES1=CHUTES1+1
                      01861         ADD?BCB _CHUTES1, 001h, _CHUTES1
                          M     if ((_CHUTES1) == (_CHUTES1))
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
00158E 2B9F               M         incf    _CHUTES1, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES1
                          M         addwf   _CHUTES1, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES1
                          M         incf    _CHUTES1, W
                          M         MOVE?AB _CHUTES1
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES1
                          M         addwf   _CHUTES1, W
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 338


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?AB _CHUTES1
                          M       endif
                          M     endif
                      01862 
                      01863 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00378                   write 2,chutes1
                      01864         WRITEADDRESS?C  002h
                          M     ifdef EEADRH
                          M         MOVE?CW (002h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 002h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    EEADR
                          M       else
001590 0E02               M         movlw   low (002h)
001592 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      01865         WRITE?B _CHUTES1
                          M         MOVE?BA _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 339


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001594 519F               M         movf    _CHUTES1, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
001596 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01866 
                      01867 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00379               endif
                      01868         LABEL?L L00056  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00056
                          M         XALL
                          M     else
00159A                    M L00056
                          M     endif
                      01869 
                      01870 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00380           endif
                      01871         LABEL?L L00053  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 340


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00053
                          M         XALL
                          M     else
00159A                    M L00053
                          M     endif
                      01872 
                      01873 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00381       endif
                      01874         LABEL?L L00041  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00041
                          M         XALL
                          M     else
00159A                    M L00041
                          M     endif
                      01875 
                      01876 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00383       if FKeytemp != FunctionKeys then        'Flag Functi
                            onKeys
                      01877         CMPEQ?BBL       _FKeytemp, _FunctionKeys, L00057
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00159A 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _FKeytemp
                          M         CHK?RP  _FKeytemp
                          M     if (((_FKeytemp) & 8000h) != PREV_ALT)
                          M       if ((_FKeytemp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FKeytemp) & 8000h
                          M     endif
                          M     if ((((_FKeytemp) & 0fffh) > BANKA_END) & (((_FKeytemp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FKeytemp) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 341


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_FKeytemp)
                          M PREV_BANK = high (_FKeytemp)
                          M       endif
                          M     endif
00159C 5166               M         movf    _FKeytemp, W
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
00159E 5D61               M         subwf   _FunctionKeys, W
                          M         BIT?GOTO 1, STATUS, Z, L00057
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00057))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00057
                          M       else
                          M         if ((L00057) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00057
                          M         else
                          M           if ((L00057) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00057
                          M           else
                          M             if ((L00057) < ($ - 7fh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 342


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00057
                          M             else
                          M         bov     L00057
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0015A0 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00057
                          M       else
                          M         if ((L00057) < 1)
                          M         goto    L00057
                          M         else
                          M           if ((L00057) > $)
0015A2 EF0D F00B          M         goto    L00057
                          M           else
                          M             if ((L00057) < ($ - 3ffh))
                          M         goto    L00057
                          M             else
                          M         bra     L00057
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01878 
                      01879 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00384           AllFlags.0=1
                      01880         MOVE?CT 001h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 343


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0015A6 8160               M         bsf     _AllFlags, 000h
                          M     else
                          M         bcf     _AllFlags, 000h
                          M     endif
                      01881 
                      01882 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00386           if FunctionKeys.0 != FKeytemp.0 then        'Pla
                            yer 1 FunctionKeys
                      01883         CMPEQ?TTL       _FunctionKeys??0, _FKeytemp??0, L00059
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0015A8 0004               M         clrwdt
                          M     endif
0015AA 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
0015AC B161               M         btfsc   _FunctionKeys, 000h
0015AE 0F01               M         addlw   1
                          M         CHK?RP  _FKeytemp
                          M     if (((_FKeytemp) & 8000h) != PREV_ALT)
                          M       if ((_FKeytemp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FKeytemp) & 8000h
                          M     endif
                          M     if ((((_FKeytemp) & 0fffh) > BANKA_END) & (((_FKeytemp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FKeytemp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FKeytemp)
                          M PREV_BANK = high (_FKeytemp)
                          M       endif
                          M     endif
0015B0 B166               M         btfsc   _FKeytemp, 000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 344


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015B2 0801               M         sublw   1
                          M         BIT?GOTO 1, STATUS, Z, L00059
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00059))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00059
                          M       else
                          M         if ((L00059) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00059
                          M         else
                          M           if ((L00059) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00059
                          M           else
                          M             if ((L00059) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00059
                          M             else
                          M         bov     L00059
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 345


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
0015B4 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00059
                          M       else
                          M         if ((L00059) < 1)
                          M         goto    L00059
                          M         else
                          M           if ((L00059) > $)
0015B6 EFDF F00A          M         goto    L00059
                          M           else
                          M             if ((L00059) < ($ - 3ffh))
                          M         goto    L00059
                          M             else
                          M         bra     L00059
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01884 
                      01885 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00387               AllFlags.1=1
                      01886         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0015BA 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      01887 
                      01888 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00388               AllFlags.0=0
                      01889         MOVE?CT 000h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 346


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 000h
                          M     else
0015BC 9160               M         bcf     _AllFlags, 000h
                          M     endif
                      01890 
                      01891 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00389           endif
                      01892         LABEL?L L00059  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00059
                          M         XALL
                          M     else
0015BE                    M L00059
                          M     endif
                      01893 
                      01894 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00390           if FunctionKeys.3 != FKeytemp.3 then        'Pla
                            yer 1 FunctionKeys
                      01895         CMPEQ?TTL       _FunctionKeys??3, _FKeytemp??3, L00061
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0015BE 0004               M         clrwdt
                          M     endif
0015C0 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 347


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
0015C2 B761               M         btfsc   _FunctionKeys, 003h
0015C4 0F01               M         addlw   1
                          M         CHK?RP  _FKeytemp
                          M     if (((_FKeytemp) & 8000h) != PREV_ALT)
                          M       if ((_FKeytemp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FKeytemp) & 8000h
                          M     endif
                          M     if ((((_FKeytemp) & 0fffh) > BANKA_END) & (((_FKeytemp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FKeytemp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FKeytemp)
                          M PREV_BANK = high (_FKeytemp)
                          M       endif
                          M     endif
0015C6 B766               M         btfsc   _FKeytemp, 003h
0015C8 0801               M         sublw   1
                          M         BIT?GOTO 1, STATUS, Z, L00061
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00061))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00061
                          M       else
                          M         if ((L00061) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00061
                          M         else
                          M           if ((L00061) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00061
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 348


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M             if ((L00061) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00061
                          M             else
                          M         bov     L00061
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0015CA B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00061
                          M       else
                          M         if ((L00061) < 1)
                          M         goto    L00061
                          M         else
                          M           if ((L00061) > $)
0015CC EFEA F00A          M         goto    L00061
                          M           else
                          M             if ((L00061) < ($ - 3ffh))
                          M         goto    L00061
                          M             else
                          M         bra     L00061
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01896 
                      01897 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00391               AllFlags.1=1
                      01898         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 349


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0015D0 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      01899 
                      01900 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00392               AllFlags.0=0
                      01901         MOVE?CT 000h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 000h
                          M     else
0015D2 9160               M         bcf     _AllFlags, 000h
                          M     endif
                      01902 
                      01903 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00393           endif
                      01904         LABEL?L L00061  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00061
                          M         XALL
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 350


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015D4                    M L00061
                          M     endif
                      01905 
                      01906 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00395           if FunctionKeys.1 != FKeytemp.1 then        'Pla
                            yer 2 FunctionKeys
                      01907         CMPEQ?TTL       _FunctionKeys??1, _FKeytemp??1, L00063
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0015D4 0004               M         clrwdt
                          M     endif
0015D6 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
0015D8 B361               M         btfsc   _FunctionKeys, 001h
0015DA 0F01               M         addlw   1
                          M         CHK?RP  _FKeytemp
                          M     if (((_FKeytemp) & 8000h) != PREV_ALT)
                          M       if ((_FKeytemp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FKeytemp) & 8000h
                          M     endif
                          M     if ((((_FKeytemp) & 0fffh) > BANKA_END) & (((_FKeytemp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FKeytemp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FKeytemp)
                          M PREV_BANK = high (_FKeytemp)
                          M       endif
                          M     endif
0015DC B366               M         btfsc   _FKeytemp, 001h
0015DE 0801               M         sublw   1
                          M         BIT?GOTO 1, STATUS, Z, L00063
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00063))
                          M         CLRWDT?
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 351


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00063
                          M       else
                          M         if ((L00063) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00063
                          M         else
                          M           if ((L00063) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00063
                          M           else
                          M             if ((L00063) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00063
                          M             else
                          M         bov     L00063
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0015E0 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00063
                          M       else
                          M         if ((L00063) < 1)
                          M         goto    L00063
                          M         else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 352


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((L00063) > $)
0015E2 EFF5 F00A          M         goto    L00063
                          M           else
                          M             if ((L00063) < ($ - 3ffh))
                          M         goto    L00063
                          M             else
                          M         bra     L00063
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01908 
                      01909 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00396               AllFlags.2=1
                      01910         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0015E6 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      01911 
                      01912 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00397               AllFlags.0=0
                      01913         MOVE?CT 000h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 353


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 000h
                          M     else
0015E8 9160               M         bcf     _AllFlags, 000h
                          M     endif
                      01914 
                      01915 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00398           endif
                      01916         LABEL?L L00063  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00063
                          M         XALL
                          M     else
0015EA                    M L00063
                          M     endif
                      01917 
                      01918 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00399           if FunctionKeys.2 != FKeytemp.2 then        'Pla
                            yer 2 FunctionKeys
                      01919         CMPEQ?TTL       _FunctionKeys??2, _FKeytemp??2, L00065
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0015EA 0004               M         clrwdt
                          M     endif
0015EC 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
0015EE B561               M         btfsc   _FunctionKeys, 002h
0015F0 0F01               M         addlw   1
                          M         CHK?RP  _FKeytemp
                          M     if (((_FKeytemp) & 8000h) != PREV_ALT)
                          M       if ((_FKeytemp) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 354


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FKeytemp) & 8000h
                          M     endif
                          M     if ((((_FKeytemp) & 0fffh) > BANKA_END) & (((_FKeytemp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FKeytemp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FKeytemp)
                          M PREV_BANK = high (_FKeytemp)
                          M       endif
                          M     endif
0015F2 B566               M         btfsc   _FKeytemp, 002h
0015F4 0801               M         sublw   1
                          M         BIT?GOTO 1, STATUS, Z, L00065
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00065))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00065
                          M       else
                          M         if ((L00065) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00065
                          M         else
                          M           if ((L00065) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00065
                          M           else
                          M             if ((L00065) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00065
                          M             else
                          M         bov     L00065
                          M             endif
                          M           endif
                          M         endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 355


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0015F6 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00065
                          M       else
                          M         if ((L00065) < 1)
                          M         goto    L00065
                          M         else
                          M           if ((L00065) > $)
0015F8 EF00 F00B          M         goto    L00065
                          M           else
                          M             if ((L00065) < ($ - 3ffh))
                          M         goto    L00065
                          M             else
                          M         bra     L00065
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01920 
                      01921 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00400               AllFlags.2=1
                      01922         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 356


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0015FC 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      01923 
                      01924 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00401               AllFlags.0=0
                      01925         MOVE?CT 000h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 000h
                          M     else
0015FE 9160               M         bcf     _AllFlags, 000h
                          M     endif
                      01926 
                      01927 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00402           endif
                      01928         LABEL?L L00065  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00065
                          M         XALL
                          M     else
001600                    M L00065
                          M     endif
                      01929 
                      01930 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00403           if FunctionKeys.4 != FKeytemp.4 then        'Pla
                            yer 2 FunctionKeys
                      01931         CMPEQ?TTL       _FunctionKeys??4, _FKeytemp??4, L00067
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001600 0004               M         clrwdt
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 357


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
001602 6AE8               M         clrf    WREG
                          M         CHK?RP  _FunctionKeys
                          M     if (((_FunctionKeys) & 8000h) != PREV_ALT)
                          M       if ((_FunctionKeys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FunctionKeys) & 8000h
                          M     endif
                          M     if ((((_FunctionKeys) & 0fffh) > BANKA_END) & (((_FunctionKeys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FunctionKeys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FunctionKeys)
                          M PREV_BANK = high (_FunctionKeys)
                          M       endif
                          M     endif
001604 B961               M         btfsc   _FunctionKeys, 004h
001606 0F01               M         addlw   1
                          M         CHK?RP  _FKeytemp
                          M     if (((_FKeytemp) & 8000h) != PREV_ALT)
                          M       if ((_FKeytemp) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_FKeytemp) & 8000h
                          M     endif
                          M     if ((((_FKeytemp) & 0fffh) > BANKA_END) & (((_FKeytemp) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_FKeytemp) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_FKeytemp)
                          M PREV_BANK = high (_FKeytemp)
                          M       endif
                          M     endif
001608 B966               M         btfsc   _FKeytemp, 004h
00160A 0801               M         sublw   1
                          M         BIT?GOTO 1, STATUS, Z, L00067
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00067))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 358


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00067
                          M       else
                          M         if ((L00067) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00067
                          M         else
                          M           if ((L00067) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00067
                          M           else
                          M             if ((L00067) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00067
                          M             else
                          M         bov     L00067
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
00160C B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00067
                          M       else
                          M         if ((L00067) < 1)
                          M         goto    L00067
                          M         else
                          M           if ((L00067) > $)
00160E EF0B F00B          M         goto    L00067
                          M           else
                          M             if ((L00067) < ($ - 3ffh))
                          M         goto    L00067
                          M             else
                          M         bra     L00067
                          M             endif
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 359


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     endif
                      01932 
                      01933 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00404               AllFlags.2=1
                      01934         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001612 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      01935 
                      01936 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00405               AllFlags.0=0
                      01937         MOVE?CT 000h, _AllFlags??0
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _AllFlags, 000h
                          M     else
001614 9160               M         bcf     _AllFlags, 000h
                          M     endif
                      01938 
                      01939 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00406           endif
                      01940         LABEL?L L00067  
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 360


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00067
                          M         XALL
                          M     else
001616                    M L00067
                          M     endif
                      01941 
                      01942 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00407           FKeytemp=FunctionKeys
                      01943         MOVE?BB _FunctionKeys, _FKeytemp
001616 C061 F066          M         movff   _FunctionKeys, _FKeytemp
                      01944 
                      01945 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00408       endif
                      01946         LABEL?L L00057  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00057
                          M         XALL
                          M     else
00161A                    M L00057
                          M     endif
                      01947 
                      01948 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00410       if F1Keys != P1Keys then        'Flag Player 1
                      01949         CMPEQ?WWL       _F1Keys, _P1Keys, L00069
                          M         MOVE?WW _F1Keys, R0
                          M         MOVE?BB _F1Keys, R0
00161A C067 F002          M         movff   _F1Keys, R0
                          M         MOVE?BB (_F1Keys) + 1, (R0) + 1
00161E C068 F003          M         movff   (_F1Keys) + 1, (R0) + 1
                          M         MOVE?WWA _P1Keys, R1
                          M         MOVE?BB (_P1Keys) + 1, (R1) + 1
001622 C063 F005          M         movff   (_P1Keys) + 1, (R1) + 1
                          M         MOVE?BA _P1Keys
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 361


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
001626 5162               M         movf    _P1Keys, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
001628 EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00069
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00069))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 362


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00069
                          M       else
                          M         if ((L00069) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00069
                          M         else
                          M           if ((L00069) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00069
                          M           else
                          M             if ((L00069) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00069
                          M             else
                          M         bov     L00069
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00162C A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00069
                          M       else
                          M         if ((L00069) < 1)
                          M         goto    L00069
                          M         else
                          M           if ((L00069) > $)
00162E EF1E F00B          M         goto    L00069
                          M           else
                          M             if ((L00069) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 363


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00069
                          M             else
                          M         bra     L00069
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01950 
                      01951 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00411           AllFlags.1=1
                      01952         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001632 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      01953 
                      01954 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00412           F1Keys = P1Keys
                      01955         MOVE?WW _P1Keys, _F1Keys
                          M         MOVE?BB _P1Keys, _F1Keys
001634 C062 F067          M         movff   _P1Keys, _F1Keys
                          M         MOVE?BB (_P1Keys) + 1, (_F1Keys) + 1
001638 C063 F068          M         movff   (_P1Keys) + 1, (_F1Keys) + 1
                      01956 
                      01957 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00413       endif
                      01958         LABEL?L L00069  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00069
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 364


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
00163C                    M L00069
                          M     endif
                      01959 
                      01960 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00414       if F2Keys != P2Keys then        'Flag Player 2
                      01961         CMPEQ?WWL       _F2Keys, _P2Keys, L00071
                          M         MOVE?WW _F2Keys, R0
                          M         MOVE?BB _F2Keys, R0
00163C C069 F002          M         movff   _F2Keys, R0
                          M         MOVE?BB (_F2Keys) + 1, (R0) + 1
001640 C06A F003          M         movff   (_F2Keys) + 1, (R0) + 1
                          M         MOVE?WWA _P2Keys, R1
                          M         MOVE?BB (_P2Keys) + 1, (R1) + 1
001644 C065 F005          M         movff   (_P2Keys) + 1, (R1) + 1
                          M         MOVE?BA _P2Keys
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
001648 5164               M         movf    _P2Keys, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 365


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00164A EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00071
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00071))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00071
                          M       else
                          M         if ((L00071) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00071
                          M         else
                          M           if ((L00071) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00071
                          M           else
                          M             if ((L00071) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00071
                          M             else
                          M         bov     L00071
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 366


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00164E A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00071
                          M       else
                          M         if ((L00071) < 1)
                          M         goto    L00071
                          M         else
                          M           if ((L00071) > $)
001650 EF2F F00B          M         goto    L00071
                          M           else
                          M             if ((L00071) < ($ - 3ffh))
                          M         goto    L00071
                          M             else
                          M         bra     L00071
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01962 
                      01963 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00415           AllFlags.2=1
                      01964         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001654 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      01965 
                      01966 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00416           F2Keys = P2Keys
                      01967         MOVE?WW _P2Keys, _F2Keys
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 367


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?BB _P2Keys, _F2Keys
001656 C064 F069          M         movff   _P2Keys, _F2Keys
                          M         MOVE?BB (_P2Keys) + 1, (_F2Keys) + 1
00165A C065 F06A          M         movff   (_P2Keys) + 1, (_F2Keys) + 1
                      01968 
                      01969 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00417       endif
                      01970         LABEL?L L00071  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00071
                          M         XALL
                          M     else
00165E                    M L00071
                          M     endif
                      01971 
                      01972 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00419       if TMEDIAK != MEDIAK then
                      01973         CMPEQ?BBL       _TMEDIAK, _MEDIAK, L00073
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
00165E 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _TMEDIAK
                          M         CHK?RP  _TMEDIAK
                          M     if (((_TMEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_TMEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TMEDIAK) & 8000h
                          M     endif
                          M     if ((((_TMEDIAK) & 0fffh) > BANKA_END) & (((_TMEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TMEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TMEDIAK)
                          M PREV_BANK = high (_TMEDIAK)
                          M       endif
                          M     endif
001660 51A6               M         movf    _TMEDIAK, W
                          M         CHK?RP  _MEDIAK
                          M     if (((_MEDIAK) & 8000h) != PREV_ALT)
                          M       if ((_MEDIAK) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 368


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (_MEDIAK) & 8000h
                          M     endif
                          M     if ((((_MEDIAK) & 0fffh) > BANKA_END) & (((_MEDIAK) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_MEDIAK) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_MEDIAK)
                          M PREV_BANK = high (_MEDIAK)
                          M       endif
                          M     endif
001662 5DA5               M         subwf   _MEDIAK, W
                          M         BIT?GOTO 1, STATUS, Z, L00073
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00073))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00073
                          M       else
                          M         if ((L00073) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00073
                          M         else
                          M           if ((L00073) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00073
                          M           else
                          M             if ((L00073) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00073
                          M             else
                          M         bov     L00073
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 369


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
001664 B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00073
                          M       else
                          M         if ((L00073) < 1)
                          M         goto    L00073
                          M         else
                          M           if ((L00073) > $)
001666 EF38 F00B          M         goto    L00073
                          M           else
                          M             if ((L00073) < ($ - 3ffh))
                          M         goto    L00073
                          M             else
                          M         bra     L00073
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      01974 
                      01975 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00420           AllFlags.3=1
                      01976         MOVE?CT 001h, _AllFlags??3
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
00166A 8760               M         bsf     _AllFlags, 003h
                          M     else
                          M         bcf     _AllFlags, 003h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 370


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01977 
                      01978 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00421           TMEDIAK = MEDIAK
                      01979         MOVE?BB _MEDIAK, _TMEDIAK
00166C C0A5 F0A6          M         movff   _MEDIAK, _TMEDIAK
                      01980 
                      01981 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00422       endif
                      01982         LABEL?L L00073  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00073
                          M         XALL
                          M     else
001670                    M L00073
                          M     endif
                      01983 
                      01984 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00423   return
                      01985         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001670 0012               M         return
                      01986 
                      01987 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00428   READAN:
                      01988 
                      01989         LABEL?L _READAN 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 371


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef PM_USED
                          M         LALL
                          M _READAN
                          M         XALL
                          M     else
001672                    M _READAN
                          M     endif
                      01990 
                      01991 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00430       LATA.2=0
                      01992         MOVE?CT 000h, _LATA??2
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     LATA,   002h
                          M     else
001672 9489               M         bcf     LATA,   002h
                          M     endif
                      01993 
                      01994 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00431       LATA.3=0
                      01995         MOVE?CT 000h, _LATA??3
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     LATA,   003h
                          M     else
001674 9689               M         bcf     LATA,   003h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 372


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      01996 
                      01997 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00432       ADCIN 0, aninput
                      01998         ADCIN?CW        000h, _ANINPUT
001676 0E00               M         movlw   000h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
001678 EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
                          M     endif
00167C 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
00167E C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      01999 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 373


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02000 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00434       ANALOG0=aninput
                      02001         MOVE?WW _ANINPUT, _ANALOG0
                          M         MOVE?BB _ANINPUT, _ANALOG0
001682 C06E F070          M         movff   _ANINPUT, _ANALOG0
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG0) + 1
001686 C06F F071          M         movff   (_ANINPUT) + 1, (_ANALOG0) + 1
                      02002 
                      02003 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00436       ADCIN 1, aninput
                      02004         ADCIN?CW        001h, _ANINPUT
00168A 0E01               M         movlw   001h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
00168C EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 374


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
001690 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
001692 C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02005 
                      02006 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00438       ANALOG1=aninput
                      02007         MOVE?WW _ANINPUT, _ANALOG1
                          M         MOVE?BB _ANINPUT, _ANALOG1
001696 C06E F072          M         movff   _ANINPUT, _ANALOG1
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG1) + 1
00169A C06F F073          M         movff   (_ANINPUT) + 1, (_ANALOG1) + 1
                      02008 
                      02009 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00441       LATA.2=1
                      02010         MOVE?CT 001h, _LATA??2
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
00169E 8489               M         bsf     LATA,   002h
                          M     else
                          M         bcf     LATA,   002h
                          M     endif
                      02011 
                      02012 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00442       LATA.3=0   
                      02013         MOVE?CT 000h, _LATA??3
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 375


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((000h) & 1) == 1)
                          M         bsf     LATA,   003h
                          M     else
0016A0 9689               M         bcf     LATA,   003h
                          M     endif
                      02014 
                      02015 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00443       ADCIN 0, aninput
                      02016         ADCIN?CW        000h, _ANINPUT
0016A2 0E00               M         movlw   000h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
0016A4 EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 376


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
0016A8 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
0016AA C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02017 
                      02018 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00445       ANALOG2=aninput
                      02019         MOVE?WW _ANINPUT, _ANALOG2
                          M         MOVE?BB _ANINPUT, _ANALOG2
0016AE C06E F074          M         movff   _ANINPUT, _ANALOG2
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG2) + 1
0016B2 C06F F075          M         movff   (_ANINPUT) + 1, (_ANALOG2) + 1
                      02020 
                      02021 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00447       ADCIN 1, aninput
                      02022         ADCIN?CW        001h, _ANINPUT
0016B6 0E01               M         movlw   001h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
0016B8 EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 377


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
                          M     endif
0016BC 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
0016BE C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02023 
                      02024 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00449       ANALOG3=aninput
                      02025         MOVE?WW _ANINPUT, _ANALOG3
                          M         MOVE?BB _ANINPUT, _ANALOG3
0016C2 C06E F076          M         movff   _ANINPUT, _ANALOG3
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG3) + 1
0016C6 C06F F077          M         movff   (_ANINPUT) + 1, (_ANALOG3) + 1
                      02026 
                      02027 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00451       LATA.2=0
                      02028         MOVE?CT 000h, _LATA??2
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     LATA,   002h
                          M     else
0016CA 9489               M         bcf     LATA,   002h
                          M     endif
                      02029 
                      02030 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00452       LATA.3=1
                      02031         MOVE?CT 001h, _LATA??3
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 378


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0016CC 8689               M         bsf     LATA,   003h
                          M     else
                          M         bcf     LATA,   003h
                          M     endif
                      02032 
                      02033 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00453       ADCIN 0, aninput
                      02034         ADCIN?CW        000h, _ANINPUT
0016CE 0E00               M         movlw   000h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
0016D0 EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 379


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
                          M     endif
0016D4 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
0016D6 C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02035 
                      02036 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00455       ANALOG4=aninput
                      02037         MOVE?WW _ANINPUT, _ANALOG4
                          M         MOVE?BB _ANINPUT, _ANALOG4
0016DA C06E F078          M         movff   _ANINPUT, _ANALOG4
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG4) + 1
0016DE C06F F079          M         movff   (_ANINPUT) + 1, (_ANALOG4) + 1
                      02038 
                      02039 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00457       ADCIN 1, aninput
                      02040         ADCIN?CW        001h, _ANINPUT
0016E2 0E01               M         movlw   001h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
0016E4 EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 380


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
                          M     endif
0016E8 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
0016EA C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02041 
                      02042 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00459       ANALOG5=aninput
                      02043         MOVE?WW _ANINPUT, _ANALOG5
                          M         MOVE?BB _ANINPUT, _ANALOG5
0016EE C06E F07A          M         movff   _ANINPUT, _ANALOG5
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG5) + 1
0016F2 C06F F07B          M         movff   (_ANINPUT) + 1, (_ANALOG5) + 1
                      02044 
                      02045 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00461       LATA.2=1
                      02046         MOVE?CT 001h, _LATA??2
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0016F6 8489               M         bsf     LATA,   002h
                          M     else
                          M         bcf     LATA,   002h
                          M     endif
                      02047 
                      02048 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00462       LATA.3=1
                      02049         MOVE?CT 001h, _LATA??3
                          M         CHK?RP  LATA
                          M     if (((LATA)  & 8000h) != PREV_ALT)
                          M       if ((LATA)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 381


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATA)  & 8000h
                          M     endif
                          M     if ((((LATA)  & 0fffh) > BANKA_END) & (((LATA)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATA)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATA)
                          M PREV_BANK = high (LATA)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0016F8 8689               M         bsf     LATA,   003h
                          M     else
                          M         bcf     LATA,   003h
                          M     endif
                      02050 
                      02051 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00463       ADCIN 0, aninput
                      02052         ADCIN?CW        000h, _ANINPUT
0016FA 0E00               M         movlw   000h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
0016FC EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 382


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
                          M     endif
001700 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
001702 C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02053 
                      02054 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00465       ANALOG6=aninput
                      02055         MOVE?WW _ANINPUT, _ANALOG6
                          M         MOVE?BB _ANINPUT, _ANALOG6
001706 C06E F07C          M         movff   _ANINPUT, _ANALOG6
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG6) + 1
00170A C06F F07D          M         movff   (_ANINPUT) + 1, (_ANALOG6) + 1
                      02056 
                      02057 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00467       ADCIN 1, aninput
                      02058         ADCIN?CW        001h, _ANINPUT
00170E 0E01               M         movlw   001h
                          M         L?CALL  ADCIN
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    ADCIN
                          M     else
                          M       if ((ADCIN) < 1)
                          M         call    ADCIN
                          M       else
                          M         if ((ADCIN) > $)
                          M         call    ADCIN
                          M         else
                          M           if ((ADCIN) < ($ - 3ffh))
001710 EC46 F000          M         call    ADCIN
                          M           else
                          M         rcall   ADCIN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 383


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?AWW R0, _ANINPUT
                          M         MOVE?AB _ANINPUT
                          M         CHK?RP  _ANINPUT
                          M     if (((_ANINPUT) & 8000h) != PREV_ALT)
                          M       if ((_ANINPUT) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANINPUT) & 8000h
                          M     endif
                          M     if ((((_ANINPUT) & 0fffh) > BANKA_END) & (((_ANINPUT) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANINPUT) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANINPUT)
                          M PREV_BANK = high (_ANINPUT)
                          M       endif
                          M     endif
001714 6F6E               M         movwf   _ANINPUT
                          M         MOVE?BB (R0)  + 1, (_ANINPUT) + 1
001716 C003 F06F          M         movff   (R0) + 1, (_ANINPUT) + 1
                      02059 
                      02060 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00469       ANALOG7=aninput
                      02061         MOVE?WW _ANINPUT, _ANALOG7
                          M         MOVE?BB _ANINPUT, _ANALOG7
00171A C06E F07E          M         movff   _ANINPUT, _ANALOG7
                          M         MOVE?BB (_ANINPUT) + 1, (_ANALOG7) + 1
00171E C06F F07F          M         movff   (_ANINPUT) + 1, (_ANALOG7) + 1
                      02062 
                      02063 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00471       if ANTemp0 != ANALOG0 then
                      02064         CMPEQ?WWL       _ANTemp0, _ANALOG0, L00075
                          M         MOVE?WW _ANTemp0, R0
                          M         MOVE?BB _ANTemp0, R0
001722 C080 F002          M         movff   _ANTemp0, R0
                          M         MOVE?BB (_ANTemp0) + 1, (R0) + 1
001726 C081 F003          M         movff   (_ANTemp0) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG0, R1
                          M         MOVE?BB (_ANALOG0) + 1, (R1) + 1
00172A C071 F005          M         movff   (_ANALOG0) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG0
                          M         CHK?RP  _ANALOG0
                          M     if (((_ANALOG0) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG0) & 8000h
                          M     endif
                          M     if ((((_ANALOG0) & 0fffh) > BANKA_END) & (((_ANALOG0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG0)
                          M PREV_BANK = high (_ANALOG0)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 384


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
00172E 5170               M         movf    _ANALOG0, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
001730 EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00075
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00075))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00075
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 385


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         if ((L00075) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00075
                          M         else
                          M           if ((L00075) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00075
                          M           else
                          M             if ((L00075) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00075
                          M             else
                          M         bov     L00075
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001734 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00075
                          M       else
                          M         if ((L00075) < 1)
                          M         goto    L00075
                          M         else
                          M           if ((L00075) > $)
001736 EFA2 F00B          M         goto    L00075
                          M           else
                          M             if ((L00075) < ($ - 3ffh))
                          M         goto    L00075
                          M             else
                          M         bra     L00075
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02065 
                      02066 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00472           AllFlags.2=1
                      02067         MOVE?CT 001h, _AllFlags??2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 386


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
00173A 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      02068 
                      02069 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00473           ANTemp0=ANALOG0
                      02070         MOVE?WW _ANALOG0, _ANTemp0
                          M         MOVE?BB _ANALOG0, _ANTemp0
00173C C070 F080          M         movff   _ANALOG0, _ANTemp0
                          M         MOVE?BB (_ANALOG0) + 1, (_ANTemp0) + 1
001740 C071 F081          M         movff   (_ANALOG0) + 1, (_ANTemp0) + 1
                      02071 
                      02072 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00474       endif
                      02073         LABEL?L L00075  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00075
                          M         XALL
                          M     else
001744                    M L00075
                          M     endif
                      02074 
                      02075 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00476       if ANTemp1 != ANALOG1 then
                      02076         CMPEQ?WWL       _ANTemp1, _ANALOG1, L00077
                          M         MOVE?WW _ANTemp1, R0
                          M         MOVE?BB _ANTemp1, R0
001744 C082 F002          M         movff   _ANTemp1, R0
                          M         MOVE?BB (_ANTemp1) + 1, (R0) + 1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 387


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001748 C083 F003          M         movff   (_ANTemp1) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG1, R1
                          M         MOVE?BB (_ANALOG1) + 1, (R1) + 1
00174C C073 F005          M         movff   (_ANALOG1) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG1
                          M         CHK?RP  _ANALOG1
                          M     if (((_ANALOG1) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG1) & 8000h
                          M     endif
                          M     if ((((_ANALOG1) & 0fffh) > BANKA_END) & (((_ANALOG1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG1)
                          M PREV_BANK = high (_ANALOG1)
                          M       endif
                          M     endif
001750 5172               M         movf    _ANALOG1, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
001752 EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00077
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 388


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ($ == (L00077))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00077
                          M       else
                          M         if ((L00077) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00077
                          M         else
                          M           if ((L00077) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00077
                          M           else
                          M             if ((L00077) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00077
                          M             else
                          M         bov     L00077
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001756 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00077
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 389


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((L00077) < 1)
                          M         goto    L00077
                          M         else
                          M           if ((L00077) > $)
001758 EFB3 F00B          M         goto    L00077
                          M           else
                          M             if ((L00077) < ($ - 3ffh))
                          M         goto    L00077
                          M             else
                          M         bra     L00077
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02077 
                      02078 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00477           AllFlags.1=1
                      02079         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
00175C 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      02080 
                      02081 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00478           ANTemp1=ANALOG1
                      02082         MOVE?WW _ANALOG1, _ANTemp1
                          M         MOVE?BB _ANALOG1, _ANTemp1
00175E C072 F082          M         movff   _ANALOG1, _ANTemp1
                          M         MOVE?BB (_ANALOG1) + 1, (_ANTemp1) + 1
001762 C073 F083          M         movff   (_ANALOG1) + 1, (_ANTemp1) + 1
                      02083 
                      02084 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00479       endif
                      02085         LABEL?L L00077  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 390


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00077
                          M         XALL
                          M     else
001766                    M L00077
                          M     endif
                      02086 
                      02087 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00481       if ANTemp2 != ANALOG2 then
                      02088         CMPEQ?WWL       _ANTemp2, _ANALOG2, L00079
                          M         MOVE?WW _ANTemp2, R0
                          M         MOVE?BB _ANTemp2, R0
001766 C084 F002          M         movff   _ANTemp2, R0
                          M         MOVE?BB (_ANTemp2) + 1, (R0) + 1
00176A C085 F003          M         movff   (_ANTemp2) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG2, R1
                          M         MOVE?BB (_ANALOG2) + 1, (R1) + 1
00176E C075 F005          M         movff   (_ANALOG2) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG2
                          M         CHK?RP  _ANALOG2
                          M     if (((_ANALOG2) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG2) & 8000h
                          M     endif
                          M     if ((((_ANALOG2) & 0fffh) > BANKA_END) & (((_ANALOG2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG2)
                          M PREV_BANK = high (_ANALOG2)
                          M       endif
                          M     endif
001772 5174               M         movf    _ANALOG2, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 391


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
001774 EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00079
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00079))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00079
                          M       else
                          M         if ((L00079) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00079
                          M         else
                          M           if ((L00079) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00079
                          M           else
                          M             if ((L00079) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00079
                          M             else
                          M         bov     L00079
                          M             endif
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 392


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001778 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00079
                          M       else
                          M         if ((L00079) < 1)
                          M         goto    L00079
                          M         else
                          M           if ((L00079) > $)
00177A EFC4 F00B          M         goto    L00079
                          M           else
                          M             if ((L00079) < ($ - 3ffh))
                          M         goto    L00079
                          M             else
                          M         bra     L00079
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02089 
                      02090 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00482           AllFlags.2=1
                      02091         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 393


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((001h) & 1) == 1)
00177E 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      02092 
                      02093 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00483           ANTemp2=ANALOG2
                      02094         MOVE?WW _ANALOG2, _ANTemp2
                          M         MOVE?BB _ANALOG2, _ANTemp2
001780 C074 F084          M         movff   _ANALOG2, _ANTemp2
                          M         MOVE?BB (_ANALOG2) + 1, (_ANTemp2) + 1
001784 C075 F085          M         movff   (_ANALOG2) + 1, (_ANTemp2) + 1
                      02095 
                      02096 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00484       endif
                      02097         LABEL?L L00079  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00079
                          M         XALL
                          M     else
001788                    M L00079
                          M     endif
                      02098 
                      02099 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00486       if ANTemp3 != ANALOG3 then
                      02100         CMPEQ?WWL       _ANTemp3, _ANALOG3, L00081
                          M         MOVE?WW _ANTemp3, R0
                          M         MOVE?BB _ANTemp3, R0
001788 C086 F002          M         movff   _ANTemp3, R0
                          M         MOVE?BB (_ANTemp3) + 1, (R0) + 1
00178C C087 F003          M         movff   (_ANTemp3) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG3, R1
                          M         MOVE?BB (_ANALOG3) + 1, (R1) + 1
001790 C077 F005          M         movff   (_ANALOG3) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG3
                          M         CHK?RP  _ANALOG3
                          M     if (((_ANALOG3) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG3) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG3) & 8000h
                          M     endif
                          M     if ((((_ANALOG3) & 0fffh) > BANKA_END) & (((_ANALOG3) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 394


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_ANALOG3) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG3)
                          M PREV_BANK = high (_ANALOG3)
                          M       endif
                          M     endif
001794 5176               M         movf    _ANALOG3, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
001796 EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00081
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00081))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 395


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00081
                          M       else
                          M         if ((L00081) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00081
                          M         else
                          M           if ((L00081) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00081
                          M           else
                          M             if ((L00081) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00081
                          M             else
                          M         bov     L00081
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00179A A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00081
                          M       else
                          M         if ((L00081) < 1)
                          M         goto    L00081
                          M         else
                          M           if ((L00081) > $)
00179C EFD5 F00B          M         goto    L00081
                          M           else
                          M             if ((L00081) < ($ - 3ffh))
                          M         goto    L00081
                          M             else
                          M         bra     L00081
                          M             endif
                          M           endif
                          M         endif
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 396


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      02101 
                      02102 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00487           AllFlags.1=1
                      02103         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0017A0 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      02104 
                      02105 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00488           ANTemp3=ANALOG3
                      02106         MOVE?WW _ANALOG3, _ANTemp3
                          M         MOVE?BB _ANALOG3, _ANTemp3
0017A2 C076 F086          M         movff   _ANALOG3, _ANTemp3
                          M         MOVE?BB (_ANALOG3) + 1, (_ANTemp3) + 1
0017A6 C077 F087          M         movff   (_ANALOG3) + 1, (_ANTemp3) + 1
                      02107 
                      02108 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00489       endif
                      02109         LABEL?L L00081  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00081
                          M         XALL
                          M     else
0017AA                    M L00081
                          M     endif
                      02110 
                      02111 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00491       if ANTemp4 != ANALOG4 then
                      02112         CMPEQ?WWL       _ANTemp4, _ANALOG4, L00083
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 397


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?WW _ANTemp4, R0
                          M         MOVE?BB _ANTemp4, R0
0017AA C088 F002          M         movff   _ANTemp4, R0
                          M         MOVE?BB (_ANTemp4) + 1, (R0) + 1
0017AE C089 F003          M         movff   (_ANTemp4) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG4, R1
                          M         MOVE?BB (_ANALOG4) + 1, (R1) + 1
0017B2 C079 F005          M         movff   (_ANALOG4) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG4
                          M         CHK?RP  _ANALOG4
                          M     if (((_ANALOG4) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG4) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG4) & 8000h
                          M     endif
                          M     if ((((_ANALOG4) & 0fffh) > BANKA_END) & (((_ANALOG4) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG4) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG4)
                          M PREV_BANK = high (_ANALOG4)
                          M       endif
                          M     endif
0017B6 5178               M         movf    _ANALOG4, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
0017B8 EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 398


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         BIT?GOTO 0, STATUS, Z, L00083
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00083))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00083
                          M       else
                          M         if ((L00083) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00083
                          M         else
                          M           if ((L00083) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00083
                          M           else
                          M             if ((L00083) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00083
                          M             else
                          M         bov     L00083
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0017BC A4D8               M         btfss   STATUS, Z
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 399


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00083
                          M       else
                          M         if ((L00083) < 1)
                          M         goto    L00083
                          M         else
                          M           if ((L00083) > $)
0017BE EFE6 F00B          M         goto    L00083
                          M           else
                          M             if ((L00083) < ($ - 3ffh))
                          M         goto    L00083
                          M             else
                          M         bra     L00083
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02113 
                      02114 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00492           AllFlags.2=1
                      02115         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0017C2 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      02116 
                      02117 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00493           ANTemp4=ANALOG4
                      02118         MOVE?WW _ANALOG4, _ANTemp4
                          M         MOVE?BB _ANALOG4, _ANTemp4
0017C4 C078 F088          M         movff   _ANALOG4, _ANTemp4
                          M         MOVE?BB (_ANALOG4) + 1, (_ANTemp4) + 1
0017C8 C079 F089          M         movff   (_ANALOG4) + 1, (_ANTemp4) + 1
                      02119 
                      02120 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00494       endif
                      02121         LABEL?L L00083  
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 400


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00083
                          M         XALL
                          M     else
0017CC                    M L00083
                          M     endif
                      02122 
                      02123 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00496       if ANTemp5 != ANALOG5 then
                      02124         CMPEQ?WWL       _ANTemp5, _ANALOG5, L00085
                          M         MOVE?WW _ANTemp5, R0
                          M         MOVE?BB _ANTemp5, R0
0017CC C08A F002          M         movff   _ANTemp5, R0
                          M         MOVE?BB (_ANTemp5) + 1, (R0) + 1
0017D0 C08B F003          M         movff   (_ANTemp5) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG5, R1
                          M         MOVE?BB (_ANALOG5) + 1, (R1) + 1
0017D4 C07B F005          M         movff   (_ANALOG5) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG5
                          M         CHK?RP  _ANALOG5
                          M     if (((_ANALOG5) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG5) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG5) & 8000h
                          M     endif
                          M     if ((((_ANALOG5) & 0fffh) > BANKA_END) & (((_ANALOG5) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG5) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG5)
                          M PREV_BANK = high (_ANALOG5)
                          M       endif
                          M     endif
0017D8 517A               M         movf    _ANALOG5, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 401


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
0017DA EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00085
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00085))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00085
                          M       else
                          M         if ((L00085) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00085
                          M         else
                          M           if ((L00085) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00085
                          M           else
                          M             if ((L00085) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00085
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 402


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             else
                          M         bov     L00085
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0017DE A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00085
                          M       else
                          M         if ((L00085) < 1)
                          M         goto    L00085
                          M         else
                          M           if ((L00085) > $)
0017E0 EFF7 F00B          M         goto    L00085
                          M           else
                          M             if ((L00085) < ($ - 3ffh))
                          M         goto    L00085
                          M             else
                          M         bra     L00085
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02125 
                      02126 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00497           AllFlags.1=1
                      02127         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 403


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0017E4 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      02128 
                      02129 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00498           ANTemp5=ANALOG5
                      02130         MOVE?WW _ANALOG5, _ANTemp5
                          M         MOVE?BB _ANALOG5, _ANTemp5
0017E6 C07A F08A          M         movff   _ANALOG5, _ANTemp5
                          M         MOVE?BB (_ANALOG5) + 1, (_ANTemp5) + 1
0017EA C07B F08B          M         movff   (_ANALOG5) + 1, (_ANTemp5) + 1
                      02131 
                      02132 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00499       endif
                      02133         LABEL?L L00085  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00085
                          M         XALL
                          M     else
0017EE                    M L00085
                          M     endif
                      02134 
                      02135 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00501       if ANTemp6 != ANALOG6 then
                      02136         CMPEQ?WWL       _ANTemp6, _ANALOG6, L00087
                          M         MOVE?WW _ANTemp6, R0
                          M         MOVE?BB _ANTemp6, R0
0017EE C08C F002          M         movff   _ANTemp6, R0
                          M         MOVE?BB (_ANTemp6) + 1, (R0) + 1
0017F2 C08D F003          M         movff   (_ANTemp6) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG6, R1
                          M         MOVE?BB (_ANALOG6) + 1, (R1) + 1
0017F6 C07D F005          M         movff   (_ANALOG6) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG6
                          M         CHK?RP  _ANALOG6
                          M     if (((_ANALOG6) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG6) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 404


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (_ANALOG6) & 8000h
                          M     endif
                          M     if ((((_ANALOG6) & 0fffh) > BANKA_END) & (((_ANALOG6) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG6) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG6)
                          M PREV_BANK = high (_ANALOG6)
                          M       endif
                          M     endif
0017FA 517C               M         movf    _ANALOG6, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
0017FC EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00087
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00087))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 405


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00087
                          M       else
                          M         if ((L00087) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00087
                          M         else
                          M           if ((L00087) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00087
                          M           else
                          M             if ((L00087) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00087
                          M             else
                          M         bov     L00087
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001800 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00087
                          M       else
                          M         if ((L00087) < 1)
                          M         goto    L00087
                          M         else
                          M           if ((L00087) > $)
001802 EF08 F00C          M         goto    L00087
                          M           else
                          M             if ((L00087) < ($ - 3ffh))
                          M         goto    L00087
                          M             else
                          M         bra     L00087
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 406


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02137 
                      02138 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00502           AllFlags.2=1
                      02139         MOVE?CT 001h, _AllFlags??2
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001806 8560               M         bsf     _AllFlags, 002h
                          M     else
                          M         bcf     _AllFlags, 002h
                          M     endif
                      02140 
                      02141 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00503           ANTemp6=ANALOG6
                      02142         MOVE?WW _ANALOG6, _ANTemp6
                          M         MOVE?BB _ANALOG6, _ANTemp6
001808 C07C F08C          M         movff   _ANALOG6, _ANTemp6
                          M         MOVE?BB (_ANALOG6) + 1, (_ANTemp6) + 1
00180C C07D F08D          M         movff   (_ANALOG6) + 1, (_ANTemp6) + 1
                      02143 
                      02144 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00504       endif
                      02145         LABEL?L L00087  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00087
                          M         XALL
                          M     else
001810                    M L00087
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 407


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      02146 
                      02147 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00506       if ANTemp7 != ANALOG7 then
                      02148         CMPEQ?WWL       _ANTemp7, _ANALOG7, L00089
                          M         MOVE?WW _ANTemp7, R0
                          M         MOVE?BB _ANTemp7, R0
001810 C08E F002          M         movff   _ANTemp7, R0
                          M         MOVE?BB (_ANTemp7) + 1, (R0) + 1
001814 C08F F003          M         movff   (_ANTemp7) + 1, (R0) + 1
                          M         MOVE?WWA _ANALOG7, R1
                          M         MOVE?BB (_ANALOG7) + 1, (R1) + 1
001818 C07F F005          M         movff   (_ANALOG7) + 1, (R1) + 1
                          M         MOVE?BA _ANALOG7
                          M         CHK?RP  _ANALOG7
                          M     if (((_ANALOG7) & 8000h) != PREV_ALT)
                          M       if ((_ANALOG7) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_ANALOG7) & 8000h
                          M     endif
                          M     if ((((_ANALOG7) & 0fffh) > BANKA_END) & (((_ANALOG7) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_ANALOG7) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_ANALOG7)
                          M PREV_BANK = high (_ANALOG7)
                          M       endif
                          M     endif
00181C 517E               M         movf    _ANALOG7, W
                          M         L?CALL  CMPEQ
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPEQ
                          M     else
                          M       if ((CMPEQ) < 1)
                          M         call    CMPEQ
                          M       else
                          M         if ((CMPEQ) > $)
                          M         call    CMPEQ
                          M         else
                          M           if ((CMPEQ) < ($ - 3ffh))
00181E EC8E F000          M         call    CMPEQ
                          M           else
                          M         rcall   CMPEQ
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 408


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, Z, L00089
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00089))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00089
                          M       else
                          M         if ((L00089) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00089
                          M         else
                          M           if ((L00089) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00089
                          M           else
                          M             if ((L00089) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00089
                          M             else
                          M         bov     L00089
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 409


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M       if ((0)      == 0)
001822 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00089
                          M       else
                          M         if ((L00089) < 1)
                          M         goto    L00089
                          M         else
                          M           if ((L00089) > $)
001824 EF19 F00C          M         goto    L00089
                          M           else
                          M             if ((L00089) < ($ - 3ffh))
                          M         goto    L00089
                          M             else
                          M         bra     L00089
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02149 
                      02150 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00507           AllFlags.1=1
                      02151         MOVE?CT 001h, _AllFlags??1
                          M         CHK?RP  _AllFlags
                          M     if (((_AllFlags) & 8000h) != PREV_ALT)
                          M       if ((_AllFlags) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_AllFlags) & 8000h
                          M     endif
                          M     if ((((_AllFlags) & 0fffh) > BANKA_END) & (((_AllFlags) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_AllFlags) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_AllFlags)
                          M PREV_BANK = high (_AllFlags)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001828 8360               M         bsf     _AllFlags, 001h
                          M     else
                          M         bcf     _AllFlags, 001h
                          M     endif
                      02152 
                      02153 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00508           ANTemp7=ANALOG7
                      02154         MOVE?WW _ANALOG7, _ANTemp7
                          M         MOVE?BB _ANALOG7, _ANTemp7
00182A C07E F08E          M         movff   _ANALOG7, _ANTemp7
                          M         MOVE?BB (_ANALOG7) + 1, (_ANTemp7) + 1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 410


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00182E C07F F08F          M         movff   (_ANALOG7) + 1, (_ANTemp7) + 1
                      02155 
                      02156 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00509       endif
                      02157         LABEL?L L00089  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00089
                          M         XALL
                          M     else
001832                    M L00089
                          M     endif
                      02158 
                      02159 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00511   RETURN
                      02160         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001832 0012               M         return
                      02161 
                      02162 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00516   COUNTER:
                      02163 
                      02164         LABEL?L _COUNTER        
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _COUNTER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 411


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
001834                    M _COUNTER
                          M     endif
                      02165 
                      02166 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00517       if chutes0>0 and COUNTS1 = 0 then
                      02167         CMPGT?BCB       _CHUTES0, 000h, T1
                          M     if ((000h) < 0)
                          M         CHK?RP  T1
                          M         setf    T1
                          M     else
                          M       if ((000h) < 0ffh)
                          M         MOVE?BB _CHUTES0, R0
001834 C09E F002          M         movff   _CHUTES0, R0
                          M         MOVE?CA 000h
001838 0E00               M         movlw   low (000h)
                          M         L?CALL  CMPGTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGTB
                          M     else
                          M       if ((CMPGTB) < 1)
                          M         call    CMPGTB
                          M       else
                          M         if ((CMPGTB) > $)
                          M         call    CMPGTB
                          M         else
                          M           if ((CMPGTB) < ($ - 3ffh))
00183A EC91 F000          M         call    CMPGTB
                          M           else
                          M         rcall   CMPGTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 412


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
00183E 6E14               M         movwf   T1
                          M       else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M       endif
                          M     endif
                      02168         CMPEQ?TCB       _COUNTS1, 000h, T2
                          M     if (((000h) == 0) | ((000h) == 1))
001840 6AE8               M         clrf    WREG
                          M         CHK?RP  PB01
                          M     if (((PB01)  & 8000h) != PREV_ALT)
                          M       if ((PB01)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PB01)  & 8000h
                          M     endif
                          M     if ((((PB01)  & 0fffh) > BANKA_END) & (((PB01)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PB01)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PB01)
                          M PREV_BANK = high (PB01)
                          M       endif
                          M     endif
                          M       if ((000h) == 0)
001842 A01E               M         btfss PB01,  000h
                          M       else
                          M         btfsc PB01,  000h
                          M       endif
001844 68E8               M         setf    WREG
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 413


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001846 6E16               M         movwf   T2
                          M     else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M     endif
                      02169         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
001848 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
00184C 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
00184E ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 414


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001852 6E16               M         movwf   T2
001854 6E17               M         movwf   T2   + 1
                      02170         CMPF?WL T2, L00091
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001856 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
001858 5016               M         movf    T2,  W
00185A 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00091
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00091))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 415


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00091
                          M       else
                          M         if ((L00091) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00091
                          M         else
                          M           if ((L00091) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00091
                          M           else
                          M             if ((L00091) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00091
                          M             else
                          M         bov     L00091
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
00185C B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00091
                          M       else
                          M         if ((L00091) < 1)
                          M         goto    L00091
                          M         else
                          M           if ((L00091) > $)
00185E EF36 F00C          M         goto    L00091
                          M           else
                          M             if ((L00091) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 416


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00091
                          M             else
                          M         bra     L00091
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02171 
                      02172 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00518           OUTPUTS2.4=1'buffersalida 1 counter 1
                      02173         MOVE?CT 001h, _OUTPUTS2??4
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001862 896D               M         bsf     _OUTPUTS2, 004h
                          M     else
                          M         bcf     _OUTPUTS2, 004h
                          M     endif
                      02174 
                      02175 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00519           gosub wout
                      02176         GOSUB?L _wout
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _wout
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 417


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _wout
                          M     else
                          M       if ((_wout) < 1)
                          M         call    _wout
                          M       else
                          M         if ((_wout) > $)
001864 EC8B F00C          M         call    _wout
                          M         else
                          M           if ((_wout) < ($ - 3ffh))
                          M         call    _wout
                          M           else
                          M         rcall   _wout
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001868                    M dlabel
                      02177 
                      02178 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00520           COUNTS1 = 1
                      02179         MOVE?CT 001h, _COUNTS1
                          M         CHK?RP  PB01
                          M     if (((PB01)  & 8000h) != PREV_ALT)
                          M       if ((PB01)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PB01)  & 8000h
                          M     endif
                          M     if ((((PB01)  & 0fffh) > BANKA_END) & (((PB01)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PB01)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PB01)
                          M PREV_BANK = high (PB01)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001868 801E               M         bsf     PB01,   000h
                          M     else
                          M         bcf     PB01,   000h
                          M     endif
                      02180 
                      02181 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00521           timer1=0
                      02182         MOVE?CB 000h, _TIMER1
                          M         CHK?RP  _TIMER1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 418


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_TIMER1) & 8000h) != PREV_ALT)
                          M       if ((_TIMER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER1) & 8000h
                          M     endif
                          M     if ((((_TIMER1) & 0fffh) > BANKA_END) & (((_TIMER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER1)
                          M PREV_BANK = high (_TIMER1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
00186A 6BA3               M         clrf    _TIMER1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TIMER1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TIMER1
                          M       endif
                          M     endif
                      02183 
                      02184 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00522       endif
                      02185         LABEL?L L00091  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00091
                          M         XALL
                          M     else
00186C                    M L00091
                          M     endif
                      02186 
                      02187 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00524       if COUNTS1=1 then
                      02188         CMPNE?TCL       _COUNTS1, 001h, L00093
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, PB01,  000h,  L00093
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 419


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00186C 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, PB01,  000h,  L00093
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00093))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((PB01)  > BANKA_END) & ((PB01)  < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  PB01
                          M       if ((0)      == 0)
                          M         btfss   PB01,  000h
                          M       else
                          M         btfsc   PB01,  000h
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00093
                          M       else
                          M         if ((L00093) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00093
                          M         else
                          M           if ((L00093) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00093
                          M           else
                          M             if ((L00093) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00093
                          M             else
                          M         bov     L00093
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 420


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

00186E A01E               M         btfss   PB01,  000h
                          M       else
                          M         btfsc   PB01,  000h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00093
                          M       else
                          M         if ((L00093) < 1)
                          M         goto    L00093
                          M         else
                          M           if ((L00093) > $)
001870 EF52 F00C          M         goto    L00093
                          M           else
                          M             if ((L00093) < ($ - 3ffh))
                          M         goto    L00093
                          M             else
                          M         bra     L00093
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00093
                          M       endif
                          M     endif
                      02189 
                      02190 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00525           timer1=timer1+1
                      02191         ADD?BCB _TIMER1, 001h, _TIMER1
                          M     if ((_TIMER1) == (_TIMER1))
                          M       if ((001h) == 1)
                          M         CHK?RP  _TIMER1
                          M     if (((_TIMER1) & 8000h) != PREV_ALT)
                          M       if ((_TIMER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER1) & 8000h
                          M     endif
                          M     if ((((_TIMER1) & 0fffh) > BANKA_END) & (((_TIMER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER1)
                          M PREV_BANK = high (_TIMER1)
                          M       endif
                          M     endif
001874 2BA3               M         incf    _TIMER1, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TIMER1
                          M         addwf   _TIMER1, F
                          M       endif
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 421


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((001h) == 1)
                          M         CHK?RP  _TIMER1
                          M         incf    _TIMER1, W
                          M         MOVE?AB _TIMER1
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TIMER1
                          M         addwf   _TIMER1, W
                          M         MOVE?AB _TIMER1
                          M       endif
                          M     endif
                      02192 
                      02193 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00526           if timer1=40 then
                      02194         CMPNE?BCL       _TIMER1, 028h, L00095
                          M     if (((028h) > -100h) & ((028h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001876 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _TIMER1
                          M         CHK?RP  _TIMER1
                          M     if (((_TIMER1) & 8000h) != PREV_ALT)
                          M       if ((_TIMER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER1) & 8000h
                          M     endif
                          M     if ((((_TIMER1) & 0fffh) > BANKA_END) & (((_TIMER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER1)
                          M PREV_BANK = high (_TIMER1)
                          M       endif
                          M     endif
001878 51A3               M         movf    _TIMER1, W
00187A 0828               M         sublw   028h
                          M         BIT?GOTO 0, STATUS, Z, L00095
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00095))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 422


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00095
                          M       else
                          M         if ((L00095) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00095
                          M         else
                          M           if ((L00095) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00095
                          M           else
                          M             if ((L00095) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00095
                          M             else
                          M         bov     L00095
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00187C A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00095
                          M       else
                          M         if ((L00095) < 1)
                          M         goto    L00095
                          M         else
                          M           if ((L00095) > $)
00187E EF44 F00C          M         goto    L00095
                          M           else
                          M             if ((L00095) < ($ - 3ffh))
                          M         goto    L00095
                          M             else
                          M         bra     L00095
                          M             endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 423


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00095
                          M     endif
                      02195 
                      02196 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00527               OUTPUTS2.4=0'buffer 1 off
                      02197         MOVE?CT 000h, _OUTPUTS2??4
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _OUTPUTS2, 004h
                          M     else
001882 996D               M         bcf     _OUTPUTS2, 004h
                          M     endif
                      02198 
                      02199 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00528               gosub wout
                      02200         GOSUB?L _wout
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _wout
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 424


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _wout
                          M     else
                          M       if ((_wout) < 1)
                          M         call    _wout
                          M       else
                          M         if ((_wout) > $)
001884 EC8B F00C          M         call    _wout
                          M         else
                          M           if ((_wout) < ($ - 3ffh))
                          M         call    _wout
                          M           else
                          M         rcall   _wout
                          M           endif
                          M         endif
                          M       endif
                          M     endif
001888                    M dlabel
                      02201 
                      02202 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00529           endif
                      02203         LABEL?L L00095  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00095
                          M         XALL
                          M     else
001888                    M L00095
                          M     endif
                      02204 
                      02205 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00530           if timer1>80 then timer1=0 :  COUNTS1=0 : chutes
                            0 = chutes0 - 1 : write 1,CHUTES0
                      02206         CMPLE?BCL       _TIMER1, 050h, L00097
                          M     if ((050h) >= 0ffh)
                          M         L?GOTO  L00097
                          M     else
                          M       if ((050h) >= 0)
                          M         CLRWDT?
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 425


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifndef NO_CLRWDT
001888 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (050h) + 1
00188A 0E51               M         movlw   low ((050h) + 1)
                          M         CHK?RP  _TIMER1
                          M     if (((_TIMER1) & 8000h) != PREV_ALT)
                          M       if ((_TIMER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER1) & 8000h
                          M     endif
                          M     if ((((_TIMER1) & 0fffh) > BANKA_END) & (((_TIMER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER1)
                          M PREV_BANK = high (_TIMER1)
                          M       endif
                          M     endif
00188C 5DA3               M         subwf   _TIMER1, W
                          M         BIT?GOTO 0, STATUS, C, L00097
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00097))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00097
                          M       else
                          M         if ((L00097) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00097
                          M         else
                          M           if ((L00097) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00097
                          M           else
                          M             if ((L00097) < ($ - 7fh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 426


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00097
                          M             else
                          M         bov     L00097
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00188E A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00097
                          M       else
                          M         if ((L00097) < 1)
                          M         goto    L00097
                          M         else
                          M           if ((L00097) > $)
001890 EF52 F00C          M         goto    L00097
                          M           else
                          M             if ((L00097) < ($ - 3ffh))
                          M         goto    L00097
                          M             else
                          M         bra     L00097
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       endif
                          M     endif
                      02207         MOVE?CB 000h, _TIMER1
                          M         CHK?RP  _TIMER1
                          M     if (((_TIMER1) & 8000h) != PREV_ALT)
                          M       if ((_TIMER1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER1) & 8000h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 427


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if ((((_TIMER1) & 0fffh) > BANKA_END) & (((_TIMER1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER1)
                          M PREV_BANK = high (_TIMER1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001894 6BA3               M         clrf    _TIMER1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TIMER1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TIMER1
                          M       endif
                          M     endif
                      02208         MOVE?CT 000h, _COUNTS1
                          M         CHK?RP  PB01
                          M     if (((PB01)  & 8000h) != PREV_ALT)
                          M       if ((PB01)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PB01)  & 8000h
                          M     endif
                          M     if ((((PB01)  & 0fffh) > BANKA_END) & (((PB01)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PB01)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PB01)
                          M PREV_BANK = high (PB01)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PB01,   000h
                          M     else
001896 901E               M         bcf     PB01,   000h
                          M     endif
                      02209         SUB?BCB _CHUTES0, 001h, _CHUTES0
                          M     if ((_CHUTES0) == (_CHUTES0))
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES0
                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 428


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
001898 079E               M         decf    _CHUTES0, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES0
                          M         subwf   _CHUTES0, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES0
                          M         decf    _CHUTES0, W
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES0
                          M         subwf   _CHUTES0, W
                          M       endif
                          M         MOVE?AB _CHUTES0
                          M     endif
                      02210         WRITEADDRESS?C  001h
                          M     ifdef EEADRH
                          M         MOVE?CW (001h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 001h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    EEADR
                          M       else
00189A 0E01               M         movlw   low (001h)
00189C 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      02211         WRITE?B _CHUTES0
                          M         MOVE?BA _CHUTES0
                          M         CHK?RP  _CHUTES0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 429


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((_CHUTES0) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES0) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES0) & 8000h
                          M     endif
                          M     if ((((_CHUTES0) & 0fffh) > BANKA_END) & (((_CHUTES0) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES0) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES0)
                          M PREV_BANK = high (_CHUTES0)
                          M       endif
                          M     endif
00189E 519E               M         movf    _CHUTES0, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
0018A0 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02212         LABEL?L L00097  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 430


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef PM_USED
                          M         LALL
                          M L00097
                          M         XALL
                          M     else
0018A4                    M L00097
                          M     endif
                      02213 
                      02214 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00531       endif
                      02215         LABEL?L L00093  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00093
                          M         XALL
                          M     else
0018A4                    M L00093
                          M     endif
                      02216 
                      02217 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00533       if chutes1>0 and COUNTS2 = 0 then
                      02218         CMPGT?BCB       _CHUTES1, 000h, T1
                          M     if ((000h) < 0)
                          M         CHK?RP  T1
                          M         setf    T1
                          M     else
                          M       if ((000h) < 0ffh)
                          M         MOVE?BB _CHUTES1, R0
0018A4 C09F F002          M         movff   _CHUTES1, R0
                          M         MOVE?CA 000h
0018A8 0E00               M         movlw   low (000h)
                          M         L?CALL  CMPGTB
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    CMPGTB
                          M     else
                          M       if ((CMPGTB) < 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 431


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         call    CMPGTB
                          M       else
                          M         if ((CMPGTB) > $)
                          M         call    CMPGTB
                          M         else
                          M           if ((CMPGTB) < ($ - 3ffh))
0018AA EC91 F000          M         call    CMPGTB
                          M           else
                          M         rcall   CMPGTB
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T1
                          M         CHK?RP  T1
                          M     if (((T1)    & 8000h) != PREV_ALT)
                          M       if ((T1)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T1)    & 8000h
                          M     endif
                          M     if ((((T1)    & 0fffh) > BANKA_END) & (((T1)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T1)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T1)
                          M PREV_BANK = high (T1)
                          M       endif
                          M     endif
0018AE 6E14               M         movwf   T1
                          M       else
                          M         CHK?RP  T1
                          M         clrf    T1
                          M       endif
                          M     endif
                      02219         CMPEQ?TCB       _COUNTS2, 000h, T2
                          M     if (((000h) == 0) | ((000h) == 1))
0018B0 6AE8               M         clrf    WREG
                          M         CHK?RP  PB01
                          M     if (((PB01)  & 8000h) != PREV_ALT)
                          M       if ((PB01)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PB01)  & 8000h
                          M     endif
                          M     if ((((PB01)  & 0fffh) > BANKA_END) & (((PB01)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PB01)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PB01)
                          M PREV_BANK = high (PB01)
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 432


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((000h) == 0)
0018B2 A21E               M         btfss PB01,  001h
                          M       else
                          M         btfsc PB01,  001h
                          M       endif
0018B4 68E8               M         setf    WREG
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0018B6 6E16               M         movwf   T2
                          M     else
                          M         CHK?RP  T2
                          M         clrf    T2
                          M     endif
                      02220         LAND?BBW        T1, T2, T2
                          M         MOVE?BB T1,   R0
0018B8 C014 F002          M         movff   T1,  R0
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0018BC 5016               M         movf    T2,  W
                          M         L?CALL  LAND
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 433


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    LAND
                          M     else
                          M       if ((LAND)  < 1)
                          M         call    LAND
                          M       else
                          M         if ((LAND)  > $)
                          M         call    LAND
                          M         else
                          M           if ((LAND)  < ($ - 3ffh))
0018BE ECAB F000          M         call    LAND
                          M           else
                          M         rcall   LAND
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         MOVE?AB T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0018C2 6E16               M         movwf   T2
0018C4 6E17               M         movwf   T2   + 1
                      02221         CMPF?WL T2, L00099
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0018C6 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA T2
                          M         CHK?RP  T2
                          M     if (((T2)    & 8000h) != PREV_ALT)
                          M       if ((T2)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 434


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (T2)    & 8000h
                          M     endif
                          M     if ((((T2)    & 0fffh) > BANKA_END) & (((T2)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((T2)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (T2)
                          M PREV_BANK = high (T2)
                          M       endif
                          M     endif
0018C8 5016               M         movf    T2,  W
0018CA 1017               M         iorwf   (T2)  + 1, W
                          M         BIT?GOTO 1, STATUS, Z, L00099
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00099))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00099
                          M       else
                          M         if ((L00099) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00099
                          M         else
                          M           if ((L00099) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00099
                          M           else
                          M             if ((L00099) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00099
                          M             else
                          M         bov     L00099
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 435


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((1)      == 0)
                          M         btfss   STATUS, Z
                          M       else
0018CC B4D8               M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00099
                          M       else
                          M         if ((L00099) < 1)
                          M         goto    L00099
                          M         else
                          M           if ((L00099) > $)
0018CE EF6E F00C          M         goto    L00099
                          M           else
                          M             if ((L00099) < ($ - 3ffh))
                          M         goto    L00099
                          M             else
                          M         bra     L00099
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02222 
                      02223 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00534           OUTPUTS2.5=1'buffersalida 1
                      02224         MOVE?CT 001h, _OUTPUTS2??5
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0018D2 8B6D               M         bsf     _OUTPUTS2, 005h
                          M     else
                          M         bcf     _OUTPUTS2, 005h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 436


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02225 
                      02226 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00535           gosub wout
                      02227         GOSUB?L _wout
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _wout
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _wout
                          M     else
                          M       if ((_wout) < 1)
                          M         call    _wout
                          M       else
                          M         if ((_wout) > $)
0018D4 EC8B F00C          M         call    _wout
                          M         else
                          M           if ((_wout) < ($ - 3ffh))
                          M         call    _wout
                          M           else
                          M         rcall   _wout
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0018D8                    M dlabel
                      02228 
                      02229 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00536           COUNTS2 = 1
                      02230         MOVE?CT 001h, _COUNTS2
                          M         CHK?RP  PB01
                          M     if (((PB01)  & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 437


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((PB01)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PB01)  & 8000h
                          M     endif
                          M     if ((((PB01)  & 0fffh) > BANKA_END) & (((PB01)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PB01)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PB01)
                          M PREV_BANK = high (PB01)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
0018D8 821E               M         bsf     PB01,   001h
                          M     else
                          M         bcf     PB01,   001h
                          M     endif
                      02231 
                      02232 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00537           timer2=0
                      02233         MOVE?CB 000h, _TIMER2
                          M         CHK?RP  _TIMER2
                          M     if (((_TIMER2) & 8000h) != PREV_ALT)
                          M       if ((_TIMER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER2) & 8000h
                          M     endif
                          M     if ((((_TIMER2) & 0fffh) > BANKA_END) & (((_TIMER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER2)
                          M PREV_BANK = high (_TIMER2)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0018DA 6BA4               M         clrf    _TIMER2
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TIMER2
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TIMER2
                          M       endif
                          M     endif
                      02234 
                      02235 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00538       endif
                      02236         LABEL?L L00099  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 438


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00099
                          M         XALL
                          M     else
0018DC                    M L00099
                          M     endif
                      02237 
                      02238 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00540       if COUNTS2=1 then
                      02239         CMPNE?TCL       _COUNTS2, 001h, L00101
                          M     if ((001h) == 0)
                          M         CLRWDT?
                          M         BIT?GOTO 1, PB01,  001h,  L00101
                          M     else
                          M       if ((001h) == 1)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0018DC 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, PB01,  001h,  L00101
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00101))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((PB01)  > BANKA_END) & ((PB01)  < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  PB01
                          M       if ((0)      == 0)
                          M         btfss   PB01,  001h
                          M       else
                          M         btfsc   PB01,  001h
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00101
                          M       else
                          M         if ((L00101) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00101
                          M         else
                          M           if ((L00101) > $)
                          M         btfsc   STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 439


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00101
                          M           else
                          M             if ((L00101) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00101
                          M             else
                          M         bov     L00101
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0018DE A21E               M         btfss   PB01,  001h
                          M       else
                          M         btfsc   PB01,  001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00101
                          M       else
                          M         if ((L00101) < 1)
                          M         goto    L00101
                          M         else
                          M           if ((L00101) > $)
0018E0 EF8A F00C          M         goto    L00101
                          M           else
                          M             if ((L00101) < ($ - 3ffh))
                          M         goto    L00101
                          M             else
                          M         bra     L00101
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       else
                          M         L?GOTO  L00101
                          M       endif
                          M     endif
                      02240 
                      02241 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00541           timer2=timer2+1
                      02242         ADD?BCB _TIMER2, 001h, _TIMER2
                          M     if ((_TIMER2) == (_TIMER2))
                          M       if ((001h) == 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 440


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _TIMER2
                          M     if (((_TIMER2) & 8000h) != PREV_ALT)
                          M       if ((_TIMER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER2) & 8000h
                          M     endif
                          M     if ((((_TIMER2) & 0fffh) > BANKA_END) & (((_TIMER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER2)
                          M PREV_BANK = high (_TIMER2)
                          M       endif
                          M     endif
0018E4 2BA4               M         incf    _TIMER2, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TIMER2
                          M         addwf   _TIMER2, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _TIMER2
                          M         incf    _TIMER2, W
                          M         MOVE?AB _TIMER2
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _TIMER2
                          M         addwf   _TIMER2, W
                          M         MOVE?AB _TIMER2
                          M       endif
                          M     endif
                      02243 
                      02244 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00542           if timer2=40 then
                      02245         CMPNE?BCL       _TIMER2, 028h, L00103
                          M     if (((028h) > -100h) & ((028h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0018E6 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _TIMER2
                          M         CHK?RP  _TIMER2
                          M     if (((_TIMER2) & 8000h) != PREV_ALT)
                          M       if ((_TIMER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER2) & 8000h
                          M     endif
                          M     if ((((_TIMER2) & 0fffh) > BANKA_END) & (((_TIMER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER2) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 441


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_TIMER2)
                          M PREV_BANK = high (_TIMER2)
                          M       endif
                          M     endif
0018E8 51A4               M         movf    _TIMER2, W
0018EA 0828               M         sublw   028h
                          M         BIT?GOTO 0, STATUS, Z, L00103
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00103))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00103
                          M       else
                          M         if ((L00103) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00103
                          M         else
                          M           if ((L00103) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00103
                          M           else
                          M             if ((L00103) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00103
                          M             else
                          M         bov     L00103
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 442


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0018EC A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00103
                          M       else
                          M         if ((L00103) < 1)
                          M         goto    L00103
                          M         else
                          M           if ((L00103) > $)
0018EE EF7C F00C          M         goto    L00103
                          M           else
                          M             if ((L00103) < ($ - 3ffh))
                          M         goto    L00103
                          M             else
                          M         bra     L00103
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00103
                          M     endif
                      02246 
                      02247 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00543               OUTPUTS2.5=0'buffer 1 off
                      02248         MOVE?CT 000h, _OUTPUTS2??5
                          M         CHK?RP  _OUTPUTS2
                          M     if (((_OUTPUTS2) & 8000h) != PREV_ALT)
                          M       if ((_OUTPUTS2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_OUTPUTS2) & 8000h
                          M     endif
                          M     if ((((_OUTPUTS2) & 0fffh) > BANKA_END) & (((_OUTPUTS2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_OUTPUTS2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_OUTPUTS2)
                          M PREV_BANK = high (_OUTPUTS2)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     _OUTPUTS2, 005h
                          M     else
0018F2 9B6D               M         bcf     _OUTPUTS2, 005h
                          M     endif
                      02249 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 443


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02250 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00544               gosub wout
                      02251         GOSUB?L _wout
  0000                    M     local dlabel
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M       ifdef DEBUG_STACK_ADDR
                          M         bcf     STATUS, C
                          M         rlcf    DEBUG_STACK, W
                          M         addlw   DEBUG_STACK_ADDR
                          M         movwf   FSR0L
                          M         clrf    FSR0H
                          M         movlw   low (dlabel)
                          M         movwf   POSTINC0
                          M         movlw   high (dlabel)
                          M         movwf   INDF0
                          M       endif
                          M         incf    DEBUG_STACK, F
                          M     endif
                          M         L?CALL  _wout
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    _wout
                          M     else
                          M       if ((_wout) < 1)
                          M         call    _wout
                          M       else
                          M         if ((_wout) > $)
0018F4 EC8B F00C          M         call    _wout
                          M         else
                          M           if ((_wout) < ($ - 3ffh))
                          M         call    _wout
                          M           else
                          M         rcall   _wout
                          M           endif
                          M         endif
                          M       endif
                          M     endif
0018F8                    M dlabel
                      02252 
                      02253 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00545           endif
                      02254         LABEL?L L00103  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 444


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00103
                          M         XALL
                          M     else
0018F8                    M L00103
                          M     endif
                      02255 
                      02256 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00546           if timer2>80 then timer2=0 :  COUNTS2=0 : chutes
                            1 = chutes1 - 1 : write 2,CHUTES1
                      02257         CMPLE?BCL       _TIMER2, 050h, L00105
                          M     if ((050h) >= 0ffh)
                          M         L?GOTO  L00105
                          M     else
                          M       if ((050h) >= 0)
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0018F8 0004               M         clrwdt
                          M     endif
                          M         MOVE?CA (050h) + 1
0018FA 0E51               M         movlw   low ((050h) + 1)
                          M         CHK?RP  _TIMER2
                          M     if (((_TIMER2) & 8000h) != PREV_ALT)
                          M       if ((_TIMER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER2) & 8000h
                          M     endif
                          M     if ((((_TIMER2) & 0fffh) > BANKA_END) & (((_TIMER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER2)
                          M PREV_BANK = high (_TIMER2)
                          M       endif
                          M     endif
0018FC 5DA4               M         subwf   _TIMER2, W
                          M         BIT?GOTO 0, STATUS, C, L00105
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00105))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 445


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00105
                          M       else
                          M         if ((L00105) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00105
                          M         else
                          M           if ((L00105) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00105
                          M           else
                          M             if ((L00105) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00105
                          M             else
                          M         bov     L00105
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0018FE A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00105
                          M       else
                          M         if ((L00105) < 1)
                          M         goto    L00105
                          M         else
                          M           if ((L00105) > $)
001900 EF8A F00C          M         goto    L00105
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 446


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           else
                          M             if ((L00105) < ($ - 3ffh))
                          M         goto    L00105
                          M             else
                          M         bra     L00105
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M       endif
                          M     endif
                      02258         MOVE?CB 000h, _TIMER2
                          M         CHK?RP  _TIMER2
                          M     if (((_TIMER2) & 8000h) != PREV_ALT)
                          M       if ((_TIMER2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_TIMER2) & 8000h
                          M     endif
                          M     if ((((_TIMER2) & 0fffh) > BANKA_END) & (((_TIMER2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_TIMER2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_TIMER2)
                          M PREV_BANK = high (_TIMER2)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001904 6BA4               M         clrf    _TIMER2
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _TIMER2
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _TIMER2
                          M       endif
                          M     endif
                      02259         MOVE?CT 000h, _COUNTS2
                          M         CHK?RP  PB01
                          M     if (((PB01)  & 8000h) != PREV_ALT)
                          M       if ((PB01)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (PB01)  & 8000h
                          M     endif
                          M     if ((((PB01)  & 0fffh) > BANKA_END) & (((PB01)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((PB01)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (PB01)
                          M PREV_BANK = high (PB01)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 447


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     PB01,   001h
                          M     else
001906 921E               M         bcf     PB01,   001h
                          M     endif
                      02260         SUB?BCB _CHUTES1, 001h, _CHUTES1
                          M     if ((_CHUTES1) == (_CHUTES1))
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
001908 079F               M         decf    _CHUTES1, F
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES1
                          M         subwf   _CHUTES1, F
                          M       endif
                          M     else
                          M       if ((001h) == 1)
                          M         CHK?RP  _CHUTES1
                          M         decf    _CHUTES1, W
                          M       else
                          M         movlw   001h
                          M         CHK?RP  _CHUTES1
                          M         subwf   _CHUTES1, W
                          M       endif
                          M         MOVE?AB _CHUTES1
                          M     endif
                      02261         WRITEADDRESS?C  002h
                          M     ifdef EEADRH
                          M         MOVE?CW (002h) & 0ffffh, EEADR
                          M     else
                          M         MOVE?CB 002h, EEADR
                          M         CHK?RP  EEADR
                          M     if (((EEADR) & 8000h) != PREV_ALT)
                          M       if ((EEADR) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 448


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (EEADR) & 8000h
                          M     endif
                          M     if ((((EEADR) & 0fffh) > BANKA_END) & (((EEADR) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((EEADR) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (EEADR)
                          M PREV_BANK = high (EEADR)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    EEADR
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    EEADR
                          M       else
00190A 0E02               M         movlw   low (002h)
00190C 6EA9               M         movwf   EEADR
                          M       endif
                          M     endif
                          M     endif
                      02262         WRITE?B _CHUTES1
                          M         MOVE?BA _CHUTES1
                          M         CHK?RP  _CHUTES1
                          M     if (((_CHUTES1) & 8000h) != PREV_ALT)
                          M       if ((_CHUTES1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_CHUTES1) & 8000h
                          M     endif
                          M     if ((((_CHUTES1) & 0fffh) > BANKA_END) & (((_CHUTES1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_CHUTES1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_CHUTES1)
                          M PREV_BANK = high (_CHUTES1)
                          M       endif
                          M     endif
00190E 519F               M         movf    _CHUTES1, W
                          M         L?CALL  WRITE
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    WRITE
                          M     else
                          M       if ((WRITE) < 1)
                          M         call    WRITE
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 449


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((WRITE) > $)
                          M         call    WRITE
                          M         else
                          M           if ((WRITE) < ($ - 3ffh))
001910 EC65 F000          M         call    WRITE
                          M           else
                          M         rcall   WRITE
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02263         LABEL?L L00105  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00105
                          M         XALL
                          M     else
001914                    M L00105
                          M     endif
                      02264 
                      02265 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00547       endif
                      02266         LABEL?L L00101  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00101
                          M         XALL
                          M     else
001914                    M L00101
                          M     endif
                      02267 
                      02268 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00548   return
                      02269         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 450


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001914 0012               M         return
                      02270 
                      02271 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00553   WOUT:
                      02272 
                      02273         LABEL?L _wout   
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _wout
                          M         XALL
                          M     else
001916                    M _wout
                          M     endif
                      02274 
                      02275 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00554       LATD.0=1
                      02276         MOVE?CT 001h, _LATD??0
                          M         CHK?RP  LATD
                          M     if (((LATD)  & 8000h) != PREV_ALT)
                          M       if ((LATD)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATD)  & 8000h
                          M     endif
                          M     if ((((LATD)  & 0fffh) > BANKA_END) & (((LATD)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATD)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATD)
                          M PREV_BANK = high (LATD)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001916 808C               M         bsf     LATD,   000h
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 451


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     LATD,   000h
                          M     endif
                      02277 
                      02278 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00555       LATD.1=1
                      02279         MOVE?CT 001h, _LATD??1
                          M         CHK?RP  LATD
                          M     if (((LATD)  & 8000h) != PREV_ALT)
                          M       if ((LATD)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATD)  & 8000h
                          M     endif
                          M     if ((((LATD)  & 0fffh) > BANKA_END) & (((LATD)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATD)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATD)
                          M PREV_BANK = high (LATD)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001918 828C               M         bsf     LATD,   001h
                          M     else
                          M         bcf     LATD,   001h
                          M     endif
                      02280 
                      02281 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00556       Shiftout  portd.3 , portd.1, 5, [OUTPUTS2,OUTPUTS1,O
                            UTPUTS0]
                      02282         SHIFTDATA?T     _PORTD??3
                          M         BIT?R1  PORTD, 003h
00191A 0E83               M         movlw   low ((PORTD) + ((003h)  >> 3))
                          M         CHK?RP  RR1
                          M     if (((RR1)   & 8000h) != PREV_ALT)
                          M       if ((RR1)   & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (RR1)   & 8000h
                          M     endif
                          M     if ((((RR1)   & 0fffh) > BANKA_END) & (((RR1)   & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((RR1)   & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (RR1)
                          M PREV_BANK = high (RR1)
                          M       endif
                          M     endif
00191C 6E1A               M         movwf   RR1
00191E 0E0F               M         movlw   high ((PORTD) + ((003h)  >> 3))
001920 6E1C               M         movwf   RS1
                          M         BIT?W   003h
                          M     if (((003h)  & 7) == 0)
                          M         movlw   01h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 452


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((003h)  & 7) == 1)
                          M         movlw   02h
                          M     endif
                          M     if (((003h)  & 7) == 2)
                          M         movlw   04h
                          M     endif
                          M     if (((003h)  & 7) == 3)
001922 0E08               M         movlw   08h
                          M     endif
                          M     if (((003h)  & 7) == 4)
                          M         movlw   10h
                          M     endif
                          M     if (((003h)  & 7) == 5)
                          M         movlw   20h
                          M     endif
                          M     if (((003h)  & 7) == 6)
                          M         movlw   40h
                          M     endif
                          M     if (((003h)  & 7) == 7)
                          M         movlw   80h
                          M     endif
001924 6E18               M         movwf   RM1
                      02283         SHIFTCLOCK?T    _PORTD??1
                          M         BIT?R2  PORTD, 001h
001926 0E83               M         movlw   low ((PORTD) + ((001h)  >> 3))
                          M         CHK?RP  RR2
                          M     if (((RR2)   & 8000h) != PREV_ALT)
                          M       if ((RR2)   & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (RR2)   & 8000h
                          M     endif
                          M     if ((((RR2)   & 0fffh) > BANKA_END) & (((RR2)   & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((RR2)   & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (RR2)
                          M PREV_BANK = high (RR2)
                          M       endif
                          M     endif
001928 6E1B               M         movwf   RR2
00192A 0E0F               M         movlw   high ((PORTD) + ((001h)  >> 3))
00192C 6E1D               M         movwf   RS2
                          M         BIT?W   001h
                          M     if (((001h)  & 7) == 0)
                          M         movlw   01h
                          M     endif
                          M     if (((001h)  & 7) == 1)
00192E 0E02               M         movlw   02h
                          M     endif
                          M     if (((001h)  & 7) == 2)
                          M         movlw   04h
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 453


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (((001h)  & 7) == 3)
                          M         movlw   08h
                          M     endif
                          M     if (((001h)  & 7) == 4)
                          M         movlw   10h
                          M     endif
                          M     if (((001h)  & 7) == 5)
                          M         movlw   20h
                          M     endif
                          M     if (((001h)  & 7) == 6)
                          M         movlw   40h
                          M     endif
                          M     if (((001h)  & 7) == 7)
                          M         movlw   80h
                          M     endif
001930 6E19               M         movwf   RM2
                      02284         SHIFTMODE?C     005h
                          M         MOVE?CB 005h, GOP
                          M         CHK?RP  GOP
                          M     if (((GOP)   & 8000h) != PREV_ALT)
                          M       if ((GOP)   & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (GOP)   & 8000h
                          M     endif
                          M     if ((((GOP)   & 0fffh) > BANKA_END) & (((GOP)   & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((GOP)   & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (GOP)
                          M PREV_BANK = high (GOP)
                          M       endif
                          M     endif
                          M     if (low (005h) == 0)
                          M         clrf    GOP
                          M     else
                          M       if (low (005h) == 255)
                          M         setf    GOP
                          M       else
001932 0E05               M         movlw   low (005h)
001934 6E01               M         movwf   GOP
                          M       endif
                          M     endif
                      02285         SHIFTOUT?BC     _OUTPUTS2, 008h
                          M         MOVE?BW _OUTPUTS2, R0
                          M         MOVE?BB _OUTPUTS2, R0
001936 C06D F002          M         movff   _OUTPUTS2, R0
                          M         CHK?RP  R0
                          M     if (((R0)    & 8000h) != PREV_ALT)
                          M       if ((R0)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 454


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (R0)    & 8000h
                          M     endif
                          M     if ((((R0)    & 0fffh) > BANKA_END) & (((R0)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R0)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R0)
                          M PREV_BANK = high (R0)
                          M       endif
                          M     endif
00193A 6A03               M         clrf    (R0)   + 1
                          M     if ((008h) == 8)
                          M         L?CALL  SHIFTOUT8
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    SHIFTOUT8
                          M     else
                          M       if ((SHIFTOUT8) < 1)
                          M         call    SHIFTOUT8
                          M       else
                          M         if ((SHIFTOUT8) > $)
                          M         call    SHIFTOUT8
                          M         else
                          M           if ((SHIFTOUT8) < ($ - 3ffh))
00193C EC02 F000          M         call    SHIFTOUT8
                          M           else
                          M         rcall   SHIFTOUT8
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         movlw   008h
                          M         L?CALL  SHIFTOUT
                          M     endif
                      02286         SHIFTOUT?BC     _OUTPUTS1, 008h
                          M         MOVE?BW _OUTPUTS1, R0
                          M         MOVE?BB _OUTPUTS1, R0
001940 C06C F002          M         movff   _OUTPUTS1, R0
                          M         CHK?RP  R0
                          M     if (((R0)    & 8000h) != PREV_ALT)
                          M       if ((R0)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 455


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (R0)    & 8000h
                          M     endif
                          M     if ((((R0)    & 0fffh) > BANKA_END) & (((R0)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R0)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R0)
                          M PREV_BANK = high (R0)
                          M       endif
                          M     endif
001944 6A03               M         clrf    (R0)   + 1
                          M     if ((008h) == 8)
                          M         L?CALL  SHIFTOUT8
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    SHIFTOUT8
                          M     else
                          M       if ((SHIFTOUT8) < 1)
                          M         call    SHIFTOUT8
                          M       else
                          M         if ((SHIFTOUT8) > $)
                          M         call    SHIFTOUT8
                          M         else
                          M           if ((SHIFTOUT8) < ($ - 3ffh))
001946 EC02 F000          M         call    SHIFTOUT8
                          M           else
                          M         rcall   SHIFTOUT8
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         movlw   008h
                          M         L?CALL  SHIFTOUT
                          M     endif
                      02287         SHIFTOUT?BC     _OUTPUTS0, 008h
                          M         MOVE?BW _OUTPUTS0, R0
                          M         MOVE?BB _OUTPUTS0, R0
00194A C06B F002          M         movff   _OUTPUTS0, R0
                          M         CHK?RP  R0
                          M     if (((R0)    & 8000h) != PREV_ALT)
                          M       if ((R0)    & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 456


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (R0)    & 8000h
                          M     endif
                          M     if ((((R0)    & 0fffh) > BANKA_END) & (((R0)    & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((R0)    & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (R0)
                          M PREV_BANK = high (R0)
                          M       endif
                          M     endif
00194E 6A03               M         clrf    (R0)   + 1
                          M     if ((008h) == 8)
                          M         L?CALL  SHIFTOUT8
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    SHIFTOUT8
                          M     else
                          M       if ((SHIFTOUT8) < 1)
                          M         call    SHIFTOUT8
                          M       else
                          M         if ((SHIFTOUT8) > $)
                          M         call    SHIFTOUT8
                          M         else
                          M           if ((SHIFTOUT8) < ($ - 3ffh))
001950 EC02 F000          M         call    SHIFTOUT8
                          M           else
                          M         rcall   SHIFTOUT8
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         movlw   008h
                          M         L?CALL  SHIFTOUT
                          M     endif
                      02288 
                      02289 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00557       LATD.2=1
                      02290         MOVE?CT 001h, _LATD??2
                          M         CHK?RP  LATD
                          M     if (((LATD)  & 8000h) != PREV_ALT)
                          M       if ((LATD)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 457


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (LATD)  & 8000h
                          M     endif
                          M     if ((((LATD)  & 0fffh) > BANKA_END) & (((LATD)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATD)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATD)
                          M PREV_BANK = high (LATD)
                          M       endif
                          M     endif
                          M     if (((001h) & 1) == 1)
001954 848C               M         bsf     LATD,   002h
                          M     else
                          M         bcf     LATD,   002h
                          M     endif
                      02291 
                      02292 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00558       pauseus 2
                      02293         PAUSEUS?C       002h
                          M     if (((002h) >> 8) == 0)
001956 0E02               M         movlw   002h
                          M         L?CALL  PAUSEUS
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PAUSEUS
                          M     else
                          M       if ((PAUSEUS) < 1)
                          M         call    PAUSEUS
                          M       else
                          M         if ((PAUSEUS) > $)
                          M         call    PAUSEUS
                          M         else
                          M           if ((PAUSEUS) < ($ - 3ffh))
001958 EC73 F000          M         call    PAUSEUS
                          M           else
                          M         rcall   PAUSEUS
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         MOVE?CB (002h) >> 8, R0 + 1
                          M         MOVE?CA low (002h)
                          M         L?CALL  PAUSEUSL
                          M     endif
                      02294 
                      02295 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00559       USBService
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 458


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02296         USBSERVICE?     
                          M         L?CALL  USBDeviceTasks  ; Interrupt or polling method
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceTasks
                          M     else
                          M       if ((USBDeviceTasks) < 1)
                          M         call    USBDeviceTasks
                          M       else
                          M         if ((USBDeviceTasks) > $)
                          M         call    USBDeviceTasks
                          M         else
                          M           if ((USBDeviceTasks) < ($ - 3ffh))
00195C ECE0 F000          M         call    USBDeviceTasks
                          M           else
                          M         rcall   USBDeviceTasks
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
001960 ECB7 F000          M         call    DUNN
                          M           else
                          M         rcall   DUNN
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 459


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02297 
                      02298 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00560       LATD.2=0
                      02299         MOVE?CT 000h, _LATD??2
                          M         CHK?RP  LATD
                          M     if (((LATD)  & 8000h) != PREV_ALT)
                          M       if ((LATD)  & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (LATD)  & 8000h
                          M     endif
                          M     if ((((LATD)  & 0fffh) > BANKA_END) & (((LATD)  & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((LATD)  & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (LATD)
                          M PREV_BANK = high (LATD)
                          M       endif
                          M     endif
                          M     if (((000h) & 1) == 1)
                          M         bsf     LATD,   002h
                          M     else
001964 948C               M         bcf     LATD,   002h
                          M     endif
                      02300 
                      02301 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00561   return
                      02302         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001966 0012               M         return
                      02303 
                      02304 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00566   DoUSBOut:
                      02305 
                      02306         LABEL?L _DoUSBOut       
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 460


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _DoUSBOut
                          M         XALL
                          M     else
001968                    M _DoUSBOut
                          M     endif
                      02307 
                      02308 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00568       select case idtx
                      02309 
                      02310 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00569           caSE 1
                      02311         CMPNE?BCL       _IDTX, 001h, L00109
                          M     if (((001h) > -100h) & ((001h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001968 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
00196A 519C               M         movf    _IDTX, W
00196C 0801               M         sublw   001h
                          M         BIT?GOTO 0, STATUS, Z, L00109
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00109))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 461


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00109
                          M       else
                          M         if ((L00109) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00109
                          M         else
                          M           if ((L00109) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00109
                          M           else
                          M             if ((L00109) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00109
                          M             else
                          M         bov     L00109
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00196E A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00109
                          M       else
                          M         if ((L00109) < 1)
                          M         goto    L00109
                          M         else
                          M           if ((L00109) > $)
001970 EFC0 F00C          M         goto    L00109
                          M           else
                          M             if ((L00109) < ($ - 3ffh))
                          M         goto    L00109
                          M             else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 462


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bra     L00109
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00109
                          M     endif
                      02312 
                      02313 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00570               USBBufferCount = USBBufferSizeTX            
                              ' TX buffer size
                      02314         MOVE?CB _USBBufferSizeTX, _USBBufferCount
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
                          M     if (low (_USBBufferSizeTX) == 0)
                          M         clrf    _USBBufferCount
                          M     else
                          M       if (low (_USBBufferSizeTX) == 255)
                          M         setf    _USBBufferCount
                          M       else
001974 0E0B               M         movlw   low (_USBBufferSizeTX)
001976 6F9B               M         movwf   _USBBufferCount
                          M       endif
                          M     endif
                      02315 
                      02316 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00571               epTX=1 
                      02317         MOVE?CB 001h, _epTX
                          M         CHK?RP  _epTX
                          M     if (((_epTX) & 8000h) != PREV_ALT)
                          M       if ((_epTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_epTX) & 8000h
                          M     endif
                          M     if ((((_epTX) & 0fffh) > BANKA_END) & (((_epTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_epTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_epTX)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 463


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_epTX)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _epTX
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _epTX
                          M       else
001978 0E01               M         movlw   low (001h)
00197A 6FAA               M         movwf   _epTX
                          M       endif
                          M     endif
                      02318 
                      02319 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00572           CASE 2
                      02320         GOTO?L  L00108
                          M         L?GOTO  L00108
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00108))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00108
                          M     else
                          M       if ((L00108) < 1)
                          M         goto    L00108
                          M       else
                          M         if ((L00108) > $)
00197C EFD6 F00C          M         goto    L00108
                          M         else
                          M           if ((L00108) < ($ - 3ffh))
                          M         goto    L00108
                          M           else
                          M         bra     L00108
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02321         LABEL?L L00109  
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 464


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00109
                          M         XALL
                          M     else
001980                    M L00109
                          M     endif
                      02322         CMPNE?BCL       _IDTX, 002h, L00110
                          M     if (((002h) > -100h) & ((002h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001980 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
001982 519C               M         movf    _IDTX, W
001984 0802               M         sublw   002h
                          M         BIT?GOTO 0, STATUS, Z, L00110
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00110))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 465


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00110
                          M       else
                          M         if ((L00110) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00110
                          M         else
                          M           if ((L00110) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00110
                          M           else
                          M             if ((L00110) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00110
                          M             else
                          M         bov     L00110
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
001986 A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00110
                          M       else
                          M         if ((L00110) < 1)
                          M         goto    L00110
                          M         else
                          M           if ((L00110) > $)
001988 EFCC F00C          M         goto    L00110
                          M           else
                          M             if ((L00110) < ($ - 3ffh))
                          M         goto    L00110
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 466


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             else
                          M         bra     L00110
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00110
                          M     endif
                      02323 
                      02324 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00573               USBBufferCount = USBMediaTX                 
                              ' TX buffer size
                      02325         MOVE?CB _USBMediaTX, _USBBufferCount
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
                          M     if (low (_USBMediaTX) == 0)
                          M         clrf    _USBBufferCount
                          M     else
                          M       if (low (_USBMediaTX) == 255)
                          M         setf    _USBBufferCount
                          M       else
00198C 0E03               M         movlw   low (_USBMediaTX)
00198E 6F9B               M         movwf   _USBBufferCount
                          M       endif
                          M     endif
                      02326 
                      02327 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00574               epTX=2
                      02328         MOVE?CB 002h, _epTX
                          M         CHK?RP  _epTX
                          M     if (((_epTX) & 8000h) != PREV_ALT)
                          M       if ((_epTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_epTX) & 8000h
                          M     endif
                          M     if ((((_epTX) & 0fffh) > BANKA_END) & (((_epTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_epTX) & 0f00h) != (PREV_BANK << 8))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 467


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         movlb   high (_epTX)
                          M PREV_BANK = high (_epTX)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _epTX
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    _epTX
                          M       else
001990 0E02               M         movlw   low (002h)
001992 6FAA               M         movwf   _epTX
                          M       endif
                          M     endif
                      02329 
                      02330 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00575           CASE 3
                      02331         GOTO?L  L00108
                          M         L?GOTO  L00108
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00108))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00108
                          M     else
                          M       if ((L00108) < 1)
                          M         goto    L00108
                          M       else
                          M         if ((L00108) > $)
001994 EFD6 F00C          M         goto    L00108
                          M         else
                          M           if ((L00108) < ($ - 3ffh))
                          M         goto    L00108
                          M           else
                          M         bra     L00108
                          M           endif
                          M         endif
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 468


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02332         LABEL?L L00110  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00110
                          M         XALL
                          M     else
001998                    M L00110
                          M     endif
                      02333         CMPNE?BCL       _IDTX, 003h, L00111
                          M     if (((003h) > -100h) & ((003h) < 100h))
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001998 0004               M         clrwdt
                          M     endif
                          M         MOVE?BA _IDTX
                          M         CHK?RP  _IDTX
                          M     if (((_IDTX) & 8000h) != PREV_ALT)
                          M       if ((_IDTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_IDTX) & 8000h
                          M     endif
                          M     if ((((_IDTX) & 0fffh) > BANKA_END) & (((_IDTX) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_IDTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_IDTX)
                          M PREV_BANK = high (_IDTX)
                          M       endif
                          M     endif
00199A 519C               M         movf    _IDTX, W
00199C 0803               M         sublw   003h
                          M         BIT?GOTO 0, STATUS, Z, L00111
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00111))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 469


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((0)      == 0)
                          M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00111
                          M       else
                          M         if ((L00111) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00111
                          M         else
                          M           if ((L00111) > $)
                          M         btfsc   STATUS, OV
                          M         goto    L00111
                          M           else
                          M             if ((L00111) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00111
                          M             else
                          M         bov     L00111
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
00199E A4D8               M         btfss   STATUS, Z
                          M       else
                          M         btfsc   STATUS, Z
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00111
                          M       else
                          M         if ((L00111) < 1)
                          M         goto    L00111
                          M         else
                          M           if ((L00111) > $)
0019A0 EFD6 F00C          M         goto    L00111
                          M           else
                          M             if ((L00111) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 470


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00111
                          M             else
                          M         bra     L00111
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M     else
                          M         L?GOTO  L00111
                          M     endif
                      02334 
                      02335 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00576               USBBufferCount = USBkeyTX                   
                              ' TX buffer size
                      02336         MOVE?CB _USBkeyTX, _USBBufferCount
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
                          M     if (low (_USBkeyTX) == 0)
                          M         clrf    _USBBufferCount
                          M     else
                          M       if (low (_USBkeyTX) == 255)
                          M         setf    _USBBufferCount
                          M       else
0019A4 0E08               M         movlw   low (_USBkeyTX)
0019A6 6F9B               M         movwf   _USBBufferCount
                          M       endif
                          M     endif
                      02337 
                      02338 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00577               epTX=2
                      02339         MOVE?CB 002h, _epTX
                          M         CHK?RP  _epTX
                          M     if (((_epTX) & 8000h) != PREV_ALT)
                          M       if ((_epTX) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_epTX) & 8000h
                          M     endif
                          M     if ((((_epTX) & 0fffh) > BANKA_END) & (((_epTX) & 0fffh) < (0f01h + BANKA_END)))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 471


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if (((_epTX) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_epTX)
                          M PREV_BANK = high (_epTX)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _epTX
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    _epTX
                          M       else
0019A8 0E02               M         movlw   low (002h)
0019AA 6FAA               M         movwf   _epTX
                          M       endif
                          M     endif
                      02340 
                      02341 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00578       END SELECT
                      02342         LABEL?L L00111  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00111
                          M         XALL
                          M     else
0019AC                    M L00111
                          M     endif
                      02343         LABEL?L L00108  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00108
                          M         XALL
                          M     else
0019AC                    M L00108
                          M     endif
                      02344 
                      02345 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00580      USBService                                    ' keep 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 472


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                            connection alive
                      02346         USBSERVICE?     
                          M         L?CALL  USBDeviceTasks  ; Interrupt or polling method
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    USBDeviceTasks
                          M     else
                          M       if ((USBDeviceTasks) < 1)
                          M         call    USBDeviceTasks
                          M       else
                          M         if ((USBDeviceTasks) > $)
                          M         call    USBDeviceTasks
                          M         else
                          M           if ((USBDeviceTasks) < ($ - 3ffh))
0019AC ECE0 F000          M         call    USBDeviceTasks
                          M           else
                          M         rcall   USBDeviceTasks
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
0019B0 ECB7 F000          M         call    DUNN
                          M           else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 473


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02347 
                      02348 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00581      USBOut epTX, USBBuffer, USBBufferCount, DoUSBOut ' if
                             bus available, transmit data
                      02349         USBOUT?BBBL     _epTX, _USBBuffer, _USBBufferCount, _DoUSBOut
                          M         MOVE?BB _epTX,    FSR0L ; Store Endpoint number
0019B4 C0AA FFE9          M         movff   _epTX, FSR0L
0019B8 EE10 F090          M         lfsr    1, _USBBuffer   ; Point to Buffer
                          M         MOVE?BA _USBBufferCount ; Get number of bytes to send
                          M         CHK?RP  _USBBufferCount
                          M     if (((_USBBufferCount) & 8000h) != PREV_ALT)
                          M       if ((_USBBufferCount) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_USBBufferCount) & 8000h
                          M     endif
                          M     if ((((_USBBufferCount) & 0fffh) > BANKA_END) & (((_USBBufferCount) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_USBBufferCount) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_USBBufferCount)
                          M PREV_BANK = high (_USBBufferCount)
                          M       endif
                          M     endif
0019BC 519B               M         movf    _USBBufferCount, W
                          M         L?CALL  PutUSB          ; Send them
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    PutUSB
                          M     else
                          M       if ((PutUSB) < 1)
                          M         call    PutUSB
                          M       else
                          M         if ((PutUSB) > $)
                          M         call    PutUSB
                          M         else
                          M           if ((PutUSB) < ($ - 3ffh))
0019BE EC08 F004          M         call    PutUSB
                          M           else
                          M         rcall   PutUSB
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 474


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         L?CALL  DUNN            ; Do our cleanup
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         call    DUNN
                          M     else
                          M       if ((DUNN)  < 1)
                          M         call    DUNN
                          M       else
                          M         if ((DUNN)  > $)
                          M         call    DUNN
                          M         else
                          M           if ((DUNN)  < ($ - 3ffh))
0019C2 ECB7 F000          M         call    DUNN
                          M           else
                          M         rcall   DUNN
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                          M         BIT?GOTO 0, STATUS, C, _DoUSBOut ; If can't send then jump to Label
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_DoUSBOut))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((STATUS) > BANKA_END) & ((STATUS) < (0f01h + BANKA_END)))
                          M         bcf     STATUS, OV
                          M         CHK?RP  STATUS
                          M       if ((0)      == 0)
                          M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M         bsf     STATUS, OV
                          M         RST?RP
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 475


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) > $)
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBOut
                          M           else
                          M             if ((_DoUSBOut) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    _DoUSBOut
                          M             else
                          M         bov     _DoUSBOut
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       if ((0)      == 0)
0019C6 A0D8               M         btfss   STATUS, C
                          M       else
                          M         btfsc   STATUS, C
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    _DoUSBOut
                          M       else
                          M         if ((_DoUSBOut) < 1)
                          M         goto    _DoUSBOut
                          M         else
                          M           if ((_DoUSBOut) > $)
                          M         goto    _DoUSBOut
                          M           else
                          M             if ((_DoUSBOut) < ($ - 3ffh))
                          M         goto    _DoUSBOut
                          M             else
0019C8 D7CF               M         bra     _DoUSBOut
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02350 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 476


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02351 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00583      Toggle porta.6
                      02352         TOGGLE?T        _PORTA??6
                          M         BIT?FLIP PORTA, 006h
                          M         CHK?RP  (PORTA) + ((006h)  >> 3)
                          M     if ((((PORTA) + ((006h) >> 3)) & 8000h) != PREV_ALT)
                          M       if (((PORTA) + ((006h) >> 3)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = ((PORTA) + ((006h) >> 3)) & 8000h
                          M     endif
                          M     if (((((PORTA) + ((006h) >> 3)) & 0fffh) > BANKA_END) & ((((PORTA) + ((006h) >> 3)) & 0fffh) < (0f01
                            h + BANKA_END)))
                          M       if ((((PORTA) + ((006h) >> 3)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high ((PORTA) + ((006h) >> 3))
                          M PREV_BANK = high ((PORTA) + ((006h) >> 3))
                          M       endif
                          M     endif
0019CA 7C80               M         btg     (PORTA) + ((006h)  >> 3), (006h)  & 7
                          M         MOVE?CT 0, ((PORTA) + 12h), 006h
                          M         CHK?RP  ((PORTA) + 12h)
                          M     if (((((PORTA) + 12h)) & 8000h) != PREV_ALT)
                          M       if ((((PORTA) + 12h)) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (((PORTA) + 12h)) & 8000h
                          M     endif
                          M     if ((((((PORTA) + 12h)) & 0fffh) > BANKA_END) & (((((PORTA) + 12h)) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((((PORTA) + 12h)) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (((PORTA) + 12h))
                          M PREV_BANK = high (((PORTA) + 12h))
                          M       endif
                          M     endif
                          M     if (((0)   & 1) == 1)
                          M         bsf     ((PORTA) + 12h), 006h
                          M     else
0019CC 9C92               M         bcf     ((PORTA) + 12h), 006h
                          M     endif
                      02353 
                      02354 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00584   return
                      02355         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 477


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
0019CE 0012               M         return
                      02356 
                      02357 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00586   RPOV:
                      02358 
                      02359         LABEL?L _RPOV   
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _RPOV
                          M         XALL
                          M     else
0019D0                    M _RPOV
                          M     endif
                      02360 
                      02361 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00591       POV1=0  
                      02362         MOVE?CB 000h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
0019D0 6BAB               M         clrf    _POV1
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _POV1
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _POV1
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 478


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02363 
                      02364 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00592       if P1keys.3 then
                      02365         CMPF?TL _P1Keys??3, L00112
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0019D2 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 003h, L00112
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00112))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
0019D4 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0019D6 A762               M         btfss   _P1Keys, 003h
                          M       else
                          M         btfsc   _P1Keys, 003h
                          M       endif
0019D8 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00112
                          M       else
                          M         if ((L00112) < 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 479


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   STATUS, OV
                          M         goto    L00112
                          M         else
                          M           if ((L00112) > $)
0019DA B6D8               M         btfsc   STATUS, OV
0019DC EF0A F00D          M         goto    L00112
                          M           else
                          M             if ((L00112) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00112
                          M             else
                          M         bov     L00112
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 003h
                          M       else
                          M         btfsc   _P1Keys, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00112
                          M       else
                          M         if ((L00112) < 1)
                          M         goto    L00112
                          M         else
                          M           if ((L00112) > $)
                          M         goto    L00112
                          M           else
                          M             if ((L00112) < ($ - 3ffh))
                          M         goto    L00112
                          M             else
                          M         bra     L00112
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02366 
                      02367 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00593           if P1keys.2 then
                      02368         CMPF?TL _P1Keys??2, L00114
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0019E0 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 002h, L00114
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00114))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 480


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
0019E2 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0019E4 A562               M         btfss   _P1Keys, 002h
                          M       else
                          M         btfsc   _P1Keys, 002h
                          M       endif
0019E6 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00114
                          M       else
                          M         if ((L00114) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00114
                          M         else
                          M           if ((L00114) > $)
0019E8 B6D8               M         btfsc   STATUS, OV
0019EA EFFB F00C          M         goto    L00114
                          M           else
                          M             if ((L00114) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00114
                          M             else
                          M         bov     L00114
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 481


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 002h
                          M       else
                          M         btfsc   _P1Keys, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00114
                          M       else
                          M         if ((L00114) < 1)
                          M         goto    L00114
                          M         else
                          M           if ((L00114) > $)
                          M         goto    L00114
                          M           else
                          M             if ((L00114) < ($ - 3ffh))
                          M         goto    L00114
                          M             else
                          M         bra     L00114
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02369 
                      02370 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00594               POV1=6
                      02371         MOVE?CB 006h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (006h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (006h) == 255)
                          M         setf    _POV1
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 482


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

0019EE 0E06               M         movlw   low (006h)
0019F0 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02372 
                      02373 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00595           elseif P1keys.1 then
                      02374         GOTO?L  L00115
                          M         L?GOTO  L00115
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00115))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00115
                          M     else
                          M       if ((L00115) < 1)
                          M         goto    L00115
                          M       else
                          M         if ((L00115) > $)
0019F2 EF08 F00D          M         goto    L00115
                          M         else
                          M           if ((L00115) < ($ - 3ffh))
                          M         goto    L00115
                          M           else
                          M         bra     L00115
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02375         LABEL?L L00114  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 483


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     ifdef PM_USED
                          M         LALL
                          M L00114
                          M         XALL
                          M     else
0019F6                    M L00114
                          M     endif
                      02376         CMPF?TL _P1Keys??1, L00116
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
0019F6 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 001h, L00116
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00116))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
0019F8 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
0019FA A362               M         btfss   _P1Keys, 001h
                          M       else
                          M         btfsc   _P1Keys, 001h
                          M       endif
0019FC 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 484


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00116
                          M       else
                          M         if ((L00116) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00116
                          M         else
                          M           if ((L00116) > $)
0019FE B6D8               M         btfsc   STATUS, OV
001A00 EF06 F00D          M         goto    L00116
                          M           else
                          M             if ((L00116) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00116
                          M             else
                          M         bov     L00116
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 001h
                          M       else
                          M         btfsc   _P1Keys, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00116
                          M       else
                          M         if ((L00116) < 1)
                          M         goto    L00116
                          M         else
                          M           if ((L00116) > $)
                          M         goto    L00116
                          M           else
                          M             if ((L00116) < ($ - 3ffh))
                          M         goto    L00116
                          M             else
                          M         bra     L00116
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02377 
                      02378 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00596               POV1=8
                      02379         MOVE?CB 008h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 485


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (008h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (008h) == 255)
                          M         setf    _POV1
                          M       else
001A04 0E08               M         movlw   low (008h)
001A06 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02380 
                      02381 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00597           else
                      02382         GOTO?L  L00115
                          M         L?GOTO  L00115
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00115))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00115
                          M     else
                          M       if ((L00115) < 1)
                          M         goto    L00115
                          M       else
                          M         if ((L00115) > $)
001A08 EF08 F00D          M         goto    L00115
                          M         else
                          M           if ((L00115) < ($ - 3ffh))
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 486


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00115
                          M           else
                          M         bra     L00115
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02383         LABEL?L L00116  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00116
                          M         XALL
                          M     else
001A0C                    M L00116
                          M     endif
                      02384 
                      02385 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00598               pov1=7
                      02386         MOVE?CB 007h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (007h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (007h) == 255)
                          M         setf    _POV1
                          M       else
001A0C 0E07               M         movlw   low (007h)
001A0E 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02387 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 487


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02388 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00599           endif 
                      02389         LABEL?L L00115  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00115
                          M         XALL
                          M     else
001A10                    M L00115
                          M     endif
                      02390 
                      02391 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00600           goto RPOV2
                      02392         GOTO?L  _RPOV2
                          M         L?GOTO  _RPOV2
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_RPOV2))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    _RPOV2
                          M     else
                          M       if ((_RPOV2) < 1)
                          M         goto    _RPOV2
                          M       else
                          M         if ((_RPOV2) > $)
001A10 EF4A F00D          M         goto    _RPOV2
                          M         else
                          M           if ((_RPOV2) < ($ - 3ffh))
                          M         goto    _RPOV2
                          M           else
                          M         bra     _RPOV2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 488


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02393 
                      02394 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00601       endif
                      02395         LABEL?L L00112  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00112
                          M         XALL
                          M     else
001A14                    M L00112
                          M     endif
                      02396 
                      02397 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00602       if P1keys.2 then
                      02398         CMPF?TL _P1Keys??2, L00118
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A14 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 002h, L00118
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00118))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
001A16 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 489


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A18 A562               M         btfss   _P1Keys, 002h
                          M       else
                          M         btfsc   _P1Keys, 002h
                          M       endif
001A1A 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00118
                          M       else
                          M         if ((L00118) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00118
                          M         else
                          M           if ((L00118) > $)
001A1C B6D8               M         btfsc   STATUS, OV
001A1E EF20 F00D          M         goto    L00118
                          M           else
                          M             if ((L00118) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00118
                          M             else
                          M         bov     L00118
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 002h
                          M       else
                          M         btfsc   _P1Keys, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00118
                          M       else
                          M         if ((L00118) < 1)
                          M         goto    L00118
                          M         else
                          M           if ((L00118) > $)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 490


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00118
                          M           else
                          M             if ((L00118) < ($ - 3ffh))
                          M         goto    L00118
                          M             else
                          M         bra     L00118
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02399 
                      02400 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00603           if P1keys.4 then
                      02401         CMPF?TL _P1Keys??4, L00120
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A22 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 004h, L00120
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00120))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
001A24 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A26 A962               M         btfss   _P1Keys, 004h
                          M       else
                          M         btfsc   _P1Keys, 004h
                          M       endif
001A28 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 491


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00120
                          M       else
                          M         if ((L00120) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00120
                          M         else
                          M           if ((L00120) > $)
001A2A B6D8               M         btfsc   STATUS, OV
001A2C EF1C F00D          M         goto    L00120
                          M           else
                          M             if ((L00120) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00120
                          M             else
                          M         bov     L00120
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 004h
                          M       else
                          M         btfsc   _P1Keys, 004h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00120
                          M       else
                          M         if ((L00120) < 1)
                          M         goto    L00120
                          M         else
                          M           if ((L00120) > $)
                          M         goto    L00120
                          M           else
                          M             if ((L00120) < ($ - 3ffh))
                          M         goto    L00120
                          M             else
                          M         bra     L00120
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02402 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 492


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02403 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00604               POV1=4
                      02404         MOVE?CB 004h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (004h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (004h) == 255)
                          M         setf    _POV1
                          M       else
001A30 0E04               M         movlw   low (004h)
001A32 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02405 
                      02406 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00605           else
                      02407         GOTO?L  L00121
                          M         L?GOTO  L00121
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00121))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00121
                          M     else
                          M       if ((L00121) < 1)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 493


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00121
                          M       else
                          M         if ((L00121) > $)
001A34 EF1E F00D          M         goto    L00121
                          M         else
                          M           if ((L00121) < ($ - 3ffh))
                          M         goto    L00121
                          M           else
                          M         bra     L00121
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02408         LABEL?L L00120  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00120
                          M         XALL
                          M     else
001A38                    M L00120
                          M     endif
                      02409 
                      02410 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00606               pov1=5
                      02411         MOVE?CB 005h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (005h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (005h) == 255)
                          M         setf    _POV1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 494


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
001A38 0E05               M         movlw   low (005h)
001A3A 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02412 
                      02413 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00607           endif
                      02414         LABEL?L L00121  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00121
                          M         XALL
                          M     else
001A3C                    M L00121
                          M     endif
                      02415 
                      02416 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00608           goto RPOV2
                      02417         GOTO?L  _RPOV2
                          M         L?GOTO  _RPOV2
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_RPOV2))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    _RPOV2
                          M     else
                          M       if ((_RPOV2) < 1)
                          M         goto    _RPOV2
                          M       else
                          M         if ((_RPOV2) > $)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 495


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A3C EF4A F00D          M         goto    _RPOV2
                          M         else
                          M           if ((_RPOV2) < ($ - 3ffh))
                          M         goto    _RPOV2
                          M           else
                          M         bra     _RPOV2
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02418 
                      02419 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00609       endif 
                      02420         LABEL?L L00118  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00118
                          M         XALL
                          M     else
001A40                    M L00118
                          M     endif
                      02421 
                      02422 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00610       if P1keys.4 then
                      02423         CMPF?TL _P1Keys??4, L00122
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A40 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 004h, L00122
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00122))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
001A42 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 496


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A44 A962               M         btfss   _P1Keys, 004h
                          M       else
                          M         btfsc   _P1Keys, 004h
                          M       endif
001A46 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00122
                          M       else
                          M         if ((L00122) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00122
                          M         else
                          M           if ((L00122) > $)
001A48 B6D8               M         btfsc   STATUS, OV
001A4A EF36 F00D          M         goto    L00122
                          M           else
                          M             if ((L00122) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00122
                          M             else
                          M         bov     L00122
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 004h
                          M       else
                          M         btfsc   _P1Keys, 004h
                          M       endif
                          M       ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 497


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00122
                          M       else
                          M         if ((L00122) < 1)
                          M         goto    L00122
                          M         else
                          M           if ((L00122) > $)
                          M         goto    L00122
                          M           else
                          M             if ((L00122) < ($ - 3ffh))
                          M         goto    L00122
                          M             else
                          M         bra     L00122
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02424 
                      02425 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00611           if P1keys.1 then
                      02426         CMPF?TL _P1Keys??1, L00124
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A4E 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 001h, L00124
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00124))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
001A50 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A52 A362               M         btfss   _P1Keys, 001h
                          M       else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 498


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         btfsc   _P1Keys, 001h
                          M       endif
001A54 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00124
                          M       else
                          M         if ((L00124) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00124
                          M         else
                          M           if ((L00124) > $)
001A56 B6D8               M         btfsc   STATUS, OV
001A58 EF32 F00D          M         goto    L00124
                          M           else
                          M             if ((L00124) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00124
                          M             else
                          M         bov     L00124
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 001h
                          M       else
                          M         btfsc   _P1Keys, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00124
                          M       else
                          M         if ((L00124) < 1)
                          M         goto    L00124
                          M         else
                          M           if ((L00124) > $)
                          M         goto    L00124
                          M           else
                          M             if ((L00124) < ($ - 3ffh))
                          M         goto    L00124
                          M             else
                          M         bra     L00124
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 499


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02427 
                      02428 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00612               POV1=2
                      02429         MOVE?CB 002h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    _POV1
                          M       else
001A5C 0E02               M         movlw   low (002h)
001A5E 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02430 
                      02431 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00613           else
                      02432         GOTO?L  L00125
                          M         L?GOTO  L00125
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00125))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 500


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00125
                          M     else
                          M       if ((L00125) < 1)
                          M         goto    L00125
                          M       else
                          M         if ((L00125) > $)
001A60 EF34 F00D          M         goto    L00125
                          M         else
                          M           if ((L00125) < ($ - 3ffh))
                          M         goto    L00125
                          M           else
                          M         bra     L00125
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02433         LABEL?L L00124  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00124
                          M         XALL
                          M     else
001A64                    M L00124
                          M     endif
                      02434 
                      02435 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00614               pov1=3
                      02436         MOVE?CB 003h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 501


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if (low (003h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (003h) == 255)
                          M         setf    _POV1
                          M       else
001A64 0E03               M         movlw   low (003h)
001A66 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02437 
                      02438 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00615           endif
                      02439         LABEL?L L00125  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00125
                          M         XALL
                          M     else
001A68                    M L00125
                          M     endif
                      02440 
                      02441 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00616           goto RPOV2
                      02442         GOTO?L  _RPOV2
                          M         L?GOTO  _RPOV2
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (_RPOV2))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 502


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    _RPOV2
                          M     else
                          M       if ((_RPOV2) < 1)
                          M         goto    _RPOV2
                          M       else
                          M         if ((_RPOV2) > $)
001A68 EF4A F00D          M         goto    _RPOV2
                          M         else
                          M           if ((_RPOV2) < ($ - 3ffh))
                          M         goto    _RPOV2
                          M           else
                          M         bra     _RPOV2
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02443 
                      02444 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00617       endif 
                      02445         LABEL?L L00122  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00122
                          M         XALL
                          M     else
001A6C                    M L00122
                          M     endif
                      02446 
                      02447 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00618       if P1keys.1 then
                      02448         CMPF?TL _P1Keys??1, L00126
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A6C 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 001h, L00126
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00126))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
001A6E 96D8               M         bcf     STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 503


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A70 A362               M         btfss   _P1Keys, 001h
                          M       else
                          M         btfsc   _P1Keys, 001h
                          M       endif
001A72 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00126
                          M       else
                          M         if ((L00126) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00126
                          M         else
                          M           if ((L00126) > $)
001A74 B6D8               M         btfsc   STATUS, OV
001A76 EF4A F00D          M         goto    L00126
                          M           else
                          M             if ((L00126) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00126
                          M             else
                          M         bov     L00126
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 504


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 001h
                          M       else
                          M         btfsc   _P1Keys, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00126
                          M       else
                          M         if ((L00126) < 1)
                          M         goto    L00126
                          M         else
                          M           if ((L00126) > $)
                          M         goto    L00126
                          M           else
                          M             if ((L00126) < ($ - 3ffh))
                          M         goto    L00126
                          M             else
                          M         bra     L00126
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02449 
                      02450 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00619           if P1keys.3 then
                      02451         CMPF?TL _P1Keys??3, L00128
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A7A 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P1Keys, 003h, L00128
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00128))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P1Keys) > BANKA_END) & ((_P1Keys) < (0f01h + BANKA_END)))
001A7C 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P1Keys
                          M     if (((_P1Keys) & 8000h) != PREV_ALT)
                          M       if ((_P1Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P1Keys) & 8000h
                          M     endif
                          M     if ((((_P1Keys) & 0fffh) > BANKA_END) & (((_P1Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P1Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P1Keys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 505


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_P1Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A7E A762               M         btfss   _P1Keys, 003h
                          M       else
                          M         btfsc   _P1Keys, 003h
                          M       endif
001A80 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00128
                          M       else
                          M         if ((L00128) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00128
                          M         else
                          M           if ((L00128) > $)
001A82 B6D8               M         btfsc   STATUS, OV
001A84 EF48 F00D          M         goto    L00128
                          M           else
                          M             if ((L00128) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00128
                          M             else
                          M         bov     L00128
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P1Keys, 003h
                          M       else
                          M         btfsc   _P1Keys, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00128
                          M       else
                          M         if ((L00128) < 1)
                          M         goto    L00128
                          M         else
                          M           if ((L00128) > $)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 506


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00128
                          M           else
                          M             if ((L00128) < ($ - 3ffh))
                          M         goto    L00128
                          M             else
                          M         bra     L00128
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02452 
                      02453 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00620               POV1=8
                      02454         MOVE?CB 008h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (008h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (008h) == 255)
                          M         setf    _POV1
                          M       else
001A88 0E08               M         movlw   low (008h)
001A8A 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02455 
                      02456 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00621           else
                      02457         GOTO?L  L00129
                          M         L?GOTO  L00129
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00129))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 507


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00129
                          M     else
                          M       if ((L00129) < 1)
                          M         goto    L00129
                          M       else
                          M         if ((L00129) > $)
001A8C EF4A F00D          M         goto    L00129
                          M         else
                          M           if ((L00129) < ($ - 3ffh))
                          M         goto    L00129
                          M           else
                          M         bra     L00129
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02458         LABEL?L L00128  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00128
                          M         XALL
                          M     else
001A90                    M L00128
                          M     endif
                      02459 
                      02460 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00622               pov1=1
                      02461         MOVE?CB 001h, _POV1
                          M         CHK?RP  _POV1
                          M     if (((_POV1) & 8000h) != PREV_ALT)
                          M       if ((_POV1) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV1) & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 508


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((_POV1) & 0fffh) > BANKA_END) & (((_POV1) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV1) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV1)
                          M PREV_BANK = high (_POV1)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _POV1
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _POV1
                          M       else
001A90 0E01               M         movlw   low (001h)
001A92 6FAB               M         movwf   _POV1
                          M       endif
                          M     endif
                      02462 
                      02463 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00623           endif
                      02464         LABEL?L L00129  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00129
                          M         XALL
                          M     else
001A94                    M L00129
                          M     endif
                      02465 
                      02466 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00624       endif
                      02467         LABEL?L L00126  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00126
                          M         XALL
                          M     else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 509


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001A94                    M L00126
                          M     endif
                      02468 
                      02469 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00625   RPOV2:
                      02470 
                      02471         LABEL?L _RPOV2  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _RPOV2
                          M         XALL
                          M     else
001A94                    M _RPOV2
                          M     endif
                      02472 
                      02473 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00626       POV2=0
                      02474         MOVE?CB 000h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (000h) == 0)
001A94 6BAC               M         clrf    _POV2
                          M     else
                          M       if (low (000h) == 255)
                          M         setf    _POV2
                          M       else
                          M         movlw   low (000h)
                          M         movwf   _POV2
                          M       endif
                          M     endif
                      02475 
                      02476 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00627       if P2keys.3 then
                      02477         CMPF?TL _P2Keys??3, L00130
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 510


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001A96 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 003h, L00130
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00130))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001A98 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001A9A A764               M         btfss   _P2Keys, 003h
                          M       else
                          M         btfsc   _P2Keys, 003h
                          M       endif
001A9C 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00130
                          M       else
                          M         if ((L00130) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00130
                          M         else
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 511


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           if ((L00130) > $)
001A9E B6D8               M         btfsc   STATUS, OV
001AA0 EF6B F00D          M         goto    L00130
                          M           else
                          M             if ((L00130) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00130
                          M             else
                          M         bov     L00130
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 003h
                          M       else
                          M         btfsc   _P2Keys, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00130
                          M       else
                          M         if ((L00130) < 1)
                          M         goto    L00130
                          M         else
                          M           if ((L00130) > $)
                          M         goto    L00130
                          M           else
                          M             if ((L00130) < ($ - 3ffh))
                          M         goto    L00130
                          M             else
                          M         bra     L00130
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02478 
                      02479 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00628           if P2keys.2 then
                      02480         CMPF?TL _P2Keys??2, L00132
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001AA4 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 002h, L00132
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00132))
                          M         CLRWDT?
                          M       endif
                          M     endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 512


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001AA6 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001AA8 A564               M         btfss   _P2Keys, 002h
                          M       else
                          M         btfsc   _P2Keys, 002h
                          M       endif
001AAA 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00132
                          M       else
                          M         if ((L00132) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00132
                          M         else
                          M           if ((L00132) > $)
001AAC B6D8               M         btfsc   STATUS, OV
001AAE EF5D F00D          M         goto    L00132
                          M           else
                          M             if ((L00132) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00132
                          M             else
                          M         bov     L00132
                          M             endif
                          M           endif
                          M         endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 513


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 002h
                          M       else
                          M         btfsc   _P2Keys, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00132
                          M       else
                          M         if ((L00132) < 1)
                          M         goto    L00132
                          M         else
                          M           if ((L00132) > $)
                          M         goto    L00132
                          M           else
                          M             if ((L00132) < ($ - 3ffh))
                          M         goto    L00132
                          M             else
                          M         bra     L00132
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02481 
                      02482 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00629               POV2=6
                      02483         MOVE?CB 006h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (006h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (006h) == 255)
                          M         setf    _POV2
                          M       else
001AB2 0E06               M         movlw   low (006h)
001AB4 6FAC               M         movwf   _POV2
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 514


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      02484 
                      02485 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00630           elseif P2keys.1 then
                      02486         GOTO?L  L00133
                          M         L?GOTO  L00133
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00133))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00133
                          M     else
                          M       if ((L00133) < 1)
                          M         goto    L00133
                          M       else
                          M         if ((L00133) > $)
001AB6 EF6A F00D          M         goto    L00133
                          M         else
                          M           if ((L00133) < ($ - 3ffh))
                          M         goto    L00133
                          M           else
                          M         bra     L00133
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02487         LABEL?L L00132  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00132
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 515


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         XALL
                          M     else
001ABA                    M L00132
                          M     endif
                      02488         CMPF?TL _P2Keys??1, L00134
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001ABA 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 001h, L00134
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00134))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001ABC 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001ABE A364               M         btfss   _P2Keys, 001h
                          M       else
                          M         btfsc   _P2Keys, 001h
                          M       endif
001AC0 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00134
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 516


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       else
                          M         if ((L00134) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00134
                          M         else
                          M           if ((L00134) > $)
001AC2 B6D8               M         btfsc   STATUS, OV
001AC4 EF68 F00D          M         goto    L00134
                          M           else
                          M             if ((L00134) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00134
                          M             else
                          M         bov     L00134
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 001h
                          M       else
                          M         btfsc   _P2Keys, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00134
                          M       else
                          M         if ((L00134) < 1)
                          M         goto    L00134
                          M         else
                          M           if ((L00134) > $)
                          M         goto    L00134
                          M           else
                          M             if ((L00134) < ($ - 3ffh))
                          M         goto    L00134
                          M             else
                          M         bra     L00134
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02489 
                      02490 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00631               POV2=8
                      02491         MOVE?CB 008h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 517


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (008h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (008h) == 255)
                          M         setf    _POV2
                          M       else
001AC8 0E08               M         movlw   low (008h)
001ACA 6FAC               M         movwf   _POV2
                          M       endif
                          M     endif
                      02492 
                      02493 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00632           else
                      02494         GOTO?L  L00133
                          M         L?GOTO  L00133
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00133))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00133
                          M     else
                          M       if ((L00133) < 1)
                          M         goto    L00133
                          M       else
                          M         if ((L00133) > $)
001ACC EF6A F00D          M         goto    L00133
                          M         else
                          M           if ((L00133) < ($ - 3ffh))
                          M         goto    L00133
                          M           else
                          M         bra     L00133
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 518


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02495         LABEL?L L00134  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00134
                          M         XALL
                          M     else
001AD0                    M L00134
                          M     endif
                      02496 
                      02497 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00633               pov2=7
                      02498         MOVE?CB 007h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (007h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (007h) == 255)
                          M         setf    _POV2
                          M       else
001AD0 0E07               M         movlw   low (007h)
001AD2 6FAC               M         movwf   _POV2
                          M       endif
                          M     endif
                      02499 
                      02500 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00634           endif 
                      02501         LABEL?L L00133  
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 519


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00133
                          M         XALL
                          M     else
001AD4                    M L00133
                          M     endif
                      02502 
                      02503 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00635           return
                      02504         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001AD4 0012               M         return
                      02505 
                      02506 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00636       endif
                      02507         LABEL?L L00130  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00130
                          M         XALL
                          M     else
001AD6                    M L00130
                          M     endif
                      02508 
                      02509 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00637       if P2keys.2 then
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 520


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02510         CMPF?TL _P2Keys??2, L00136
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001AD6 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 002h, L00136
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00136))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001AD8 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001ADA A564               M         btfss   _P2Keys, 002h
                          M       else
                          M         btfsc   _P2Keys, 002h
                          M       endif
001ADC 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00136
                          M       else
                          M         if ((L00136) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00136
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 521


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00136) > $)
001ADE B6D8               M         btfsc   STATUS, OV
001AE0 EF80 F00D          M         goto    L00136
                          M           else
                          M             if ((L00136) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00136
                          M             else
                          M         bov     L00136
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 002h
                          M       else
                          M         btfsc   _P2Keys, 002h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00136
                          M       else
                          M         if ((L00136) < 1)
                          M         goto    L00136
                          M         else
                          M           if ((L00136) > $)
                          M         goto    L00136
                          M           else
                          M             if ((L00136) < ($ - 3ffh))
                          M         goto    L00136
                          M             else
                          M         bra     L00136
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02511 
                      02512 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00638           if P2keys.4 then
                      02513         CMPF?TL _P2Keys??4, L00138
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001AE4 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 004h, L00138
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00138))
                          M         CLRWDT?
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 522


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001AE6 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001AE8 A964               M         btfss   _P2Keys, 004h
                          M       else
                          M         btfsc   _P2Keys, 004h
                          M       endif
001AEA 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00138
                          M       else
                          M         if ((L00138) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00138
                          M         else
                          M           if ((L00138) > $)
001AEC B6D8               M         btfsc   STATUS, OV
001AEE EF7D F00D          M         goto    L00138
                          M           else
                          M             if ((L00138) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00138
                          M             else
                          M         bov     L00138
                          M             endif
                          M           endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 523


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 004h
                          M       else
                          M         btfsc   _P2Keys, 004h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00138
                          M       else
                          M         if ((L00138) < 1)
                          M         goto    L00138
                          M         else
                          M           if ((L00138) > $)
                          M         goto    L00138
                          M           else
                          M             if ((L00138) < ($ - 3ffh))
                          M         goto    L00138
                          M             else
                          M         bra     L00138
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02514 
                      02515 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00639               POV2=4
                      02516         MOVE?CB 004h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (004h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (004h) == 255)
                          M         setf    _POV2
                          M       else
001AF2 0E04               M         movlw   low (004h)
001AF4 6FAC               M         movwf   _POV2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 524


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       endif
                          M     endif
                      02517 
                      02518 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00640           else
                      02519         GOTO?L  L00139
                          M         L?GOTO  L00139
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00139))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00139
                          M     else
                          M       if ((L00139) < 1)
                          M         goto    L00139
                          M       else
                          M         if ((L00139) > $)
001AF6 EF7F F00D          M         goto    L00139
                          M         else
                          M           if ((L00139) < ($ - 3ffh))
                          M         goto    L00139
                          M           else
                          M         bra     L00139
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02520         LABEL?L L00138  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 525


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M L00138
                          M         XALL
                          M     else
001AFA                    M L00138
                          M     endif
                      02521 
                      02522 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00641               pov2=5
                      02523         MOVE?CB 005h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (005h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (005h) == 255)
                          M         setf    _POV2
                          M       else
001AFA 0E05               M         movlw   low (005h)
001AFC 6FAC               M         movwf   _POV2
                          M       endif
                          M     endif
                      02524 
                      02525 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00642           endif
                      02526         LABEL?L L00139  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00139
                          M         XALL
                          M     else
001AFE                    M L00139
                          M     endif
                      02527 
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 526


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02528 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00643           return
                      02529         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001AFE 0012               M         return
                      02530 
                      02531 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00644       endif 
                      02532         LABEL?L L00136  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00136
                          M         XALL
                          M     else
001B00                    M L00136
                          M     endif
                      02533 
                      02534 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00645       if P2keys.4 then
                      02535         CMPF?TL _P2Keys??4, L00140
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001B00 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 004h, L00140
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00140))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001B02 96D8               M         bcf     STATUS, OV
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 527


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001B04 A964               M         btfss   _P2Keys, 004h
                          M       else
                          M         btfsc   _P2Keys, 004h
                          M       endif
001B06 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00140
                          M       else
                          M         if ((L00140) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00140
                          M         else
                          M           if ((L00140) > $)
001B08 B6D8               M         btfsc   STATUS, OV
001B0A EF95 F00D          M         goto    L00140
                          M           else
                          M             if ((L00140) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00140
                          M             else
                          M         bov     L00140
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 528


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 004h
                          M       else
                          M         btfsc   _P2Keys, 004h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00140
                          M       else
                          M         if ((L00140) < 1)
                          M         goto    L00140
                          M         else
                          M           if ((L00140) > $)
                          M         goto    L00140
                          M           else
                          M             if ((L00140) < ($ - 3ffh))
                          M         goto    L00140
                          M             else
                          M         bra     L00140
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02536 
                      02537 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00646           if P2keys.1 then
                      02538         CMPF?TL _P2Keys??1, L00142
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001B0E 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 001h, L00142
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00142))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001B10 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 529


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001B12 A364               M         btfss   _P2Keys, 001h
                          M       else
                          M         btfsc   _P2Keys, 001h
                          M       endif
001B14 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00142
                          M       else
                          M         if ((L00142) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00142
                          M         else
                          M           if ((L00142) > $)
001B16 B6D8               M         btfsc   STATUS, OV
001B18 EF92 F00D          M         goto    L00142
                          M           else
                          M             if ((L00142) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00142
                          M             else
                          M         bov     L00142
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 001h
                          M       else
                          M         btfsc   _P2Keys, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00142
                          M       else
                          M         if ((L00142) < 1)
                          M         goto    L00142
                          M         else
                          M           if ((L00142) > $)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 530


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         goto    L00142
                          M           else
                          M             if ((L00142) < ($ - 3ffh))
                          M         goto    L00142
                          M             else
                          M         bra     L00142
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02539 
                      02540 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00647               POV2=2
                      02541         MOVE?CB 002h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (002h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (002h) == 255)
                          M         setf    _POV2
                          M       else
001B1C 0E02               M         movlw   low (002h)
001B1E 6FAC               M         movwf   _POV2
                          M       endif
                          M     endif
                      02542 
                      02543 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00648           else
                      02544         GOTO?L  L00143
                          M         L?GOTO  L00143
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00143))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 531


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00143
                          M     else
                          M       if ((L00143) < 1)
                          M         goto    L00143
                          M       else
                          M         if ((L00143) > $)
001B20 EF94 F00D          M         goto    L00143
                          M         else
                          M           if ((L00143) < ($ - 3ffh))
                          M         goto    L00143
                          M           else
                          M         bra     L00143
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02545         LABEL?L L00142  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00142
                          M         XALL
                          M     else
001B24                    M L00142
                          M     endif
                      02546 
                      02547 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00649               pov2=3
                      02548         MOVE?CB 003h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 532


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (003h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (003h) == 255)
                          M         setf    _POV2
                          M       else
001B24 0E03               M         movlw   low (003h)
001B26 6FAC               M         movwf   _POV2
                          M       endif
                          M     endif
                      02549 
                      02550 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00650           endif
                      02551         LABEL?L L00143  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00143
                          M         XALL
                          M     else
001B28                    M L00143
                          M     endif
                      02552 
                      02553 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00651           return
                      02554         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001B28 0012               M         return
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 533


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                      02555 
                      02556 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00652       endif 
                      02557         LABEL?L L00140  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00140
                          M         XALL
                          M     else
001B2A                    M L00140
                          M     endif
                      02558 
                      02559 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00653       if P2keys.1 then
                      02560         CMPF?TL _P2Keys??1, L00144
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001B2A 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 001h, L00144
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00144))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001B2C 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 534


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

001B2E A364               M         btfss   _P2Keys, 001h
                          M       else
                          M         btfsc   _P2Keys, 001h
                          M       endif
001B30 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00144
                          M       else
                          M         if ((L00144) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00144
                          M         else
                          M           if ((L00144) > $)
001B32 B6D8               M         btfsc   STATUS, OV
001B34 EFA9 F00D          M         goto    L00144
                          M           else
                          M             if ((L00144) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00144
                          M             else
                          M         bov     L00144
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 001h
                          M       else
                          M         btfsc   _P2Keys, 001h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00144
                          M       else
                          M         if ((L00144) < 1)
                          M         goto    L00144
                          M         else
                          M           if ((L00144) > $)
                          M         goto    L00144
                          M           else
                          M             if ((L00144) < ($ - 3ffh))
                          M         goto    L00144
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 535


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M             else
                          M         bra     L00144
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02561 
                      02562 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00654           if P2keys.3 then
                      02563         CMPF?TL _P2Keys??3, L00146
                          M         CLRWDT?
                          M     ifndef NO_CLRWDT
001B38 0004               M         clrwdt
                          M     endif
                          M         BIT?GOTO 0, _P2Keys, 003h, L00146
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00146))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M     if (((_P2Keys) > BANKA_END) & ((_P2Keys) < (0f01h + BANKA_END)))
001B3A 96D8               M         bcf     STATUS, OV
                          M         CHK?RP  _P2Keys
                          M     if (((_P2Keys) & 8000h) != PREV_ALT)
                          M       if ((_P2Keys) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_P2Keys) & 8000h
                          M     endif
                          M     if ((((_P2Keys) & 0fffh) > BANKA_END) & (((_P2Keys) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_P2Keys) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_P2Keys)
                          M PREV_BANK = high (_P2Keys)
                          M       endif
                          M     endif
                          M       if ((0)      == 0)
001B3C A764               M         btfss   _P2Keys, 003h
                          M       else
                          M         btfsc   _P2Keys, 003h
                          M       endif
001B3E 86D8               M         bsf     STATUS, OV
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 536


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
                          M       ifdef USE_LINKER
                          M         btfsc   STATUS, OV
                          M         goto    L00146
                          M       else
                          M         if ((L00146) < 1)
                          M         btfsc   STATUS, OV
                          M         goto    L00146
                          M         else
                          M           if ((L00146) > $)
001B40 B6D8               M         btfsc   STATUS, OV
001B42 EFA7 F00D          M         goto    L00146
                          M           else
                          M             if ((L00146) < ($ - 7fh))
                          M         btfsc   STATUS, OV
                          M         goto    L00146
                          M             else
                          M         bov     L00146
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     else
                          M         RST?RP
                          M       if ((0)      == 0)
                          M         btfss   _P2Keys, 003h
                          M       else
                          M         btfsc   _P2Keys, 003h
                          M       endif
                          M       ifdef USE_LINKER
                          M         goto    L00146
                          M       else
                          M         if ((L00146) < 1)
                          M         goto    L00146
                          M         else
                          M           if ((L00146) > $)
                          M         goto    L00146
                          M           else
                          M             if ((L00146) < ($ - 3ffh))
                          M         goto    L00146
                          M             else
                          M         bra     L00146
                          M             endif
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02564 
                      02565 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00655               POV2=8
                      02566         MOVE?CB 008h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 537


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (008h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (008h) == 255)
                          M         setf    _POV2
                          M       else
001B46 0E08               M         movlw   low (008h)
001B48 6FAC               M         movwf   _POV2
                          M       endif
                          M     endif
                      02567 
                      02568 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00656           else
                      02569         GOTO?L  L00147
                          M         L?GOTO  L00147
                          M     ifdef USE_LINKER
                          M         CLRWDT?
                          M     else
                          M       if ($ == (L00147))
                          M         CLRWDT?
                          M       endif
                          M     endif
                          M 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M 
                          M     ifdef USE_LINKER
                          M         goto    L00147
                          M     else
                          M       if ((L00147) < 1)
                          M         goto    L00147
                          M       else
                          M         if ((L00147) > $)
001B4A EFA9 F00D          M         goto    L00147
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 538


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M         else
                          M           if ((L00147) < ($ - 3ffh))
                          M         goto    L00147
                          M           else
                          M         bra     L00147
                          M           endif
                          M         endif
                          M       endif
                          M     endif
                      02570         LABEL?L L00146  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00146
                          M         XALL
                          M     else
001B4E                    M L00146
                          M     endif
                      02571 
                      02572 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00657               pov2=1
                      02573         MOVE?CB 001h, _POV2
                          M         CHK?RP  _POV2
                          M     if (((_POV2) & 8000h) != PREV_ALT)
                          M       if ((_POV2) & 8000h)
                          M         bsf     WDTCON, ADSHR
                          M       else
                          M         bcf     WDTCON, ADSHR
                          M       endif
                          M PREV_ALT = (_POV2) & 8000h
                          M     endif
                          M     if ((((_POV2) & 0fffh) > BANKA_END) & (((_POV2) & 0fffh) < (0f01h + BANKA_END)))
                          M       if (((_POV2) & 0f00h) != (PREV_BANK << 8))
                          M         movlb   high (_POV2)
                          M PREV_BANK = high (_POV2)
                          M       endif
                          M     endif
                          M     if (low (001h) == 0)
                          M         clrf    _POV2
                          M     else
                          M       if (low (001h) == 255)
                          M         setf    _POV2
                          M       else
001B4E 0E01               M         movlw   low (001h)
001B50 6FAC               M         movwf   _POV2
                          M       endif
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 539


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M     endif
                      02574 
                      02575 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00658           endif
                      02576         LABEL?L L00147  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00147
                          M         XALL
                          M     else
001B52                    M L00147
                          M     endif
                      02577 
                      02578 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00659       endif       
                      02579         LABEL?L L00144  
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M L00144
                          M         XALL
                          M     else
001B52                    M L00144
                          M     endif
                      02580 
                      02581 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00660   return
                      02582         RETURN? 
                          M     ifdef DEBUG_STACK
                          M         CHK?RP  DEBUG_STACK
                          M         decf    DEBUG_STACK, F
                          M     endif
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 540


LOC  OBJECT CODE     LINE SOURCE TEXT
  VALUE

                          M PREV_BANK = 0
                          M     endif
001B52 0012               M         return
                      02583 
                      02584 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00662   disable
                      02585         DISABLE?        
                      02586 
                      02587 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00663   SerialIn:
                      02588 
                      02589         LABEL?L _SerialIn       
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
                          M     ifdef PM_USED
                          M         LALL
                          M _SerialIn
                          M         XALL
                          M     else
001B54                    M _SerialIn
                          M     endif
                      02590 
                      02591 ; C:\TEMP\DCLFI32V1.0\FIRMAC01.PBP      00665   resume 
                      02592         RESUME? 
                          M         RST?RP
                          M     if (PREV_ALT != 0)
                          M         bcf     WDTCON, ADSHR
                          M PREV_ALT = 0
                          M     endif
                          M     if (PREV_BANK != 0)
                          M         movlb   0
                          M PREV_BANK = 0
                          M     endif
001B54 0010               M         retfie
                      02593 
                      02594         END
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 541


SYMBOL TABLE
  LABEL                             VALUE 

A                                 00000000
ABDEN                             00000000
ABDOVF                            00000007
ACCESS                            00000000
ACKDT                             00000005
ACKEN                             00000004
ACKSTAT                           00000006
ACQT0                             00000003
ACQT1                             00000004
ACQT2                             00000005
ACTVIE                            00000002
ACTVIF                            00000002
ADCIN                             0000008C
ADCIN?CW                          
ADCIN_USED                        00000001
ADCON0                            00000FC2
ADCON1                            00000FC1
ADCON2                            00000FC0
ADCS0                             00000000
ADCS1                             00000001
ADCS2                             00000002
ADC_BITS                          10
ADC_CLOCK                         3
ADC_SAMPLEUS                      50
ADD?BCB                           
ADDEN                             00000003
ADDR0                             00000000
ADDR1                             00000001
ADDR2                             00000002
ADDR3                             00000003
ADDR4                             00000004
ADDR5                             00000005
ADDR6                             00000006
ADDRESS_STATE                     0x10
ADEN                              00000003
ADFM                              00000007
ADIE                              00000006
ADIF                              00000006
ADIP                              00000006
ADON                              00000000
ADRES                             00000FC3
ADRESH                            00000FC4
ADRESL                            00000FC3
ADRH                              3
ADRL                              2
ADR_PENDING_STATE                 0x08
AIN?CBB                           
AN0                               00000000
AN1                               00000001
AN2                               00000002
AN3                               00000003
AN4                               00000005
ASM?                              
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 542


SYMBOL TABLE
  LABEL                             VALUE 

ATTACHED_STATE                    0x01
BANK0_END                         000000FF
BANK0_START                       00000060
BANK1_END                         000001FF
BANK1_START                       00000100
BANK2_END                         000002FF
BANK2_START                       00000200
BANK3_END                         000003FF
BANK3_START                       00000300
BANK4_END                         000004FF
BANK4_START                       00000400
BANK5_END                         000005FF
BANK5_START                       00000500
BANK6_END                         000006FF
BANK6_START                       00000600
BANK7_END                         000007FF
BANK7_START                       00000700
BANKA_END                         0000005F
BANKA_START                       00000000
BANKED                            00000001
BAUDCON                           00000FB8
BAUDCTL                           00000FB8
BCLIE                             00000003
BCLIF                             00000003
BCLIP                             00000003
BF                                00000000
BGST                              00000005
BIT?FLIP                          
BIT?GOTO                          
BIT?R1                            
BIT?R2                            
BIT?W                             
BLOCK_SIZE                        00000020
BOOT_INTF_SUBCLASS                0x01
BOOT_PROTOCOL                     0x00
BOR                               00000000
BRG16                             00000003
BRGH                              00000002
BSR                               00000FE0
BSTALL                            2
BTOEE                             00000004
BTOEF                             00000004
BTSEE                             00000007
BTSEF                             00000007
BUTTON_PAUSE                      0000000A
C                                 00000000
C1INV                             00000004
C1OUT                             00000006
C2INV                             00000005
C2OUT                             00000007
CCP1                              00000002
CCP1AS                            00000FB6
CCP1CON                           00000FBD
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 543


SYMBOL TABLE
  LABEL                             VALUE 

CCP1DEL                           00000FB7
CCP1IE                            00000002
CCP1IF                            00000002
CCP1IP                            00000002
CCP1M0                            00000000
CCP1M1                            00000001
CCP1M2                            00000002
CCP1M3                            00000003
CCP1_BIT                          00000002
CCP1_REG                          00000F82
CCP2CON                           00000FBA
CCP2IE                            00000000
CCP2IF                            00000000
CCP2IP                            00000000
CCP2M0                            00000000
CCP2M1                            00000001
CCP2M2                            00000002
CCP2M3                            00000003
CCP2_BIT                          00000001
CCP2_REG                          00000F82
CCPR1                             00000FBE
CCPR1H                            00000FBF
CCPR1L                            00000FBE
CCPR2                             00000FBB
CCPR2H                            00000FBC
CCPR2L                            00000FBB
CFGS                              00000006
CHK?RP                            
CHS0                              00000002
CHS1                              00000003
CHS2                              00000004
CHS3                              00000005
CIS                               00000003
CK                                00000006
CK1SPP                            00000000
CK2SPP                            00000001
CKE                               00000006
CKP                               00000004
CLASS                             0x01
CLEAR?                            
CLEAR_USED                        00000001
CLK1EN                            00000004
CLKCFG0                           00000006
CLKCFG1                           00000007
CLRWDT?                           
CLRWDT?NOP                        
CLR_FEATURE                       1
CM0                               00000000
CM1                               00000001
CM2                               00000002
CMCON                             00000FB4
CMIE                              00000006
CMIF                              00000006
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 544


SYMBOL TABLE
  LABEL                             VALUE 

CMIP                              00000006
CMP                               00000136
CMPEQ                             0000011C
CMPEQ?BBL                         
CMPEQ?BCL                         
CMPEQ?TCB                         
CMPEQ?TTL                         
CMPEQ?WWL                         
CMPEQ_USED                        00000001
CMPF?TL                           
CMPF?WL                           
CMPGT                             00000126
CMPGT?BCB                         
CMPGT?BCL                         
CMPGTB                            00000122
CMPGTB_USED                       00000001
CMPGTW                            00000124
CMPGTW_USED                       00000001
CMPGT_USED                        00000001
CMPLE?BCL                         
CMPLT                             00000130
CMPLT?BCB                         
CMPLTB                            0000012C
CMPLTB_USED                       00000001
CMPLTW                            0000012E
CMPLTW_USED                       00000001
CMPLT_USED                        00000001
CMPNE?BCL                         
CMPNE?TCL                         
CMP_USED                          00000001
CONFIGURED_STATE                  0x20
CRC16EE                           00000002
CRC16EF                           00000002
CRC5EE                            00000001
CRC5EF                            00000001
CREN                              00000004
CSEN                              00000005
CSRC                              00000007
CTRL_TRF_RX                       2
CTRL_TRF_TX                       1
CVR0                              00000000
CVR1                              00000001
CVR2                              00000002
CVR3                              00000003
CVRCON                            00000FB5
CVREF                             00000004
CVREN                             00000007
CVROE                             00000006
CVRR                              00000005
CVRSS                             00000004
Cnt                               1
Config1                           00000A70
Config1Len                        00000A74
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 545


SYMBOL TABLE
  LABEL                             VALUE 

Configs                           00000A6C
CtrlTrfData                       00000437
D                                 00000005
DATA_ADDRESS                      00000005
DC                                00000001
DC1B0                             00000004
DC1B1                             00000005
DC2B0                             00000004
DC2B1                             00000005
DDRA                              TRISA
DDRB                              TRISB
DDRC                              TRISC
DDRD                              TRISD
DDRE                              TRISE
DEBUGIN_BIT                       00000000
DEBUGIN_MODE                      00000001
DEBUGIN_REG                       00000F81
DEBUG_BAUD                        00000960
DEBUG_BIT                         00000000
DEBUG_DELAY                       0000019F
DEBUG_MODE                        00000001
DEBUG_REG                         00000F81
DEFAULT_STATE                     0x04
DETACHED_STATE                    0x00
DEVICE_REMOTE_WAKEUP              0x01
DEV_TO_HOST                       1
DFN8EE                            00000003
DFN8EF                            00000003
DIR                               00000002
DISABLE?                          
DONE                              00000001
DSC_HID                           0x21
DSC_PHY                           0x23
DSC_RPT                           0x22
DTS                               6
DTSEN                             3
DUNN                              0000016E
DUNN5                             00000170
DUNN_USED                         00000001
D_A                               00000005
D_NOT_A                           00000005
DataDir                           7
DeviceDescriptor                  00000A48
ECCP1AS                           00000FB6
ECCP1CON                          00000FBD
ECCP1DEL                          00000FB7
ECCPAS0                           00000004
ECCPAS1                           00000005
ECCPAS2                           00000006
ECCPASE                           00000007
EEADR                             00000FA9
EECON1                            00000FA6
EECON2                            00000FA7
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 546


SYMBOL TABLE
  LABEL                             VALUE 

EEDATA                            00000FA8
EEIE                              00000004
EEIF                              00000004
EEIP                              00000004
EEPGD                             00000007
EEPROM_START                      00F00000
ENDASM?                           
ENDP0                             00000003
ENDP1                             00000004
ENDP2                             00000005
ENDP3                             00000006
ENDPOINT_HALT                     0x00
EPCONDIS                          00000003
EPDir                             7
EPHSHK                            00000004
EPINEN                            00000001
EPNum                             0
EPOUTEN                           00000002
EPSTALL                           00000000
EP_CTRL                           0x06
EP_IN                             0x0A
EP_OUT                            0x0C
EP_OUT_IN                         0x0E
EndConfig1                        00000AF4
EndDeviceDescriptor               00000A6C
EndPoint2Out                      00000AE6
EndReportDescriptor1              00000C70
EndReportDescriptor2              00000D58
Endpoint1In                       00000AA6
Endpoint2In                       00000AD8
FAST                              00000001
FERR                              00000002
FLAGS                             00000000
FLTS                              00000002
FREE                              00000004
FRM0                              00000000
FRM1                              00000001
FRM10                             00000002
FRM2                              00000002
FRM3                              00000003
FRM4                              00000004
FRM5                              00000005
FRM6                              00000006
FRM7                              00000007
FRM8                              00000000
FRM9                              00000001
FSEN                              00000002
FSR0                              00000000
FSR0H                             00000FEA
FSR0L                             00000FE9
FSR1                              00000001
FSR1H                             00000FE2
FSR1L                             00000FE1
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 547


SYMBOL TABLE
  LABEL                             VALUE 

FSR2                              00000002
FSR2H                             00000FDA
FSR2L                             00000FD9
GCEN                              00000007
GET_CFG                           8
GET_DSC                           6
GET_IDLE                          0x02
GET_INTF                          10
GET_PROTOCOL                      0x03
GET_REPORT                        0x01
GET_STATUS                        0
GIE                               00000007
GIEH                              00000007
GIEL                              00000006
GIE_GIEH                          00000007
GO                                00000001
GOP                               00000001
GOSUB?L                           
GOTO?L                            
GO_DONE                           00000001
GO_NOT_DONE                       00000001
GetPutUSBZero                     00000800
GetUSB                            000007BA
GetUSBLoop                        000007F8
GetUSBNotReady                    000007DA
HIDDescriptor1                    00000A94
HIDDescriptor2                    00000AC6
HIDGetReportHandler               000009A0
HIDSetReportHandler               000009A2
HID_DEV_EP                        2
HID_DEV_INTF_ID                   0x01
HID_DEV_INT_IN_EP_SIZE            16
HID_DEV_INT_OUT_EP_SIZE           16
HID_EP                            1
HID_INTF                          0x03
HID_INTF_ID                       0x00
HID_INT_IN_EP_SIZE                16
HID_INT_OUT_EP_SIZE               16
HID_NUM_OF_DSC                    1
HID_PROTOCOL_KEYBOARD             0x01
HID_PROTOCOL_MOUSE                0x02
HID_PROTOCOL_NONE                 0x00
HIGHT                             00000076
HIGHT_USED                        00000001
HLVDCON                           00000FD2
HLVDEN                            00000004
HLVDIE                            00000002
HLVDIF                            00000002
HLVDIN                            00000005
HLVDIP                            00000002
HLVDL0                            00000000
HLVDL1                            00000001
HLVDL2                            00000002
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 548


SYMBOL TABLE
  LABEL                             VALUE 

HLVDL3                            00000003
HOST_TO_DEV                       0
HSER2_BAUD                        00000960
HSER2_BITS                        00000008
HSER2_RCSTA                       00000090
HSER2_SPBRG                       00000138
HSER2_TXSTA                       00000020
HSER_BAUD                         115200
HSER_BITS                         00000008
HSER_PORT                         00000001
HSER_RCSTA                        90h
HSER_SPBRG                        00000019
HSER_TXSTA                        24h
I2CFIRSTFLAG                      FLAGS, 2
I2CREADFLAG                       FLAGS, 3
I2CSTOPFLAG                       FLAGS, 5
I2CSTOPSTRFLAG                    FLAGS, 6
I2CWRITEFLAG                      FLAGS, 4
I2C_DAT                           00000005
I2C_READ                          00000002
I2C_START                         00000003
I2C_STOP                          00000004
IDLEIE                            00000004
IDLEIF                            00000004
IDLEN                             00000007
INCDIS                            4
INDF0                             00000FEF
INDF1                             00000FE7
INDF2                             00000FDF
INIT                              00000174
INT0                              00000000
INT0E                             00000004
INT0F                             00000001
INT0IE                            00000004
INT0IF                            00000001
INT1                              00000001
INT1E                             00000003
INT1F                             00000000
INT1IE                            00000003
INT1IF                            00000000
INT1IP                            00000006
INT1P                             00000006
INT2                              00000002
INT2E                             00000004
INT2F                             00000001
INT2IE                            00000004
INT2IF                            00000001
INT2IP                            00000007
INT2P                             00000007
INTCON                            00000FF2
INTCON2                           00000FF1
INTCON3                           00000FF0
INTEDG0                           00000006
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 549


SYMBOL TABLE
  LABEL                             VALUE 

INTEDG1                           00000005
INTEDG2                           00000004
INTSRC                            00000007
IN_TOKEN                          0x09
IOFS                              00000002
IPEN                              00000007
IPR1                              00000F9F
IPR2                              00000FA2
IRCF0                             00000004
IRCF1                             00000005
IRCF2                             00000006
IRVST                             00000005
IVRST                             00000005
Interface1                        00000A82
Interface2                        00000AB4
KEN                               5
L00001                            00000E5E
L00003                            00000E76
L00005                            00000EC6
L00007                            00000ED6
L00009                            00000EE6
L00011                            00000F60
L00013                            00000F70
L00015                            00001022
L00017                            000010DA
L00019                            00001218
L00021                            000010F0
L00022                            00001110
L00023                            00001134
L00025                            000011DC
L00027                            0000115C
L00029                            0000117C
L00031                            0000119C
L00033                            000011BC
L00035                            000011DC
L00037                            00001200
L00039                            00001212
L00041                            0000159A
L00043                            00001494
L00045                            000014C4
L00047                            00001500
L00049                            00001510
L00051                            00001540
L00053                            0000159A
L00055                            0000158E
L00056                            0000159A
L00057                            0000161A
L00059                            000015BE
L00061                            000015D4
L00063                            000015EA
L00065                            00001600
L00067                            00001616
L00069                            0000163C
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 550


SYMBOL TABLE
  LABEL                             VALUE 

L00071                            0000165E
L00073                            00001670
L00075                            00001744
L00077                            00001766
L00079                            00001788
L00081                            000017AA
L00083                            000017CC
L00085                            000017EE
L00087                            00001810
L00089                            00001832
L00091                            0000186C
L00093                            000018A4
L00095                            00001888
L00097                            000018A4
L00099                            000018DC
L00101                            00001914
L00103                            000018F8
L00105                            00001914
L00108                            000019AC
L00109                            00001980
L00110                            00001998
L00111                            000019AC
L00112                            00001A14
L00114                            000019F6
L00115                            00001A10
L00116                            00001A0C
L00118                            00001A40
L00120                            00001A38
L00121                            00001A3C
L00122                            00001A6C
L00124                            00001A64
L00125                            00001A68
L00126                            00001A94
L00128                            00001A90
L00129                            00001A94
L00130                            00001AD6
L00132                            00001ABA
L00133                            00001AD4
L00134                            00001AD0
L00136                            00001B00
L00138                            00001AFA
L00139                            00001AFE
L00140                            00001B2A
L00142                            00001B24
L00143                            00001B28
L00144                            00001B52
L00146                            00001B4E
L00147                            00001B52
L?CALL                            
L?GOTO                            
LABEL?L                           
LAND                              00000156
LAND?BBW                          
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 551


SYMBOL TABLE
  LABEL                             VALUE 

LAND_USED                         00000001
LATA                              00000F89
LATA0                             00000000
LATA1                             00000001
LATA2                             00000002
LATA3                             00000003
LATA4                             00000004
LATA5                             00000005
LATA6                             00000006
LATB                              00000F8A
LATB0                             00000000
LATB1                             00000001
LATB2                             00000002
LATB3                             00000003
LATB4                             00000004
LATB5                             00000005
LATB6                             00000006
LATB7                             00000007
LATC                              00000F8B
LATC0                             00000000
LATC1                             00000001
LATC2                             00000002
LATC6                             00000006
LATC7                             00000007
LATD                              00000F8C
LATD0                             00000000
LATD1                             00000001
LATD2                             00000002
LATD3                             00000003
LATD4                             00000004
LATD5                             00000005
LATD6                             00000006
LATD7                             00000007
LATE                              00000F8D
LATE0                             00000000
LATE1                             00000001
LATE2                             00000002
LCDCDFLAG                         FLAGS, 0
LCDINITFLAG                       FLAGS, 1
LCD_BITS                          00000004
LCD_COMMANDUS                     000007D0
LCD_DATAUS                        00000032
LCD_DBIT                          00000000
LCD_DREG                          00000F80
LCD_EBIT                          00000003
LCD_EREG                          00000F81
LCD_LINES                         00000002
LCD_RSBIT                         00000004
LCD_RSREG                         00000F80
LCD_RWBIT                         00000004
LCD_RWREG                         00000F80
LOR                               00000164
LOR?BBW                           
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 552


SYMBOL TABLE
  LABEL                             VALUE 

LOR_USED                          00000001
LOWT                              0000007A
LOWT_USED                         00000001
LVDCON                            00000FD2
LVDEN                             00000004
LVDIE                             00000002
LVDIF                             00000002
LVDIN                             00000005
LVDIP                             00000002
LVDL0                             00000000
LVDL1                             00000001
LVDL2                             00000002
LVDL3                             00000003
LVV0                              00000000
LVV1                              00000001
LVV2                              00000002
LVV3                              00000003
MOVE?AB                           
MOVE?AT                           
MOVE?AW                           
MOVE?AWW                          
MOVE?BA                           
MOVE?BB                           
MOVE?BT                           
MOVE?BW                           
MOVE?CA                           
MOVE?CB                           
MOVE?CT                           
MOVE?CW                           
MOVE?TA                           
MOVE?TB                           
MOVE?TT                           
MOVE?TW                           
MOVE?WA                           
MOVE?WB                           
MOVE?WT                           
MOVE?WW                           
MOVE?WWA                          
MPASMWIN_USED                     00000001
N                                 00000004
NEXT?BCL                          
NOT?TT                            
NOT_A                             00000005
NOT_ADDRESS                       00000005
NOT_BOR                           00000000
NOT_DONE                          00000001
NOT_IPEN                          00000007
NOT_PD                            00000002
NOT_POR                           00000001
NOT_RBPU                          00000007
NOT_RI                            00000004
NOT_T1SYNC                        00000002
NOT_T3SYNC                        00000002
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 553


SYMBOL TABLE
  LABEL                             VALUE 

NOT_TO                            00000003
NOT_W                             00000002
NOT_WRITE                         00000002
NUM_CONFIGURATIONS                1
NUM_INTERFACES                    2
OERR                              00000001
OESPP                             00000002
OSC                               48
OSC2                              00000006
OSCCON                            00000FD3
OSCFIE                            00000007
OSCFIF                            00000007
OSCFIP                            00000007
OSCTUNE                           00000F9B
OSC_VALID                         00000001
OSTS                              00000003
OUTPUTI                           00000082
OUTPUTI_USED                      00000001
OUTPUTT                           00000080
OUTPUTT_USED                      00000001
OUT_TOKEN                         0x01
OV                                00000003
P                                 00000004
P1A                               00000002
P1M0                              00000006
P1M1                              00000007
PAUSEUS                           000000E6
PAUSEUS?C                         
PAUSEUSL                          000000E8
PAUSEUS_USED                      00000001
PB01                              0000001E
PBP_HARDWAREDEF                   
PBP_PATH                          C:\PROGRAM FILES (X86)\PBP3\
PC                                00000FF9
PCFG0                             00000000
PCFG1                             00000001
PCFG2                             00000002
PCFG3                             00000003
PCL                               00000FF9
PCLATH                            00000FFA
PCLATU                            00000FFB
PD                                00000002
PDC0                              00000000
PDC1                              00000001
PDC2                              00000002
PDC3                              00000003
PDC4                              00000004
PDC5                              00000005
PDC6                              00000006
PEIE                              00000006
PEIE_GIEL                         00000006
PEN                               00000002
PGC                               00000006
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 554


SYMBOL TABLE
  LABEL                             VALUE 

PGD                               00000007
PGM                               00000005
PID                               2
PIDEE                             00000000
PIDEF                             00000000
PIE1                              00000F9D
PIE2                              00000FA0
PIR                               00000F9E
PIR1                              00000F9E
PIR2                              00000FA1
PKTDIS                            00000004
PLUSW0                            00000FEB
PLUSW1                            00000FE3
PLUSW2                            00000FDB
POR                               00000001
PORTA                             00000F80
PORTB                             00000F81
PORTC                             00000F82
PORTD                             00000F83
PORTE                             00000F84
POSTDEC0                          00000FED
POSTDEC1                          00000FE5
POSTDEC2                          00000FDD
POSTINC0                          00000FEE
POSTINC1                          00000FE6
POSTINC2                          00000FDE
POWERED_STATE                     0x02
PPB0                              00000000
PPB1                              00000001
PPBI                              00000001
PPBRST                            00000006
PR2                               00000FCB
PREINC0                           00000FEC
PREINC1                           00000FE4
PREINC2                           00000FDC
PREV_ALT                          00000000
PREV_BANK                         00000000
PROD                              00000FF3
PRODH                             00000FF4
PRODL                             00000FF3
PRSEN                             00000007
PSA                               00000003
PSSAC0                            00000002
PSSAC1                            00000003
PSSBD0                            00000000
PSSBD1                            00000001
PutUSB                            00000810
PutUSBLoop                        0000084E
PutUSBNotReady                    00000830
R                                 00000002
R0                                00000002
R1                                00000004
R2                                00000006
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 555


SYMBOL TABLE
  LABEL                             VALUE 

R3                                00000008
R4                                0000000A
R5                                0000000C
R6                                0000000E
R7                                00000010
R8                                00000012
RA0                               00000000
RA1                               00000001
RA2                               00000002
RA3                               00000003
RA4                               00000004
RA5                               00000005
RA6                               00000006
RAM_BANKS                         00000008
RAM_END                           000007FF
RAM_START                         00000000
RB0                               00000000
RB1                               00000001
RB2                               00000002
RB3                               00000003
RB4                               00000004
RB5                               00000005
RB6                               00000006
RB7                               00000007
RBIE                              00000003
RBIF                              00000000
RBIP                              00000000
RBPU                              00000007
RC0                               00000000
RC1                               00000001
RC2                               00000002
RC4                               00000004
RC5                               00000005
RC6                               00000006
RC7                               00000007
RCEN                              00000003
RCIDL                             00000006
RCIE                              00000005
RCIF                              00000005
RCIP                              00000005
RCMT                              00000006
RCON                              00000FD0
RCPT_DEV                          0
RCPT_EP                           2
RCPT_INTF                         1
RCPT_OTH                          3
RCREG                             00000FAE
RCSTA                             00000FAB
RD                                00000000
RD0                               00000000
RD1                               00000001
RD16                              00000007
RD2                               00000002
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 556


SYMBOL TABLE
  LABEL                             VALUE 

RD3                               00000003
RD4                               00000004
RD5                               00000005
RD6                               00000006
RD7                               00000007
RDPU                              00000007
RDSPP                             00000007
RE0                               00000000
RE1                               00000001
RE2                               00000002
RE3                               00000003
READ                              000000BC
READ?B                            
READADDRESS?C                     
READINC                           000000C2
READ_USED                         00000001
READ_WRITE                        00000002
RESET_ORG                         00000000
RESUME                            00000002
RESUME?                           
RETURN?                           
REV                               000000FE
REV_USED                          00000001
RI                                00000004
RM1                               00000018
RM2                               00000019
RPT_PROTOCOL                      0x01
RR1                               0000001A
RR2                               0000001B
RS1                               0000001C
RS2                               0000001D
RSEN                              00000001
RST?RP                            
RX                                00000007
RX9                               00000006
RX9D                              00000000
RXDTP                             00000005
R_NOT_W                           00000002
R_W                               00000002
Recipient                         0
RemoteWakeup                      0000042E
ReportDescriptor1                 00000AF4
ReportDescriptor1Len              00000AA2
ReportDescriptor2                 00000C70
ReportDescriptor2Len              00000AD4
RequestType                       5
S                                 00000003
SBOREN                            00000006
SCKP                              00000004
SCS0                              00000000
SCS1                              00000001
SE0                               00000005
SEN                               00000000
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 557


SYMBOL TABLE
  LABEL                             VALUE 

SENDB                             00000003
SETUP_TOKEN                       0x0D
SET_ADR                           5
SET_CFG                           9
SET_DSC                           7
SET_FEATURE                       3
SET_IDLE                          0x0A
SET_INTF                          11
SET_PROTOCOL                      0x0B
SET_REPORT                        0x09
SHIFTCLOCK?T                      
SHIFTDATA?T                       
SHIFTMODE?C                       
SHIFTOUT                          00000006
SHIFTOUT8                         00000004
SHIFTOUT?BC                       
SHIFTOUT_USED                     00000001
SHIFTTOGGLE_USED                  00000001
SHORT_PKT_NOT_USED                0
SHORT_PKT_PENDING                 1
SHORT_PKT_SENT                    2
SMP                               00000007
SOFIE                             00000006
SOFIF                             00000006
SPBRG                             00000FAF
SPBRGH                            00000FB0
SPEN                              00000007
SPP0                              00000000
SPP1                              00000001
SPP2                              00000002
SPP3                              00000003
SPP4                              00000004
SPP5                              00000005
SPP6                              00000006
SPP7                              00000007
SPPBUSY                           00000004
SPPCFG                            00000F63
SPPCON                            00000F65
SPPDATA                           00000F62
SPPEN                             00000000
SPPEPS                            00000F64
SPPIE                             00000007
SPPIF                             00000007
SPPIP                             00000007
SPPOWN                            00000001
SREN                              00000005
SSPADD                            00000FC8
SSPBUF                            00000FC9
SSPCON1                           00000FC6
SSPCON2                           00000FC5
SSPEN                             00000005
SSPIE                             00000003
SSPIF                             00000003
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 558


SYMBOL TABLE
  LABEL                             VALUE 

SSPIP                             00000003
SSPM0                             00000000
SSPM1                             00000001
SSPM2                             00000002
SSPM3                             00000003
SSPOV                             00000006
SSPSTAT                           00000FC7
STALLIE                           00000005
STALLIF                           00000005
STANDARD                          0x00
STATUS                            00000FD8
STKFUL                            00000007
STKOVF                            00000007
STKPTR                            00000FFC
STKPTR0                           00000000
STKPTR1                           00000001
STKPTR2                           00000002
STKPTR3                           00000003
STKPTR4                           00000004
STKUNF                            00000006
SUB?BCB                           
SUSPND                            00000001
SWDTE                             00000000
SWDTEN                            00000000
SYNC                              00000004
SYNCH_FRAME                       12
SetupPkt                          0000042F
Stat                              0
String0                           00000D6C
String1                           00000D74
String2                           00000D84
String3                           00000DB8
String4                           00000DD8
String5                           00000DF8
Strings                           00000D58
T08BIT                            00000006
T0CKI                             00000004
T0CON                             00000FD5
T0CS                              00000005
T0IE                              00000005
T0IF                              00000002
T0IP                              00000002
T0PS0                             00000000
T0PS1                             00000001
T0PS2                             00000002
T0SE                              00000004
T1                                00000014
T13CKI                            00000000
T1CKPS0                           00000004
T1CKPS1                           00000005
T1CON                             00000FCD
T1OSCEN                           00000003
T1OSI                             00000001
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 559


SYMBOL TABLE
  LABEL                             VALUE 

T1OSO                             00000000
T1RUN                             00000006
T1SYNC                            00000002
T2                                00000016
T2CKPS0                           00000000
T2CKPS1                           00000001
T2CON                             00000FCA
T2OUTPS0                          00000003
T2OUTPS1                          00000004
T2OUTPS2                          00000005
T2OUTPS3                          00000006
T3CCP1                            00000003
T3CCP2                            00000006
T3CKPS0                           00000004
T3CKPS1                           00000005
T3CON                             00000FB1
T3NSYNC                           00000002
T3SYNC                            00000002
TABLAT                            00000FF5
TBLPTR                            00000FF6
TBLPTRH                           00000FF7
TBLPTRL                           00000FF6
TBLPTRU                           00000FF8
TMR0                              00000FD6
TMR0H                             00000FD7
TMR0IE                            00000005
TMR0IF                            00000002
TMR0IP                            00000002
TMR0L                             00000FD6
TMR0ON                            00000007
TMR1                              00000FCE
TMR1CS                            00000001
TMR1H                             00000FCF
TMR1IE                            00000000
TMR1IF                            00000000
TMR1IP                            00000000
TMR1L                             00000FCE
TMR1ON                            00000000
TMR2                              00000FCC
TMR2IE                            00000001
TMR2IF                            00000001
TMR2IP                            00000001
TMR2ON                            00000002
TMR3                              00000FB2
TMR3CS                            00000001
TMR3H                             00000FB3
TMR3IE                            00000001
TMR3IF                            00000001
TMR3IP                            00000001
TMR3L                             00000FB2
TMR3ON                            00000000
TO                                00000003
TOGGLE?T                          
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 560


SYMBOL TABLE
  LABEL                             VALUE 

TOS                               00000FFD
TOSH                              00000FFE
TOSL                              00000FFD
TOSU                              00000FFF
TOUTPS0                           00000003
TOUTPS1                           00000004
TOUTPS2                           00000005
TOUTPS3                           00000006
TRISA                             00000F92
TRISA0                            00000000
TRISA1                            00000001
TRISA2                            00000002
TRISA3                            00000003
TRISA4                            00000004
TRISA5                            00000005
TRISA6                            00000006
TRISB                             00000F93
TRISB0                            00000000
TRISB1                            00000001
TRISB2                            00000002
TRISB3                            00000003
TRISB4                            00000004
TRISB5                            00000005
TRISB6                            00000006
TRISB7                            00000007
TRISC                             00000F94
TRISC0                            00000000
TRISC1                            00000001
TRISC2                            00000002
TRISC6                            00000006
TRISC7                            00000007
TRISD                             00000F95
TRISD0                            00000000
TRISD1                            00000001
TRISD2                            00000002
TRISD3                            00000003
TRISD4                            00000004
TRISD5                            00000005
TRISD6                            00000006
TRISD7                            00000007
TRISE                             00000F96
TRISE0                            00000000
TRISE1                            00000001
TRISE2                            00000002
TRMT                              00000001
TRNIE                             00000003
TRNIF                             00000003
TUN0                              00000000
TUN1                              00000001
TUN2                              00000002
TUN3                              00000003
TUN4                              00000004
TX                                00000006
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 561


SYMBOL TABLE
  LABEL                             VALUE 

TX9                               00000006
TX9D                              00000000
TXCKP                             00000004
TXEN                              00000005
TXIE                              00000004
TXIF                              00000004
TXIP                              00000004
TXREG                             00000FAD
TXSTA                             00000FAC
UA                                00000001
UADDR                             00000F6E
UCFG                              00000F6F
UCFG_VAL                          USB_PULLUP_ENABLE|USB_INTERNAL_TRANSCEIVER|USB_FULL_SPEED|USB_PING_PONG__NO_PING_PONG
UCON                              00000F6D
UEIE                              00000F6B
UEIR                              00000F6A
UEP0                              00000F70
UEP1                              00000F71
UEP10                             00000F7A
UEP11                             00000F7B
UEP12                             00000F7C
UEP13                             00000F7D
UEP14                             00000F7E
UEP15                             00000F7F
UEP2                              00000F72
UEP3                              00000F73
UEP4                              00000F74
UEP5                              00000F75
UEP6                              00000F76
UEP7                              00000F77
UEP8                              00000F78
UEP9                              00000F79
UEP_STALL                         0x0001
UERRIE                            00000001
UERRIF                            00000001
UFRM                              00000F66
UFRMH                             00000F67
UFRML                             00000F66
UIE                               00000F69
UIR                               00000F68
UOEMON                            00000006
UOWN                              7
UPUEN                             00000004
URSTIE                            00000000
URSTIF                            00000000
USBActiveConfiguration            00000420
USBAlternateInterface             00000421
USBCBCheckOtherReq                000009E6
USBCBErrorHandler                 000009E4
USBCBInitEP                       000009EA
USBCBSendResume                   00000A32
USBCBSendResumeLoop               00000A3C
USBCBStdSetDscHandler             000009E8
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 562


SYMBOL TABLE
  LABEL                             VALUE 

USBCBSuspend                      000009DE
USBCBWakeFromSuspend              000009E0
USBCB_SOF_Handler                 000009E2
USBCalcEPAddress                  0000046A
USBCheckHIDRequest                00000858
USBCheckHIDRequest1               000008E2
USBCheckHIDRequest2               00000922
USBCheckHIDRequest3               000008A8
USBCheckHIDRequest4               000009A4
USBCheckHIDRequestClass           0000092C
USBCheckHIDRequestClass1          00000960
USBCheckHIDRequestClass2          00000970
USBCheckHIDRequestClass3          00000990
USBCheckHIDRequestExit            0000086C
USBCheckStdRequest                00000380
USBCheckStdRequest1               00000398
USBCheckStdRequest3               000003A6
USBCheckStdRequest4               000003C4
USBCheckStdRequest5               000003CC
USBCheckStdRequest8               000003FA
USBCheckStdRequest9               0000040E
USBCheckStdRequestExit            00000396
USBCtrlEPService                  000002A2
USBCtrlEPService1                 000002B6
USBCtrlEPServiceComplete          00000594
USBCtrlEPServiceComplete0         000005BC
USBCtrlEPServiceComplete1         000005D2
USBCtrlEPServiceComplete11        000005F0
USBCtrlEPServiceComplete2         00000616
USBCtrlEPServiceCompleteCopy      000005E8
USBCtrlTrfInHandler               000002E6
USBCtrlTrfInHandler1              00000302
USBCtrlTrfInHandler2              00000320
USBCtrlTrfOutHandler              000002DC
USBCtrlTrfRxService               000006D0
USBCtrlTrfRxService1              000006E0
USBCtrlTrfRxService2              00000720
USBCtrlTrfRxServiceExit           00000708
USBCtrlTrfRxServiceLoop           000006F8
USBCtrlTrfSetupHandler            000002C0
USBCtrlTrfTxService               00000632
USBCtrlTrfTxServiceExit           000006CE
USBCtrlTrfTxServiceGreater        00000660
USBCtrlTrfTxServiceNotEQ          00000646
USBCtrlTrfTxServiceNotEQ1         00000654
USBCtrlTrfTxServiceNotLess        00000668
USBCtrlTrfTxServiceRam            000006B2
USBCtrlTrfTxServiceRamLoop        000006BA
USBCtrlTrfTxServiceRomLoop        00000694
USBDeviceInit                     00000178
USBDeviceInitEPLoop               0000018C
USBDeviceInitFlush1               000001A6
USBDeviceInitFlushLoop            00000198
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 563


SYMBOL TABLE
  LABEL                             VALUE 

USBDeviceState                    0000041F
USBDeviceTasks                    000001C0
USBDeviceTasks1                   000001FC
USBDeviceTasks2                   00000220
USBDeviceTasks3                   0000022C
USBDeviceTasks4                   00000238
USBDeviceTasks5                   00000240
USBDeviceTasks6                   0000024C
USBDeviceTasks7                   0000025E
USBDeviceTasksA                   000001F4
USBDeviceTasksCDLoop              000001CC
USBDeviceTasksCheckAttached       000001DC
USBDeviceTasksCheckDetached       000001C2
USBDriverTasksExit                0000026E
USBEN                             00000003
USBEnableEndpointIn               0000078E
USBEnableEndpointOut              0000075A
USBIE                             00000005
USBIF                             00000005
USBINIT?                          
USBIP                             00000005
USBOUT?BBBL                       
USBPrepareForNextSetupTrf         0000032A
USBPrepareForNextSetupTrf1        00000364
USBPrepareForNextSetupTrf2        0000037C
USBPrepareForNextSetupTrfLoop     0000035A
USBRxOnePacket                    000007BA
USBSERVICE?                       
USBStallEndpoint1                 000007BA
USBStallHandler                   00000270
USBStallHandlerExit               00000288
USBStdFeatureReqHandler           00000416
USBStdFeatureReqHandler1          00000430
USBStdFeatureReqHandler2          00000454
USBStdFeatureReqHandlerExit       00000434
USBStdGetDscHandler               0000047A
USBStdGetDscHandler1              000004AE
USBStdGetDscHandler2              000004FE
USBStdGetDscHandler3              00000540
USBStdGetStatusHandler            00000544
USBStdGetStatusHandler1           0000055A
USBStdGetStatusHandler2           00000566
USBStdGetStatusHandlerExit        0000057A
USBStdSetCfgHandler               0000072C
USBStdSetCfgHandler1              00000754
USBStdSetCfgHandlerClearAltLoop   00000742
USBStdSetCfgHandlerClearEPLoop    00000736
USBSuspend                        0000028C
USBTxOnePacket                    00000810
USBWakeFromSuspend                00000294
USBWakeFromSuspendLoop            0000029A
USB_ALLOW_SETUP                   0x00
USB_CD_Ptr                        00000A6C
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 564


SYMBOL TABLE
  LABEL                             VALUE 

USB_DESCRIPTOR_CONFIGURATION      0x02
USB_DESCRIPTOR_DEVICE             0x01
USB_DESCRIPTOR_DEVICE_QUALIFIER   0x06
USB_DESCRIPTOR_ENDPOINT           0x05
USB_DESCRIPTOR_INTERFACE          0x04
USB_DESCRIPTOR_INTERFACE_POWER    0x08
USB_DESCRIPTOR_OTG                0x09
USB_DESCRIPTOR_OTHER_SPEED        0x07
USB_DESCRIPTOR_STRING             0x03
USB_DISALLOW_SETUP                0x08
USB_EP0_BUFF_SIZE                 8
USB_EP0_BUSY                      USB_INPIPES_BUSY
USB_EP0_INCLUDE_ZERO              USB_INPIPES_INCLUDE_ZERO
USB_EP0_NO_DATA                   USB_INPIPES_NO_DATA
USB_EP0_NO_OPTIONS                USB_INPIPES_NO_OPTIONS
USB_EP0_RAM                       USB_INPIPES_RAM
USB_EP0_ROM                       USB_INPIPES_ROM
USB_EXTERNAL_TRANSCEIVER          0x08
USB_FULL_SPEED                    0x04
USB_HANDSHAKE_DISABLED            0x00
USB_HANDSHAKE_ENABLED             0x10
USB_INPIPES_BUSY                  0x80
USB_INPIPES_INCLUDE_ZERO          0x40
USB_INPIPES_NO_DATA               0x00
USB_INPIPES_NO_OPTIONS            0x00
USB_INPIPES_RAM                   0x01
USB_INPIPES_ROM                   0x00
USB_INTERNAL_TRANSCEIVER          0x00
USB_IN_DISABLED                   0x00
USB_IN_ENABLED                    0x02
USB_LOW_SPEED                     0x00
USB_MAX_EP_NUMBER                 2
USB_MAX_NUM_INT                   2
USB_OUT_DISABLED                  0x00
USB_OUT_ENABLED                   0x04
USB_PING_PONG__ALL_BUT_EP0        0x03
USB_PING_PONG__EP0_OUT_ONLY       0x01
USB_PING_PONG__FULL_PING_PONG     0x02
USB_PING_PONG__NO_PING_PONG       0x00
USB_POLLING                       
USB_PULLUP_DISABLED               0x00
USB_PULLUP_ENABLE                 0x10
USB_SD_Ptr                        00000D58
USB_STALL_ENDPOINT                0x01
USB_USE_HID                       
USTAT                             00000F6C
USTAT_EP0_IN                      0x04
USTAT_EP0_OUT                     0x00
USTAT_EP0_PP_MASK                 ~0x02
USTAT_EP_MASK                     0x7E
USTATcopy                         00000429
UTEYE                             00000007
UTRDIS                            00000003
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 565


SYMBOL TABLE
  LABEL                             VALUE 

VCFG0                             00000004
VCFG1                             00000005
VDIRMAG                           00000007
VENDOR                            0x02
VREFM                             00000002
VREFP                             00000003
W                                 00000000
WAIT_SETUP                        0
WCOL                              00000007
WDTCON                            00000FD1
WR                                00000001
WREG                              00000FE8
WREN                              00000002
WRERR                             00000003
WRITE                             000000CA
WRITE?B                           
WRITE?C                           
WRITEADDRESS?C                    
WRITEZ                            000000C8
WRITE_USED                        00000001
WRSPP                             00000006
WS0                               00000000
WS1                               00000001
WS2                               00000002
WS3                               00000003
WUE                               00000001
Z                                 00000002
_ANALOG0                          00000070
_ANALOG0??HIGHBYTE                00000071
_ANALOG0??LOWBYTE                 00000070
_ANALOG1                          00000072
_ANALOG1??HIGHBYTE                00000073
_ANALOG1??LOWBYTE                 00000072
_ANALOG2                          00000074
_ANALOG2??HIGHBYTE                00000075
_ANALOG2??LOWBYTE                 00000074
_ANALOG3                          00000076
_ANALOG3??HIGHBYTE                00000077
_ANALOG3??LOWBYTE                 00000076
_ANALOG4                          00000078
_ANALOG4??HIGHBYTE                00000079
_ANALOG4??LOWBYTE                 00000078
_ANALOG5                          0000007A
_ANALOG5??HIGHBYTE                0000007B
_ANALOG5??LOWBYTE                 0000007A
_ANALOG6                          0000007C
_ANALOG6??HIGHBYTE                0000007D
_ANALOG6??LOWBYTE                 0000007C
_ANALOG7                          0000007E
_ANALOG7??HIGHBYTE                0000007F
_ANALOG7??LOWBYTE                 0000007E
_ANINPUT                          0000006E
_ANTemp0                          00000080
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 566


SYMBOL TABLE
  LABEL                             VALUE 

_ANTemp1                          00000082
_ANTemp2                          00000084
_ANTemp3                          00000086
_ANTemp4                          00000088
_ANTemp5                          0000008A
_ANTemp6                          0000008C
_ANTemp7                          0000008E
_AllFlags                         00000060
_AllFlags??0                      _AllFlags, 000h
_AllFlags??1                      _AllFlags, 001h
_AllFlags??2                      _AllFlags, 002h
_AllFlags??3                      _AllFlags, 003h
_BORV_0_2L                        000000E7
_BORV_1_2L                        000000EF
_BORV_2_2L                        000000F7
_BORV_3_2L                        000000FF
_BOR_OFF_2L                       000000F9
_BOR_ON_2L                        000000FF
_BOR_ON_ACTIVE_2L                 000000FD
_BOR_SOFT_2L                      000000FB
_BSTALL                           0x04
_BULK                             0x02
_CCP2MX_OFF_3H                    000000FE
_CCP2MX_ON_3H                     000000FF
_CHUTES0                          0000009E
_CHUTES1                          0000009F
_CONFIG1H                         00300001
_CONFIG1L                         00300000
_CONFIG2H                         00300003
_CONFIG2L                         00300002
_CONFIG3H                         00300005
_CONFIG4L                         00300006
_CONFIG5H                         00300009
_CONFIG5L                         00300008
_CONFIG6H                         0030000B
_CONFIG6L                         0030000A
_CONFIG7H                         0030000D
_CONFIG7L                         0030000C
_COUNTER                          00001834
_COUNTS1                          PB01, 000h
_COUNTS2                          PB01, 001h
_CP0_OFF_5L                       000000FF
_CP0_ON_5L                        000000FE
_CP1_OFF_5L                       000000FF
_CP1_ON_5L                        000000FD
_CP2_OFF_5L                       000000FF
_CP2_ON_5L                        000000FB
_CP3_OFF_5L                       000000FF
_CP3_ON_5L                        000000F7
_CPB_OFF_5H                       000000FF
_CPB_ON_5H                        000000BF
_CPD_OFF_5H                       000000FF
_CPD_ON_5H                        0000007F
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 567


SYMBOL TABLE
  LABEL                             VALUE 

_CPUDIV_OSC1_PLL2_1L              000000E7
_CPUDIV_OSC2_PLL3_1L              000000EF
_CPUDIV_OSC3_PLL4_1L              000000F7
_CPUDIV_OSC4_PLL6_1L              000000FF
_CTRL                             0x00
_DAT0                             0x00
_DAT1                             0x40
_DEBUG_OFF_4L                     000000FF
_DEBUG_ON_4L                      0000007F
_DEFAULT                          (0x01<<7)
_DEVID1                           003FFFFE
_DEVID2                           003FFFFF
_DTSEN                            0x08
_DTSMASK                          0x40
_DoUSBOut                         00001968
_EBTR0_OFF_7L                     000000FF
_EBTR0_ON_7L                      000000FE
_EBTR1_OFF_7L                     000000FF
_EBTR1_ON_7L                      000000FD
_EBTR2_OFF_7L                     000000FF
_EBTR2_ON_7L                      000000FB
_EBTR3_OFF_7L                     000000FF
_EBTR3_ON_7L                      000000F7
_EBTRB_OFF_7H                     000000FF
_EBTRB_ON_7H                      000000BF
_EP01_IN                          0x81
_EP01_OUT                         0x01
_EP02_IN                          0x82
_EP02_OUT                         0x02
_EP_IN                            0x80
_EP_OUT                           0x00
_F1Keys                           00000067
_F2Keys                           00000069
_FCMEN_OFF_1H                     000000BF
_FCMEN_ON_1H                      000000FF
_FKeytemp                         00000066
_FKeytemp??0                      _FKeytemp, 000h
_FKeytemp??1                      _FKeytemp, 001h
_FKeytemp??2                      _FKeytemp, 002h
_FKeytemp??3                      _FKeytemp, 003h
_FKeytemp??4                      _FKeytemp, 004h
_FOSC_ECIO_EC_1H                  000000F4
_FOSC_ECPLLIO_EC_1H               000000F6
_FOSC_ECPLL_EC_1H                 000000F7
_FOSC_EC_EC_1H                    000000F5
_FOSC_HSPLL_HS_1H                 000000FE
_FOSC_HS_1H                       000000FC
_FOSC_INTOSCIO_EC_1H              000000F8
_FOSC_INTOSC_EC_1H                000000F9
_FOSC_INTOSC_HS_1H                000000FB
_FOSC_INTOSC_XT_1H                000000FA
_FOSC_XTPLL_XT_1H                 000000F2
_FOSC_XT_XT_1H                    000000F0
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 568


SYMBOL TABLE
  LABEL                             VALUE 

_FunctionKeys                     00000061
_FunctionKeys??0                  _FunctionKeys, 000h
_FunctionKeys??1                  _FunctionKeys, 001h
_FunctionKeys??2                  _FunctionKeys, 002h
_FunctionKeys??3                  _FunctionKeys, 003h
_FunctionKeys??4                  _FunctionKeys, 004h
_ICPRT_OFF_4L                     000000DF
_ICPRT_ON_4L                      000000FF
_IDLOC0                           00200000
_IDLOC1                           00200001
_IDLOC2                           00200002
_IDLOC3                           00200003
_IDLOC4                           00200004
_IDLOC5                           00200005
_IDLOC6                           00200006
_IDLOC7                           00200007
_IDTX                             0000009C
_IESO_OFF_1H                      0000007F
_IESO_ON_1H                       000000FF
_INCDIS                           0x10
_INT                              0x03
_ISO                              0x01
_KEN                              0x20
_LATA??2                          LATA, 002h
_LATA??3                          LATA, 003h
_LATA??4                          LATA, 004h
_LATC??0                          LATC, 000h
_LATD??0                          LATD, 000h
_LATD??1                          LATD, 001h
_LATD??2                          LATD, 002h
_LPT1OSC_OFF_3H                   000000FB
_LPT1OSC_ON_3H                    000000FF
_LVP_OFF_4L                       000000FB
_LVP_ON_4L                        000000FF
_MCLRE_OFF_3H                     0000007F
_MCLRE_ON_3H                      000000FF
_MEDIAK                           000000A5
_MEDIAK??0                        _MEDIAK, 000h
_MEDIAK??1                        _MEDIAK, 001h
_MEDIAK??2                        _MEDIAK, 002h
_MEDIAK??3                        _MEDIAK, 003h
_MEDIAK??4                        _MEDIAK, 004h
_MEDIAK??5                        _MEDIAK, 005h
_MEDIAK??6                        _MEDIAK, 006h
_MEDIAK??7                        _MEDIAK, 007h
_MainLoop                         00000F26
_OUTPUTS0                         0000006B
_OUTPUTS1                         0000006C
_OUTPUTS2                         0000006D
_OUTPUTS2??4                      _OUTPUTS2, 004h
_OUTPUTS2??5                      _OUTPUTS2, 005h
_OUTPUTS2??6                      _OUTPUTS2, 006h
_OUTPUTS2??7                      _OUTPUTS2, 007h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 569


SYMBOL TABLE
  LABEL                             VALUE 

_P1Keys                           00000062
_P1Keys??0                        _P1Keys, 000h
_P1Keys??1                        _P1Keys, 001h
_P1Keys??10                       _P1Keys + 001h, 002h
_P1Keys??2                        _P1Keys, 002h
_P1Keys??3                        _P1Keys, 003h
_P1Keys??4                        _P1Keys, 004h
_P1Keys??5                        _P1Keys, 005h
_P1Keys??6                        _P1Keys, 006h
_P1Keys??7                        _P1Keys, 007h
_P1Keys??8                        _P1Keys + 001h, 000h
_P1Keys??9                        _P1Keys + 001h, 001h
_P2Keys                           00000064
_P2Keys??0                        _P2Keys, 000h
_P2Keys??1                        _P2Keys, 001h
_P2Keys??10                       _P2Keys + 001h, 002h
_P2Keys??2                        _P2Keys, 002h
_P2Keys??3                        _P2Keys, 003h
_P2Keys??4                        _P2Keys, 004h
_P2Keys??5                        _P2Keys, 005h
_P2Keys??6                        _P2Keys, 006h
_P2Keys??7                        _P2Keys, 007h
_P2Keys??8                        _P2Keys + 001h, 000h
_P2Keys??9                        _P2Keys + 001h, 001h
_PBADEN_OFF_3H                    000000FD
_PBADEN_ON_3H                     000000FF
_PLLDIV_10_1L                     000000FE
_PLLDIV_12_1L                     000000FF
_PLLDIV_1_1L                      000000F8
_PLLDIV_2_1L                      000000F9
_PLLDIV_3_1L                      000000FA
_PLLDIV_4_1L                      000000FB
_PLLDIV_5_1L                      000000FC
_PLLDIV_6_1L                      000000FD
_PORTA??5                         PORTA, 005h
_PORTA??6                         PORTA, 006h
_PORTB??0                         PORTB, 000h
_PORTB??1                         PORTB, 001h
_PORTB??2                         PORTB, 002h
_PORTB??3                         PORTB, 003h
_PORTB??4                         PORTB, 004h
_PORTB??5                         PORTB, 005h
_PORTB??6                         PORTB, 006h
_PORTB??7                         PORTB, 007h
_PORTD??1                         PORTD, 001h
_PORTD??3                         PORTD, 003h
_PORTD??4                         PORTD, 004h
_PORTD??5                         PORTD, 005h
_PORTD??6                         PORTD, 006h
_PORTD??7                         PORTD, 007h
_PORTE??0                         PORTE, 000h
_PORTE??1                         PORTE, 001h
_PORTE??2                         PORTE, 002h
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 570


SYMBOL TABLE
  LABEL                             VALUE 

_PORTH                            00000F82
_PORTL                            00000F81
_POV1                             000000AB
_POV1??0                          _POV1, 000h
_POV1??1                          _POV1, 001h
_POV1??2                          _POV1, 002h
_POV1??3                          _POV1, 003h
_POV2                             000000AC
_POV2??0                          _POV2, 000h
_POV2??1                          _POV2, 001h
_POV2??2                          _POV2, 002h
_POV2??3                          _POV2, 003h
_PWRT_OFF_2L                      000000FF
_PWRT_ON_2L                       000000FE
_READAN                           00001672
_READIN                           00001222
_RESET                            00000E20
_RPOV                             000019D0
_RPOV2                            00001A94
_RWU                              (0x01<<5)
_SELF                             (0x01<<6)
_STVREN_OFF_4L                    000000FE
_STVREN_ON_4L                     000000FF
_SerialIn                         00001B54
_TIMER1                           000000A3
_TIMER2                           000000A4
_TMEDIAK                          000000A6
_TRIGGER1                         000000A1
_TRIGGER2                         000000A2
_TRISH                            00000F94
_TRISL                            00000F93
_Temp                             0000009D
_Temp??0                          _Temp, 000h
_Temp??1                          _Temp, 001h
_Temp??2                          _Temp, 002h
_Temp??3                          _Temp, 003h
_Temp??4                          _Temp, 004h
_Temp??5                          _Temp, 005h
_Temp??6                          _Temp, 006h
_Temp??7                          _Temp, 007h
_UCPU                             0x00
_USBBuffer                        00000090
_USBBufferCount                   0000009B
_USBBufferSizeMax                 00000008
_USBBufferSizeRX                  00000008
_USBBufferSizeTX                  0000000B
_USBDIV_1_1L                      000000DF
_USBDIV_2_1L                      000000FF
_USBMEMORYADDRESS                 00000400
_USBMEMORYSIZE                    00000100
_USBMediaTX                       00000003
_USBReservedMemory                00000400
_USBkeyTX                         00000008
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 571


SYMBOL TABLE
  LABEL                             VALUE 

_USIE                             0x80
_VConfig                          000000A0
_VConfig??0                       _VConfig, 000h
_VConfig??1                       _VConfig, 001h
_VConfig??2                       _VConfig, 002h
_VConfig??3                       _VConfig, 003h
_VConfig??4                       _VConfig, 004h
_VREGEN_OFF_2L                    000000DF
_VREGEN_ON_2L                     000000FF
_WDTPS_1024_2H                    000000F5
_WDTPS_128_2H                     000000EF
_WDTPS_16384_2H                   000000FD
_WDTPS_16_2H                      000000E9
_WDTPS_1_2H                       000000E1
_WDTPS_2048_2H                    000000F7
_WDTPS_256_2H                     000000F1
_WDTPS_2_2H                       000000E3
_WDTPS_32768_2H                   000000FF
_WDTPS_32_2H                      000000EB
_WDTPS_4096_2H                    000000F9
_WDTPS_4_2H                       000000E5
_WDTPS_512_2H                     000000F3
_WDTPS_64_2H                      000000ED
_WDTPS_8192_2H                    000000FB
_WDTPS_8_2H                       000000E7
_WDT_OFF_2H                       000000FE
_WDT_ON_2H                        000000FF
_WRT0_OFF_6L                      000000FF
_WRT0_ON_6L                       000000FE
_WRT1_OFF_6L                      000000FF
_WRT1_ON_6L                       000000FD
_WRT2_OFF_6L                      000000FF
_WRT2_ON_6L                       000000FB
_WRT3_OFF_6L                      000000FF
_WRT3_ON_6L                       000000F7
_WRTB_OFF_6H                      000000FF
_WRTB_ON_6H                       000000BF
_WRTC_OFF_6H                      000000FF
_WRTC_ON_6H                       000000DF
_WRTD_OFF_6H                      000000FF
_WRTD_ON_6H                       0000007F
_XINST_OFF_4L                     000000BF
_XINST_ON_4L                      000000FF
__18F4550                         00000001
_epTX                             000000AA
_hid_desc_end                     00000DF8
_i                                000000A7
_wout                             00001916
_x                                000000A8
_y                                000000A9
active_protocol                   00000440
adcinloop                         000000AE
bAltID                            2
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 572


SYMBOL TABLE
  LABEL                             VALUE 

bAltID_H                          3
bCfgRSD                           3
bConfigurationValue               2
bDescriptorType                   3
bDevADR                           2
bDevADRH                          3
bDscIndex                         2
bEPID                             4
bEPID_H                           5
bFeature                          2
bIntfID                           4
bIntfID_H                         5
bReportID                         2
bReportType                       3
bRequest                          1
bTRNIFCount                       0000042B
bmRequestType                     0
busy                              7
cmpnoteq                          00000142
controlTransferState              00000423
ctrl_trf_mem                      0
ep0Bi                             00000404
ep0Bo                             00000400
ep1Bi                             0000040C
ep1Bo                             00000408
ep2Bi                             00000414
ep2Bo                             00000410
hid_dev_report_in                 00000474
hid_dev_report_out                00000463
hid_report_in                     00000452
hid_report_out                    00000441
idle_rate                         0000043F
inCount                           00000424
includeZero                       6
info                              0000042C
lastDTS                           0000042A
mGetRomTableCount                 
mSetDestinationPointer            
mSetSourcePointer                 
main                              00000174
outCount                          00000426
outfo                             0000042D
pDst                              0000041D
pSrc                              0000041A
pauseusloop                       000000EC
revfirst                          0000010C
revloop                           00000104
shiftoutdone                      00000052
shiftoutloop                      0000003E
shifttoggle                       00000056
shortPacketStatus                 00000428
usb_temp                          00000418
wIndex                            4
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 573


SYMBOL TABLE
  LABEL                             VALUE 

wLangID                           4
wLength                           6
wValue                            2
writeloop                         000000DA


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)

0000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
00C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
01C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
02C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
03C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
04C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
05C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
06C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
07C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
08C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 574


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


0980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
09C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0B80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0BC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0C80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0CC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0D80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0DC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0E80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0EC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0F80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
0FC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1000 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1040 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1080 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
10C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1100 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1140 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1180 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
11C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1200 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1240 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1280 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
12C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1300 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1340 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1380 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
13C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1400 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1440 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1480 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
14C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
MPASM  5.49                      FIRMAC01.ASM   4-16-2023  1:18:12         PAGE 575


MEMORY USAGE MAP ('X' = Used,  '-' = Unused)


1500 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1540 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1580 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
15C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1600 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1640 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1680 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
16C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1700 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1740 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1780 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
17C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1800 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1840 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1880 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
18C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1900 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1940 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1980 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
19C0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A40 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1A80 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1AC0 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B00 : XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX XXXXXXXXXXXXXXXX
1B40 : XXXXXXXXXXXXXXXX XXXXXX---------- ---------------- ----------------
0000 : XXXX-XX-XXXXXX-- ---------------- ---------------- ----------------

All other memory blocks unused.

Program Memory Bytes Used:  7010
Program Memory Bytes Free: 25758


Errors   :     0
Warnings :     0 reported,     0 suppressed
Messages :     0 reported,     0 suppressed

